---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Yineleme #5 – Oluştur birim testleri (C#) | Microsoft Docs'
author: microsoft
description: Beşinci yinelemede biz uygulamamız korumak ve birim testleri ekleyerek değiştirmek kolaylaştırır. Biz bizim veri modeli sınıflarını mock ve o için birim testleri oluştur...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a61b5791a40088df9d27f7b1bd37df1831ef22b
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30875584"
---
<a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="1a056-104">Yineleme #5 – birim testleri oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="1a056-104">Iteration #5 – Create unit tests (C#)</span></span>
====================
<span data-ttu-id="1a056-105">tarafından [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="1a056-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="1a056-106">Kodu indirme</span><span class="sxs-lookup"><span data-stu-id="1a056-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="1a056-107">Beşinci yinelemede biz uygulamamız korumak ve birim testleri ekleyerek değiştirmek kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="1a056-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="1a056-108">Biz bizim veri modeli sınıflarını mock ve bizim denetleyicileri ve Doğrulama mantığı için birim testleri oluşturma.</span><span class="sxs-lookup"><span data-stu-id="1a056-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="1a056-109">Bir kişi yönetim ASP.NET MVC uygulaması (C#) oluşturma</span><span class="sxs-lookup"><span data-stu-id="1a056-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="1a056-110">Bu öğretici serisinde tamamlamak için tüm kişi yönetim uygulamanın başından oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1a056-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="1a056-111">Kişi Yöneticisi uygulama kişi listesi için kişi bilgilerini - adları, telefon numarası ve e-posta adresleri - depolamak sağlar.</span><span class="sxs-lookup"><span data-stu-id="1a056-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="1a056-112">Biz uygulamayı birden çok kez oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1a056-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="1a056-113">Her bir yineleme, biz kademeli olarak uygulama geliştirin.</span><span class="sxs-lookup"><span data-stu-id="1a056-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="1a056-114">Bu birden çok yineleme yaklaşımı, her değişiklik nedeni anlamak etkinleştirmek için hedefidir.</span><span class="sxs-lookup"><span data-stu-id="1a056-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="1a056-115">Yineleme #1 - uygulama oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1a056-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="1a056-116">İlk yinelemede Contact Manager en basit yolu olası oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="1a056-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="1a056-117">Temel veritabanı işlemleri için destek eklediğimiz: oluşturma, okuma, güncelleştirme ve silme (CRUD).</span><span class="sxs-lookup"><span data-stu-id="1a056-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="1a056-118">Yineleme #2 - iyi Ara uygulama olun.</span><span class="sxs-lookup"><span data-stu-id="1a056-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="1a056-119">Bu yinelemede biz ana görünüm sayfası, ASP.NET MVC varsayılan değiştirme ve geçişli stil sayfası uygulama görünümünü geliştirir.</span><span class="sxs-lookup"><span data-stu-id="1a056-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="1a056-120">Yineleme #3 - form doğrulama ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="1a056-121">Üçüncü yinelemede temel form doğrulama ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="1a056-122">Biz, kişilerin gerekli form alanları tamamlamadan bir form gönderme engelleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="1a056-123">Biz de e-posta adresleri ve telefon numaralarını doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="1a056-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="1a056-124">Yineleme #4 - gevşek uygulama olun.</span><span class="sxs-lookup"><span data-stu-id="1a056-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="1a056-125">Bu üçüncü yinelemede biz Bakım ve ilgili kişi Yöneticisi uygulaması değişiklik kolaylaştırmak için çeşitli yazılım tasarım desenleri yararlanın.</span><span class="sxs-lookup"><span data-stu-id="1a056-125">In this third iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="1a056-126">Örneğin, uygulamamız havuz deseni ve bağımlılık ekleme düzeni kullanmak üzere yeniden.</span><span class="sxs-lookup"><span data-stu-id="1a056-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="1a056-127">Yineleme #5 - birim testleri oluşturma.</span><span class="sxs-lookup"><span data-stu-id="1a056-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="1a056-128">Beşinci yinelemede biz uygulamamız korumak ve birim testleri ekleyerek değiştirmek kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="1a056-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="1a056-129">Biz bizim veri modeli sınıflarını mock ve bizim denetleyicileri ve Doğrulama mantığı için birim testleri oluşturma.</span><span class="sxs-lookup"><span data-stu-id="1a056-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="1a056-130">Yineleme #6 - teste dayalı geliştirme kullanın.</span><span class="sxs-lookup"><span data-stu-id="1a056-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="1a056-131">Bu altıncı yinelemede yeni işlevsellik uygulamamız için birim testleri ilk yazma ve birim testleri karşı kod yazma ekleriz.</span><span class="sxs-lookup"><span data-stu-id="1a056-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="1a056-132">Bu yinelemede kişi grupları ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="1a056-133">Yineleme #7 - Ajax işlevselliği ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="1a056-134">Yedinci yinelemede biz uygulamamız performansını ve yanıt hızını Ajax için destek ekleyerek geliştirin.</span><span class="sxs-lookup"><span data-stu-id="1a056-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="1a056-135">Bu yineleme</span><span class="sxs-lookup"><span data-stu-id="1a056-135">This Iteration</span></span>

<span data-ttu-id="1a056-136">Contact Manager uygulamasının önceki yinelemede daha gevşek için uygulamanın yeniden.</span><span class="sxs-lookup"><span data-stu-id="1a056-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="1a056-137">Biz ayrı denetleyici, hizmet ve depo Katmanlar uygulamasına ayrılmış.</span><span class="sxs-lookup"><span data-stu-id="1a056-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="1a056-138">Her katman altındaki katmanı arabirimleri aracılığıyla ile etkileşim kurar.</span><span class="sxs-lookup"><span data-stu-id="1a056-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="1a056-139">Uygulamanın Bakım ve değişiklik daha kolay hale getirmek için uygulama yeniden düzenlenmiş sürümlere.</span><span class="sxs-lookup"><span data-stu-id="1a056-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="1a056-140">Yeni bir veri erişim teknolojisini ihtiyacınız varsa, örneğin, biz yalnızca depo katman denetleyici veya hizmet katmanı dokunmadan değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="1a056-141">Gevşek, kişinin Yöneticisi yaparak biz ve uygulama değiştirmek için daha esnek hale.</span><span class="sxs-lookup"><span data-stu-id="1a056-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="1a056-142">Ancak kişinin Yöneticisi uygulamaya yeni bir özellik eklemek ihtiyacımız ne olur?</span><span class="sxs-lookup"><span data-stu-id="1a056-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="1a056-143">Veya, biz hata düzeltme ne olur?</span><span class="sxs-lookup"><span data-stu-id="1a056-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="1a056-144">Yeni hatalar Tanıtımı riskini oluşturduğunuz kod touch her kod yazmaya üzücü, ancak iyi kanıtlanmış gerçekte olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="1a056-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="1a056-145">Örneğin, bir ince günü, yöneticinize başvurun Yöneticisi için yeni bir özellik eklemek için isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="1a056-146">İlgili kişi grupları için destek eklemek istediği.</span><span class="sxs-lookup"><span data-stu-id="1a056-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="1a056-147">Kullanıcıların kendi kişiler arkadaşlarınız, iş vb. gibi gruplar halinde düzenlemek istediği.</span><span class="sxs-lookup"><span data-stu-id="1a056-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="1a056-148">Bu yeni özellik uygulamak için tüm üç katmanı Contact Manager uygulamasının değiştirmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="1a056-149">Denetleyicileri, hizmet katmanı ve depo yeni işlevsellik eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="1a056-150">Kod değiştirme başlar başlamaz, önce çalışılan işlevselliği sonu riski oluşur.</span><span class="sxs-lookup"><span data-stu-id="1a056-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="1a056-151">Önceki yinelemede yaptığımız gibi uygulamamız ayrı katmanlara yeniden düzenleme dâhil oluştu.</span><span class="sxs-lookup"><span data-stu-id="1a056-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="1a056-152">Bize uygulamanın geri kalanına dokunmadan tüm katmanlara değişiklik yapmak sağladığından dâhil oluştu.</span><span class="sxs-lookup"><span data-stu-id="1a056-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="1a056-153">Ancak, bir katman içindeki kod Bakım ve değişiklik daha kolay yapmak istiyorsanız, kod için birim testleri oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="1a056-154">Bir birim kod tek bir birim sınamak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="1a056-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="1a056-155">Bu kodu tüm uygulama katmanları küçük birimleridir.</span><span class="sxs-lookup"><span data-stu-id="1a056-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="1a056-156">Genellikle, birim testi kodunuzda belirli bir yöntem beklediğiniz şekilde davranan olup olmadığını doğrulamak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="1a056-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="1a056-157">Örneğin, birim testi ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact() yöntemi için oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="1a056-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="1a056-158">Yalnızca bir uygulama çalışması için birim testleri güvenlik ağı ister.</span><span class="sxs-lookup"><span data-stu-id="1a056-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="1a056-159">Bir uygulama kodunda değişiklik olduğunda, bir dizi değişiklik mevcut işlevlerde olup olmadığını denetlemek için birim testleri çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="1a056-160">Birim testleri kodunuzu değiştirmek güvenli hale getirir.</span><span class="sxs-lookup"><span data-stu-id="1a056-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="1a056-161">Birim testleri tüm kodu, uygulamanızda değiştirmek için daha esnek olun.</span><span class="sxs-lookup"><span data-stu-id="1a056-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="1a056-162">Bu yinelemede Contact Manager uygulamamız için birim testleri ekleriz.</span><span class="sxs-lookup"><span data-stu-id="1a056-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="1a056-163">Böylece, sonraki yinelemede ilgili kişi grupları uygulamamız için var olan işlevselliği bölme hakkında endişelenmeden ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="1a056-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1a056-164">Birim testi çerçevelerini NUnit, xUnit.net ve MbUnit dahil olmak üzere çeşitli vardır.</span><span class="sxs-lookup"><span data-stu-id="1a056-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="1a056-165">Bu öğreticide, birim testi çerçevesi ile Visual Studio dahil kullanırız.</span><span class="sxs-lookup"><span data-stu-id="1a056-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="1a056-166">Ancak, bu alternatif çerçeveleri birini kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="1a056-167">Test</span><span class="sxs-lookup"><span data-stu-id="1a056-167">What Gets Tested</span></span>

<span data-ttu-id="1a056-168">İdeal şartlar altında tüm kodunuzu birim testleri tarafından ele.</span><span class="sxs-lookup"><span data-stu-id="1a056-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="1a056-169">İdeal şartlar altında kusursuz güvenlik ağı gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="1a056-170">Uygulamanızdaki kod satırıyla değiştirebilir ve hemen birim testlerinizi yürüterek değişiklik mevcut işlevselliğini ihlal olup olmadığını bilmek gerçekleştirebilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="1a056-171">Ancak, mükemmel bir dünya dinamik t güncelleştireceğinizi.</span><span class="sxs-lookup"><span data-stu-id="1a056-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="1a056-172">Uygulamada birim testleri yazma sırasında iş mantığınızı (örneğin, doğrulama mantığını) için testleri yazma yoğunlaşabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="1a056-173">Özellikle, *sağlamadığı* verileriniz için birim testleri yazma erişim mantığı ya da Görünüm mantığınızı.</span><span class="sxs-lookup"><span data-stu-id="1a056-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="1a056-174">Kullanışlı olması için birim testleri çok hızlı bir şekilde yürütmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="1a056-175">Bir uygulama için birim testleri yüzlerce (veya hatta binlerce) kolayca birikebilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="1a056-176">Birim testleri çalıştırmak uzun sürebilir, bunları yürütmesini kaçının.</span><span class="sxs-lookup"><span data-stu-id="1a056-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="1a056-177">Diğer bir deyişle, uzun süre çalışan birim testleri için günlük kodlama amaçlı yaramaz.</span><span class="sxs-lookup"><span data-stu-id="1a056-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="1a056-178">Bu nedenle, genellikle bir veritabanıyla etkileşim kod için birim testleri yazma.</span><span class="sxs-lookup"><span data-stu-id="1a056-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="1a056-179">Birim testleri yüzlerce canlı bir veritabanına karşı çalışan çok yavaş olacaktır.</span><span class="sxs-lookup"><span data-stu-id="1a056-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="1a056-180">Bunun yerine, veritabanınızı mock ve (bir veritabanı mocking aşağıdakiler ele) sahte veritabanıyla etkileşim kod yazın.</span><span class="sxs-lookup"><span data-stu-id="1a056-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="1a056-181">Benzer bir nedeni, genellikle görünümleri için birim testleri yazma.</span><span class="sxs-lookup"><span data-stu-id="1a056-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="1a056-182">Bir görünümü test etmek amacıyla bir web sunucusu kurma dönmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="1a056-183">Bir web sunucusu dönen görece yavaş bir işlem olduğundan, kendi görünümlerinizi için birim testleri oluşturma önerilmez.</span><span class="sxs-lookup"><span data-stu-id="1a056-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="1a056-184">Görünümünüzü karmaşık mantık içeriyorsa mantığı yardımcı yöntemler taşıma düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="1a056-185">Bir web sunucusu dönen olmadan yürütme yardımcı yöntemler için birim testleri yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1a056-186">İşlev oluşturma veya tümleştirme testleri çalıştırılırken yazma için veri erişim mantığı testleri veya Görünüm mantığı iyi bir fikir birim testleri yazma değil, ancak bu testler çok yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="1a056-187">ASP.NET MVC Web Forms görünüm altyapısıdır.</span><span class="sxs-lookup"><span data-stu-id="1a056-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="1a056-188">Web Forms görünüm altyapısının bir web sunucusuna bağlı olsa da, diğer görünüm altyapıları olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="1a056-189">Sahte nesne Framework kullanma</span><span class="sxs-lookup"><span data-stu-id="1a056-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="1a056-190">Birim testleri oluştururken, neredeyse her zaman bir Mock nesne çerçevesinden yararlanamazsınız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="1a056-191">Bir nesne Mock framework mocks ve saplamalar sınıfları için uygulamanızda oluşturmanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="1a056-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="1a056-192">Örneğin, depo sınıfınız sahte bir sürümüne oluşturmak için bir nesne Mock framework kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="1a056-193">Bu şekilde, birim testleri yerine gerçek depo sınıfını sahte depo sınıfını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="1a056-194">Sahte depo kullanarak, birim testi yürütülürken veritabanı kod yürütmek önlemek sağlar.</span><span class="sxs-lookup"><span data-stu-id="1a056-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="1a056-195">Visual Studio Mock nesne framework içermez.</span><span class="sxs-lookup"><span data-stu-id="1a056-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="1a056-196">Ancak, çeşitli ticari ve açık kaynak Mock nesne çerçeveleri .NET framework için kullanılabilen vardır:</span><span class="sxs-lookup"><span data-stu-id="1a056-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="1a056-197">Moq - bu çerçeve açık kaynak BSD lisans kapsamında kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="1a056-198">Gelen Moq indirebilirsiniz [ https://code.google.com/p/moq/ ](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="1a056-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="1a056-199">Kemalu Mocks - bu çerçeve açık kaynak BSD lisans kapsamında kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="1a056-200">Kemalu Mocks indirebilirsiniz [ http://ayende.com/projects/rhino-mocks.aspx ](http://ayende.com/projects/rhino-mocks.aspx).</span><span class="sxs-lookup"><span data-stu-id="1a056-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="1a056-201">Typemock ayırıcı - bu ticari bir çerçevedir.</span><span class="sxs-lookup"><span data-stu-id="1a056-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="1a056-202">Deneme sürümünden indirebilirsiniz [ http://www.typemock.com/ ](http://www.typemock.com/).</span><span class="sxs-lookup"><span data-stu-id="1a056-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="1a056-203">Bu öğreticide, t Moq kullanmaya karar vermiştir.</span><span class="sxs-lookup"><span data-stu-id="1a056-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="1a056-204">Ancak, kemalu Mocks kolayca kullanabilirsiniz veya Contact Manager uygulaması için Typemock Mock oluşturmak için ayırıcı nesneleri.</span><span class="sxs-lookup"><span data-stu-id="1a056-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="1a056-205">Moq kullanmadan önce aşağıdaki adımları tamamlamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="1a056-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="1a056-206">biçimindeki telefon numarasıdır.</span><span class="sxs-lookup"><span data-stu-id="1a056-206">.</span></span>
2. <span data-ttu-id="1a056-207">İndirme sıkıştırmasını önce dosyaya sağ tıklayın ve etiketli düğmesine tıklayabilir emin olun **Engellemeyi Kaldır** (bkz: Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="1a056-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="1a056-208">İndirme sıkıştırmasını açın.</span><span class="sxs-lookup"><span data-stu-id="1a056-208">Unzip the download.</span></span>
4. <span data-ttu-id="1a056-209">Moq derlemesine başvuru ContactManager.Tests proje başvuruları klasörüne sağ tıklayıp seçerek eklemek **Başvuru Ekle**.</span><span class="sxs-lookup"><span data-stu-id="1a056-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="1a056-210">Gözat sekmesinin altında Burada, Moq sıkıştırması açılmış klasöre göz atın ve Moq.dll derleme seçin.</span><span class="sxs-lookup"><span data-stu-id="1a056-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="1a056-211">Tıklatın **Tamam** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="1a056-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="1a056-212">Bu adımları tamamladıktan sonra başvuruları klasörünüze Şekil 2'gibi görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="1a056-212">After you complete these steps, your References folder should look like Figure 2.</span></span>


<span data-ttu-id="1a056-213">[![Engellemeyi kaldırma Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1a056-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="1a056-214">**Şekil 01**: engellemesini kaldırma Moq ([tam boyutlu görüntüyü görüntülemek için tıklatın](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="1a056-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>


<span data-ttu-id="1a056-215">[![Moq ekledikten sonra başvuruları](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1a056-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="1a056-216">**Şekil 02**: Moq ekledikten sonra başvurular ([tam boyutlu görüntüyü görüntülemek için tıklatın](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="1a056-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="1a056-217">Hizmet katmanı için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="1a056-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="1a056-218">Bizim Contact Manager uygulama s hizmet katmanı için birim testleri kümesi oluşturarak başlayın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="1a056-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="1a056-219">Doğrulama mantığımızı doğrulamak için bu testler kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="1a056-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="1a056-220">Modelleri ContactManager.Tests projesinde adlı yeni bir klasör oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1a056-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="1a056-221">Ardından, modeller klasörü sağ tıklatın ve seçin **Ekle, Yeni Test**.</span><span class="sxs-lookup"><span data-stu-id="1a056-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="1a056-222">**Yeni Test Ekle** Şekil 3'te gösterilen iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="1a056-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="1a056-223">Seçin **birim testi** şablonu ve yeni testinizi ContactManagerServiceTest.cs olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="1a056-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="1a056-224">Tıklatın **Tamam** düğmesi, yeni test Test projenize ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1a056-225">Genel olarak, ASP.NET MVC projenizin klasör yapısını eşleşecek şekilde Test projenizin klasör yapısını istiyor.</span><span class="sxs-lookup"><span data-stu-id="1a056-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="1a056-226">Örneğin, denetleyici testleri modeller klasörü modeli testlerinde bir denetleyicileri klasöre yerleştirin ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="1a056-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


<span data-ttu-id="1a056-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1a056-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="1a056-228">**Şekil 03**: Models\ContactManagerServiceTest.cs ([tam boyutlu görüntüyü görüntülemek için tıklatın](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1a056-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>


<span data-ttu-id="1a056-229">Başlangıçta, ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact() yöntemi test etmek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="1a056-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="1a056-230">Aşağıdaki beş sınama oluşturacağız:</span><span class="sxs-lookup"><span data-stu-id="1a056-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="1a056-231">CreateContact() - testler o CreateContact() döner true değerini geçerli bir kişi yönteme geçirilen.</span><span class="sxs-lookup"><span data-stu-id="1a056-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="1a056-232">CreateContactRequiredFirstName() - model durumuna bir kişi, eksik bir ad ile bir hata iletisi eklenir testleri CreateContact() yönteme geçirilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="1a056-233">CreateContactRequredLastName() - model durumu son adı eksik sahip bir kişi olduğunda hata iletisi eklenir testleri CreateContact() yönteme geçirilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-233">CreateContactRequredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="1a056-234">CreateContactInvalidPhone() - model durumuna bir kişi, geçersiz bir telefon numarası ile bir hata iletisi eklenir testleri CreateContact() yönteme geçirilir.</span><span class="sxs-lookup"><span data-stu-id="1a056-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="1a056-235">CreateContactInvalidEmail() - model durumuna bir kişi, e-posta adresi olan bir hata iletisi eklenir testleri CreateContact() yöntemine iletilir...</span><span class="sxs-lookup"><span data-stu-id="1a056-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="1a056-236">Geçerli bir kişi bir doğrulama hatası oluşturmaz ilk test doğrular.</span><span class="sxs-lookup"><span data-stu-id="1a056-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="1a056-237">Kalan testleri her doğrulama kuralları denetleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="1a056-238">Bu testler için kod listeleme 1'de yer alır.</span><span class="sxs-lookup"><span data-stu-id="1a056-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="1a056-239">**1 - Models\ContactManagerServiceTest.cs listeleme**</span><span class="sxs-lookup"><span data-stu-id="1a056-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]


<span data-ttu-id="1a056-240">İlgili kişi sınıf listeleme 1'de kullandığından bizim Test projesi için Microsoft Entity Framework bir başvuru eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="1a056-241">System.Data.Entity derlemesine başvuru ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1a056-241">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="1a056-242">1 Listeleme [TestInitialize] özniteliği ile donatılmış Initialize() adlı bir yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="1a056-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="1a056-243">Bu yöntem her birim testleri çalıştırmadan önce otomatik olarak adlandırılır (buna 5 kez sağ her bir birim testleri önce denir).</span><span class="sxs-lookup"><span data-stu-id="1a056-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="1a056-244">Önce Initialize() yöntemini aşağıdaki kod satırını ile sahte bir depo oluşturur:</span><span class="sxs-lookup"><span data-stu-id="1a056-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="1a056-245">Bu kod satırı Moq framework IContactManagerRepository arabiriminden sahte bir havuz oluşturmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="1a056-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="1a056-246">Sahte depo yerine gerçek EntityContactManagerRepository her birim testi çalıştırma veritabanına erişmesini önlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="1a056-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="1a056-247">Sahte depo IContactManagerRepository arabirimi yöntemlerini uygular, ancak yöntemler tan t gerçekten bunu herhangi bir şey.</span><span class="sxs-lookup"><span data-stu-id="1a056-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1a056-248">Moq framework kullanılırken arasında fark yoktur \_mockRepository ve \_mockRepository.Object.</span><span class="sxs-lookup"><span data-stu-id="1a056-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="1a056-249">Önceki Mock başvuruyor&lt;IContactManagerRepository&gt; sahte depo nasıl davranacak belirtmek için yöntemleri içeren sınıf.</span><span class="sxs-lookup"><span data-stu-id="1a056-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="1a056-250">İkincisi IContactManagerRepository arabirimini uygulayan gerçek sahte depoya ifade eder.</span><span class="sxs-lookup"><span data-stu-id="1a056-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="1a056-251">Sahte depo önce Initialize() yöntemini ContactManagerService sınıfının bir örneği oluşturulurken kullanılır.</span><span class="sxs-lookup"><span data-stu-id="1a056-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="1a056-252">Tüm tek tek birim testleri ContactManagerService sınıfı bu örneğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="1a056-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="1a056-253">1 listeleme her birim testleri karşılık gelen beş yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="1a056-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="1a056-254">Bu yöntemlerin her biri [TestMethod] özniteliği ile tasarlandığına.</span><span class="sxs-lookup"><span data-stu-id="1a056-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="1a056-255">Birim testleri çalıştırdığınızda bu özniteliğine sahip herhangi bir yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="1a056-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="1a056-256">Diğer bir deyişle, [TestMethod] özniteliği ile donatılmış herhangi bir birim testi yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="1a056-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="1a056-257">İlgili kişi sınıf geçerli bir örneği yönteme geçirilen CreateContact() çağırma true değerini döndürür, CreateContact(), adlı ilk birim testi doğrular.</span><span class="sxs-lookup"><span data-stu-id="1a056-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="1a056-258">Test kişiyi sınıfının bir örneğini oluşturur, CreateContact() yöntemini çağırır ve CreateContact() true değerini döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="1a056-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="1a056-259">Kalan testleri geçersiz bir kişiyle CreateContact() yöntemi çağrıldığında sonra yöntemi false değerini döndürür ve beklenen doğrulama hatası iletisini model durumuna eklenmiş olduğunu doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="1a056-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="1a056-260">Örneğin, CreateContactRequiredFirstName() test FirstName özelliği için boş bir dize kişiyi sınıfının bir örneğini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1a056-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="1a056-261">Ardından, CreateContact() yöntemi geçersiz kişiyle çağrılır.</span><span class="sxs-lookup"><span data-stu-id="1a056-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="1a056-262">Son olarak, test CreateContact() false döndürür ve model durumu "ilk adı gereklidir." beklenen doğrulama hatası iletisini içeren doğrular</span><span class="sxs-lookup"><span data-stu-id="1a056-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="1a056-263">Menü seçeneğini seçerek listeleme 1'de birim testleri çalıştırabilirsiniz **Test çalışması, çözüm (CTRL + R, A) tüm testler,**.</span><span class="sxs-lookup"><span data-stu-id="1a056-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="1a056-264">Test sonuçlarını Test Sonuçları penceresinde görüntülenir (Şekil 4'e bakın).</span><span class="sxs-lookup"><span data-stu-id="1a056-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


<span data-ttu-id="1a056-265">[![Test sonuçları](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1a056-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="1a056-266">**Şekil 04**: Test sonuçlarını ([tam boyutlu görüntüyü görüntülemek için tıklatın](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="1a056-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="1a056-267">Denetleyicileri için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="1a056-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="1a056-268">ASP.NETMVC uygulama kullanıcı etkileşimi akışını denetler.</span><span class="sxs-lookup"><span data-stu-id="1a056-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="1a056-269">Bir denetleyici test edilirken sağ eylem sonucu ve görünüm verileri denetleyiciye döndürüp döndürmediğini test etmek istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="1a056-270">Bir denetleyici beklendiği şekilde modeli sınıfları ile etkileşime giren olup olmadığını test etmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="1a056-271">Örneğin, listeleme 2 kişi denetleyicisi Create() yöntemi için iki birim testleri içerir.</span><span class="sxs-lookup"><span data-stu-id="1a056-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="1a056-272">İlk birim testi Create() yöntemi dizin eyleme yeniden yönlendirir sonra geçerli bir kişi Create() yönteme geçirildiğinde doğrular.</span><span class="sxs-lookup"><span data-stu-id="1a056-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="1a056-273">Diğer bir deyişle, geçerli bir kişi geçirildiğinde Create() yöntemi dizin eylemi temsil eden bir RedirectToRouteResult döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="1a056-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="1a056-274">Biz t biz denetleyicisi katman sınarken ContactManager hizmet katmanı sınamak istiyorsanız güncelleştireceğinizi.</span><span class="sxs-lookup"><span data-stu-id="1a056-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="1a056-275">Bu nedenle, aşağıdaki kod Initialize yöntemi ile hizmet katmanı mock:</span><span class="sxs-lookup"><span data-stu-id="1a056-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="1a056-276">CreateValidContact() birim testi hizmet katmanı aşağıdaki kod satırını CreateContact() yöntemiyle çağırma davranışını mock:</span><span class="sxs-lookup"><span data-stu-id="1a056-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="1a056-277">Bu kod satırı CreateContact() yöntemi çağrıldığında true değerini döndürmek sahte ContactManager hizmetinin neden olur.</span><span class="sxs-lookup"><span data-stu-id="1a056-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="1a056-278">Hizmet katmanı mocking tarafından size herhangi bir kod hizmet katmanında gerek kalmadan denetleyicimizin davranışını test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="1a056-279">İkinci birim testi Create() eylem yöntemi için geçersiz bir kişi geçirildiğinde Oluştur görünümünün döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="1a056-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="1a056-280">Biz, hizmet katmanı ile aşağıdaki kod satırını false değerini döndürür CreateContact() yöntemi neden:</span><span class="sxs-lookup"><span data-stu-id="1a056-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="1a056-281">Create() yöntemi bekliyoruz gibi davranır, hizmet katmanı false değerini döndürür, ardından bunu Oluştur görünümünün döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="1a056-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="1a056-282">Bu şekilde, denetleyici oluşturma görünümünde doğrulama hatası iletilerini görüntüleyebilirsiniz ve kullanıcının bu geçersiz kişi özellikler düzeltmek için bir fırsat.</span><span class="sxs-lookup"><span data-stu-id="1a056-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="1a056-283">Denetleyicileriniz için birim testleri oluşturmayı planlıyorsanız açık görünüm adları denetleyicisi eylemlerden dönmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="1a056-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="1a056-284">Örneğin, şöyle bir görünüm döndürmeyen:</span><span class="sxs-lookup"><span data-stu-id="1a056-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="1a056-285">View() döndürür;</span><span class="sxs-lookup"><span data-stu-id="1a056-285">return View();</span></span>

<span data-ttu-id="1a056-286">Bunun yerine, bu gibi görünümü döndürün:</span><span class="sxs-lookup"><span data-stu-id="1a056-286">Instead, return the view like this:</span></span>

<span data-ttu-id="1a056-287">View("create") döndürür;</span><span class="sxs-lookup"><span data-stu-id="1a056-287">return View("Create");</span></span>

<span data-ttu-id="1a056-288">Bir görünüm döndürülürken konusunda açık değilse ViewResult.ViewName özellik boş bir dize döndürür.</span><span class="sxs-lookup"><span data-stu-id="1a056-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


<span data-ttu-id="1a056-289">**2 - Controllers\ContactControllerTest.cs listeleme**</span><span class="sxs-lookup"><span data-stu-id="1a056-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="1a056-290">Özet</span><span class="sxs-lookup"><span data-stu-id="1a056-290">Summary</span></span>

<span data-ttu-id="1a056-291">Bu yinelemede Contact Manager uygulamamız için birim testleri oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="1a056-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="1a056-292">Uygulamamız hala bekliyoruz şekilde davranır doğrulamak için herhangi bir zamanda Biz bu birim testlerini çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1a056-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="1a056-293">Birim testleri, uygulamamız gelecekte güvenli bir şekilde değiştirmek bize etkinleştirme uygulamamız için güvenlik ağı görevi görür.</span><span class="sxs-lookup"><span data-stu-id="1a056-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="1a056-294">Birim testleri iki kümesi oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="1a056-294">We created two sets of unit tests.</span></span> <span data-ttu-id="1a056-295">İlk olarak, doğrulama mantığımızı bizim hizmet katmanı için birim testleri oluşturarak test.</span><span class="sxs-lookup"><span data-stu-id="1a056-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="1a056-296">Ardından, akış denetimi mantığımızı bizim denetleyicisi katmanı için birim testleri oluşturarak test.</span><span class="sxs-lookup"><span data-stu-id="1a056-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="1a056-297">Bizim hizmet katmanı test edilirken biz testlerimiz bizim hizmet katmanı için bizim havuz katmanından bizim deposu katman mocking tarafından ayrılmış.</span><span class="sxs-lookup"><span data-stu-id="1a056-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="1a056-298">Denetleyici katman sınarken, biz testlerimizde bizim denetleyicisi katmanı için hizmet katmanı mocking tarafından yalıtılmış.</span><span class="sxs-lookup"><span data-stu-id="1a056-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="1a056-299">İlgili kişi grupları destekler şekilde sonraki yinelemede biz Kişi Yöneticisi uygulaması değiştirin.</span><span class="sxs-lookup"><span data-stu-id="1a056-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="1a056-300">Bu yeni işlevsellik teste dayalı geliştirme adlı bir yazılım tasarım işlemi kullanarak uygulamamız ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="1a056-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1a056-301">[Önceki](iteration-4-make-the-application-loosely-coupled-cs.md)
> [sonraki](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="1a056-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
