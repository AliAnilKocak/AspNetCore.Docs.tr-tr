---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: (C#) kullanıcılara roller atama | Microsoft Docs
author: rick-anderson
description: Bu öğreticide biz hangi kullanıcıların hangi rollere ait yönetmeye yardımcı olmak üzere iki ASP.NET sayfaları oluşturacaksınız. İlk sayfasını görmek için tesis içerecektir...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/24/2008
ms.topic: article
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: a0518cd04f6b7f055a413b2b236712965451839c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891392"
---
<a name="assigning-roles-to-users-c"></a><span data-ttu-id="cc0e0-104">(C#) kullanıcılara roller atama</span><span class="sxs-lookup"><span data-stu-id="cc0e0-104">Assigning Roles to Users (C#)</span></span>
====================
<span data-ttu-id="cc0e0-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cc0e0-106">[Kodu indirme](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) veya [PDF indirin](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="cc0e0-107">Bu öğreticide biz hangi kullanıcıların hangi rollere ait yönetmeye yardımcı olmak üzere iki ASP.NET sayfaları oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="cc0e0-108">Hangi kullanıcıların belirli bir role ait görmek için tesis ilk sayfasına ekleneceğini belirli bir kullanıcının ait olduğu için hangi rollerin ve atama veya belirli bir kullanıcının belirli bir rolden kaldırma yeteneği.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="cc0e0-109">Yeni oluşturulan kullanıcı ait hangi rolleri belirlemek üzere bir adımı içeren ikinci sayfasında biz CreateUserWizard denetim kullanmasıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="cc0e0-110">Bu, bir yöneticinin yeni kullanıcı hesapları oluşturmak mümkün olduğu senaryolarda kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="cc0e0-111">Giriş</span><span class="sxs-lookup"><span data-stu-id="cc0e0-111">Introduction</span></span>

<span data-ttu-id="cc0e0-112"><a id="_msoanchor_1"> </a> [Önceki öğretici](creating-and-managing-roles-cs.md) rolleri framework incelenmesi ve `SqlRoleProvider`; nasıl kullanılacağını gördüğümüz `Roles` oluşturmak, almak ve rollerini silmek için sınıf.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="cc0e0-113">Oluşturma ve rollerini silme ek olarak, biz atayın veya kullanıcılar bir rolden kaldırmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="cc0e0-114">Ne yazık ki, ASP.NET hangi kullanıcıların hangi rollere ait yönetmek için tüm Web denetimleri ile birlikte gelmez.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="cc0e0-115">Bunun yerine, biz bu ilişkileri yönetmek için kendi ASP.NET sayfaları oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="cc0e0-116">İyi haber o ekleme ve kullanıcıları rollere kaldırma oldukça kolaydır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="cc0e0-117">`Roles` Sınıfı bir veya daha fazla rol için bir veya daha fazla kullanıcı eklemek için yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="cc0e0-118">Bu öğreticide biz hangi kullanıcıların hangi rollere ait yönetmeye yardımcı olmak üzere iki ASP.NET sayfaları oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="cc0e0-119">Hangi kullanıcıların belirli bir role ait görmek için tesis ilk sayfasına ekleneceğini belirli bir kullanıcının ait olduğu için hangi rollerin ve atama veya belirli bir kullanıcının belirli bir rolden kaldırma yeteneği.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="cc0e0-120">Yeni oluşturulan kullanıcı ait hangi rolleri belirlemek üzere bir adımı içeren ikinci sayfasında biz CreateUserWizard denetim kullanmasıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="cc0e0-121">Bu, bir yöneticinin yeni kullanıcı hesapları oluşturmak mümkün olduğu senaryolarda kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="cc0e0-122">Haydi başlayalım!</span><span class="sxs-lookup"><span data-stu-id="cc0e0-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="cc0e0-123">Hangi rollere ait hangi kullanıcıların listeleme</span><span class="sxs-lookup"><span data-stu-id="cc0e0-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="cc0e0-124">İlk iş sırası Bu öğretici için kendisinden rollere kullanıcıları atanabilir bir web sayfası oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="cc0e0-125">Kullanıcıları rollere atama ile biz kendisini ilgilendiren önce şimdi önce hangi kullanıcıların hangi rollere ait belirlemekte nasıl yoğunlaşabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="cc0e0-126">Bu bilgileri görüntülemek için iki yolu vardır: "rol" veya "kullanıcı tarafından."</span><span class="sxs-lookup"><span data-stu-id="cc0e0-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="cc0e0-127">Bir rol seçin ve ardından bunları ("rol tarafından" görüntüle) rolüne ait tüm kullanıcıları göster ziyaretçi izin verebilir veya bir kullanıcı seçin ve ardından o kullanıcıya ("kullanıcı tarafından" görüntüle) atanan rollerden göstermek için ziyaretçi sor.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="cc0e0-128">"Rol" görünümü ziyaretçi burada belirli bir role ait kullanıcılar kümesini bilmek ister durumlarda kullanışlıdır. "kullanıcı" görünümü ziyaretçi belirli bir kullanıcının rollerini bilmeniz gerektiğinde idealdir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="cc0e0-129">Hem "rol" ve "kullanıcı tarafından" dahil sayfamızı şimdi sahip arabirimler.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="cc0e0-130">Biz "kullanıcı tarafından" arabirimi oluşturma ile başlar.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="cc0e0-131">Bu arabirim, aşağı açılan liste ve onay kutularını listesini oluşur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="cc0e0-132">Aşağı açılan liste kullanıcılar kümesiyle sistemde doldurulur; onay kutularını rolleri numaralandırır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="cc0e0-133">Bir kullanıcı aşağı açılan listeden seçerek kullanıcının ait olduğu bu rollerden kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="cc0e0-134">Sayfasını ziyaret kişi sonra denetleyebilir veya eklemek veya karşılık gelen rollerden Seçili kullanıcıyı kaldırmak için onay kutusunun işaretini kaldırın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="cc0e0-135">Bir açılır listesini kullanarak kullanıcı hesaplarını değil Web siteleri için ideal seçim olabilir yerde kullanıcı hesapları yüzlerce.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="cc0e0-136">Aşağı açılan liste seçeneklerden daha kısa bir listeden bir öğe seçmek bir kullanıcı izin vermek için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="cc0e0-137">Liste öğeleri sayısı arttıkça hızla yönetilmeleri olur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="cc0e0-138">Potansiyel olarak çok sayıda kullanıcı hesaplarına sahip olan bir Web sitesi oluşturuyorsanız, disk belleğine alınabilir GridView veya listeleyen bir filtrelenebilir arabirimi ziyaretçi bir harf seçmenizi ister gibi bir alternatif kullanıcı arabirimini kullanarak isteyebilirsiniz ve ardından yalnızca Kullanıcı adı seçilen harfle başlayan kullanıcılarla gösterir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="cc0e0-139">1. adım: "kullanıcı tarafından" kullanıcı arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="cc0e0-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="cc0e0-140">Açık `UsersAndRoles.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="cc0e0-141">Sayfanın en üstünde adlı bir etiket Web denetimi ekleme `ActionStatus` ve temizleyin, `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="cc0e0-142">İletileri gibi görüntüleme gerçekleştirilen eylemler hakkında geri bildirim sağlamak için bu etiket kullanacağız, "kullanıcı Tito Yöneticiler rolüne eklenmiş olan" veya "Kullanıcı Jisun denetçiler rolünden kaldırılmıştır."</span><span class="sxs-lookup"><span data-stu-id="cc0e0-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="cc0e0-143">Bunlar yapmak için iletileri göze etiketin ayarlamak `CssClass` "Önemli" özelliği.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="cc0e0-144">Ardından, aşağıdaki CSS sınıf tanımına ekleme `Styles.css` stil sayfası:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="cc0e0-145">Bu CSS tanımı büyük, kırmızı bir yazı tipi kullanarak etiketi görüntülemek için tarayıcıyı yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="cc0e0-146">Şekil 1, Visual Studio tasarımcısı aracılığıyla Bu etkiyi gösterir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="cc0e0-147">[![Etiketin CssClass özelliğini büyük, kırmızı yazı tipiyle sonuçları](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span></span>

<span data-ttu-id="cc0e0-148">**Şekil 1**: etiketin `CssClass` büyük, kırmızı yazı tipi özelliği sonuçlarında ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>


<span data-ttu-id="cc0e0-149">Ardından, bir DropDownList sayfasına ekleme ayarlayın kendi `ID` özelliğine `UserList`ve kendi `AutoPostBack` özelliğinin True.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="cc0e0-150">Tüm kullanıcıların sistemde listelemek için bu DropDownList kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="cc0e0-151">Bu DropDownList MembershipUser nesnelerin bir koleksiyona bağlı.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="cc0e0-152">Görüntü MembershipUser nesnesi, kullanıcı adı özelliği (ve liste öğeleri değeri olarak kullanmak üzere) DropDownList istiyoruz olduğundan DropDownList's kümesi `DataTextField` ve `DataValueField` "UserName" özellikleri.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="cc0e0-153">Adlı bir yineleyici DropDownList altında eklemek `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="cc0e0-154">Bu yineleyici tüm rollerin sistemde onay kutularını bir dizi olarak listelenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="cc0e0-155">Yineleyici 's tanımlamak `ItemTemplate` aşağıdaki bildirim temelli biçimlendirme kullanarak:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="cc0e0-156">`ItemTemplate` Biçimlendirme içeren adlı tek bir onay kutusu Web Denetim `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="cc0e0-157">CheckBox'ın `AutoPostBack` özelliği True olarak ayarlanmış ve `Text` özelliği bağlı `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="cc0e0-158">Veri bağlama sözdizimi yalnızca nedeni `Container.DataItem` rolleri framework rol adları listesini bir dize dizisi olarak döndürür ve biz yineleyici bağlama Bu dize dizisi olduğundan olduğu.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="cc0e0-159">Bir veri Web denetimine bağlı bir dizinin içeriğini görüntülemek için bu sözdizimi neden kullanılır kapsamlı bir açıklama Bu öğretici kapsamında değildir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="cc0e0-160">Bu konuyla ilgili daha fazla bilgi için başvurmak [skaler dizi bir veri Web denetime bağlama](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="cc0e0-161">Bu noktada, "kullanıcı tarafından" arabiriminin bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="cc0e0-162">Biz şimdi DropDownList kullanıcı hesaplarına kümesini ve yineleyici rollere kümesi bağlamak için kod yazmaya hazırsınız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="cc0e0-163">Sayfa arka plan kodu sınıfında adlı bir yöntem ekleyin `BindUsersToUserList` ve başka adlı `BindRolesList`, aşağıdaki kodu kullanarak:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="cc0e0-164">`BindUsersToUserList` Yöntemi sistemindeki tüm kullanıcı hesaplarını alır [ `Membership.GetAllUsers` yöntemi](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="cc0e0-165">Bu döndürür bir [ `MembershipUserCollection` nesne](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), koleksiyonu olduğu [ `MembershipUser` örnekleri](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="cc0e0-166">Bu koleksiyonu daha sonra bağlı `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="cc0e0-167">`MembershipUser` Koleksiyon gibi çeşitli özellikler, içerir, oluşma şekli örnekleri `UserName`, `Email`, `CreationDate`, ve `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="cc0e0-168">Değerini görüntülemek için DropDownList istemek için `UserName` özelliği emin `UserList` DropDownList'ın `DataTextField` ve `DataValueField` özellikleri "UserName" ayarlandı.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="cc0e0-169">`Membership.GetAllUsers` Yöntemi iki aşırı vardır: biri hiç giriş parametresi kabul eder ve tüm kullanıcıların döndüren, diğeri sayfa dizini ve sayfa boyutu tamsayı değerlerini alır ve yalnızca belirtilen kullanıcı alt kümesini döndürür.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="cc0e0-170">Büyük miktarda disk belleğine alınabilir bir kullanıcı arabirimi öğesi görüntülenmesini kullanıcı hesapları olduğunda, yalnızca kullanıcı hesaplarını yerine bunların tümünün kesin kısmı döndürdüğünden ikinci aşırı kullanıcıları daha verimli bir şekilde bir sayfadan için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="cc0e0-171">`BindRolesToList` Yöntemi başlatır çağırarak `Roles` sınıfının [ `GetAllRoles` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), sistem rollerini içeren bir dize dizisi döndürür.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="cc0e0-172">Bu dize dizisi sonra yineleyici bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="cc0e0-173">Son olarak, biz sayfa ilk kez yüklendiğinde bu iki yöntem çağırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="cc0e0-174">Aşağıdaki kodu ekleyin `Page_Load` olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="cc0e0-175">Bu kod yerinde bir tarayıcı aracılığıyla sayfasını ziyaret edin için bir dakikanızı ayırın; Ekranınızın Şekil 2'ye benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="cc0e0-176">Tüm kullanıcı hesaplarını aşağı açılan listesinde ve altında her bir rol bir onay kutusu olarak görünen doldurulur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="cc0e0-177">Ayarlarız çünkü `AutoPostBack` seçili kullanıcı değiştirme veya denetimi veya rol kaldırılırsa DropDownList ve özelliklerini onay kutularını true geri gönderimin neden olur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="cc0e0-178">Bu eylemler işlemek için kod yazmaya henüz çünkü hiçbir eylem ancak, gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="cc0e0-179">Biz, sonraki iki bölümde bu görevler üstesinden gelmek.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="cc0e0-180">[![Kullanıcılar ve roller sayfasını görüntüler](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span></span>

<span data-ttu-id="cc0e0-181">**Şekil 2**: kullanıcılar ve roller sayfasını görüntüler ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="cc0e0-182">Rolleri denetimi seçilen kullanıcıya ait</span><span class="sxs-lookup"><span data-stu-id="cc0e0-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="cc0e0-183">Sayfa ilk kez yüklendiğinde veya ziyaretçi aşağı açılan listeden yeni bir kullanıcı seçtiğinde güncelleştirmek ihtiyacımız `UsersRoleList`ait onay kutularını böylece yalnızca seçilen kullanıcı bu role aitse verilen rol checkbox denetlenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="cc0e0-184">Bunu gerçekleştirmek için adlı bir yöntem oluşturun `CheckRolesForSelectedUser` aşağıdaki kod ile:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="cc0e0-185">Yukarıdaki kod, seçili kullanıcının kim olduğunu belirleyerek başlatır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="cc0e0-186">Ardından rolleri sınıfının kullanır [ `GetRolesForUser(userName)` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) rolleri bir dize dizisi olarak belirtilen kullanıcının kümesi dönün.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="cc0e0-187">Ardından, yineleyici'nın öğelerini numaralandırılır ve her öğenin `RoleCheckBox` onay kutusunu programlı olarak başvurulur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="cc0e0-188">Karşılık gelen için rol içinde içindeyse onay kutusu işaretliyse `selectedUsersRoles` dize dizisi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="cc0e0-189">`selectedUserRoles.Contains<string>(...)` ASP.NET 2.0 sürümünü kullanıyorsanız, söz dizimi derlenmez.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="cc0e0-190">`Contains<string>` Yöntemi parçasıdır [LINQ Kitaplığı](http://en.wikipedia.org/wiki/Language_Integrated_Query), ASP.NET 3.5 için yeni olan.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="cc0e0-191">ASP.NET 2.0 sürümünü kullanmaya devam ediyorsanız kullanmak [ `Array.IndexOf<string>` yöntemi](https://msdn.microsoft.com/library/eha9t187.aspx) yerine.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="cc0e0-192">`CheckRolesForSelectedUser` Yöntemi iki durumda da çağrılması gerekir: sayfa ilk kez yüklendiğinde ve her `UserList` DropDownList'ın seçili dizin değiştirildi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="cc0e0-193">Bu nedenle, bu yöntemi çağırın `Page_Load` olay işleyicisi (çağrıları sonra `BindUsersToUserList` ve `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="cc0e0-194">Ayrıca, olay işleyicisi DropDownList için 's oluşturmak `SelectedIndexChanged` olay ve buradan bu yöntemi çağırın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="cc0e0-195">Yerinde şu kodla sayfanın tarayıcı yoluyla test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="cc0e0-196">Ancak, bu yana `UsersAndRoles.aspx` sayfa şu anda eksik kullanıcıları rollere atama olanağı, hiçbir kullanıcı rolleri sahiptir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="cc0e0-197">Bu kod çalışan word alabilir ve bunu daha sonra yapar olduğunu doğrulamak için kullanıcıları rollere biraz bekledikten sonra atamak için kullanılan arabirimi oluşturacağız veya kayıtlar ekleme kullanıcıları rollere el ile ekleyebilirsiniz `aspnet_UsersInRoles` bu functi test etmek için tablo Şimdi onality.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="cc0e0-198">Atama ve kullanıcıları rollerden kaldırma</span><span class="sxs-lookup"><span data-stu-id="cc0e0-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="cc0e0-199">Ne zaman ziyaretçi ya da bir onay kutusu temizler `UsersRoleList` yineleyici ihtiyacımız eklemek veya seçili kullanıcı karşılık gelen rolünden kaldırmak için.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="cc0e0-200">CheckBox'ın `AutoPostBack` özelliği şu anda yineleyicideki bir onay kutusu işaretli veya işaretsiz zaman hangi geri gönderimin neden True olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="cc0e0-201">Kısacası, olay işleyici onay kutusunu 's oluşturmak ihtiyacımız `CheckChanged` olay.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="cc0e0-202">Onay kutusu yineleyici denetiminde olduğundan, olay işleyici tesisat el ile eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="cc0e0-203">Başlangıç olay işleyicisi arka plandaki kod sınıfı olarak ekleyerek bir `protected` yöntemi, şu şekilde:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="cc0e0-204">Bir dakika içinde bu olay işleyicisi için kod yazma için döndürür.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="cc0e0-205">Ancak ilk Haydi tesisat işleme olay tamamlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="cc0e0-206">Yineleyici'nın içinde onay kutusu gelen `ItemTemplate`, ekleme `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="cc0e0-207">Bu sözdiziminin bağlayan `RoleCheckBox_CheckChanged` olay işleyicisine `RoleCheckBox`'s `CheckedChanged` olay.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="cc0e0-208">Bizim son tamamlamak için bir görevdir `RoleCheckBox_CheckChanged` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="cc0e0-209">Bu onay kutusu örneği hangi rolü işaretli veya işaretsiz aracılığıyla bize bildiren çünkü olayı onay kutusu denetimini başvurarak başlatmak ihtiyacımız kendi `Text` ve `Checked` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="cc0e0-210">Seçilen kullanıcının kullanıcı adı ile birlikte bu bilgileri kullanarak, biz ekleme veya kullanıcı rolü kaldırma `Roles` sınıfının [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) veya [ `RemoveUserFromRole` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="cc0e0-211">Yukarıdaki kod, program aracılığıyla aracılığıyla kullanıma olayı onay kutusunu başvurarak başlatır `sender` giriş parametresi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="cc0e0-212">Onay kutusu işaretli değilse, Seçilen kullanıcıyı rolünden kaldırılır belirtilen rol, aksi takdirde eklenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="cc0e0-213">Her iki durumda da `ActionStatus` etiketi yalnızca gerçekleştirilen eylem özetleyen bir ileti görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="cc0e0-214">Bu sayfa bir tarayıcı aracılığıyla kullanıma test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="cc0e0-215">Kullanıcı Tito seçin ve ardından Tito hem yöneticilerin hem de Denetçiler rollere ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="cc0e0-216">[![Yöneticiler ve denetçiler rolleri Tito eklendi](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span></span>

<span data-ttu-id="cc0e0-217">**Şekil 3**: Yöneticiler ve denetçiler rollere Tito eklendi ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>


<span data-ttu-id="cc0e0-218">Ardından, kullanıcı Bruce'a aşağı açılan listeden seçin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="cc0e0-219">Geri gönderimin yoktur ve yineleyici'nın onay kutularını aracılığıyla güncelleştirilir `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="cc0e0-220">Bruce'a henüz hiçbir role ait değil olduğundan, iki onay kutusu işaretli.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="cc0e0-221">Ardından, Bruce'a denetçiler role ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="cc0e0-222">[![Bruce'a denetçiler rolüne eklendi](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span></span>

<span data-ttu-id="cc0e0-223">**Şekil 4**: Bruce'a denetçiler rolüne eklendi ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>


<span data-ttu-id="cc0e0-224">Daha fazla işlevselliğini doğrulamak için `CheckRolesForSelectedUser` yöntemi, Tito veya Bruce'a başka kullanıcı seçin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="cc0e0-225">Bunlar hiçbir role ait değil belirten, onay kutularını nasıl otomatik olarak işaretli unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="cc0e0-226">Tito için döndür.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-226">Return to Tito.</span></span> <span data-ttu-id="cc0e0-227">Hem yöneticilerin hem de Denetçiler onay kutularını denetlenmesi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="cc0e0-228">2. adım: "Tarafından rolleri" kullanıcı arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="cc0e0-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="cc0e0-229">Bu noktada biz "kullanıcılar tarafından" arabirimi tamamladınız ve "rolleri tarafından" arabirimi tackling başlatmaya hazırsınız demektir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="cc0e0-230">"Rolleri tarafından" arabirimi kullanıcıdan aşağı açılan listeden bir rol seçin ve ardından GridView o role ait kullanıcılar kümesini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="cc0e0-231">Başka bir DropDownList denetimine ekleme `UsersAndRoles.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="cc0e0-232">Bu bir yineleyici denetim altına yerleştirin, adlandırın `RoleList`ve kendi `AutoPostBack` özelliğinin True.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="cc0e0-233">Bu altında GridView ekleyin ve adını `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="cc0e0-234">Bu GridView, seçili role ait kullanıcılar listelenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="cc0e0-235">GridView's ayarlamak `AutoGenerateColumns` özelliğini false olarak ayarlayın, ızgaranın bir TemplateField eklemek `Columns` toplama ve kümesi kendi `HeaderText` "Kullanıcılar" özelliğine.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="cc0e0-236">TemplateField's tanımlamak `ItemTemplate` böylece databinding ifadesinin değerini görüntüler `Container.DataItem` içinde `Text` adlı bir etiket özelliği `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="cc0e0-237">Ekleme ve GridView yapılandırdıktan sonra "rol tarafından" arabiriminin bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="cc0e0-238">Doldurmak ihtiyacımız `RoleList` sistem rollerinde kümesiyle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="cc0e0-239">Bunu başarmak için güncelleştirme `BindRolesToList` bağlar, böylece yöntemi tarafından döndürülen dize dizisi `Roles.GetAllRoles` yönteme `RolesList` DropDownList (yanı sıra `UsersRoleList` yineleyici).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="cc0e0-240">Son iki satırları `BindRolesToList` yöntemi için roller kümesi bağlamak için eklenmiştir `RoleList` DropDownList denetimi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="cc0e0-241">Şekil 5 – sistem rolleri ile doldurulan bir açılır liste tarayıcısından görüntülendiğinde sonuç gösterir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="cc0e0-242">[![Rolleri RoleList DropDownList görüntülenir](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span></span>

<span data-ttu-id="cc0e0-243">**Şekil 5**: roller görüntülenir `RoleList` DropDownList ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="cc0e0-244">Seçilen Role ait kullanıcılar görüntüleme</span><span class="sxs-lookup"><span data-stu-id="cc0e0-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="cc0e0-245">Sayfa ilk ne zaman yüklendi veya yeni bir rolü zaman seçilir `RoleList` DropDownList, ihtiyacımız GridView o role ait olan kullanıcıların listesini görüntülemek.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="cc0e0-246">Adlı bir yöntem oluşturma `DisplayUsersBelongingToRole` aşağıdaki kodu kullanarak:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="cc0e0-247">Bu yöntem seçili rolünden alarak başlatır `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="cc0e0-248">Daha sonra kullanır [ `Roles.GetUsersInRole(roleName)` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) bir dize dizisi, bu role ait kullanıcılar kullanıcı adları alınamadı.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="cc0e0-249">Bu dizi sonra bağlı `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="cc0e0-250">Bu yöntem iki durumlarda çağrılması gerekir: sayfa ilk kez yüklendiğinde ve ne zaman içinde seçilen rol `RoleList` DropDownList değişiklikleri.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="cc0e0-251">Bu nedenle, güncelleştirme `Page_Load` olay işleyicisi çağrısından sonra bu yöntem çağrılır böylece `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="cc0e0-252">Ardından, bir olay işleyicisi oluşturun `RoleList`'s `SelectedIndexChanged` olayı ve buradan, çok bu yöntemi çağırın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="cc0e0-253">Bu kod, yerinde `RolesUserList` GridView, seçili role ait kullanıcılarla görüntülemelidir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="cc0e0-254">Şekil 6 gösterildiği gibi iki üyeleri denetçiler rolü oluşur: Bruce'a ve Tito.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="cc0e0-255">[![GridView, seçili Role ait bu kullanıcılar listelenmiştir.](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span></span>

<span data-ttu-id="cc0e0-256">**Şekil 6**: GridView listeler bu kullanıcılar, ait seçili rol için ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="cc0e0-257">Seçili rolünden kullanıcıları kaldırma</span><span class="sxs-lookup"><span data-stu-id="cc0e0-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="cc0e0-258">Şimdi büyütmek `RolesUserList` GridView bir sütunu içeren "Kaldır" düğmeler.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="cc0e0-259">Belirli bir kullanıcı için "Kaldır" düğmesini tıklatarak bu rolden kaldırır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="cc0e0-260">GridView Sil düğmesine alan ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="cc0e0-261">Bu alan en dosyalanmış sol görünür ve değişiklik yapmak, `DeleteText` "Sil" (varsayılan) özelliğine "Kaldır".</span><span class="sxs-lookup"><span data-stu-id="cc0e0-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="cc0e0-262">[![Ekleme](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-262">[![Add the](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span></span>

<span data-ttu-id="cc0e0-263">**Şekil 7**: GridView için "Kaldır" düğmesi ekleme ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>


<span data-ttu-id="cc0e0-264">"Kaldır" düğmesine tıklandığında geri gönderimin ensues ve GridView's `RowDeleting` olayı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="cc0e0-265">Bu olay için bir olay işleyicisi oluşturun ve kullanıcı seçili rolünden kaldırır kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="cc0e0-266">Olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="cc0e0-267">Kod, seçili rol adı belirleyerek başlatır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="cc0e0-268">Ardından, program aracılığıyla başvuruları `UserNameLabel` , "Kaldır" düğmesine tıklanana kaldırmak için kullanıcı adını belirlemek için satır denetiminden.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="cc0e0-269">Kullanıcı rolü için bir çağrı aracılığıyla kaldırılır `Roles.RemoveUserFromRole` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="cc0e0-270">`RolesUserList` Aracılığıyla bir ileti görüntülenir ve GridView sonra yenilendiğini `ActionStatus` etiket denetimini.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="cc0e0-271">"Kaldır" düğmesini herhangi bir tür kullanıcı rolünden kaldırmadan önce kullanıcıdan onay gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="cc0e0-272">Belirli bir düzeyde kullanıcı onayı eklemenizi davet.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="cc0e0-273">Eylemi onaylamak için en kolay yollarından biri bir istemci-tarafı Onayla iletişim kutusudur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="cc0e0-274">Bu teknik hakkında daha fazla bilgi için bkz: [ekleme istemci-tarafı onay olduğunda silme](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>


<span data-ttu-id="cc0e0-275">Şekil 8 kullanıcı Tito denetçiler grubundan kaldırdıktan sonra sayfada görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="cc0e0-276">[![Ne yazık ki Tito artık bir yönetici değil](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span></span>

<span data-ttu-id="cc0e0-277">**Şekil 8**: ne yazık ki Tito artık bir denetleyicidir ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="cc0e0-278">Seçili rol için yeni kullanıcı ekleme</span><span class="sxs-lookup"><span data-stu-id="cc0e0-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="cc0e0-279">Seçili rolünden kullanıcıları kaldırma yanı sıra bu sayfaya ziyaretçi Ayrıca seçili rol için bir kullanıcı eklemek görebilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="cc0e0-280">Seçili rol için bir kullanıcı eklemek için en iyi arabirimi kullanıcı hesaplarına sahip olmayı beklediğiniz sayısına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="cc0e0-281">Web sitenizi birkaç düzine kullanıcı hesaplarını barındırmak veya daha küçükse, burada bir DropDownList kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="cc0e0-282">Olabilir, kullanıcı hesaplarını binlerce hesapları, belirli bir hesap için arama yoluyla sayfa veya kullanıcı hesapları başka bir şekilde filtrelemek için ziyaretçi izin veren bir kullanıcı arabirimi eklemek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="cc0e0-283">Bu sayfa için kullanıcı hesaplarının sayısına bakılmaksızın sistemde çalışan çok basit bir arabirim kullanalım.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="cc0e0-284">Yani, seçili role eklemek istediği kullanıcının kullanıcı adı yazın ziyaretçi isteyen bir metin kutusu kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="cc0e0-285">Bu adda kullanıcı yok veya kullanıcı rolünün bir üyesi ise, bir ileti görüntüler `ActionStatus` etiketi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="cc0e0-286">Ancak kullanıcı varsa ve rolünün bir üyesi değil, biz role ekleyin ve kılavuz yenileyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="cc0e0-287">TextBox ve GridView düğmesini ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="cc0e0-288">TextBox's ayarlamak `ID` için `UserNameToAddToRole` ve düğmenin ayarlayın `ID` ve `Text` özelliklerine `AddUserToRoleButton` ve "Kullanıcı için Rol Ekle", sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="cc0e0-289">Ardından, oluşturun bir `Click` için olay işleyicisini `AddUserToRoleButton` ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="cc0e0-290">Kodda çoğunluğu `Click` olay işleyicisi çeşitli doğrulama denetimleri gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="cc0e0-291">Ziyaretçi bir kullanıcı tarafından sağlanan sağlar `UserNameToAddToRole` TextBox kullanıcı sistemde var ve bunlar zaten seçili role ait değil.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="cc0e0-292">Bunları herhangi biri başarısız işaretlerse, uygun bir mesaj görüntülenir `ActionStatus` ve olay işleyicisi çıkıldı.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="cc0e0-293">Tüm denetimler başarılı olursa kullanıcı rolüne eklenir `Roles.AddUserToRole` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="cc0e0-294">Metin kutusu ait aşağıdaki `Text` özelliği temizlendiğinde, GridView yenilenir ve `ActionStatus` etiket belirtilen kullanıcı için seçili rolü başarıyla eklendiğini belirten bir ileti görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="cc0e0-295">Belirtilen kullanıcı zaten seçili rolüne ait olmadığını emin olmak için kullanırız [ `Roles.IsUserInRole(userName, roleName)` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), gösteren bir Boole değeri döndürür olup olmadığını *kullanıcıadı* üyesi*roleName*.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="cc0e0-296">Bu yöntemde yeniden kullanacağız <a id="_msoanchor_2"> </a> [sonraki öğretici](role-based-authorization-cs.md) rol tabanlı yetkilendirme baktığınızda biz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="cc0e0-297">Bir tarayıcı aracılığıyla sayfasını ziyaret edin ve denetçiler rolünden seçin `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="cc0e0-298">Geçersiz kullanıcı adı girmeyi deneyin – kullanıcı sistemde yok açıklayan bir ileti görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="cc0e0-299">[![Mevcut olmayan kullanıcı Role eklenemiyor](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span></span>

<span data-ttu-id="cc0e0-300">**Şekil 9**: varolmayan kullanıcı rol ekleyemezsiniz ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>


<span data-ttu-id="cc0e0-301">Artık geçerli bir kullanıcı eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-301">Now try adding a valid user.</span></span> <span data-ttu-id="cc0e0-302">Bir tane Tito denetçiler rolünü yeniden ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="cc0e0-303">[![Tito yine bir denetleyicidir!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span></span>

<span data-ttu-id="cc0e0-304">**Şekil 10**: Tito olan yine bir yönetici!</span><span class="sxs-lookup"><span data-stu-id="cc0e0-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="cc0e0-305">([Tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="cc0e0-306">3. adım: Arası güncelleştirme "kullanıcı" ve "rol" arabirimleri</span><span class="sxs-lookup"><span data-stu-id="cc0e0-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="cc0e0-307">`UsersAndRoles.aspx` Sayfası kullanıcıları ve rolleri yönetmek için iki farklı arabirimleri sunar.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="cc0e0-308">Şu anda bir arabiriminde yapılan bir değişikliği hemen diğer yansıtılmaz, mümkün olması için bu iki arabirim birbirinden bağımsız olarak davranır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="cc0e0-309">Örneğin, sayfa ziyaretçiye denetçiler rolünden seçer düşünün `RoleList` Bruce'a ve Tito üyeleri listeler DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="cc0e0-310">Ardından, ziyaretçi Tito gelen seçer `UserList` Yöneticiler ve denetçiler onay denetler DropDownList `UsersRoleList` yineleyici.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="cc0e0-311">Ziyaretçi sonra yineleyici yönetici rolünden temizler, Tito denetçiler rolünden kaldırılır, ancak bu değişiklik "rol tarafından" arabiriminde yansıtılmaz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="cc0e0-312">Denetçiler rolünün bir üyesi olduğu GridView hala Tito gösterir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="cc0e0-313">Bu rol işaretli veya işaretsiz gelen olduğunda GridView yenilemek için ihtiyacımız sorunu gidermek için `UsersRoleList` yineleyici.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="cc0e0-314">Benzer şekilde, biz her bir kullanıcı kaldırılmış veya "rolü tarafından" arabiriminden role eklenen yineleyici yenilemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="cc0e0-315">"Kullanıcı tarafından" arabirimi Yineleyicideki çağırarak yenilenir `CheckRolesForSelectedUser` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="cc0e0-316">"Rol tarafından" arabirimi değiştirilebilir `RolesUserList` GridView'ın `RowDeleting` olay işleyicisi ve `AddUserToRoleButton` düğmenin `Click` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="cc0e0-317">Bu nedenle, çağırmak ihtiyacımız `CheckRolesForSelectedUser` bu yöntemlerin her biri yönteminden.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="cc0e0-318">Benzer şekilde, "rol tarafından" arabiriminde GridView çağırarak yenilenir `DisplayUsersBelongingToRole` yöntemi ve "kullanıcı tarafından" arabirimi aracılığıyla değiştirilmiş `RoleCheckBox_CheckChanged` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="cc0e0-319">Bu nedenle, çağırmak ihtiyacımız `DisplayUsersBelongingToRole` bu olay işleyicisi yönteminden.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="cc0e0-320">Bu küçük kod değişikliklerle "kullanıcı" ve "rol" arabirimleri artık doğru arası güncelleştirme.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="cc0e0-321">Bunu doğrulamak için bir tarayıcı aracılığıyla sayfasını ziyaret edin ve Tito seçip denetçiler gelen `UserList` ve `RoleList` DropDownLists, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="cc0e0-322">"Kullanıcı tarafından" arabirimi Yineleyicideki gelen Tito için denetçiler rol işaretini gibi Tito otomatik olarak "rolü tarafından" arabiriminde GridView kaldırılır olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="cc0e0-323">"Rol tarafından" arabiriminden denetçiler rolüne Tito otomatik olarak ekleme "kullanıcı tarafından" arabiriminde denetçiler onay kutusunu yeniden denetler.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="cc0e0-324">4. adım: bir "Rolleri belirtin" adımı eklemek için CreateUserWizard özelleştirme</span><span class="sxs-lookup"><span data-stu-id="cc0e0-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="cc0e0-325">İçinde <a id="_msoanchor_3"> </a> [ *kullanıcı hesapları oluşturma* ](../membership/creating-user-accounts-cs.md) CreateUserWizard Web denetimi yeni bir kullanıcı hesabı oluşturmak için bir arabirim sağlamak için nasıl kullanılacağını gördüğümüz öğretici.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="cc0e0-326">CreateUserWizard denetim iki yoldan biriyle kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="cc0e0-327">Site, kendi kullanıcı hesabı oluşturmak ziyaretçi için bir yol olarak ve</span><span class="sxs-lookup"><span data-stu-id="cc0e0-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="cc0e0-328">Bir araç olarak yöneticiler yeni hesapları oluşturmak için</span><span class="sxs-lookup"><span data-stu-id="cc0e0-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="cc0e0-329">İlk kullanım örneğindeki bir ziyaretçi siteye gelir ve sitesinde kaydetmek için kendi bilgilerini girme CreateUserWizard çıkışı doldurur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="cc0e0-330">İkinci durumda, yönetici yeni bir hesap için başka bir kişiye oluşturur.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="cc0e0-331">Başka bir kişi için bir yönetici tarafından bir hesap oluşturulduğunda, yeni kullanıcı hesabına ait hangi rolleri belirlemek üzere yöneticinin izin vermek faydalı olabilir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="cc0e0-332">İçinde <a id="_msoanchor_4"> </a> [ *depolama* *ek kullanıcı bilgilerini* ](../membership/storing-additional-user-information-cs.md) ek ekleyerek CreateUserWizard özelleştirmeyi gördüğümüz Öğreticisi `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="cc0e0-333">Yeni kullanıcının rollerini belirtmek için CreateUserWizard için ek bir adım eklemek ne bakalım.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="cc0e0-334">Açık `CreateUserWizardWithRoles.aspx` sayfasında ve adlı CreateUserWizard denetim ekleme `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="cc0e0-335">Denetimin ayarlamak `ContinueDestinationPageUrl` özelliğine "~ / Default.aspx".</span><span class="sxs-lookup"><span data-stu-id="cc0e0-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="cc0e0-336">Buradaki bir yönetici bu CreateUserWizard denetim yeni kullanıcı hesapları oluşturmak için kullanacağınız, denetimin ayarlı, çünkü `LoginCreatedUser` özelliğini false olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="cc0e0-337">Bu `LoginCreatedUser` özelliği ziyaretçi otomatik olarak yeni oluşturulan kullanıcı oturum ve doğru olarak varsayılan olarak olup olmadığını belirtir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="cc0e0-338">Bir yönetici yeni hesap oluşturduğunda kendisine kendisi imzalanmış tutmak istiyoruz çünkü biz False olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="cc0e0-339">Ardından, "Ekle/Kaldır `WizardSteps`..."</span><span class="sxs-lookup"><span data-stu-id="cc0e0-339">Next, select the "Add/Remove `WizardSteps`…"</span></span> <span data-ttu-id="cc0e0-340">seçenek CreateUserWizard kullanıcının akıllı etiketten ve yeni bir ekleme `WizardStep`, ayar kendi `ID` için `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-340">option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="cc0e0-341">Taşıma `SpecifyRolesStep WizardStep` böylece "Oturum yukarı için yeni hesabınız" adımından sonra ancak "Tamamlandı" adım önce gelir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-341">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="cc0e0-342">Ayarlama `WizardStep`'s `Title` özelliği "Rollere belirtin", kendi `StepType` özelliğine `Step`ve kendi `AllowReturn` özelliğini false olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-342">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="cc0e0-343">[![Ekleme](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-343">[![Add the](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span></span>

<span data-ttu-id="cc0e0-344">**Şekil 11**: "Rolleri belirtin" ekleme `WizardStep` CreateUserWizard için ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-344">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>


<span data-ttu-id="cc0e0-345">Bu değişiklikten sonra CreateUserWizard'ın bildirim temelli biçimlendirme aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-345">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="cc0e0-346">Rollerdeki "belirtin" `WizardStep`, adlandırılmış bir CheckBoxList eklemek `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-346">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="cc0e0-347">Bu CheckBoxList kullanılabilir roller yeni oluşturulan kullanıcı ait hangi rolleri denetleme sayfasını ziyaret ettiğinizde kişinin etkinleştirme listeler.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-347">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="cc0e0-348">Şu iki kodlama görevlerle sol: ilk biz doldurmanız gerekir `RoleList` ; sistem rolleriyle CheckBoxList ikinci olarak, kullanıcı "Tamamlandı" adım "Rol belirtin" adımdan taşıdığında seçili roller için oluşturulan kullanıcı eklemek ihtiyacımız.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-348">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="cc0e0-349">Biz ilk görevde gerçekleştirebileceğiniz `Page_Load` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-349">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="cc0e0-350">Aşağıdaki başvurular programlı olarak kod `RoleList` ilk onay sayfasını ziyaret edin ve rolleri sistemde kendisine bağlar.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-350">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="cc0e0-351">Yukarıdaki kod tanıdık gelecektir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-351">The above code should look familiar.</span></span> <span data-ttu-id="cc0e0-352">İçinde <a id="_msoanchor_5"> </a> [ *depolama* *ek kullanıcı bilgilerini* ](../membership/storing-additional-user-information-cs.md) iki kullandık öğretici `FindControl` Web denetimi başvurmak için deyimleri gelen bir özel içinde `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-352">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="cc0e0-353">Ve rolleri CheckBoxList'in bağlar kod Bu öğreticide daha önce yapılmadı.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-353">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="cc0e0-354">İkinci bir programlama görevi gerçekleştirmek için biz "Rolleri belirtin" adım zaman tamamlandı bilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-354">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="cc0e0-355">CreateUserWizard sahip geri çağırma bir `ActiveStepChanged` ziyaretçi varlıklardan bir adım diğerine her zaman harekete olay.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-355">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="cc0e0-356">Burada kullanıcının "Tamamlandı" adım aşması durumunda belirleyebilirsiniz; Bu durumda, biz seçili rollere kullanıcı eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-356">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="cc0e0-357">İçin bir olay işleyicisi oluşturun `ActiveStepChanged` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-357">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="cc0e0-358">Kullanıcı yalnızca "Tamamlandı" adım ulaştı, olay işleyicisi öğeler numaralandırır `RoleList` CheckBoxList ve yeni oluşturulan kullanıcı seçili rollere atanır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-358">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="cc0e0-359">Bir tarayıcı aracılığıyla bu sayfasını ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-359">Visit this page through a browser.</span></span> <span data-ttu-id="cc0e0-360">CreateUserWizard ilk adımı, yeni kullanıcının kullanıcı adı, parola, e-posta ve diğer önemli bilgiler için ister standart "Oturum yukarı için yeni hesabınız" adım olacaktır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-360">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="cc0e0-361">Wanda adlı yeni bir kullanıcı oluşturmak için gereken bilgileri girin.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-361">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="cc0e0-362">[![Wanda adlı yeni bir kullanıcı oluşturun](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-362">[![Create a New User Named Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span></span>

<span data-ttu-id="cc0e0-363">**Şekil 12**: adlı yeni bir kullanıcı Wanda oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-363">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>


<span data-ttu-id="cc0e0-364">"Kullanıcı oluştur" düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-364">Click the "Create User" button.</span></span> <span data-ttu-id="cc0e0-365">CreateUserWizard dahili olarak çağırır `Membership.CreateUser` yöntemi, yeni kullanıcı hesabı ve ardından sonraki adıma ilerler oluşturma "Roller'i belirtin."</span><span class="sxs-lookup"><span data-stu-id="cc0e0-365">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="cc0e0-366">Sistem rolleri burada listelenir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-366">Here the system roles are listed.</span></span> <span data-ttu-id="cc0e0-367">Denetçiler onay kutusunu işaretleyin ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-367">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="cc0e0-368">[![Wanda denetçiler rolünün bir üyesi yapın](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-368">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span></span>

<span data-ttu-id="cc0e0-369">**Şekil 13**: Wanda denetçiler rolünün bir üyesi yapın ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-369">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>


<span data-ttu-id="cc0e0-370">İleri'yi tıklatmadan neden geri gönderimin ve güncelleştirmeleri `ActiveStep` "Tamamlandı" adıma.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-370">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="cc0e0-371">İçinde `ActiveStepChanged` olay işleyicisi, en son oluşturulan kullanıcı hesabı denetçiler rolüne atanır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-371">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="cc0e0-372">Bunu doğrulamak için dönmek `UsersAndRoles.aspx` sayfasında ve gelen denetçiler seçin `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-372">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="cc0e0-373">Şekil 14 gösterildiği gibi denetçiler artık üç kullanıcılarının oluşur: Bruce'a, Tito ve Wanda.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-373">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="cc0e0-374">[![Tüm denetçiler şunlardır: Bruce'a, Tito ve Wanda](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-374">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span></span>

<span data-ttu-id="cc0e0-375">**Şekil 14**: Bruce'a, Tito ve Wanda olan tüm denetçiler ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="cc0e0-375">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="cc0e0-376">Özet</span><span class="sxs-lookup"><span data-stu-id="cc0e0-376">Summary</span></span>

<span data-ttu-id="cc0e0-377">Rolleri framework belirli bir kullanıcının rollerini ve hangi kullanıcıların belirli bir role ait belirlemek için yöntemler hakkında bilgi almak için yöntemleri sunar.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-377">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="cc0e0-378">Ayrıca, çeşitli bir veya daha fazla rol için bir veya daha fazla kullanıcı eklemek ve kaldırmak için yöntemler vardır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-378">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="cc0e0-379">Bu öğreticide biz yalnızca iki bu yöntemleri odaklanmış: `AddUserToRole` ve `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-379">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="cc0e0-380">Tek bir rol için birden çok kullanıcı eklemek ve birden fazla rol tek bir kullanıcıya atamak için tasarlanmış ek çeşitlemesi vardır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-380">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="cc0e0-381">Bu öğretici içerecek şekilde CreateUserWizard denetimini genişletme bir bakış da dahil bir `WizardStep` yeni oluşturulan kullanıcı rolleri belirtmek için.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-381">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="cc0e0-382">Bu tür bir adımı yönetici yeni kullanıcılar için kullanıcı hesapları oluşturma işlemini kolaylaştırmaya yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-382">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="cc0e0-383">Bu noktada biz nasıl oluşturulacağı ve rollerini silme ve ekleme ve kullanıcıların rollerini kaldırın gördünüz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-383">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="cc0e0-384">Ancak, rol tabanlı yetkilendirme uygulamayı aramak henüz.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-384">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="cc0e0-385">İçinde <a id="_msoanchor_6"> </a> [öğretici aşağıdaki](role-based-authorization-cs.md) sayfa düzeyinde işlevselliği sınırlamak için şu anda oturum açmış kullanıcının rollerine dayalı olarak nasıl biz bir rol tarafından rol temelinde URL yetkilendirme kuralları tanımlama adresindeki de arar.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-385">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="cc0e0-386">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="cc0e0-386">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="cc0e0-387">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="cc0e0-387">Further Reading</span></span>

<span data-ttu-id="cc0e0-388">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="cc0e0-388">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="cc0e0-389">ASP.NET Web sitesi yönetim aracına genel bakış</span><span class="sxs-lookup"><span data-stu-id="cc0e0-389">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="cc0e0-390">ASP inceleniyor. NET'in üyelik, roller ve profil</span><span class="sxs-lookup"><span data-stu-id="cc0e0-390">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="cc0e0-391">Kendi Web sitesi yönetim aracı alınıyor</span><span class="sxs-lookup"><span data-stu-id="cc0e0-391">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="cc0e0-392">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="cc0e0-392">About the Author</span></span>

<span data-ttu-id="cc0e0-393">Scott Mitchell, birden çok ASP/ASP.NET books yazar ve 4GuysFromRolla.com, kurucusu 1998 itibaren Microsoft Web teknolojileri ile çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-393">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cc0e0-394">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-394">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cc0e0-395">En son kendi defteri  *[kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-395">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="cc0e0-396">Tan adresindeki ulaşılabilir [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) veya kendi blog aracılığıyla [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="cc0e0-396">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="cc0e0-397">Özel teşekkürler...</span><span class="sxs-lookup"><span data-stu-id="cc0e0-397">Special Thanks To…</span></span>

<span data-ttu-id="cc0e0-398">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-398">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cc0e0-399">Bu öğretici için sağlama İnceleme Teresa Murphy oluştu.</span><span class="sxs-lookup"><span data-stu-id="cc0e0-399">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="cc0e0-400">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="cc0e0-400">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cc0e0-401">Öyleyse, bir satırında bana bırak [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-401">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cc0e0-402">[Önceki](creating-and-managing-roles-cs.md)
> [sonraki](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="cc0e0-402">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
