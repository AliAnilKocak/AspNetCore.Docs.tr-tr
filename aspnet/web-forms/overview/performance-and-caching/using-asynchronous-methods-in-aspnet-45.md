---
uid: web-forms/overview/performance-and-caching/using-asynchronous-methods-in-aspnet-45
title: "ASP.NET 4.5 içinde zaman uyumsuz yöntemlerle | Microsoft Docs"
author: Rick-Anderson
description: "Bu öğretici ücretsiz bir Web için Visual Studio Express 2012 kullanarak zaman uyumsuz bir ASP.NET Web Forms uygulaması oluşturma temellerini öğretmek..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/06/2012
ms.topic: article
ms.assetid: a585c9a2-7c8e-478b-9706-90f3739c50d1
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/performance-and-caching/using-asynchronous-methods-in-aspnet-45
msc.type: authoredcontent
ms.openlocfilehash: 62a32db0984cfc2a1f5fd8f9196aad9259d74f93
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/10/2017
---
<a name="using-asynchronous-methods-in-aspnet-45"></a><span data-ttu-id="3c330-103">ASP.NET 4.5 içinde zaman uyumsuz yöntemler kullanma</span><span class="sxs-lookup"><span data-stu-id="3c330-103">Using Asynchronous Methods in ASP.NET 4.5</span></span>
====================
<span data-ttu-id="3c330-104">Tarafından [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="3c330-104">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="3c330-105">Bu öğretici zaman uyumsuz bir ASP.NET Web Forms uygulaması kullanılarak oluşturmaya temellerini öğretmek [için Visual Studio Express 2012 Web](https://www.microsoft.com/visualstudio/11/en-us), Microsoft Visual Studio ücretsiz sürümünü olduğu.</span><span class="sxs-lookup"><span data-stu-id="3c330-105">This tutorial will teach you the basics of building an asynchronous ASP.NET Web Forms application using [Visual Studio Express 2012 for Web](https://www.microsoft.com/visualstudio/11/en-us), which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="3c330-106">Aynı zamanda [Visual Studio 2012](https://www.microsoft.com/visualstudio/11/en-us).</span><span class="sxs-lookup"><span data-stu-id="3c330-106">You can also use [Visual Studio 2012](https://www.microsoft.com/visualstudio/11/en-us).</span></span> <span data-ttu-id="3c330-107">Aşağıdaki bölümlerde, bu öğreticide dahil edilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-107">The following sections are included in this tutorial.</span></span>
> 
> - [<span data-ttu-id="3c330-108">İstekleri iş parçacığı havuzu tarafından nasıl işlenir</span><span class="sxs-lookup"><span data-stu-id="3c330-108">How Requests Are Processed by the Thread Pool</span></span>](#HowRequestsProcessedByTP)
> - [<span data-ttu-id="3c330-109">Zaman uyumlu veya zaman uyumsuz yöntemleri seçme</span><span class="sxs-lookup"><span data-stu-id="3c330-109">Choosing Synchronous or Asynchronous Methods</span></span>](#ChoosingSyncVasync)
> - [<span data-ttu-id="3c330-110">Örnek uygulama</span><span class="sxs-lookup"><span data-stu-id="3c330-110">The Sample Application</span></span>](#SampleApp)
> - [<span data-ttu-id="3c330-111">En zaman uyumlu sayfası</span><span class="sxs-lookup"><span data-stu-id="3c330-111">The Gizmos Synchronous Page</span></span>](#GizmosSynch)
> - [<span data-ttu-id="3c330-112">Zaman uyumsuz en sayfası oluşturma</span><span class="sxs-lookup"><span data-stu-id="3c330-112">Creating an Asynchronous Gizmos Page</span></span>](#CreatingAsynchGizmos)
> - [<span data-ttu-id="3c330-113">Paralel olarak birden çok işlemlerini gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="3c330-113">Performing Multiple Operations in Parallel</span></span>](#Parallel)
> - [<span data-ttu-id="3c330-114">Bir iptal belirteci kullanma</span><span class="sxs-lookup"><span data-stu-id="3c330-114">Using a Cancellation Token</span></span>](#CancelToken)
> - [<span data-ttu-id="3c330-115">Yüksek eşzamanlılık/yüksek gecikme Web hizmeti çağrıları için sunucu yapılandırması</span><span class="sxs-lookup"><span data-stu-id="3c330-115">Server Configuration for High Concurrency/High Latency Web Service Calls</span></span>](#ServerConfig)
> 
> <span data-ttu-id="3c330-116">Bu öğreticinin için tam bir örnek sağlanır</span><span class="sxs-lookup"><span data-stu-id="3c330-116">A complete sample is provided for this tutorial at</span></span>  
>  <span data-ttu-id="3c330-117">[https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/) üzerinde [GitHub](https://github.com/) site.</span><span class="sxs-lookup"><span data-stu-id="3c330-117">[https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/) on the [GitHub](https://github.com/) site.</span></span>


<span data-ttu-id="3c330-118">ASP.NET 4.5 Web sayfaları birlikte [.NET 4.5](https://msdn.microsoft.com/en-us/library/w0x726c2(VS.110).aspx) bir nesne türü döndüren zaman uyumsuz yöntemler kaydetmenizi sağlayan [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx).</span><span class="sxs-lookup"><span data-stu-id="3c330-118">ASP.NET 4.5 Web Pages in combination [.NET 4.5](https://msdn.microsoft.com/en-us/library/w0x726c2(VS.110).aspx) enables you to register asynchronous methods that return an object of type [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx).</span></span> <span data-ttu-id="3c330-119">.NET Framework 4 olarak adlandırılan bir zaman uyumsuz programlama kavram sunulan bir [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) ve ASP.NET 4.5 destekler [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx).</span><span class="sxs-lookup"><span data-stu-id="3c330-119">The .NET Framework 4 introduced an asynchronous programming concept referred to as a [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) and ASP.NET 4.5 supports [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx).</span></span> <span data-ttu-id="3c330-120">Görevler tarafından gösterilen **görev** türü ve ilgili türlerinde [System.Threading.Tasks](https://msdn.microsoft.com/en-us/library/system.threading.tasks.aspx) ad alanı.</span><span class="sxs-lookup"><span data-stu-id="3c330-120">Tasks are represented by the **Task** type and related types in the [System.Threading.Tasks](https://msdn.microsoft.com/en-us/library/system.threading.tasks.aspx) namespace.</span></span> <span data-ttu-id="3c330-121">Bu zaman uyumsuz desteği ile .NET Framework 4.5 derlemeler [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) çalışmak olun anahtar sözcükleri [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) daha önceki daha az karmaşık nesneleri zaman uyumsuz yaklaşımlar.</span><span class="sxs-lookup"><span data-stu-id="3c330-121">The .NET Framework 4.5 builds on this asynchronous support with the [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keywords that make working with [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) objects much less complex than previous asynchronous approaches.</span></span> <span data-ttu-id="3c330-122">[Await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) , paylaştırılabilen bir kod zaman uyumsuz olarak diğer bazı kod parçasına beklemesi gerektiğini belirten için söz dizimi toplu bir anahtardır.</span><span class="sxs-lookup"><span data-stu-id="3c330-122">The [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) keyword is syntactical shorthand for indicating that a piece of code should asynchronously wait on some other piece of code.</span></span> <span data-ttu-id="3c330-123">[Zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) anahtar sözcüğü yöntemleri görev tabanlı zaman uyumsuz yöntemleri olarak işaretlemek için kullanabileceğiniz bir ipucu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="3c330-123">The [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keyword represents a hint that you can use to mark methods as task-based asynchronous methods.</span></span> <span data-ttu-id="3c330-124">Birleşimi **await**, **zaman uyumsuz**ve **görev** nesne sağlar, .NET 4.5 içinde zaman uyumsuz kod yazmak çok daha kolay.</span><span class="sxs-lookup"><span data-stu-id="3c330-124">The combination of **await**, **async**, and the **Task** object makes it much easier for you to write asynchronous code in .NET 4.5.</span></span> <span data-ttu-id="3c330-125">Zaman uyumsuz yöntemleri için yeni model adlı *görev tabanlı zaman uyumsuz desen* (**DOKUNUN**).</span><span class="sxs-lookup"><span data-stu-id="3c330-125">The new model for asynchronous methods is called the *Task-based Asynchronous Pattern* (**TAP**).</span></span> <span data-ttu-id="3c330-126">Bu öğretici, zaman uyumsuz programing kullanma konusunda biraz bilgili varsayar [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) ad alanı.</span><span class="sxs-lookup"><span data-stu-id="3c330-126">This tutorial assumes you have some familiarity with asynchronous programing using [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) namespace.</span></span>

<span data-ttu-id="3c330-127">Kullanma hakkında daha fazla bilgi için [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) ad alanı, aşağıdaki kaynaklara bakın.</span><span class="sxs-lookup"><span data-stu-id="3c330-127">For more information on the using [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) namespace, see the following references.</span></span>

- [<span data-ttu-id="3c330-128">Teknik İnceleme: Asynchrony .NET içinde</span><span class="sxs-lookup"><span data-stu-id="3c330-128">Whitepaper: Asynchrony in .NET</span></span>](https://go.microsoft.com/fwlink/?LinkId=204844)
- [<span data-ttu-id="3c330-129">Zaman uyumsuz/bekleme SSS</span><span class="sxs-lookup"><span data-stu-id="3c330-129">Async/Await FAQ</span></span>](https://blogs.msdn.com/b/pfxteam/archive/2012/04/12/10293335.aspx)
- [<span data-ttu-id="3c330-130">Visual Studio zaman uyumsuz programlama</span><span class="sxs-lookup"><span data-stu-id="3c330-130">Visual Studio Asynchronous Programming</span></span>](https://msdn.microsoft.com/en-us/vstudio/gg316360)

## <a id="HowRequestsProcessedByTP"></a><span data-ttu-id="3c330-131">İstekleri iş parçacığı havuzu tarafından nasıl işlenir</span><span class="sxs-lookup"><span data-stu-id="3c330-131">How Requests Are Processed by the Thread Pool</span></span>

<span data-ttu-id="3c330-132">Web sunucusunda .NET Framework ASP.NET isteklere hizmet vermek için kullanılan iş parçacığı havuzu tutar.</span><span class="sxs-lookup"><span data-stu-id="3c330-132">On the web server, the .NET Framework maintains a pool of threads that are used to service ASP.NET requests.</span></span> <span data-ttu-id="3c330-133">Bir istek ulaştığında, bir iş parçacığı havuzundaki bu isteği işlemek için gönderilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-133">When a request arrives, a thread from the pool is dispatched to process that request.</span></span> <span data-ttu-id="3c330-134">İstek zaman uyumlu olarak işlenir, isteği işleyen iş parçacığı isteği sırasında meşgul işlenmektedir ve iş parçacığı başka bir isteğe hizmet veremiyor olur.</span><span class="sxs-lookup"><span data-stu-id="3c330-134">If the request is processed synchronously, the thread that processes the request is busy while the request is being processed, and that thread cannot service another request.</span></span>   
  
<span data-ttu-id="3c330-135">İş parçacığı havuzu pek çok meşgul iş parçacığı uyabilecek kadar büyük hale getirilebilir çünkü bu bir sorun olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-135">This might not be a problem, because the thread pool can be made large enough to accommodate many busy threads.</span></span> <span data-ttu-id="3c330-136">Ancak, iş parçacığı havuzu iş parçacıkları sayısı sınırlıdır (.NET 4.5 için en fazla 5000 varsayılandır).</span><span class="sxs-lookup"><span data-stu-id="3c330-136">However, the number of threads in the thread pool is limited (the default maximum for .NET 4.5 is 5,000).</span></span> <span data-ttu-id="3c330-137">Uzun süre çalışan istekler yüksek eşzamanlılık ile büyük uygulamalar tüm kullanılabilir iş parçacıklarının meşgul olabilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-137">In large applications with high concurrency of long-running requests, all available threads might be busy.</span></span> <span data-ttu-id="3c330-138">Bu durum, iş parçacığı yetersizliğini bilinir.</span><span class="sxs-lookup"><span data-stu-id="3c330-138">This condition is known as thread starvation.</span></span> <span data-ttu-id="3c330-139">Bu durum ulaşıldığında, web sunucusu isteklerinin sıralar.</span><span class="sxs-lookup"><span data-stu-id="3c330-139">When this condition is reached, the web server queues requests.</span></span> <span data-ttu-id="3c330-140">İstek sırası dolduğunda, web sunucusu (Sunucu meşgul) HTTP 503 durumuna sahip istekleri reddeder.</span><span class="sxs-lookup"><span data-stu-id="3c330-140">If the request queue becomes full, the web server rejects requests with an HTTP 503 status (Server Too Busy).</span></span> <span data-ttu-id="3c330-141">CLR iş parçacığı havuzu üzerinde yeni iş parçacığı eklemelerini sınırlamaları vardır.</span><span class="sxs-lookup"><span data-stu-id="3c330-141">The CLR thread pool has limitations on new thread injections.</span></span> <span data-ttu-id="3c330-142">Eşzamanlılık bursty ise (diğer bir deyişle, web sitenizi aniden çok sayıda istek alabilirsiniz) ve tüm kullanılabilir isteği iş parçacığı arka uç çağrıları nedeniyle yüksek gecikme süresiyle meşgul, sınırlı iş parçacığı ekleme oranı çok kötü yanıt uygulamanızı yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c330-142">If concurrency is bursty (that is, your web site can suddenly get a large number of requests) and all available request threads are busy because of backend calls with high latency, the limited thread injection rate can make your application respond very poorly.</span></span> <span data-ttu-id="3c330-143">Ayrıca, iş parçacığı havuzuna eklenen her yeni iş parçacığı (örneğin, 1 MB yığın bellek) yüke sahiptir.</span><span class="sxs-lookup"><span data-stu-id="3c330-143">Additionally, each new thread added to the thread pool has overhead (such as 1 MB of stack memory).</span></span> <span data-ttu-id="3c330-144">İş parçacığı havuzu .NET 4.5 varsayılan olarak 5 maksimum büyür nerede hizmet yüksek gecikme çağrıları için zaman uyumlu yöntemleri kullanarak bir web uygulaması uygulamanın mümkün daha fazla bellek yaklaşık 5 GB 000 iş parçacığı kullanır aynı hizmet istekleri kullanma zaman uyumsuz yöntemleri ve yalnızca 50 iş parçacığı sayısı.</span><span class="sxs-lookup"><span data-stu-id="3c330-144">A web application using synchronous methods to service high latency calls where the thread pool grows to the .NET 4.5 default maximum of 5, 000 threads would consume approximately 5 GB more memory than an application able the service the same requests using asynchronous methods and only 50 threads.</span></span> <span data-ttu-id="3c330-145">Zaman uyumsuz iş yaparken, her zaman bir iş parçacığı kullanıyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="3c330-145">When you're doing asynchronous work, you're not always using a thread.</span></span> <span data-ttu-id="3c330-146">Zaman uyumsuz web hizmeti isteğine yaptığınızda, örneğin, ASP.NET tüm iş parçacıkları arasında kullanmadığınız **zaman uyumsuz** yöntem çağrısı ve **await**.</span><span class="sxs-lookup"><span data-stu-id="3c330-146">For example, when you make an asynchronous web service request, ASP.NET will not be using any threads between the **async** method call and the **await**.</span></span> <span data-ttu-id="3c330-147">Yüksek gecikme süresine sahip isteklere hizmet iş parçacığı havuzu kullanma büyük bellek kaplama alanı ve sunucu donanımı zayıf kullanımı için yol açabilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-147">Using the thread pool to service requests with high latency can lead to a large memory footprint and poor utilization of the server hardware.</span></span>

## <a name="processing-asynchronous-requests"></a><span data-ttu-id="3c330-148">Zaman uyumsuz istek işleme</span><span class="sxs-lookup"><span data-stu-id="3c330-148">Processing Asynchronous Requests</span></span>

<span data-ttu-id="3c330-149">(Burada eşzamanlılık aniden artırır) bursty yükü çok sayıda eş zamanlı istekleri başlatma bakın veya web uygulamalarında zaman uyumsuz web hizmeti çağrıları yapma, uygulamanızın yanıt hızını artırır.</span><span class="sxs-lookup"><span data-stu-id="3c330-149">In web applications that see a large number of concurrent requests at start-up or has a bursty load (where concurrency increases suddenly), making web service calls asynchronous will increase the responsiveness of your application.</span></span> <span data-ttu-id="3c330-150">Zaman uyumsuz bir istek aynı zaman uyumlu bir isteği işlemek için gereken süre.</span><span class="sxs-lookup"><span data-stu-id="3c330-150">An asynchronous request takes the same amount of time to process as a synchronous request.</span></span> <span data-ttu-id="3c330-151">Örneğin, bir istek bir web hizmeti, çağrı yaparsa tamamlamak, isteği alır iki saniye eşzamanlı veya zaman uyumsuz olarak gerçekleştirilen olup olmadığını iki saniye gerektirir.</span><span class="sxs-lookup"><span data-stu-id="3c330-151">For example, if a request makes a web service call that requires two seconds to complete, the request takes two seconds whether it is performed synchronously or asynchronously.</span></span> <span data-ttu-id="3c330-152">Ancak, bir zaman uyumsuz çağrı sırasında ilk istek tamamlanması için beklerken diğer isteklere yanıt iş parçacığı engellenmez.</span><span class="sxs-lookup"><span data-stu-id="3c330-152">However, during an asynchronous call, a thread is not blocked from responding to other requests while it waits for the first request to complete.</span></span> <span data-ttu-id="3c330-153">Bu nedenle, uzun süre çalışan işlemleri çağırma çok sayıda eş zamanlı istekleri olduğunda zaman uyumsuz istekleri isteği sıraya alma ve iş parçacığı havuzu büyümesini engellemek.</span><span class="sxs-lookup"><span data-stu-id="3c330-153">Therefore, asynchronous requests prevent request queuing and thread pool growth when there are many concurrent requests that invoke long-running operations.</span></span>

## <a id="ChoosingSyncVasync"></a><span data-ttu-id="3c330-154">Zaman uyumlu veya zaman uyumsuz yöntemleri seçme</span><span class="sxs-lookup"><span data-stu-id="3c330-154">Choosing Synchronous or Asynchronous Methods</span></span>

<span data-ttu-id="3c330-155">Bu bölümde, zaman zaman uyumlu veya zaman uyumsuz yöntemler kullanmayı yönergeleri listelenir.</span><span class="sxs-lookup"><span data-stu-id="3c330-155">This section lists guidelines for when to use synchronous or asynchronous Methods.</span></span> <span data-ttu-id="3c330-156">Bunlar yalnızca yönergelerdir; tek tek zaman uyumsuz yöntemleri ile performansı Yardım olup olmadığını belirlemek için her bir uygulama inceleyin.</span><span class="sxs-lookup"><span data-stu-id="3c330-156">These are just guidelines; examine each application individually to determine whether asynchronous methods help with performance.</span></span>

<span data-ttu-id="3c330-157">Genel olarak, aşağıdaki koşullar için zaman uyumlu yöntemleri kullanın:</span><span class="sxs-lookup"><span data-stu-id="3c330-157">In general, use synchronous methods for the following conditions:</span></span>

- <span data-ttu-id="3c330-158">, Basit veya kısa süreli işlemleridir.</span><span class="sxs-lookup"><span data-stu-id="3c330-158">The operations are simple or short-running.</span></span>
- <span data-ttu-id="3c330-159">Basitlik verimliliği daha önemlidir.</span><span class="sxs-lookup"><span data-stu-id="3c330-159">Simplicity is more important than efficiency.</span></span>
- <span data-ttu-id="3c330-160">Öncelikle CPU işlemleri kapsamlı disk veya ağ yükünü içeren işlemleri yerine işlemleridir.</span><span class="sxs-lookup"><span data-stu-id="3c330-160">The operations are primarily CPU operations instead of operations that involve extensive disk or network overhead.</span></span> <span data-ttu-id="3c330-161">CPU bağımlı işlemlerini zaman uyumsuz yöntemlerle hiçbir yararları sağlar ve daha fazla bilgi için ek yükü sonuçlanır.</span><span class="sxs-lookup"><span data-stu-id="3c330-161">Using asynchronous methods on CPU-bound operations provides no benefits and results in more overhead.</span></span>

 <span data-ttu-id="3c330-162">Genel olarak, aşağıdaki koşullar için zaman uyumsuz yöntemleri kullanın:</span><span class="sxs-lookup"><span data-stu-id="3c330-162">In general, use asynchronous methods for the following conditions:</span></span>

- <span data-ttu-id="3c330-163">Zaman uyumsuz yöntemlerle tüketilebilir Hizmetleri arıyoruz ve .NET 4.5 veya üstünü kullanıyorsanız.</span><span class="sxs-lookup"><span data-stu-id="3c330-163">You're calling services that can be consumed through asynchronous methods, and you're using .NET 4.5 or higher.</span></span>
- <span data-ttu-id="3c330-164">, Ağ sınırını veya g/O-bağlı CPU bağımlı yerine işlemleridir.</span><span class="sxs-lookup"><span data-stu-id="3c330-164">The operations are network-bound or I/O-bound instead of CPU-bound.</span></span>
- <span data-ttu-id="3c330-165">Paralellik kod kolaylık daha önemlidir.</span><span class="sxs-lookup"><span data-stu-id="3c330-165">Parallelism is more important than simplicity of code.</span></span>
- <span data-ttu-id="3c330-166">Uzun süre çalışan isteği iptal kullanıcıların olanak sağlayan bir mekanizma sağlamak istediğinizde.</span><span class="sxs-lookup"><span data-stu-id="3c330-166">You want to provide a mechanism that lets users cancel a long-running request.</span></span>
- <span data-ttu-id="3c330-167">Ne zaman iş parçacığı çıkış geçiş avantajı, içerik anahtarı maliyetini ağırlık verir.</span><span class="sxs-lookup"><span data-stu-id="3c330-167">When the benefit of switching threads out weights the cost of the context switch.</span></span> <span data-ttu-id="3c330-168">Zaman uyumlu yöntemi hiçbir iş yaparken ASP.NET isteği iş parçacığı engelliyorsa genel olarak, bir yöntem zaman uyumsuz yapmanız.</span><span class="sxs-lookup"><span data-stu-id="3c330-168">In general, you should make a method asynchronous if the synchronous method blocks the ASP.NET request thread while doing no work.</span></span> <span data-ttu-id="3c330-169">Arama zaman uyumsuz hale getirerek, ASP.NET isteği iş parçacığı için web hizmeti isteği tamamlamak beklerken hiçbir çalışarak engellenmez.</span><span class="sxs-lookup"><span data-stu-id="3c330-169">By making the call asynchronous, the ASP.NET request thread is not blocked doing no work while it waits for the web service request to complete.</span></span>
- <span data-ttu-id="3c330-170">Sınama engelleme işlemleri site performans bir performans sorunu olduğunu ve IIS daha fazla isteği bu engelleme çağrıları için zaman uyumsuz yöntemleri kullanarak hizmet gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c330-170">Testing shows that the blocking operations are a bottleneck in site performance and that IIS can service more requests by using asynchronous methods for these blocking calls.</span></span>

 <span data-ttu-id="3c330-171">İndirilebilir örnekteki zaman uyumsuz yöntemleri etkili bir şekilde kullanmayı gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c330-171">The downloadable sample shows how to use asynchronous methods effectively.</span></span> <span data-ttu-id="3c330-172">Sağlanan örnek ASP.NET 4.5 içinde zaman uyumsuz programlama basit Tanıtımı sağlamak için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="3c330-172">The sample provided was designed to provide a simple demonstration of asynchronous programming in ASP.NET 4.5.</span></span> <span data-ttu-id="3c330-173">Örnek ASP.NET zaman uyumsuz programlama için bir başvuru mimarisi olması amaçlanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="3c330-173">The sample is not intended to be a reference architecture for asynchronous programming in ASP.NET.</span></span> <span data-ttu-id="3c330-174">Örnek program çağrıları [ASP.NET Web API](../../../web-api/index.md) daha sırayla çağıran yöntemleri [Task.Delay](https://msdn.microsoft.com/en-us/library/hh139096(VS.110).aspx) uzun süre çalışan web hizmeti çağrıları benzetimini yapmak için.</span><span class="sxs-lookup"><span data-stu-id="3c330-174">The sample program calls [ASP.NET Web API](../../../web-api/index.md) methods which in turn call [Task.Delay](https://msdn.microsoft.com/en-us/library/hh139096(VS.110).aspx) to simulate long-running web service calls.</span></span> <span data-ttu-id="3c330-175">Üretim uygulamaların çoğu zaman uyumsuz yöntemler kullanma gibi belirgin avantajları göstermez.</span><span class="sxs-lookup"><span data-stu-id="3c330-175">Most production applications will not show such obvious benefits to using asynchronous Methods.</span></span>   
  
<span data-ttu-id="3c330-176">Birkaç uygulamalar tüm yöntemleri zaman uyumsuz olmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="3c330-176">Few applications require all methods to be asynchronous.</span></span> <span data-ttu-id="3c330-177">Genellikle, birkaç zaman uyumlu yöntemleri zaman uyumsuz yöntemleri dönüştürme gerekli iş miktarı için en iyi verimliliği artırma sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c330-177">Often, converting a few synchronous methods to asynchronous methods provides the best efficiency increase for the amount of work required.</span></span>

## <a id="SampleApp"></a><span data-ttu-id="3c330-178">Örnek uygulama</span><span class="sxs-lookup"><span data-stu-id="3c330-178">The Sample Application</span></span>

<span data-ttu-id="3c330-179">Örnek uygulamayı indirebilirsiniz [https://github.com/RickAndMSFT/Async-ASP.NET](https://github.com/RickAndMSFT/Async-ASP.NET) üzerinde [GitHub](https://github.com/) site.</span><span class="sxs-lookup"><span data-stu-id="3c330-179">You can download the sample application from [https://github.com/RickAndMSFT/Async-ASP.NET](https://github.com/RickAndMSFT/Async-ASP.NET) on the [GitHub](https://github.com/) site.</span></span> <span data-ttu-id="3c330-180">Depo üç projelerin oluşur:</span><span class="sxs-lookup"><span data-stu-id="3c330-180">The repository consists of three projects:</span></span>

- <span data-ttu-id="3c330-181">*WebAppAsync*: Web API'sini kullanan ASP.NET Web Forms proje **WebAPIpwg** hizmet.</span><span class="sxs-lookup"><span data-stu-id="3c330-181">*WebAppAsync*: The ASP.NET Web Forms project that consumes the Web API **WebAPIpwg** service.</span></span> <span data-ttu-id="3c330-182">Bu öğreticide bunu için kod çoğu projesi.</span><span class="sxs-lookup"><span data-stu-id="3c330-182">Most of the code for this tutorial is from the this project.</span></span>
- <span data-ttu-id="3c330-183">*WebAPIpgw*: uygulayan ASP.NET MVC 4 Web API projesi `Products, Gizmos and Widgets` denetleyicileri.</span><span class="sxs-lookup"><span data-stu-id="3c330-183">*WebAPIpgw*: The ASP.NET MVC 4 Web API project that implements the `Products, Gizmos and Widgets` controllers.</span></span> <span data-ttu-id="3c330-184">İçin veri sağlar *WebAppAsync* proje ve *Mvc4Async* projesi.</span><span class="sxs-lookup"><span data-stu-id="3c330-184">It provides the data for the *WebAppAsync* project and the *Mvc4Async* project.</span></span>
- <span data-ttu-id="3c330-185">*Mvc4Async*: başka bir öğreticide kullanılan kod içeren ASP.NET MVC 4 projesinin.</span><span class="sxs-lookup"><span data-stu-id="3c330-185">*Mvc4Async*: The ASP.NET MVC 4 project that contains the code used in another tutorial.</span></span> <span data-ttu-id="3c330-186">Web API çağrıları yapan **WebAPIpwg** hizmet.</span><span class="sxs-lookup"><span data-stu-id="3c330-186">It makes Web API calls to the **WebAPIpwg** service.</span></span>

## <a id="GizmosSynch"></a><span data-ttu-id="3c330-187">En zaman uyumlu sayfası</span><span class="sxs-lookup"><span data-stu-id="3c330-187">The Gizmos Synchronous Page</span></span>

 <span data-ttu-id="3c330-188">Aşağıdaki kodda gösterildiği `Page_Load` en listesini görüntülemek için kullanılan zaman uyumlu yöntemi.</span><span class="sxs-lookup"><span data-stu-id="3c330-188">The following code shows the `Page_Load` synchronous method that is used to display a list of gizmos.</span></span> <span data-ttu-id="3c330-189">(Bu makalede, bir gizmo bir kurgusal mekanik aygıttır.)</span><span class="sxs-lookup"><span data-stu-id="3c330-189">(For this article, a gizmo is a fictional mechanical device.)</span></span> 

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample1.cs)]

<span data-ttu-id="3c330-190">Aşağıdaki kodda gösterildiği `GetGizmos` gizmo hizmetinin yöntemi.</span><span class="sxs-lookup"><span data-stu-id="3c330-190">The following code shows the `GetGizmos` method of the gizmo service.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample2.cs)]

<span data-ttu-id="3c330-191">`GizmoService GetGizmos` Yöntemi en veri listesi döndüren bir ASP.NET Web API HTTP hizmeti için bir URI geçirir.</span><span class="sxs-lookup"><span data-stu-id="3c330-191">The `GizmoService GetGizmos` method passes a URI to an ASP.NET Web API HTTP service which returns a list of gizmos data.</span></span> <span data-ttu-id="3c330-192">*WebAPIpgw* projeyi içeren Web API uygulaması `gizmos, widget` ve `product` denetleyicileri.</span><span class="sxs-lookup"><span data-stu-id="3c330-192">The *WebAPIpgw* project contains the implementation of the Web API `gizmos, widget` and `product` controllers.</span></span>  
<span data-ttu-id="3c330-193">Aşağıdaki resimde örnek proje en sayfasından gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c330-193">The following image shows the gizmos page from the sample project.</span></span>

![En](using-asynchronous-methods-in-aspnet-45/_static/image1.png)

## <a id="CreatingAsynchGizmos"></a><span data-ttu-id="3c330-195">Zaman uyumsuz en sayfası oluşturma</span><span class="sxs-lookup"><span data-stu-id="3c330-195">Creating an Asynchronous Gizmos Page</span></span>

<span data-ttu-id="3c330-196">Örnek yeni [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) ve [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) anahtar sözcükler (.NET 4.5 ve Visual Studio 2012'de kullanılabilir) karmaşık dönüştürmeleri için gerekli tutmakla derleyici izin vermek için zaman uyumsuz programlama.</span><span class="sxs-lookup"><span data-stu-id="3c330-196">The sample uses the new [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) and [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) keywords (available in .NET 4.5 and Visual Studio 2012) to let the compiler be responsible for maintaining the complicated transformations necessary for asynchronous programming.</span></span> <span data-ttu-id="3c330-197">Derleyici, C# ' nin zaman uyumlu denetim akışı yapıları kullanılarak kod yazmanıza olanak veren ve derleyici iş parçacıkları engelleme önlemek için geri çağırmaları kullanmak için gerekli dönüşümleri otomatik olarak uygular.</span><span class="sxs-lookup"><span data-stu-id="3c330-197">The compiler lets you write code using the C#'s synchronous control flow constructs and the compiler automatically applies the transformations necessary to use callbacks in order to avoid blocking threads.</span></span>

<span data-ttu-id="3c330-198">ASP.NET zaman uyumsuz sayfaları içermelidir [sayfa](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) ile yönerge `Async` özniteliği "true".</span><span class="sxs-lookup"><span data-stu-id="3c330-198">ASP.NET asynchronous pages must include the [Page](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) directive with the `Async` attribute set to "true".</span></span> <span data-ttu-id="3c330-199">Aşağıdaki kodda gösterildiği [sayfa](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) ile yönerge `Async` özniteliği "true" için *GizmosAsync.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="3c330-199">The following code shows the [Page](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) directive with the `Async` attribute set to "true" for the *GizmosAsync.aspx* page.</span></span>

[!code-aspx[Main](using-asynchronous-methods-in-aspnet-45/samples/sample3.aspx?highlight=1)]

<span data-ttu-id="3c330-200">Aşağıdaki kodda gösterildiği `Gizmos` zaman uyumlu `Page_Load` yöntemi ve `GizmosAsync` zaman uyumsuz sayfası.</span><span class="sxs-lookup"><span data-stu-id="3c330-200">The following code shows the `Gizmos` synchronous `Page_Load` method and the `GizmosAsync` asynchronous page.</span></span> <span data-ttu-id="3c330-201">Tarayıcınız destekliyorsa [HTML 5 &lt;işaretlemek&gt; öğesi](http://www.w3.org/wiki/HTML/Elements/mark), değişiklikleri görürsünüz `GizmosAsync` sarı Vurgu içinde.</span><span class="sxs-lookup"><span data-stu-id="3c330-201">If your browser supports the [HTML 5 &lt;mark&gt; element](http://www.w3.org/wiki/HTML/Elements/mark), you'll see the changes in `GizmosAsync` in yellow highlight.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample4.cs)]

<span data-ttu-id="3c330-202">Zaman uyumsuz sürümü:</span><span class="sxs-lookup"><span data-stu-id="3c330-202">The asynchronous version:</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample5.cs?highlight=3,6-7,9,11)]

 <span data-ttu-id="3c330-203">Aşağıdaki değişiklikleri izin vermek için uygulanan `GizmosAsync` sayfa zaman uyumsuz.</span><span class="sxs-lookup"><span data-stu-id="3c330-203">The following changes were applied to allow the `GizmosAsync` page be asynchronous.</span></span>

- <span data-ttu-id="3c330-204">[Sayfa](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) yönergesi olmalıdır `Async` özniteliği "true".</span><span class="sxs-lookup"><span data-stu-id="3c330-204">The [Page](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) directive must have the `Async` attribute set to "true".</span></span>
- <span data-ttu-id="3c330-205">`RegisterAsyncTask` Yöntemi, zaman uyumsuz olarak çalışan bir kod içeren zaman uyumsuz bir görevi kaydetmek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="3c330-205">The `RegisterAsyncTask` method is used to register an asynchronous task containing the code which runs asynchronously.</span></span>
- <span data-ttu-id="3c330-206">Yeni `GetGizmosSvcAsync` yöntemi ile işaretlenmiş [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) gövde bölümlerinin geri aramalar oluşturun ve otomatik olarak oluşturmak için derleyici söyler anahtar sözcüğü bir `Task` , döndürülür.</span><span class="sxs-lookup"><span data-stu-id="3c330-206">The new `GetGizmosSvcAsync` method is marked with the [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keyword, which tells the compiler to generate callbacks for parts of the body and to automatically create a `Task` that is returned.</span></span>
- <span data-ttu-id="3c330-207">&quot;Zaman uyumsuz&quot; zaman uyumsuz yöntem adına eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="3c330-207">&quot;Async&quot; was appended to the asynchronous method name.</span></span> <span data-ttu-id="3c330-208">"Zaman uyumsuz" ekleyerek gerekli değildir ancak zaman uyumsuz yöntemleri yazarken kuraldır.</span><span class="sxs-lookup"><span data-stu-id="3c330-208">Appending "Async" is not required but is the convention when writing asynchronous methods.</span></span>
- <span data-ttu-id="3c330-209">Dönüş türü yeni yeni `GetGizmosSvcAsync` yöntemi `Task`.</span><span class="sxs-lookup"><span data-stu-id="3c330-209">The return type of the new new `GetGizmosSvcAsync` method is `Task`.</span></span> <span data-ttu-id="3c330-210">Dönüş türü `Task` devam eden iş temsil eder ve zaman uyumsuz işlemin tamamlanması için beklenecek içinden işleyici ile yöntemini arayanlar sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c330-210">The return type of `Task` represents ongoing work and provides callers of the method with a handle through which to wait for the asynchronous operation's completion.</span></span>
- <span data-ttu-id="3c330-211">[Await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) anahtar sözcüğü, web hizmeti çağrısı uygulandı.</span><span class="sxs-lookup"><span data-stu-id="3c330-211">The [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) keyword was applied to the web service call.</span></span>
- <span data-ttu-id="3c330-212">Zaman uyumsuz web hizmeti API'si çağrıldı (`GetGizmosAsync`).</span><span class="sxs-lookup"><span data-stu-id="3c330-212">The asynchronous web service API was called (`GetGizmosAsync`).</span></span>

<span data-ttu-id="3c330-213">İçinde `GetGizmosSvcAsync` yöntemi gövde başka bir zaman uyumsuz yöntem `GetGizmosAsync` olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="3c330-213">Inside of the `GetGizmosSvcAsync` method body another asynchronous method, `GetGizmosAsync` is called.</span></span> <span data-ttu-id="3c330-214">`GetGizmosAsync`hemen döndüren bir `Task<List<Gizmo>>` , sonuç tamamlanacak veriler kullanılabilir olduğunda.</span><span class="sxs-lookup"><span data-stu-id="3c330-214">`GetGizmosAsync` immediately returns a `Task<List<Gizmo>>` that will eventually complete when the data is available.</span></span> <span data-ttu-id="3c330-215">Gizmo verileri elde edene kadar başka bir şey yapmak istemeyeceğiniz için kod görev bekler (kullanarak **await** anahtar sözcüğü).</span><span class="sxs-lookup"><span data-stu-id="3c330-215">Because you don't want to do anything else until you have the gizmo data, the code awaits the task (using the **await** keyword).</span></span> <span data-ttu-id="3c330-216">Kullanabileceğiniz **await** anahtar sözcüğü ile Açıklama yöntemler **zaman uyumsuz** anahtar sözcüğü.</span><span class="sxs-lookup"><span data-stu-id="3c330-216">You can use the **await** keyword only in methods annotated with the **async** keyword.</span></span>

<span data-ttu-id="3c330-217">**Await** anahtar sözcüğü görevi tamamlanana kadar iş parçacığı engellemez.</span><span class="sxs-lookup"><span data-stu-id="3c330-217">The **await** keyword does not block the thread until the task is complete.</span></span> <span data-ttu-id="3c330-218">Görev üzerinde geri arama olarak yöntemi rest imzalar ve hemen döndürür.</span><span class="sxs-lookup"><span data-stu-id="3c330-218">It signs up the rest of the method as a callback on the task, and immediately returns.</span></span> <span data-ttu-id="3c330-219">Awaited görevi sonunda tamamlandığında, bu geri çağırma ve böylece kaldığı yerden yöntemi sağ yürütülmesini Sürdür.</span><span class="sxs-lookup"><span data-stu-id="3c330-219">When the awaited task eventually completes, it will invoke that callback and thus resume the execution of the method right where it left off.</span></span> <span data-ttu-id="3c330-220">Kullanma hakkında daha fazla bilgi için [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) ad alanı, bkz: [zaman uyumsuz başvurular](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span><span class="sxs-lookup"><span data-stu-id="3c330-220">For more information on using the [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx) namespace, see the [async references](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span></span>

<span data-ttu-id="3c330-221">Aşağıdaki kodda gösterildiği `GetGizmos` ve `GetGizmosAsync` yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="3c330-221">The following code shows the `GetGizmos` and `GetGizmosAsync` methods.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample6.cs)]

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample7.cs?highlight=1,4-8)]

 <span data-ttu-id="3c330-222">Zaman uyumsuz değişiklikler için yapılan benzer **GizmosAsync** üstünde.</span><span class="sxs-lookup"><span data-stu-id="3c330-222">The asynchronous changes are similar to those made to the **GizmosAsync** above.</span></span> 

- <span data-ttu-id="3c330-223">Yöntem imzası ile ek açıklama [zaman uyumsuz](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) anahtar sözcüğü, dönüş türü için değiştirildi `Task<List<Gizmo>>`, ve *zaman uyumsuz* yöntemi adına eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="3c330-223">The method signature was annotated with the [async](https://msdn.microsoft.com/en-us/library/hh156513(VS.110).aspx) keyword, the return type was changed to `Task<List<Gizmo>>`, and *Async* was appended to the method name.</span></span>
- <span data-ttu-id="3c330-224">Zaman uyumsuz [HttpClient](https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(VS.110).aspx) sınıfı zaman uyumlu yerine kullanılır [WebClient](https://msdn.microsoft.com/en-us/library/system.net.webclient.aspx) sınıfı.</span><span class="sxs-lookup"><span data-stu-id="3c330-224">The asynchronous [HttpClient](https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(VS.110).aspx) class is used instead of the synchronous [WebClient](https://msdn.microsoft.com/en-us/library/system.net.webclient.aspx) class.</span></span>
- <span data-ttu-id="3c330-225">[Await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) anahtar sözcüğü için uygulandığı [HttpClient](https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(VS.110).aspx)[GetAsync](https://msdn.microsoft.com/en-us/library/hh158944(VS.110).aspx) zaman uyumsuz yöntem.</span><span class="sxs-lookup"><span data-stu-id="3c330-225">The [await](https://msdn.microsoft.com/en-us/library/hh156528(VS.110).aspx) keyword was applied to the [HttpClient](https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(VS.110).aspx)[GetAsync](https://msdn.microsoft.com/en-us/library/hh158944(VS.110).aspx) asynchronous method.</span></span>

<span data-ttu-id="3c330-226">Aşağıdaki resimde zaman uyumsuz gizmo görünümü gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c330-226">The following image shows the asynchronous gizmo view.</span></span>

![async](using-asynchronous-methods-in-aspnet-45/_static/image2.png)

<span data-ttu-id="3c330-228">En verilerinin tarayıcılar sunumu eşzamanlı çağrı tarafından oluşturulan görünüm aynıdır.</span><span class="sxs-lookup"><span data-stu-id="3c330-228">The browsers presentation of the gizmos data is identical to the view created by the synchronous call.</span></span> <span data-ttu-id="3c330-229">Zaman uyumsuz sürümü ağır yük altında daha fazla kullanıcı olabilir yalnızca farktır.</span><span class="sxs-lookup"><span data-stu-id="3c330-229">The only difference is the asynchronous version may be more performant under heavy loads.</span></span>

## <a name="registerasynctask-notes"></a><span data-ttu-id="3c330-230">RegisterAsyncTask Notlar</span><span class="sxs-lookup"><span data-stu-id="3c330-230">RegisterAsyncTask Notes</span></span>

<span data-ttu-id="3c330-231">Yöntemleri kancalanmış ile `RegisterAsyncTask` hemen sonra çalışır [PreRender](https://msdn.microsoft.com/en-us/library/ms178472.aspx).</span><span class="sxs-lookup"><span data-stu-id="3c330-231">Methods hooked up with `RegisterAsyncTask` will run immediately after [PreRender](https://msdn.microsoft.com/en-us/library/ms178472.aspx).</span></span> <span data-ttu-id="3c330-232">Zaman uyumsuz void Sayfa olaylarının, doğrudan aşağıdaki kodda gösterildiği gibi kullanabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="3c330-232">You can also use async void page events directly, as shown in the following code:</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample8.cs)]

<span data-ttu-id="3c330-233">Zaman uyumsuz void olayları dezavantajı geliştiriciler artık olayları yürütülürken üzerinde tam denetim olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="3c330-233">The downside to async void events is that developers no longer has full control over when events execute.</span></span> <span data-ttu-id="3c330-234">Örneğin, her iki .aspx varsa ve bir. Ana tanımlamak `Page_Load` olayları ve biri veya her ikisi de zaman uyumsuz, yürütme sırasını garanti edilemez.</span><span class="sxs-lookup"><span data-stu-id="3c330-234">For example, if both an .aspx and a .Master define `Page_Load` events and one or both of them are asynchronous, the order of execution can't be guaranteed.</span></span> <span data-ttu-id="3c330-235">Aynı indeterminiate sipariş olmayan olay işleyicileri için (gibi `async void Button_Click` ) uygulanır.</span><span class="sxs-lookup"><span data-stu-id="3c330-235">The same indeterminiate order for non event handlers (such as `async void Button_Click` ) applies.</span></span> <span data-ttu-id="3c330-236">Çoğu geliştiriciler için bu kabul edilebilir olmalıdır, ancak yürütme sırasını üzerinde tam denetim gerektirir olanlar gibi API'leri yalnızca kullanmanız gerekir `RegisterAsyncTask` bir görev nesnesi döndürmesi yöntemleri kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-236">For most developers this should be acceptable, but those who require full control over the order of execution should only use APIs like `RegisterAsyncTask` that consume methods which return a Task object.</span></span>

## <a id="Parallel"></a><span data-ttu-id="3c330-237">Paralel olarak birden çok işlemlerini gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="3c330-237">Performing Multiple Operations in Parallel</span></span>

<span data-ttu-id="3c330-238">Bir eylem birkaç bağımsız işlemler gerçekleştirdiğinizde gerekir zaman uyumsuz yöntemleri zaman uyumlu yöntemleri önemli bir avantajı vardır.</span><span class="sxs-lookup"><span data-stu-id="3c330-238">Asynchronous Methods have a significant advantage over synchronous methods when an action must perform several independent operations.</span></span> <span data-ttu-id="3c330-239">Sağlanan örnek zaman uyumlu sayfa *PWG.aspx*(ürünleri, pencere öğeleri ve en) ürünleri, pencere öğeleri ve en listesini almak için üç web hizmeti çağrıları sonuçlarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="3c330-239">In the sample provided, the synchronous page *PWG.aspx*(for Products, Widgets and Gizmos) displays the results of three web service calls to get a list of products, widgets, and gizmos.</span></span> <span data-ttu-id="3c330-240">[ASP.NET Web API](../../../web-api/index.md) bu sağlar proje hizmetleri kullanan [Task.Delay](https://msdn.microsoft.com/en-us/library/hh139096(VS.110).aspx) gecikme veya yavaş ağ benzetimi için çağırır.</span><span class="sxs-lookup"><span data-stu-id="3c330-240">The [ASP.NET Web API](../../../web-api/index.md) project that provides these services uses [Task.Delay](https://msdn.microsoft.com/en-us/library/hh139096(VS.110).aspx) to simulate latency or slow network calls.</span></span> <span data-ttu-id="3c330-241">Gecikme 500 milisaniye, zaman uyumsuz ayarlandığında *PWGasync.aspx* sayfa geçen zaman uyumlu sırasında tamamlanması biraz 500 milisaniye `PWG` sürüm 1500 milisaniye alır.</span><span class="sxs-lookup"><span data-stu-id="3c330-241">When the delay is set to 500 milliseconds, the asynchronous *PWGasync.aspx* page takes a little over 500 milliseconds to complete while the synchronous `PWG` version takes over 1,500 milliseconds.</span></span> <span data-ttu-id="3c330-242">Zaman uyumlu *PWG.aspx* sayfasında, aşağıdaki kodda gösterilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-242">The synchronous *PWG.aspx* page is shown in the following code.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample9.cs)]

<span data-ttu-id="3c330-243">Zaman uyumsuz `PWGasync` arka plan kod aşağıda gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="3c330-243">The asynchronous `PWGasync` code behind is shown below.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample10.cs?highlight=5,11,21)]

<span data-ttu-id="3c330-244">Aşağıdaki resimde zaman uyumsuz döndürülen görüntüler *PWGasync.aspx* sayfası.</span><span class="sxs-lookup"><span data-stu-id="3c330-244">The following image shows the view returned from the asynchronous *PWGasync.aspx* page.</span></span>

![](using-asynchronous-methods-in-aspnet-45/_static/image3.png)

## <a id="CancelToken"></a><span data-ttu-id="3c330-245">Bir iptal belirteci kullanma</span><span class="sxs-lookup"><span data-stu-id="3c330-245">Using a Cancellation Token</span></span>

<span data-ttu-id="3c330-246">Döndüren zaman uyumsuz yöntemleri `Task`aldıkları olduğundan iptal edilebilen, olan bir [CancellationToken](https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(VS.110).aspx) ile sağlandığında parametresi `AsyncTimeout` özniteliği [sayfa](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) yönergesi.</span><span class="sxs-lookup"><span data-stu-id="3c330-246">Asynchronous Methods returning `Task`are cancelable, that is they take a [CancellationToken](https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(VS.110).aspx) parameter when one is provided with the `AsyncTimeout` attribute of the [Page](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) directive.</span></span> <span data-ttu-id="3c330-247">Aşağıdaki kodda gösterildiği *GizmosCancelAsync.aspx* bir zaman aşımı süresi ikinci üzerinde sayfası.</span><span class="sxs-lookup"><span data-stu-id="3c330-247">The following code shows the *GizmosCancelAsync.aspx* page with a timeout of on second.</span></span>

[!code-aspx[Main](using-asynchronous-methods-in-aspnet-45/samples/sample11.aspx?highlight=1)]

<span data-ttu-id="3c330-248">Aşağıdaki kodda gösterildiği *GizmosCancelAsync.aspx.cs* dosya.</span><span class="sxs-lookup"><span data-stu-id="3c330-248">The following code shows the *GizmosCancelAsync.aspx.cs* file.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-45/samples/sample12.cs?highlight=6,9)]

<span data-ttu-id="3c330-249">Sağlanan örnek uygulama seçme *GizmosCancelAsync* bağlama çağrıları *GizmosCancelAsync.aspx* sayfasında ve zaman uyumsuz çağrı iptal edilmesine (tarafından zaman aşımına uğramadan) gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c330-249">In the sample application provided, selecting the *GizmosCancelAsync* link calls the *GizmosCancelAsync.aspx* page and demonstrates the cancelation (by timing out) of the asynchronous call.</span></span> <span data-ttu-id="3c330-250">Gecikme süresi rastgele bir aralık içinde olduğundan, zaman aşımı hata iletisini almak için birkaç kez sayfayı yenilemeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-250">Because the delay time is within a random range, you might need to refresh the page a couple times to get the time out error message.</span></span>

## <a id="ServerConfig"></a><span data-ttu-id="3c330-251">Yüksek eşzamanlılık/yüksek gecikme Web hizmeti çağrıları için sunucu yapılandırması</span><span class="sxs-lookup"><span data-stu-id="3c330-251">Server Configuration for High Concurrency/High Latency Web Service Calls</span></span>

<span data-ttu-id="3c330-252">Bir zaman uyumsuz web uygulaması faydaları hayata geçirmek için varsayılan sunucu yapılandırma bazı değişiklikler yapmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="3c330-252">To realize the benefits of an asynchronous web application, you might need to make some changes to the default server configuration.</span></span> <span data-ttu-id="3c330-253">Aşağıdaki yapılandırırken unutmayın ve zaman uyumsuz web uygulamanızı test etme stres tutun.</span><span class="sxs-lookup"><span data-stu-id="3c330-253">Keep the following in mind when configuring and stress testing your asynchronous web application.</span></span>

- <span data-ttu-id="3c330-254">Windows 7, Windows Vista, Windows 8 ve tüm Windows istemci işletim sistemleri en fazla 10 eşzamanlı istek var.</span><span class="sxs-lookup"><span data-stu-id="3c330-254">Windows 7, Windows Vista, Window 8, and all Windows client operating systems have a maximum of 10 concurrent requests.</span></span> <span data-ttu-id="3c330-255">Zaman uyumsuz yöntemleri yüksek yük altında faydalarını görmek için bir Windows Server işletim sistemi gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c330-255">You'll need a Windows Server operating system to see the benefits of asynchronous methods under high load.</span></span>
- <span data-ttu-id="3c330-256">.NET 4.5 aşağıdaki komutu kullanarak yükseltilmiş komut isteminden IIS'ye kaydedin:</span><span class="sxs-lookup"><span data-stu-id="3c330-256">Register .NET 4.5 with IIS from an elevated command prompt using the following command:</span></span>  
 <span data-ttu-id="3c330-257">%windir%\Microsoft.NET\Framework64 \v4.0.30319\aspnet\_regiis -i</span><span class="sxs-lookup"><span data-stu-id="3c330-257">%windir%\Microsoft.NET\Framework64 \v4.0.30319\aspnet\_regiis -i</span></span>  
 <span data-ttu-id="3c330-258">Bkz: [ASP.NET IIS Kayıt Aracı (Aspnet\_regiis.exe)](https://msdn.microsoft.com/en-us/library/k6h9cz8h.aspx)</span><span class="sxs-lookup"><span data-stu-id="3c330-258">See    [ASP.NET IIS Registration Tool (Aspnet\_regiis.exe)](https://msdn.microsoft.com/en-us/library/k6h9cz8h.aspx)</span></span>
- <span data-ttu-id="3c330-259">Artırmanız gerekebilir [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) 1.000 ile 5.000 varsayılan değerinden kuyruk sınırı.</span><span class="sxs-lookup"><span data-stu-id="3c330-259">You might need to increase the [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) queue limit from the default value of 1,000 to 5,000.</span></span> <span data-ttu-id="3c330-260">Ayar çok düşük ise görebileceğiniz [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) HTTP 503 durumu olan istekleri reddedecek.</span><span class="sxs-lookup"><span data-stu-id="3c330-260">If the setting is too low, you may see [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) reject requests with a HTTP 503 status.</span></span> <span data-ttu-id="3c330-261">HTTP.sys kuyruk sınırı değiştirmek için:</span><span class="sxs-lookup"><span data-stu-id="3c330-261">To change the HTTP.sys queue limit:</span></span>

    - <span data-ttu-id="3c330-262">IIS Yöneticisi'ni açın ve uygulama havuzları bölmesine gidin.</span><span class="sxs-lookup"><span data-stu-id="3c330-262">Open IIS manager and navigate to the Application Pools pane.</span></span>
    - <span data-ttu-id="3c330-263">Hedef uygulama havuzunda sağ tıklayın ve **Gelişmiş ayarları**.</span><span class="sxs-lookup"><span data-stu-id="3c330-263">Right click on the target application pool and select **Advanced Settings**.</span></span>  
        <span data-ttu-id="3c330-264">![Gelişmiş](using-asynchronous-methods-in-aspnet-45/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3c330-264">![advanced](using-asynchronous-methods-in-aspnet-45/_static/image4.png)</span></span>
    - <span data-ttu-id="3c330-265">İçinde **Gelişmiş ayarları** iletişim kutusu, değişiklik *sırası uzunluğu* 5.000 için 1000'den.</span><span class="sxs-lookup"><span data-stu-id="3c330-265">In the **Advanced Settings** dialog box, change *Queue Length* from 1,000 to 5,000.</span></span>  
        <span data-ttu-id="3c330-266">![Sırası uzunluğu](using-asynchronous-methods-in-aspnet-45/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="3c330-266">![Queue length](using-asynchronous-methods-in-aspnet-45/_static/image5.png)</span></span>  
  
 <span data-ttu-id="3c330-267">Not Yukarıdaki görüntüleri uygulama havuzu .NET 4.5 kullanıyor olsa da, .NET framework v4.0 listelenir.</span><span class="sxs-lookup"><span data-stu-id="3c330-267">Note in the images above, the .NET framework is listed as v4.0, even though the application pool is using .NET 4.5.</span></span> <span data-ttu-id="3c330-268">Bu uyuşmazlık anlamak için aşağıdakilere bakın:</span><span class="sxs-lookup"><span data-stu-id="3c330-268">To understand this discrepancy, see the following:</span></span>

        - [.NET Versioning and Multi-Targeting - .NET 4.5 is an in-place upgrade to .NET 4.0](http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx)
        - [How to set an IIS Application or AppPool to use ASP.NET 3.5 rather than 2.0](http://www.hanselman.com/blog/HowToSetAnIISApplicationOrAppPoolToUseASPNET35RatherThan20.aspx)
        - [.NET Framework Versions and Dependencies](https://msdn.microsoft.com/en-us/library/bb822049(VS.110).aspx)
- <span data-ttu-id="3c330-269">Uygulamanızın web hizmetlerini kullanarak veya HTTP üzerinden arka ucuyla iletişim System.NET artırmak gerekebilir [connectionManagement/maxconnection](https://msdn.microsoft.com/en-us/library/fb6y0fyc(VS.110).aspx) öğesi.</span><span class="sxs-lookup"><span data-stu-id="3c330-269">If your application is using web services or System.NET to communicate with a backend over HTTP you may need to increase the [connectionManagement/maxconnection](https://msdn.microsoft.com/en-us/library/fb6y0fyc(VS.110).aspx) element.</span></span> <span data-ttu-id="3c330-270">ASP.NET uygulamaları için bu CPU sayısı 12 kat otomatik yapılandırma özelliği sınırlıdır.</span><span class="sxs-lookup"><span data-stu-id="3c330-270">For ASP.NET applications, this is limited by the autoConfig feature to 12 times the number of CPUs.</span></span> <span data-ttu-id="3c330-271">Bir dört proc üzerinde en fazla 12 olabileceği anlamına \* 4 = 48 IP uç noktası için eş zamanlı bağlantı.</span><span class="sxs-lookup"><span data-stu-id="3c330-271">That means that on a quad-proc, you can have at most 12 \* 4 = 48 concurrent connections to an IP end point.</span></span> <span data-ttu-id="3c330-272">Bu bağlıdır çünkü [autoConfig](https://msdn.microsoft.com/en-us/library/7w2sway1(VS.110).aspx), artırmak için en kolay yolu `maxconnection` bir ASP.NET uygulaması ayarlamaktır [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programlı olarak gelen `Application_Start` yönteminde *global.asax* dosya.</span><span class="sxs-lookup"><span data-stu-id="3c330-272">Because this is tied to [autoConfig](https://msdn.microsoft.com/en-us/library/7w2sway1(VS.110).aspx), the easiest way to increase `maxconnection` in an ASP.NET application is to set [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programmatically in the from `Application_Start` method in the *global.asax* file.</span></span> <span data-ttu-id="3c330-273">Bir örnek için karşıdan örneğine bakın.</span><span class="sxs-lookup"><span data-stu-id="3c330-273">See the sample download for an example.</span></span>
- <span data-ttu-id="3c330-274">.NET 4.5, 5000 için varsayılan olarak [MaxConcurrentRequestsPerCPU](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) ince olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="3c330-274">In .NET 4.5, the default of 5000 for [MaxConcurrentRequestsPerCPU](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) should be fine.</span></span>

## <a name="contributors"></a><span data-ttu-id="3c330-275">Katkıda Bulunanlar</span><span class="sxs-lookup"><span data-stu-id="3c330-275">Contributors</span></span>

- [<span data-ttu-id="3c330-276">Levi Broderick</span><span class="sxs-lookup"><span data-stu-id="3c330-276">Levi Broderick</span></span>](http://stackoverflow.com/users/59641/levi)
- [<span data-ttu-id="3c330-277">Zel Dykstra</span><span class="sxs-lookup"><span data-stu-id="3c330-277">Tom Dykstra</span></span>](http://www.bing.com/search?q=site%3Aasp.net+%22Tom+Dykstra%22+-forums.asp.net&amp;qs=n&amp;form=QBRE&amp;pq=site%3Aasp.net+%22tom+dykstra%22+-forums.asp.net&amp;sc=8-42&amp;sp=-1&amp;sk=)
- [<span data-ttu-id="3c330-278">Brad Wilson</span><span class="sxs-lookup"><span data-stu-id="3c330-278">Brad Wilson</span></span>](http://bradwilson.typepad.com/)
- [<span data-ttu-id="3c330-279">HongMei Ge</span><span class="sxs-lookup"><span data-stu-id="3c330-279">HongMei Ge</span></span>](https://blogs.msdn.com/b/hongmeig/)
