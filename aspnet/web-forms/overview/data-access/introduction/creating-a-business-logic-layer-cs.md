---
uid: web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
title: "Bir iş mantığı katmanı (C#) oluşturma | Microsoft Docs"
author: rick-anderson
description: "Bu öğreticide, iş kurallarını içine bir iş mantığı katmanı (t arasında veri alışverişi için bir aracı görevi gören BLL) merkezileştirmek nasıl göreceğiz..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 85554606-47cb-4e4f-9848-eed9da579056
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: 7518ddd11a05a9e3d5df85e3cf6ceffa09a25060
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="creating-a-business-logic-layer-c"></a><span data-ttu-id="ff294-103">Bir iş mantığı katmanı (C#) oluşturma</span><span class="sxs-lookup"><span data-stu-id="ff294-103">Creating a Business Logic Layer (C#)</span></span>
====================
<span data-ttu-id="ff294-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ff294-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ff294-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) veya [PDF indirin](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ff294-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) or [Download PDF](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span></span>

> <span data-ttu-id="ff294-106">Bu öğreticide, iş kurallarını içine bir iş mantığı katmanı (sunu katmanı ve DAL arasında veri alışverişi için bir aracı görevi gören BLL) merkezileştirmek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="ff294-106">In this tutorial we'll see how to centralize your business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span>


## <a name="introduction"></a><span data-ttu-id="ff294-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="ff294-107">Introduction</span></span>

<span data-ttu-id="ff294-108">Veri erişim düzeyi (DAL) oluşturulan [ilk öğreticide](creating-a-data-access-layer-cs.md) düzgün bir şekilde ayırır veri sunu mantığından mantığı erişim.</span><span class="sxs-lookup"><span data-stu-id="ff294-108">The Data Access Layer (DAL) created in the [first tutorial](creating-a-data-access-layer-cs.md) cleanly separates the data access logic from the presentation logic.</span></span> <span data-ttu-id="ff294-109">Ancak, DAL, veri erişim ayrıntıları düzgün bir şekilde sunu katmanı ayırır. olsa da, uygulanabilir tüm iş kuralları uygulamaz.</span><span class="sxs-lookup"><span data-stu-id="ff294-109">However, while the DAL cleanly separates the data access details from the presentation layer, it does not enforce any business rules that may apply.</span></span> <span data-ttu-id="ff294-110">Örneğin, uygulamamız için size izin vermeyecek şekilde isteyebilir `CategoryID` veya `SupplierID` alanlarının `Products` ne zaman değiştirilecek tabloyu `Discontinued` alan 1 olarak ayarlayın veya Kıdem kurallarını zorunlu tutmak hangi durumlarda yasaklanması istiyoruz bir çalışan, bunlardan sonra işe biri tarafından yönetilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-110">For example, for our application we may want to disallow the `CategoryID` or `SupplierID` fields of the `Products` table to be modified when the `Discontinued` field is set to 1, or we might want to enforce seniority rules, prohibiting situations in which an employee is managed by someone who was hired after them.</span></span> <span data-ttu-id="ff294-111">Başka bir yaygın Yetkilendirme belki de yalnızca kullanıcıların belirli bir rol olarak ürünleri silebilir veya değiştirebilirsiniz senaryodur `UnitPrice` değeri.</span><span class="sxs-lookup"><span data-stu-id="ff294-111">Another common scenario is authorization perhaps only users in a particular role can delete products or can change the `UnitPrice` value.</span></span>

<span data-ttu-id="ff294-112">Bu öğreticide içine bir iş mantığı katmanı (sunu katmanı ve DAL arasında veri alışverişi için bir aracı görevi gören BLL) bu iş kuralları merkezileştirmek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="ff294-112">In this tutorial we'll see how to centralize these business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span> <span data-ttu-id="ff294-113">Gerçek dünya uygulamada BLL ayrı bir sınıf kitaplığı proje uygulanması gerekir; Ancak, bu öğreticileri için biz BLL sınıflarında serisi olarak uygulamak bizim `App_Code` proje yapısını basitleştirmek için klasör.</span><span class="sxs-lookup"><span data-stu-id="ff294-113">In a real-world application, the BLL should be implemented as a separate Class Library project; however, for these tutorials we'll implement the BLL as a series of classes in our `App_Code` folder in order to simplify the project structure.</span></span> <span data-ttu-id="ff294-114">Şekil 1 sunu katmanı, BLL ve DAL arasındaki mimari ilişkiler gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="ff294-114">Figure 1 illustrates the architectural relationships among the presentation layer, BLL, and DAL.</span></span>


![BLL veri erişim katmanı sunu katmanı ayırır ve iş kuralları uygular](creating-a-business-logic-layer-cs/_static/image1.png)

<span data-ttu-id="ff294-116">**Şekil 1**: BLL sunu katmanı veri erişim katmanı ayırır ve iş kuralları uygular</span><span class="sxs-lookup"><span data-stu-id="ff294-116">**Figure 1**: The BLL Separates the Presentation Layer from the Data Access Layer and Imposes Business Rules</span></span>


## <a name="step-1-creating-the-bll-classes"></a><span data-ttu-id="ff294-117">1. adım: BLL sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="ff294-117">Step 1: Creating the BLL Classes</span></span>

<span data-ttu-id="ff294-118">Bizim BLL oluşan her TableAdapter içinde DAL için dört sınıfları; Bu BLL sınıfların her biri, alma, ekleme, güncelleştirme ve ilgili TableAdapter uygun iş kuralları uygulama DAL içinde silmeye yöntemleri sahip olur.</span><span class="sxs-lookup"><span data-stu-id="ff294-118">Our BLL will be composed of four classes, one for each TableAdapter in the DAL; each of these BLL classes will have methods for retrieving, inserting, updating, and deleting from the respective TableAdapter in the DAL, applying the appropriate business rules.</span></span>

<span data-ttu-id="ff294-119">Daha fazla düzgün bir şekilde için DAL ve BLL ilgili sınıflarını ayırmak, iki alt klasör oluşturalım `App_Code` klasörünü `DAL` ve `BLL`.</span><span class="sxs-lookup"><span data-stu-id="ff294-119">To more cleanly separate the DAL- and BLL-related classes, let's create two subfolders in the `App_Code` folder, `DAL` and `BLL`.</span></span> <span data-ttu-id="ff294-120">Yalnızca sağ `App_Code` Çözüm Gezgininde klasör ve yeni bir klasör seçin.</span><span class="sxs-lookup"><span data-stu-id="ff294-120">Simply right-click on the `App_Code` folder in the Solution Explorer and choose New Folder.</span></span> <span data-ttu-id="ff294-121">Bu iki klasör oluşturduktan sonra yazılan ilk öğreticide oluşturulan DataSet taşıma `DAL` alt klasörü.</span><span class="sxs-lookup"><span data-stu-id="ff294-121">After creating these two folders, move the Typed DataSet created in the first tutorial into the `DAL` subfolder.</span></span>

<span data-ttu-id="ff294-122">Ardından, dört BLL sınıfı dosyalarında oluşturun `BLL` alt klasörü.</span><span class="sxs-lookup"><span data-stu-id="ff294-122">Next, create the four BLL class files in the `BLL` subfolder.</span></span> <span data-ttu-id="ff294-123">Bunu başarmak için sağ `BLL` alt, yeni öğe Ekle'yi seçin ve sınıf şablonu seçin.</span><span class="sxs-lookup"><span data-stu-id="ff294-123">To accomplish this, right-click on the `BLL` subfolder, choose Add a New Item, and choose the Class template.</span></span> <span data-ttu-id="ff294-124">Dört sınıf adı `ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`, ve `EmployeesBLL`.</span><span class="sxs-lookup"><span data-stu-id="ff294-124">Name the four classes `ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`, and `EmployeesBLL`.</span></span>


![Dört yeni sınıf App_Code klasörüne eklemek](creating-a-business-logic-layer-cs/_static/image2.png)

<span data-ttu-id="ff294-126">**Şekil 2**: için dört yeni sınıflar ekleyebilirsiniz `App_Code` klasörü</span><span class="sxs-lookup"><span data-stu-id="ff294-126">**Figure 2**: Add Four New Classes to the `App_Code` Folder</span></span>


<span data-ttu-id="ff294-127">Ardından, yalnızca ilk öğreticiden TableAdapters için tanımlanan yöntemler sarmalamak için sınıfların her biri için yöntemleri ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="ff294-127">Next, let's add methods to each of the classes to simply wrap the methods defined for the TableAdapters from the first tutorial.</span></span> <span data-ttu-id="ff294-128">Şimdilik, bu yöntemleri yalnızca doğrudan DAL çağıracak; gerekli iş mantığı eklemek için sonraki getireceğiz.</span><span class="sxs-lookup"><span data-stu-id="ff294-128">For now, these methods will just call directly into the DAL; we'll return later to add any needed business logic.</span></span>

> [!NOTE]
> <span data-ttu-id="ff294-129">Visual Studio Standard Edition kullanıyorsanız veya üstü (diğer bir deyişle, olduğunuz *değil* Visual Web Developer kullanarak), isteğe bağlı olarak görsel olarak kullanarak sınıflarınızı tasarlayabilirsiniz [Sınıf Tasarımcısı](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp).</span><span class="sxs-lookup"><span data-stu-id="ff294-129">If you are using Visual Studio Standard Edition or above (that is, you're *not* using Visual Web Developer), you can optionally design your classes visually using the [Class Designer](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp).</span></span> <span data-ttu-id="ff294-130">Başvurmak [Sınıf Tasarımcısı Blog](https://blogs.msdn.com/classdesigner/default.aspx) Visual Studio'da bu yeni özellik hakkında daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="ff294-130">Refer to the [Class Designer Blog](https://blogs.msdn.com/classdesigner/default.aspx) for more information on this new feature in Visual Studio.</span></span>


<span data-ttu-id="ff294-131">İçin `ProductsBLL` sınıfı ihtiyacımız yedi yöntemleri toplam eklemek için:</span><span class="sxs-lookup"><span data-stu-id="ff294-131">For the `ProductsBLL` class we need to add a total of seven methods:</span></span>

- <span data-ttu-id="ff294-132">`GetProducts()`tüm ürünleri verir</span><span class="sxs-lookup"><span data-stu-id="ff294-132">`GetProducts()` returns all products</span></span>
- <span data-ttu-id="ff294-133">`GetProductByProductID(productID)`Belirtilen ürün kimlikli ürün döndürür</span><span class="sxs-lookup"><span data-stu-id="ff294-133">`GetProductByProductID(productID)` returns the product with the specified product ID</span></span>
- <span data-ttu-id="ff294-134">`GetProductsByCategoryID(categoryID)`Belirtilen kategorideki tüm ürünleri verir</span><span class="sxs-lookup"><span data-stu-id="ff294-134">`GetProductsByCategoryID(categoryID)` returns all products from the specified category</span></span>
- <span data-ttu-id="ff294-135">`GetProductsBySupplier(supplierID)`tüm ürünleri listesinden belirtilen tedarikçi döndürür</span><span class="sxs-lookup"><span data-stu-id="ff294-135">`GetProductsBySupplier(supplierID)` returns all products from the specified supplier</span></span>
- <span data-ttu-id="ff294-136">`AddProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued)`Yeni bir ürün değerleri kullanarak veritabanına ekler geçilen; döndürür `ProductID` yeni eklenen kaydın değeri</span><span class="sxs-lookup"><span data-stu-id="ff294-136">`AddProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued)` inserts a new product into the database using the values passed-in; returns the `ProductID` value of the newly inserted record</span></span>
- <span data-ttu-id="ff294-137">`UpdateProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued, productID)`geçirilen değerlerini kullanarak veritabanında varolan bir ürün güncelleştirmeleri; döndürür `true` tam olarak bir satır güncelleştirildiyse, `false` Aksi takdirde</span><span class="sxs-lookup"><span data-stu-id="ff294-137">`UpdateProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued, productID)` updates an existing product in the database using the passed-in values; returns `true` if precisely one row was updated, `false` otherwise</span></span>
- <span data-ttu-id="ff294-138">`DeleteProduct(productID)`Belirtilen ürün veritabanından siler</span><span class="sxs-lookup"><span data-stu-id="ff294-138">`DeleteProduct(productID)` deletes the specified product from the database</span></span>

<span data-ttu-id="ff294-139">ProductsBLL.cs</span><span class="sxs-lookup"><span data-stu-id="ff294-139">ProductsBLL.cs</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample1.cs)]

<span data-ttu-id="ff294-140">Yalnızca veri döndüren yöntemler `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`, ve `GetProductBySuppliersID` bunlar yalnızca DAL çağrı gibi oldukça basittir.</span><span class="sxs-lookup"><span data-stu-id="ff294-140">The methods that simply return data `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`, and `GetProductBySuppliersID` are fairly straightforward as they simply call down into the DAL.</span></span> <span data-ttu-id="ff294-141">Bazı senaryolarda olsa da uygulanması gereken iş kurallarını bu düzeyde (örneğin, yetkilendirme kuralları) şu anda oturum açmış kullanıcı veya kullanıcının ait olduğu rol göre yalnızca bu yöntemleri olarak bırakacağız-değil.</span><span class="sxs-lookup"><span data-stu-id="ff294-141">While in some scenarios there may be business rules that need to be implemented at this level (such as authorization rules based on the currently logged on user or the role to which the user belongs), we'll simply leave these methods as-is.</span></span> <span data-ttu-id="ff294-142">Bu yöntemler, daha sonra BLL yalnızca ve sunu katmanı temel alınan veriler veri erişim katmanı erişen bir proxy görevi görür.</span><span class="sxs-lookup"><span data-stu-id="ff294-142">For these methods, then, the BLL serves merely as a proxy through which the presentation layer accesses the underlying data from the Data Access Layer.</span></span>

<span data-ttu-id="ff294-143">`AddProduct` Ve `UpdateProduct` yöntemleri hem parametre olarak çeşitli ürün alanlarına ait değerlerin olur ve yeni bir ürün ekleyin veya mevcut bir sırasıyla güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="ff294-143">The `AddProduct` and `UpdateProduct` methods both take in as parameters the values for the various product fields and add a new product or update an existing one, respectively.</span></span> <span data-ttu-id="ff294-144">Birçok itibaren `Product` tablo sütunlarından kabul edebilir `NULL` değerleri (`CategoryID`, `SupplierID`, ve `UnitPrice`, birkaçıdır), bu giriş parametreleri için `AddProduct` ve `UpdateProduct` böyle bir sütun kullanımı eşlenen[boş değer atanabilir türler](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="ff294-144">Since many of the `Product` table's columns can accept `NULL` values (`CategoryID`, `SupplierID`, and `UnitPrice`, to name a few), those input parameters for `AddProduct` and `UpdateProduct` that map to such columns use [nullable types](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx).</span></span> <span data-ttu-id="ff294-145">Boş değer atanabilir türler .NET 2.0 için yenidir ve bir değer türü, bunun yerine, gerekip gerekmediğini belirten olması için bir yöntem sağlayan `null`.</span><span class="sxs-lookup"><span data-stu-id="ff294-145">Nullable types are new to .NET 2.0 and provide a technique for indicating whether a value type should, instead, be `null`.</span></span> <span data-ttu-id="ff294-146">C# ' ta, bir değer türü null olabilir bir tür ekleyerek işaretleyebilirsiniz `?` türü sonra (gibi `int? x;`).</span><span class="sxs-lookup"><span data-stu-id="ff294-146">In C# you can flag a value type as a nullable type by adding `?` after the type (like `int? x;`).</span></span> <span data-ttu-id="ff294-147">Başvurmak [boş değer atanabilir türler](https://msdn.microsoft.com/library/1t3y8s4s.aspx) bölümüne [C# programlama kılavuzu](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="ff294-147">Refer to the [Nullable Types](https://msdn.microsoft.com/library/1t3y8s4s.aspx) section in the [C# Programming Guide](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) for more information.</span></span>

<span data-ttu-id="ff294-148">Üçünü bir satır eklenir, güncelleştirilmiş veya işlemi etkilenen bir satırda sağlamayabilir bu yana silinmiş olup olmadığını gösteren bir Boole değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="ff294-148">All three methods return a Boolean value indicating whether a row was inserted, updated, or deleted since the operation may not result in an affected row.</span></span> <span data-ttu-id="ff294-149">Örneğin, sayfa Geliştirici çağırırsa `DeleteProduct` tümleştirilmesidir bir `ProductID` mevcut olmayan ürününün `DELETE` veritabanına verilen deyimi herhangi bir etkisi olacaktır ve bu nedenle `DeleteProduct` yöntemi döndürür `false`.</span><span class="sxs-lookup"><span data-stu-id="ff294-149">For example, if the page developer calls `DeleteProduct` passing in a `ProductID` for a non-existent product, the `DELETE` statement issued to the database will have no affect and therefore the `DeleteProduct` method will return `false`.</span></span>

<span data-ttu-id="ff294-150">Yeni bir ürün eklerken dikkat edin veya var olan bir güncelleştirme Biz yeni veya değiştirilmiş ürünün alan değerlerini kabul aksine skalerler listesi olarak ele bir `ProductsRow` örneği.</span><span class="sxs-lookup"><span data-stu-id="ff294-150">Note that when adding a new product or updating an existing one we take in the new or modified product's field values as a list of scalars as opposed to accepting a `ProductsRow` instance.</span></span> <span data-ttu-id="ff294-151">Bu yaklaşım seçildi, çünkü `ProductsRow` sınıfı ADO.NET türer `DataRow` varsayılan parametresiz bir kurucusu yok sınıfı.</span><span class="sxs-lookup"><span data-stu-id="ff294-151">This approach was chosen because the `ProductsRow` class derives from the ADO.NET `DataRow` class, which doesn't have a default parameterless constructor.</span></span> <span data-ttu-id="ff294-152">Yeni bir oluşturmak için `ProductsRow` örneği, biz önce oluşturmanız gerekir bir `ProductsDataTable` örneği ve ardından çağırma kendi `NewProductRow()` yöntemi (hangi bunu yapmadan `AddProduct`).</span><span class="sxs-lookup"><span data-stu-id="ff294-152">In order to create a new `ProductsRow` instance, we must first create a `ProductsDataTable` instance and then invoke its `NewProductRow()` method (which we do in `AddProduct`).</span></span> <span data-ttu-id="ff294-153">Biz ekleme ve ObjectDataSource kullanarak ürünleri güncelleştirmek için etkinleştirdiğinizde bu eksiklikleri kendi head rears.</span><span class="sxs-lookup"><span data-stu-id="ff294-153">This shortcoming rears its head when we turn to inserting and updating products using the ObjectDataSource.</span></span> <span data-ttu-id="ff294-154">Kısacası, ObjectDataSource giriş parametreleri örneği oluşturmak çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="ff294-154">In short, the ObjectDataSource will try to create an instance of the input parameters.</span></span> <span data-ttu-id="ff294-155">BLL yöntemi görüyorsa bir `ProductsRow` örneği ObjectDataSource oluşturun, ancak varsayılan parametresiz bir kurucusu eksikliği nedeniyle başarısız çalışır.</span><span class="sxs-lookup"><span data-stu-id="ff294-155">If the BLL method expects a `ProductsRow` instance, the ObjectDataSource will try to create one, but fail due to the lack of a default parameterless constructor.</span></span> <span data-ttu-id="ff294-156">Bu sorunla ilgili daha fazla bilgi için aşağıdaki iki ASP.NET forumları gönderileri bakın: [güncelleştirme ObjectDataSources Strongly-Typed veri kümeleriyle](https://forums.asp.net/1098630/ShowPost.aspx), ve [sorunu ile ObjectDataSource ve Strongly-Typed DataSet](https://forums.asp.net/1048212/ShowPost.aspx).</span><span class="sxs-lookup"><span data-stu-id="ff294-156">For more information on this problem, refer to the following two ASP.NET Forums posts: [Updating ObjectDataSources with Strongly-Typed DataSets](https://forums.asp.net/1098630/ShowPost.aspx), and [Problem With ObjectDataSource and Strongly-Typed DataSet](https://forums.asp.net/1048212/ShowPost.aspx).</span></span>

<span data-ttu-id="ff294-157">Hem de sonraki `AddProduct` ve `UpdateProduct`, kod oluşturur bir `ProductsRow` örneği ve yalnızca geçirilen değerlerle doldurur.</span><span class="sxs-lookup"><span data-stu-id="ff294-157">Next, in both `AddProduct` and `UpdateProduct`, the code creates a `ProductsRow` instance and populates it with the values just passed in.</span></span> <span data-ttu-id="ff294-158">DataRow DataColumn nesneleri için değerler atama çeşitli alan düzeyindeki doğrulama denetimlerini ortaya çıkabilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-158">When assigning values to DataColumns of a DataRow various field-level validation checks can occur.</span></span> <span data-ttu-id="ff294-159">Bu nedenle, el ile geçirilen değerlerin bir DataRow satırının koyma BLL yönteme geçirilen verileri geçerliliğini sağlamaya yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="ff294-159">Therefore, manually putting the passed in values back into a DataRow helps ensure the validity of the data being passed to the BLL method.</span></span> <span data-ttu-id="ff294-160">Ne yazık ki kesin türü belirtilmiş DataRow Visual Studio tarafından oluşturulan sınıflar boş değer atanabilir türler kullanmayın.</span><span class="sxs-lookup"><span data-stu-id="ff294-160">Unfortunately the strongly-typed DataRow classes generated by Visual Studio do not use nullable types.</span></span> <span data-ttu-id="ff294-161">Bunun yerine, bir DataRow satırının belirli bir DataColumn karşılık belirtmek için bir `NULL` veritabanı gerekir kullanırız değeri `SetColumnNameNull()` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="ff294-161">Rather, to indicate that a particular DataColumn in a DataRow should correspond to a `NULL` database value we must use the `SetColumnNameNull()` method.</span></span>

<span data-ttu-id="ff294-162">İçinde `UpdateProduct` biz öncelikle kullanarak güncelleştirmek için ürün yük `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="ff294-162">In `UpdateProduct` we first load in the product to update using `GetProductByProductID(productID)`.</span></span> <span data-ttu-id="ff294-163">Bu veritabanı için gereksiz bir seyahat gibi görünebilir, ancak bu ek seyahat iyimser eşzamanlılık keşfedin gelecekteki eğitimlerine faydalı kanıtlamak.</span><span class="sxs-lookup"><span data-stu-id="ff294-163">While this may seem like an unnecessary trip to the database, this extra trip will prove worthwhile in future tutorials that explore optimistic concurrency.</span></span> <span data-ttu-id="ff294-164">İyimser eşzamanlılık, aynı verileri aynı anda çalışan iki kullanıcılar, başka birinin değişiklikleri yanlışlıkla üzerine yazmayın sağlamak için kullanılan bir tekniktir.</span><span class="sxs-lookup"><span data-stu-id="ff294-164">Optimistic concurrency is a technique to ensure that two users who are simultaneously working on the same data don't accidentally overwrite one another's changes.</span></span> <span data-ttu-id="ff294-165">Kaydın tamamını kapmasını Ayrıca, güncelleştirme yöntemleri yalnızca bir sütun alt kümesini DataRow nesnesinin değişiklik BLL içinde oluşturmak kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="ff294-165">Grabbing the entire record also makes it easier to create update methods in the BLL that only modify a subset of the DataRow's columns.</span></span> <span data-ttu-id="ff294-166">Ne zaman biz keşfedin `SuppliersBLL` sınıfı biz buna bir örnek göreceksiniz.</span><span class="sxs-lookup"><span data-stu-id="ff294-166">When we explore the `SuppliersBLL` class we'll see such an example.</span></span>

<span data-ttu-id="ff294-167">Son olarak, unutmayın `ProductsBLL` sınıfına sahip [DataObject özniteliği](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) uygulanan ( `[System.ComponentModel.DataObject]` hemen önce dosyanın en üstüne yakın class deyimi sözdizimi) ve yöntemleri [ DataObjectMethodAttribute öznitelikleri](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="ff294-167">Finally, note that the `ProductsBLL` class has the [DataObject attribute](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) applied to it (the `[System.ComponentModel.DataObject]` syntax right before the class statement near the top of the file) and the methods have [DataObjectMethodAttribute attributes](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx).</span></span> <span data-ttu-id="ff294-168">`DataObject` Özniteliği işaretler bağlama için uygun bir nesne olarak sınıfı bir [ObjectDataSource Denetimi](https://msdn.microsoft.com/library/9a4kyhcx.aspx), ancak `DataObjectMethodAttribute` yöntemi amacını gösterir.</span><span class="sxs-lookup"><span data-stu-id="ff294-168">The `DataObject` attribute marks the class as being an object suitable for binding to an [ObjectDataSource control](https://msdn.microsoft.com/library/9a4kyhcx.aspx), whereas the `DataObjectMethodAttribute` indicates the purpose of the method.</span></span> <span data-ttu-id="ff294-169">Öğreticiler gelecekte anlatıldığı gibi ASP.NET 2.0'ın ObjectDataSource bildirimli olarak bir sınıftan verilere erişmek kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="ff294-169">As we'll see in future tutorials, ASP.NET 2.0's ObjectDataSource makes it easy to declaratively access data from a class.</span></span> <span data-ttu-id="ff294-170">ObjectDataSource'nın Sihirbazı'nda bağlamak için olası sınıfların listesi filtre yardımcı olmak için yalnızca olarak işaretlenmiş sınıfları varsayılan olarak `DataObjects` sihirbazın aşağı açılan listesinde gösterilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-170">To help filter the list of possible classes to bind to in the ObjectDataSource's wizard, by default only those classes marked as `DataObjects` are shown in the wizard's drop-down list.</span></span> <span data-ttu-id="ff294-171">`ProductsBLL` Sınıfı bu öznitelikler da çalışır, ancak eklemeden kolaylaştırır ObjectDataSource'nın Sihirbazı'nda çalışmak.</span><span class="sxs-lookup"><span data-stu-id="ff294-171">The `ProductsBLL` class will work just as well without these attributes, but adding them makes it easier to work with in the ObjectDataSource's wizard.</span></span>

## <a name="adding-the-other-classes"></a><span data-ttu-id="ff294-172">Diğer sınıf ekleme</span><span class="sxs-lookup"><span data-stu-id="ff294-172">Adding the Other Classes</span></span>

<span data-ttu-id="ff294-173">İle `ProductsBLL` sınıfı tam, hala ihtiyacımız kategorileri, üreticiler ve çalışanlar ile çalışmaya yönelik sınıfları eklemek.</span><span class="sxs-lookup"><span data-stu-id="ff294-173">With the `ProductsBLL` class complete, we still need to add the classes for working with categories, suppliers, and employees.</span></span> <span data-ttu-id="ff294-174">Aşağıdaki sınıflar ve yöntemler Yukarıdaki örnekteki kavramları kullanarak oluşturmak için bir dakikanızı ayırın:</span><span class="sxs-lookup"><span data-stu-id="ff294-174">Take a moment to create the following classes and methods using the concepts from the example above:</span></span>

- <span data-ttu-id="ff294-175">**CategoriesBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="ff294-175">**CategoriesBLL.cs**</span></span>

    - `GetCategories()`
    - `GetCategoryByCategoryID(categoryID)`
- <span data-ttu-id="ff294-176">**SuppliersBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="ff294-176">**SuppliersBLL.cs**</span></span>

    - `GetSuppliers()`
    - `GetSupplierBySupplierID(supplierID)`
    - `GetSuppliersByCountry(country)`
    - `UpdateSupplierAddress(supplierID, address, city, country)`
- <span data-ttu-id="ff294-177">**EmployeesBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="ff294-177">**EmployeesBLL.cs**</span></span>

    - `GetEmployees()`
    - `GetEmployeeByEmployeeID(employeeID)`
    - `GetEmployeesByManager(managerID)`

<span data-ttu-id="ff294-178">Eşitlenmeyeceği yöntemi `SuppliersBLL` sınıfının `UpdateSupplierAddress` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="ff294-178">The one method worth noting is the `SuppliersBLL` class's `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="ff294-179">Bu yöntem yalnızca tedarikçi adres bilgilerini güncelleştirmek için bir arabirim sağlar.</span><span class="sxs-lookup"><span data-stu-id="ff294-179">This method provides an interface for updating just the supplier's address information.</span></span> <span data-ttu-id="ff294-180">Dahili olarak, bu yöntem okur `SupplierDataRow` için belirtilen nesne `supplierID` (kullanarak `GetSupplierBySupplierID`), adresi ilgili özelliklerini ayarlar ve içine çağırır `SupplierDataTable`'s `Update` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="ff294-180">Internally, this method reads in the `SupplierDataRow` object for the specified `supplierID` (using `GetSupplierBySupplierID`), sets its address-related properties, and then calls down into the `SupplierDataTable`'s `Update` method.</span></span> <span data-ttu-id="ff294-181">`UpdateSupplierAddress` Yöntemi aşağıdadır:</span><span class="sxs-lookup"><span data-stu-id="ff294-181">The `UpdateSupplierAddress` method follows:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample2.cs)]

<span data-ttu-id="ff294-182">Bu makalenin indirme my tam uygulama BLL sınıfları için bakın.</span><span class="sxs-lookup"><span data-stu-id="ff294-182">Refer to this article's download for my complete implementation of the BLL classes.</span></span>

## <a name="step-2-accessing-the-typed-datasets-through-the-bll-classes"></a><span data-ttu-id="ff294-183">2. adım: yazılan veri kümeleri BLL sınıflar üzerinden erişme</span><span class="sxs-lookup"><span data-stu-id="ff294-183">Step 2: Accessing the Typed DataSets Through the BLL Classes</span></span>

<span data-ttu-id="ff294-184">İlk öğreticide gördüğümüz doğrudan yazılan kümesiyle program aracılığıyla çalışma örnekleri, ancak bizim BLL sınıfları eklenmesiyle, sunu katmanı karşı BLL yerine çalışması gerekir.</span><span class="sxs-lookup"><span data-stu-id="ff294-184">In the first tutorial we saw examples of working directly with the Typed DataSet programmatically, but with the addition of our BLL classes, the presentation tier should work against the BLL instead.</span></span> <span data-ttu-id="ff294-185">İçinde `AllProducts.aspx` ilk öğreticide örnekten `ProductsTableAdapter` aşağıdaki kodda gösterildiği gibi bir GridView için ürünlerin listesini bağlamak için kullanılan:</span><span class="sxs-lookup"><span data-stu-id="ff294-185">In the `AllProducts.aspx` example from the first tutorial, the `ProductsTableAdapter` was used to bind the list of products to a GridView, as shown in the following code:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample3.cs)]

<span data-ttu-id="ff294-186">Yeni BLL kullanmaktır tüm değiştirilmesi gereken sınıflar, yalnızca ilk satır kod değiştirin `ProductsTableAdapter` nesnesi ile bir `ProductBLL` nesnesi:</span><span class="sxs-lookup"><span data-stu-id="ff294-186">To use the new BLL classes, all that needs to be changed is the first line of code simply replace the `ProductsTableAdapter` object with a `ProductBLL` object:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample4.cs)]

<span data-ttu-id="ff294-187">BLL sınıfları ayrıca bildirimli olarak (yazılan veri kümesi gibi) ObjectDataSource kullanılarak erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-187">The BLL classes can also be accessed declaratively (as can the Typed DataSet) by using the ObjectDataSource.</span></span> <span data-ttu-id="ff294-188">Biz daha ayrıntılı ObjectDataSource aşağıdaki öğreticilerde ele.</span><span class="sxs-lookup"><span data-stu-id="ff294-188">We'll be discussing the ObjectDataSource in greater detail in the following tutorials.</span></span>


<span data-ttu-id="ff294-189">[![Ürünleri listeler bir GridView görüntülenir](creating-a-business-logic-layer-cs/_static/image4.png)](creating-a-business-logic-layer-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ff294-189">[![The List of Products is Displayed in a GridView](creating-a-business-logic-layer-cs/_static/image4.png)](creating-a-business-logic-layer-cs/_static/image3.png)</span></span>

<span data-ttu-id="ff294-190">**Şekil 3**: ürünleri listeler, bir GridView görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-business-logic-layer-cs/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="ff294-190">**Figure 3**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image5.png))</span></span>


## <a name="step-3-adding-field-level-validation-to-the-datarow-classes"></a><span data-ttu-id="ff294-191">3. adım: Alan düzeyindeki doğrulama DataRow sınıfları ekleme</span><span class="sxs-lookup"><span data-stu-id="ff294-191">Step 3: Adding Field-Level Validation to the DataRow Classes</span></span>

<span data-ttu-id="ff294-192">Alan düzeyindeki doğrulama olan ekleme veya güncelleştirme sırasında iş nesnelerin özellik değerlerini ilgilidir denetler.</span><span class="sxs-lookup"><span data-stu-id="ff294-192">Field-level validation are checks that pertains to the property values of the business objects when inserting or updating.</span></span> <span data-ttu-id="ff294-193">Bazı alan düzeyindeki doğrulama kuralları ürünleri için şunları içerir:</span><span class="sxs-lookup"><span data-stu-id="ff294-193">Some field-level validation rules for products include:</span></span>

- <span data-ttu-id="ff294-194">`ProductName` Alanı 40 karakter veya daha az olmalıdır</span><span class="sxs-lookup"><span data-stu-id="ff294-194">The `ProductName` field must be 40 characters or less in length</span></span>
- <span data-ttu-id="ff294-195">`QuantityPerUnit` Alanı 20 karakter veya daha az olmalıdır</span><span class="sxs-lookup"><span data-stu-id="ff294-195">The `QuantityPerUnit` field must be 20 characters or less in length</span></span>
- <span data-ttu-id="ff294-196">`ProductID`, `ProductName`, Ve `Discontinued` alanları gereklidir, ancak diğer tüm alanlar isteğe bağlıdır</span><span class="sxs-lookup"><span data-stu-id="ff294-196">The `ProductID`, `ProductName`, and `Discontinued` fields are required, but all other fields are optional</span></span>
- <span data-ttu-id="ff294-197">`UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, Ve `ReorderLevel` alanları değerinden büyük veya sıfıra eşit olmalıdır</span><span class="sxs-lookup"><span data-stu-id="ff294-197">The `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields must be greater than or equal to zero</span></span>

<span data-ttu-id="ff294-198">Bu kurallar, olabilir ve veritabanı düzeyinde ifade edilmelidir.</span><span class="sxs-lookup"><span data-stu-id="ff294-198">These rules can and should be expressed at the database level.</span></span> <span data-ttu-id="ff294-199">Karakter sınırını `ProductName` ve `QuantityPerUnit` alanları bu sütunların veri türleri tarafından yakalanan `Products` tablosu (`nvarchar(40)` ve `nvarchar(20)`sırasıyla).</span><span class="sxs-lookup"><span data-stu-id="ff294-199">The character limit on the `ProductName` and `QuantityPerUnit` fields are captured by the data types of those columns in the `Products` table (`nvarchar(40)` and `nvarchar(20)`, respectively).</span></span> <span data-ttu-id="ff294-200">Alanları gerekli ve isteğe bağlı olup ifade edilir tarafından veritabanı tablo sütununa izin veriyorsa `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="ff294-200">Whether fields are required and optional are expressed by if the database table column allows `NULL` s.</span></span> <span data-ttu-id="ff294-201">Dört [denetim kısıtlamaları](https://msdn.microsoft.com/library/ms188258.aspx) mevcut emin yalnızca şu değerler sıfırdan büyük veya sıfıra eşit içine yapabilirsiniz `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, veya `ReorderLevel` sütun.</span><span class="sxs-lookup"><span data-stu-id="ff294-201">Four [check constraints](https://msdn.microsoft.com/library/ms188258.aspx) exist that ensure that only values greater than or equal to zero can make it into the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` columns.</span></span>

<span data-ttu-id="ff294-202">Bu kurallar veritabanı sırasında zorlama yanı sıra bunların ayrıca veri kümesi düzeyinde zorunlu tutulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="ff294-202">In addition to enforcing these rules at the database they should also be enforced at the DataSet level.</span></span> <span data-ttu-id="ff294-203">Aslında, alan uzunluğu ve bir değer gerekli veya isteğe bağlı olup zaten DataColumn nesneleri her DataTable nesnesinin kümesi için yakalanır.</span><span class="sxs-lookup"><span data-stu-id="ff294-203">In fact, the field length and whether a value is required or optional are already captured for each DataTable's set of DataColumns.</span></span> <span data-ttu-id="ff294-204">Otomatik olarak sağlanan mevcut alan düzeyindeki doğrulama görmek için veri kümesi Tasarımcısı gidin, DataTables birinden bir alan seçin ve Özellikler penceresine gidin.</span><span class="sxs-lookup"><span data-stu-id="ff294-204">To see the existing field-level validation automatically provided, go to the DataSet Designer, select a field from one of the DataTables and then go to the Properties window.</span></span> <span data-ttu-id="ff294-205">Şekil 4'te gösterildiği gibi `QuantityPerUnit` DataColumn `ProductsDataTable` en çok 20 karakter içeriyor ve izin vermiyor `NULL` değerleri.</span><span class="sxs-lookup"><span data-stu-id="ff294-205">As Figure 4 shows, the `QuantityPerUnit` DataColumn in the `ProductsDataTable` has a maximum length of 20 characters and does allow `NULL` values.</span></span> <span data-ttu-id="ff294-206">Biz ayarlamaya çalışırsanız `ProductsDataRow`'s `QuantityPerUnit` 20 karakterden uzun bir dize değeri özelliğine bir `ArgumentException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="ff294-206">If we attempt to set the `ProductsDataRow`'s `QuantityPerUnit` property to a string value longer than 20 characters an `ArgumentException` will be thrown.</span></span>


<span data-ttu-id="ff294-207">[![DataColumn temel alan düzeyindeki doğrulama sağlar](creating-a-business-logic-layer-cs/_static/image7.png)](creating-a-business-logic-layer-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="ff294-207">[![The DataColumn Provides Basic Field-Level Validation](creating-a-business-logic-layer-cs/_static/image7.png)](creating-a-business-logic-layer-cs/_static/image6.png)</span></span>

<span data-ttu-id="ff294-208">**Şekil 4**: DataColumn ile sağlar temel alan düzeyindeki doğrulama ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-business-logic-layer-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ff294-208">**Figure 4**: The DataColumn Provides Basic Field-Level Validation ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image8.png))</span></span>


<span data-ttu-id="ff294-209">Ne yazık ki, biz sınırları denetimleri gibi belirtemezsiniz `UnitPrice` değeri Özellikler penceresini aracılığıyla sıfıra eşit veya daha büyük olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="ff294-209">Unfortunately, we can't specify bounds checks, such as the `UnitPrice` value must be greater than or equal to zero, through the Properties window.</span></span> <span data-ttu-id="ff294-210">Bu tür bir alan düzeyindeki doğrulama sağlamak için bir olay işleyicisi DataTable için nesnesinin oluşturmak ihtiyacımız [ColumnChanging](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) olay.</span><span class="sxs-lookup"><span data-stu-id="ff294-210">In order to provide this type of field-level validation we need to create an event handler for the DataTable's [ColumnChanging](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) event.</span></span> <span data-ttu-id="ff294-211">Bölümünde belirtildiği gibi [önceki öğretici](creating-a-data-access-layer-cs.md), kısmi sınıflar kullanımı ile yazılan veri kümesi tarafından oluşturulan veri kümesi, DataTable ve DataRow nesneler genişletilebilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-211">As mentioned in the [preceding tutorial](creating-a-data-access-layer-cs.md), the DataSet, DataTables, and DataRow objects created by the Typed DataSet can be extended through the use of partial classes.</span></span> <span data-ttu-id="ff294-212">Biz oluşturabilirsiniz Bu teknik kullanılarak bir `ColumnChanging` için olay işleyicisini `ProductsDataTable` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="ff294-212">Using this technique we can create a `ColumnChanging` event handler for the `ProductsDataTable` class.</span></span> <span data-ttu-id="ff294-213">Başlangıç bir sınıfta oluşturarak `App_Code` adlı klasörü `ProductsDataTable.ColumnChanging.cs`.</span><span class="sxs-lookup"><span data-stu-id="ff294-213">Start by creating a class in the `App_Code` folder named `ProductsDataTable.ColumnChanging.cs`.</span></span>


<span data-ttu-id="ff294-214">[![Yeni bir sınıf App_Code klasörüne ekleyin](creating-a-business-logic-layer-cs/_static/image10.png)](creating-a-business-logic-layer-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ff294-214">[![Add a New Class to the App_Code Folder](creating-a-business-logic-layer-cs/_static/image10.png)](creating-a-business-logic-layer-cs/_static/image9.png)</span></span>

<span data-ttu-id="ff294-215">**Şekil 5**: yeni bir sınıf ekleyin `App_Code` klasörü ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-business-logic-layer-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="ff294-215">**Figure 5**: Add a New Class to the `App_Code` Folder ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image11.png))</span></span>


<span data-ttu-id="ff294-216">Ardından, bir olay işleyicisi oluşturun `ColumnChanging` sağlar olay `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, ve `ReorderLevel` sütun değerlerini (değilse `NULL`) değerinden büyük veya sıfıra eşit olan.</span><span class="sxs-lookup"><span data-stu-id="ff294-216">Next, create an event handler for the `ColumnChanging` event that ensures that the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` column values (if not `NULL`) are greater than or equal to zero.</span></span> <span data-ttu-id="ff294-217">Böyle bir sütunu aralık dışında ise, throw bir `ArgumentException`.</span><span class="sxs-lookup"><span data-stu-id="ff294-217">If any such column is out of range, throw an `ArgumentException`.</span></span>

<span data-ttu-id="ff294-218">ProductsDataTable.ColumnChanging.cs</span><span class="sxs-lookup"><span data-stu-id="ff294-218">ProductsDataTable.ColumnChanging.cs</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample5.cs)]

## <a name="step-4-adding-custom-business-rules-to-the-blls-classes"></a><span data-ttu-id="ff294-219">4. adım: Özel iş kurallarını BLL'ın sınıflara ekleme</span><span class="sxs-lookup"><span data-stu-id="ff294-219">Step 4: Adding Custom Business Rules to the BLL's Classes</span></span>

<span data-ttu-id="ff294-220">Alan düzeyindeki doğrulama yanı sıra, farklı varlıklar veya tek bir sütun düzeyinde değil ifade kavramları gibi ilgili üst düzey özel iş kurallarını olabilir:</span><span class="sxs-lookup"><span data-stu-id="ff294-220">In addition to field-level validation, there may be high-level custom business rules that involve different entities or concepts not expressible at the single column level, such as:</span></span>

- <span data-ttu-id="ff294-221">Bir ürün kesilir, kendi `UnitPrice` güncelleştirilemiyor</span><span class="sxs-lookup"><span data-stu-id="ff294-221">If a product is discontinued, its `UnitPrice` cannot be updated</span></span>
- <span data-ttu-id="ff294-222">Çalışanın ülke ikamet ettiğiniz ikamet ettiğiniz ülke kendi manager'ın aynı olması gerekir</span><span class="sxs-lookup"><span data-stu-id="ff294-222">An employee's country of residence must be the same as their manager's country of residence</span></span>
- <span data-ttu-id="ff294-223">Sağlayıcısı tarafından sağlanan tek ürün ise bir ürün dönüştürülmesine olamaz</span><span class="sxs-lookup"><span data-stu-id="ff294-223">A product cannot be discontinued if it is the only product provided by the supplier</span></span>

<span data-ttu-id="ff294-224">Uygulamanın iş kuralları bağlılığı emin olmak için denetimleri BLL sınıfları içerir.</span><span class="sxs-lookup"><span data-stu-id="ff294-224">The BLL classes should contain checks to ensure adherence to the application's business rules.</span></span> <span data-ttu-id="ff294-225">Bu denetimler, uygulandıkları yöntemleri doğrudan eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="ff294-225">These checks can be added directly to the methods to which they apply.</span></span>

<span data-ttu-id="ff294-226">Bizim iş kurallarını yalnızca ürün belirli bir sağlayıcının ise, bir ürün devam etmeyen işaretlenemez, dikte düşünün.</span><span class="sxs-lookup"><span data-stu-id="ff294-226">Imagine that our business rules dictate that a product could not be marked discontinued if it was the only product from a given supplier.</span></span> <span data-ttu-id="ff294-227">Diğer bir deyişle, varsa ürün *X* biz satın listesinden Tedarikçi yalnızca ürün *Y*, biz değil işaretleyebilir *X* ; değilse, kullanımdan gibi ancak tedarikçi *Y*bize üç ürünleri ile sağlanan *A*, *B*, ve *C*, ardından biz herhangi işaretleyebilir ve tüm bunların devam etmez.</span><span class="sxs-lookup"><span data-stu-id="ff294-227">That is, if product *X* was the only product we purchased from supplier *Y*, we could not mark *X* as discontinued; if, however, supplier *Y* supplied us with three products, *A*, *B*, and *C*, then we could mark any and all of these as discontinued.</span></span> <span data-ttu-id="ff294-228">Bir tek iş kuralı ancak iş kuralları ve sağduyunuzu her zaman hizalı değil!</span><span class="sxs-lookup"><span data-stu-id="ff294-228">An odd business rule, but business rules and common sense aren't always aligned!</span></span>

<span data-ttu-id="ff294-229">Bu iş kuralı zorlamak için `UpdateProducts` biz start olmadığını denetleyerek yöntemi `Discontinued` ayarlandı `true` ve bu nedenle, biz çağırırdı varsa `GetProductsBySupplierID` kaç ürünleri belirlemek için şu listesinden bu ürünün tedarikçi satın alınmış.</span><span class="sxs-lookup"><span data-stu-id="ff294-229">To enforce this business rule in the `UpdateProducts` method we'd start by checking if `Discontinued` was set to `true` and, if so, we'd call `GetProductsBySupplierID` to determine how many products we purchased from this product's supplier.</span></span> <span data-ttu-id="ff294-230">Yalnızca bir ürün listesinden bu tedarikçi satın biz throw bir `ApplicationException`.</span><span class="sxs-lookup"><span data-stu-id="ff294-230">If only one product is purchased from this supplier, we throw an `ApplicationException`.</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample6.cs)]

## <a name="responding-to-validation-errors-in-the-presentation-tier"></a><span data-ttu-id="ff294-231">Sunu katmanındaki doğrulama hataları yanıtlama</span><span class="sxs-lookup"><span data-stu-id="ff294-231">Responding to Validation Errors in the Presentation Tier</span></span>

<span data-ttu-id="ff294-232">Sunu Katmanı'ndan BLL çağrılırken, yükseltilmiş veya ASP.NET kadar Kabarcık bildirmek özel durumları işleme girişimi edilmeyeceğine karar verebilirsiniz (Yükselt `HttpApplication`'s `Error` olay).</span><span class="sxs-lookup"><span data-stu-id="ff294-232">When calling the BLL from the presentation tier we can decide whether to attempt to handle any exceptions that might be raised or let them bubble up to ASP.NET (which will raise the `HttpApplication`'s `Error` event).</span></span> <span data-ttu-id="ff294-233">Program aracılığıyla BLL ile çalışırken, özel bir durumu işlemek için şu kullanabilirsiniz bir [try... catch](https://msdn.microsoft.com/library/0yd65esw.aspx) aşağıdaki örnekte gösterildiği gibi engelle:</span><span class="sxs-lookup"><span data-stu-id="ff294-233">To handle an exception when working with the BLL programmatically, we can use a [try...catch](https://msdn.microsoft.com/library/0yd65esw.aspx) block, as the following example shows:</span></span>


[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample7.cs)]

<span data-ttu-id="ff294-234">Gelecekte öğreticileri göreceğiz, Yukarı veri kullanırken BLL Kabarcık işleme özel durumları, güncelleştirme, ekleme, Denetim Web veya verileri silme işlenebilir kodda kaydırma gerek kalmadan aksine doğrudan bir olay işleyicisi `try...catch` engeller.</span><span class="sxs-lookup"><span data-stu-id="ff294-234">As we'll see in future tutorials, handling exceptions that bubble up from the BLL when using a data Web control for inserting, updating, or deleting data can be handled directly in an event handler as opposed to having to wrap code in `try...catch` blocks.</span></span>

## <a name="summary"></a><span data-ttu-id="ff294-235">Özet</span><span class="sxs-lookup"><span data-stu-id="ff294-235">Summary</span></span>

<span data-ttu-id="ff294-236">Her biri belirli bir rol yalıtır farklı katmanlara hazırlanmış bir iyi tasarlanmış bir uygulama.</span><span class="sxs-lookup"><span data-stu-id="ff294-236">A well architected application is crafted into distinct layers, each of which encapsulates a particular role.</span></span> <span data-ttu-id="ff294-237">Bu makale dizisinin ilk öğreticide yazılan veri kümeleri kullanarak veri erişim katmanı oluşturduğumuz; Bu öğreticide bir iş mantığı katmanı sınıfları bir dizi olarak bizim uygulamanın içinde oluşturduğumuz `App_Code` bizim DAL çağrı klasör.</span><span class="sxs-lookup"><span data-stu-id="ff294-237">In the first tutorial of this article series we created a Data Access Layer using Typed DataSets; in this tutorial we built a Business Logic Layer as a series of classes in our application's `App_Code` folder that call down into our DAL.</span></span> <span data-ttu-id="ff294-238">BLL uygulamamız için alan ve iş düzeyi mantığını uygular.</span><span class="sxs-lookup"><span data-stu-id="ff294-238">The BLL implements the field-level and business-level logic for our application.</span></span> <span data-ttu-id="ff294-239">Bu öğreticide, yaptığımız ayrı BLL oluşturmaya ek olarak, başka bir seçenek TableAdapters yöntemleri kısmi sınıflar kullanımı ile genişletmek için aynıdır.</span><span class="sxs-lookup"><span data-stu-id="ff294-239">In addition to creating a separate BLL, as we did in this tutorial, another option is to extend the TableAdapters' methods through the use of partial classes.</span></span> <span data-ttu-id="ff294-240">Ancak, bu teknik kullanılarak bize varolan yöntemleri geçersiz kılmak izin vermez veya onu bizim DAL ve bizim BLL Biz bu makalede ayırdıktan yaklaşımı olarak düzgün bir şekilde ayrı yapar.</span><span class="sxs-lookup"><span data-stu-id="ff294-240">However, using this technique does not allow us to override existing methods nor does it separate our DAL and our BLL as cleanly as the approach we've taken in this article.</span></span>

<span data-ttu-id="ff294-241">DAL ve BLL tam biz bizim sunu katmanı başlamaya hazırsınız.</span><span class="sxs-lookup"><span data-stu-id="ff294-241">With the DAL and BLL complete, we're ready to start on our presentation layer.</span></span> <span data-ttu-id="ff294-242">İçinde [sonraki öğretici](master-pages-and-site-navigation-cs.md) şu veri erişimi konulardan kısa detour alın ve öğreticiler boyunca kullanmanız için bir tutarlı sayfa düzeni tanımlamak.</span><span class="sxs-lookup"><span data-stu-id="ff294-242">In the [next tutorial](master-pages-and-site-navigation-cs.md) we'll take a brief detour from data access topics and define a consistent page layout for use throughout the tutorials.</span></span>

<span data-ttu-id="ff294-243">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="ff294-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ff294-244">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="ff294-244">About the Author</span></span>

<span data-ttu-id="ff294-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="ff294-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ff294-246">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="ff294-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ff294-247">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ff294-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ff294-248">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ff294-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ff294-249">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="ff294-249">Special Thanks To</span></span>

<span data-ttu-id="ff294-250">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="ff294-250">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ff294-251">Bu öğretici için sağlama gözden geçirenler Liz Shulok, Dennis Patterson, Carlos Santos ve Hilton Giesenow yoktu.</span><span class="sxs-lookup"><span data-stu-id="ff294-251">Lead reviewers for this tutorial were Liz Shulok, Dennis Patterson, Carlos Santos, and Hilton Giesenow.</span></span> <span data-ttu-id="ff294-252">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="ff294-252">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ff294-253">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ff294-253">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="ff294-254">[Önceki](creating-a-data-access-layer-cs.md)
[sonraki](master-pages-and-site-navigation-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ff294-254">[Previous](creating-a-data-access-layer-cs.md)
[Next](master-pages-and-site-navigation-cs.md)</span></span>
