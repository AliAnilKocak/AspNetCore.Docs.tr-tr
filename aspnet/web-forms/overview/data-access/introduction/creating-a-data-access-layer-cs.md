---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: "Veri erişim katmanı (C#) oluşturma | Microsoft Docs"
author: rick-anderson
description: "Bu öğreticide biz çok baştan başlamanız ve veri erişim katmanı (bir veritabanı olarak bilgilere erişmek için yazılan veri kümeleri kullanarak DAL), oluşturmak."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: c610f84cfb82f38f9c67b757aa341c7a1497369c
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="47728-103">Veri erişim katmanı (C#) oluşturma</span><span class="sxs-lookup"><span data-stu-id="47728-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="47728-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="47728-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="47728-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) veya [PDF indirin](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="47728-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) or [Download PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span></span>

> <span data-ttu-id="47728-106">Bu öğreticide biz çok baştan başlamanız ve veri erişim katmanı (bir veritabanı olarak bilgilere erişmek için yazılan veri kümeleri kullanarak DAL), oluşturmak.</span><span class="sxs-lookup"><span data-stu-id="47728-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="47728-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="47728-107">Introduction</span></span>

<span data-ttu-id="47728-108">Web geliştiricileri, verileri ile çalışma geçici bizim yaşamlarını Uzayda Döndür.</span><span class="sxs-lookup"><span data-stu-id="47728-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="47728-109">Kod almak ve ve toplamak ve onu özetlemek için web sayfaları değiştirmek için verileri depolamak için veritabanlarını oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="47728-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="47728-110">ASP.NET 2. 0 ' Bu ortak desenler uygulamak için teknikleri inceleyeceksiniz uzun serideki ilk öğreticide budur.</span><span class="sxs-lookup"><span data-stu-id="47728-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="47728-111">Oluşturma ile başlayacağız bir [yazılım mimarisi](http://en.wikipedia.org/wiki/Software_architecture) özel iş kurallarını uygulayan bir veri erişim katmanı (yazılan veri kümeleri, iş mantığı katmanı (BLL) kullanarak DAL,) oluşur ve ASP.NET oluşan bir sunu katmanı sayfalar ortak bir sayfa düzeni paylaşır.</span><span class="sxs-lookup"><span data-stu-id="47728-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="47728-112">Bu arka uç öğrenmeniz, biz raporlamasına, taşırsınız yerleştirilmiş sonra görüntülemek nasıl gösteren özetleyin, toplamak ve bir web uygulamasından veri doğrulama.</span><span class="sxs-lookup"><span data-stu-id="47728-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="47728-113">Bu öğreticileri, kısa ve görsel olarak işleminde size kılavuzluk için yeterince ekran görüntüleri ile adım adım yönergeler sağlamak için sağlamıştır.</span><span class="sxs-lookup"><span data-stu-id="47728-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="47728-114">Her öğretici C# ve Visual Basic sürümlerinde kullanılabilir ve kullanılan tam kod yüklenmesini içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="47728-115">(Bu ilk öğreticide oldukça uzun, ancak geri kalan çok daha fazla digestible yığınlar halinde sunulur.)</span><span class="sxs-lookup"><span data-stu-id="47728-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="47728-116">Bu öğreticileri için biz yerleştirilen Northwind veritabanı Microsoft SQL Server 2005 Express Edition sürümü kullanmaya başlayacağınız **uygulama\_veri** dizin.</span><span class="sxs-lookup"><span data-stu-id="47728-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="47728-117">Veritabanı dosyası yanı sıra **uygulama\_veri** klasör durumunda farklı veritabanı sürümü kullanmak istediğiniz veritabanı oluşturmak için SQL komut dosyaları da içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="47728-118">Bu komut dosyalarını olması da olabilir [doğrudan Microsoft'tan yüklenen](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), dilerseniz.</span><span class="sxs-lookup"><span data-stu-id="47728-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="47728-119">Northwind veritabanı farklı bir SQL Server sürümünü kullanıyorsanız, güncelleştirmeniz gerekecektir **NORTHWNDConnectionString** uygulamanın içinde ayarı **Web.config** dosya.</span><span class="sxs-lookup"><span data-stu-id="47728-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="47728-120">Web uygulaması, dosya sistemi tabanlı Web sitesi projesi olarak Visual Studio 2005 Professional sürümü kullanılarak oluşturuldu.</span><span class="sxs-lookup"><span data-stu-id="47728-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="47728-121">Ancak, tüm öğreticileri çalışır eşit olarak Visual Studio 2005, ücretsiz sürümü ile yanı sıra [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="47728-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="47728-122">Bu öğreticide biz çok baştan başlamanız ve veri erişim katmanı (ikinci öğreticide iş mantığı katmanı (BLL) oluşturma ve sayfa düzeni ve üçüncü Gezinti çalışma arkasından DAL), oluşturmak.</span><span class="sxs-lookup"><span data-stu-id="47728-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="47728-123">Üçüncü bir foundation oluşturacaksınız sonra öğreticileri ilk üç düzenlenir.</span><span class="sxs-lookup"><span data-stu-id="47728-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="47728-124">Biz bu ilk öğreticide, böylece Visual Studio'yu ayarlama yangın ve başlayalım çok sahibiz!</span><span class="sxs-lookup"><span data-stu-id="47728-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="47728-125">1. adım: bir Web projesi oluşturma ve veritabanına bağlanma</span><span class="sxs-lookup"><span data-stu-id="47728-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="47728-126">Bizim veri erişim düzeyi (DAL) oluşturabilmeniz için önce ilk olarak bir web sitesi oluşturun ve bizim Veritabanı Kurulumu ihtiyacımız.</span><span class="sxs-lookup"><span data-stu-id="47728-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="47728-127">Yeni bir dosya sistemi tabanlı ASP.NET web sitesi oluşturmaya başlayın.</span><span class="sxs-lookup"><span data-stu-id="47728-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="47728-128">Bunu başarmak için Dosya menüsüne gidin ve yeni Web sitesi iletişim kutusunu görüntüleme yeni Web sitesi seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="47728-129">ASP.NET Web sitesi şablonunu seçin, dosya sistemine konum aşağı açılan listesi ayarlamak, web sitesi yerleştirmek için bir klasör seçin ve dil C# ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="47728-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="47728-130">[![Yeni bir dosya sistemi tabanlı Web sitesi oluşturma](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="47728-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="47728-131">**Şekil 1**: New File System-Based Web sitesi oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="47728-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="47728-132">Bu yeni bir web sitesi ile oluşturacak bir **Default.aspx** ASP.NET sayfası ve bir **uygulama\_veri** klasör.</span><span class="sxs-lookup"><span data-stu-id="47728-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="47728-133">Oluşturulan web sitesi ile Visual Studio'nun Sunucu Gezgininde veritabanına bir başvuru ekleyin sonraki adımdır.</span><span class="sxs-lookup"><span data-stu-id="47728-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="47728-134">Bir veritabanı için Sunucu Gezgini ekleyerek tabloları, saklı yordamlar, görünümler ve Visual Studio vb. tüm ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="47728-135">Ayrıca, tablo verileri görüntülemek veya kendi sorguları Sorgu Oluşturucusu el ile veya grafik oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="47728-136">Biz yazılan veri kümeleri için DAL derlerken Ayrıca, biz noktası Visual Studio yazılan veri kümeleri oluşturulması veritabanı gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="47728-137">Bu bağlantı bilgisini zamandaki o noktada sağladığımız olsa da, Visual Studio açılır listesini Server Explorer'da zaten kayıtlı veritabanları otomatik olarak doldurur.</span><span class="sxs-lookup"><span data-stu-id="47728-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="47728-138">Northwind veritabanı için Sunucu Gezgini ekleme adımları, SQL Server 2005 Express Edition veritabanında kullanmak istediğiniz bağımlı **uygulama\_veri** klasörü veya bir Microsoft SQL Server 2000 veya 2005 varsa Bunun yerine kullanmak istediğiniz veritabanı sunucusu kurulumu.</span><span class="sxs-lookup"><span data-stu-id="47728-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="47728-139">Bir veritabanı içinde App kullanarak\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="47728-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="47728-140">Bir SQL Server 2000 veya 2005 veritabanı sunucusuna bağlanmak için yok veya veritabanı bir veritabanı sunucusuna eklemek zorunda kalmamak, yalnızca istediğiniz, indirilen websit içinde bulunan Northwind veritabanı SQL Server 2005 Express Edition sürümü kullanabilirsiniz e's **uygulama\_veri** klasörü (**NORTHWND. MDF**).</span><span class="sxs-lookup"><span data-stu-id="47728-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="47728-141">Bir veritabanı yerleştirilen **uygulama\_veri** klasörü için Sunucu Gezgini otomatik olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="47728-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="47728-142">SQL Server 2005 Express makinenize yüklü sürümü, varsayarak NORTHWND adlı bir düğüm görmeniz gerekir. Sunucu Gezgininde MDF genişletin ve onun tabloları, görünümleri, saklı yordam ve benzeri (bkz. Şekil 2) keşfedin.</span><span class="sxs-lookup"><span data-stu-id="47728-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="47728-143">**Uygulama\_veri** klasörü ayrıca Microsoft Access tutun **.mdb** hangi SQL Server'dekiler gibi Sunucu Gezgini otomatik olarak eklenen dosyalar.</span><span class="sxs-lookup"><span data-stu-id="47728-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="47728-144">SQL Server seçeneklerinden herhangi birini kullanmak istemiyorsanız, her zaman yapabilecekleriniz [Northwind veritabanı dosyası bir Microsoft Access sürümünü indirmek](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) ve içine bırakma **uygulama\_veri** dizin.</span><span class="sxs-lookup"><span data-stu-id="47728-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="47728-145">Access veritabanları olarak olmayan Koru unutmayın, ancak zengin SQL Server ve web sitesi senaryolarda kullanılmak üzere tasarlanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="47728-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="47728-146">Ayrıca, birkaç 35 + öğreticileri Access tarafından desteklenmeyen bazı veritabanı düzeyi özellikleri yararlanacak olan.</span><span class="sxs-lookup"><span data-stu-id="47728-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="47728-147">Bir Microsoft SQL Server 2000 veya 2005 veritabanı sunucusu veritabanına bağlanma</span><span class="sxs-lookup"><span data-stu-id="47728-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="47728-148">Alternatif olarak, bir veritabanı sunucusunda yüklü Northwind veritabanına bağlanabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="47728-149">Veritabanı sunucusu yüklü Northwind veritabanı zaten yoksa, öncelikle bu veritabanı sunucusuna bu öğreticinin indirme ya da dahil yükleme komut dosyası çalıştırarak eklemeniz gerekir [Northwind SQL Server 2000 sürümü indirme ve yükleme komut dosyası](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) Microsoft'un web sitesinden doğrudan.</span><span class="sxs-lookup"><span data-stu-id="47728-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="47728-150">Yüklenen veritabanı olduktan sonra Visual Studio Server Explorer'da için veri bağlantıları düğümüne sağ tıklayın ve bağlantı Ekle seçin gidin.</span><span class="sxs-lookup"><span data-stu-id="47728-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="47728-151">Sunucu Gezgini görünümüne gidin görmüyorsanız, / Sunucu Gezgini ya da isabet Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="47728-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="47728-152">Bu kimlik doğrulama bilgilerini ve veritabanı adını bağlanmak için sunucunun belirtebileceğiniz Bağlantı Ekle iletişim kutusunu getirir.</span><span class="sxs-lookup"><span data-stu-id="47728-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="47728-153">Başarılı bir şekilde veritabanı bağlantısı bilgilerini yapılandırdıktan ve Tamam düğmesine tıklandığında sonra veritabanı veri bağlantıları düğümü altında bir düğüm olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="47728-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="47728-154">Tabloları, görünümleri, saklı yordamlar ve benzeri keşfetmek için veritabanı düğümü genişletebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Veritabanı sunucunuzun Northwind veritabanına bir bağlantı Ekle](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="47728-156">**Şekil 2**: veritabanı sunucunuzun Northwind veritabanına bir bağlantı Ekle</span><span class="sxs-lookup"><span data-stu-id="47728-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="47728-157">2. adım: veri erişim katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="47728-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="47728-158">İle çalışırken, verileri bir veri özgü mantığı (bir web uygulaması'nda sunu katmanı oluşturan ASP.NET sayfaları yapma) doğrudan sunu katmanına katıştırmak için seçenektir.</span><span class="sxs-lookup"><span data-stu-id="47728-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="47728-159">Bu, ASP.NET sayfa kod bölümünde ADO.NET kod yazma veya bir işaretleme bölümünden SqlDataSource denetimi kullanarak form alabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="47728-160">Her iki durumda da, bu yaklaşım, veri erişim mantığı sıkı bir şekilde sunu katmanı ile couples.</span><span class="sxs-lookup"><span data-stu-id="47728-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="47728-161">Önerilen yaklaşım, ancak, veri erişim mantığı sunu katmanı ayırmak için gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="47728-162">Bu ayrı bir katman DAL kısaca, veri erişim katmanı olarak adlandırılır ve genel ayrı bir sınıf kitaplığı proje uygulanır.</span><span class="sxs-lookup"><span data-stu-id="47728-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="47728-163">Bu katmanlı mimarisinin avantajları belgelendiğinden (aşağıdaki avantajları hakkında bilgi için bu öğreticinin sonunda "Başka okumalar" bölümüne bakın) ve biz bu dizide sürer yaklaşımdır.</span><span class="sxs-lookup"><span data-stu-id="47728-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="47728-164">Veritabanına bir bağlantı oluşturma gibi temel alınan veri kaynağına özgü tüm kod veren **seçin**, **Ekle**, **güncelleştirme**, ve  **SİLME** DAL komutlar ve benzeri bulunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="47728-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="47728-165">Sunu katmanı bu tür veri erişim kodu yönelik tüm başvuruları içermemesi gerekir, ancak bunun yerine tüm veri istekleri için DAL çağrılarını olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="47728-166">Veri erişim katmanları genellikle temel alınan veritabanı veri erişmek için yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="47728-167">Örneğin, Northwind veritabanı sahip **ürünleri** ve **kategorileri** ürünler satış ve ait oldukları kategorileri için kayıt tabloları.</span><span class="sxs-lookup"><span data-stu-id="47728-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="47728-168">Bizim DAL biz yöntemler gibi olacaktır:</span><span class="sxs-lookup"><span data-stu-id="47728-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="47728-169">**GetCategories(),** tüm kategorileri hakkında bilgiler döndürecektir</span><span class="sxs-lookup"><span data-stu-id="47728-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="47728-170">**GetProducts()**, ürünlerin tamamı hakkında bilgi döndürecektir</span><span class="sxs-lookup"><span data-stu-id="47728-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="47728-171">**GetProductsByCategoryID (*adlı kullanıcı, Categoryıd'si*) **, belirtilen bir kategoriye ait tüm ürünleri döndürecektir</span><span class="sxs-lookup"><span data-stu-id="47728-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="47728-172">**GetProductByProductID (*ProductID*) **, belirli bir ürünü hakkında bilgi döndürecektir</span><span class="sxs-lookup"><span data-stu-id="47728-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="47728-173">Bu yöntem çağrıldığında, veritabanına bağlanmak, uygun sorgu vermek ve sonuçlar döndürebilir.</span><span class="sxs-lookup"><span data-stu-id="47728-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="47728-174">Bu sonuçları nasıl döndürürüz önemlidir.</span><span class="sxs-lookup"><span data-stu-id="47728-174">How we return these results is important.</span></span> <span data-ttu-id="47728-175">Bu yöntemleri yalnızca bir veri kümesi veya veritabanı sorgusunun doldurulmuş DataReader döndürebilir ancak kullanarak bu sonuçlar ideal olarak döndürülmelidir *türü kesin belirlenmiş nesnelerin*.</span><span class="sxs-lookup"><span data-stu-id="47728-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="47728-176">Geniş yazılmış bir nesne karşıtı biri, şema çalışma zamanına kadar bilinmiyor iken kesin türü belirtilmiş bir nesne, şema aracılığı derleme zamanında tanımlanan biridir.</span><span class="sxs-lookup"><span data-stu-id="47728-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="47728-177">Bunları doldurmak için kullanılan veritabanı sorgusunun döndürdüğü sütunlara göre kendi şema tanımlamış Örneğin, DataReader ve veri kümesi (varsayılan) geniş yazılmış nesneleridir.</span><span class="sxs-lookup"><span data-stu-id="47728-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="47728-178">Belirli bir sütuna ihtiyacımız gibi sözdizimini kullanmak için geniş yazılmış bir DataTable erişmek için:   ***DataTable*. Satırlar [*dizin*] ["*columnName*"]**. Bu örnekte DataTable nesnesinin gevşek yazarak bir dize veya sıra dizini kullanarak sütun adı erişmek için ihtiyacımız olgu tarafından sergilenen. Kesin türü belirtilmiş bir DataTable Öte yandan, her özellikleri olarak uygulanan sütunları benzer kodunda sonuçlanan olacaktır:   ***DataTable*. Satırlar [*dizin*].* columnName***.</span><span class="sxs-lookup"><span data-stu-id="47728-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: ***DataTable*.Rows[*index*]["*columnName*"]**. The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index. A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: ***DataTable*.Rows[*index*].*columnName***.</span></span>

<span data-ttu-id="47728-179">Türü kesin belirlenmiş nesnelerin döndürmek için geliştiricilerin kendi özel iş nesneleri oluşturmak veya yazılan veri kümeleri kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-179">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="47728-180">Özellikleri genellikle iş nesnesi temel alınan veritabanı tablosunun sütunları yansıtacak bir sınıfı temsil eder gibi bir iş nesnesi geliştirici tarafından uygulanır.</span><span class="sxs-lookup"><span data-stu-id="47728-180">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="47728-181">Yazılan veri kümesi, sizin için bir veritabanı şeması ve kesin türü belirtilmiş-bu şemaya göre üyeleri göre Visual Studio tarafından oluşturulan bir sınıftır.</span><span class="sxs-lookup"><span data-stu-id="47728-181">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="47728-182">Yazılan veri kümesi kendisini ADO.NET veri kümesi, DataTable ve DataRow sınıfları genişleten sınıflardan oluşur.</span><span class="sxs-lookup"><span data-stu-id="47728-182">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="47728-183">Kesin türü belirtilmiş DataTables ek olarak yazılan veri kümeleri artık ayrıca veri kümesi'nin DataTables doldurma ve veritabanında yapılan değişikliklerin DataTables içinde geri yayılıyor yöntemleriyle sınıflardır TableAdapters içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-183">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="47728-184">Olumlu ve olumsuz özel iş nesnelerine karşı yazılan veri kümeleri kullanma hakkında daha fazla bilgi için bkz [veri katmanı bileşenleri tasarlama ve veri katmanlarını aracılığıyla geçirme](https://msdn.microsoft.com/en-us/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="47728-184">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/en-us/library/ms978496.aspx).</span></span>


<span data-ttu-id="47728-185">Kesin türü belirtilmiş veri kümeleri için bu öğreticileri mimarisi kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="47728-185">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="47728-186">Şekil 3 yazılan veri kümeleri kullanan bir uygulama farklı katmanları arasında iş akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="47728-186">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="47728-187">[![Tüm veri erişim kodu DAL ile sahip](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="47728-187">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="47728-188">**Şekil 3**: tüm veri erişim kodu DAL ile gönderilen ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="47728-188">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="47728-189">Türü belirtilmiş veri kümesi ve tablo bağdaştırıcısı oluşturma</span><span class="sxs-lookup"><span data-stu-id="47728-189">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="47728-190">Bizim DAL oluşturmaya başlamak için Projemizin için yazılmış bir veri kümesi ekleyerek başlatın.</span><span class="sxs-lookup"><span data-stu-id="47728-190">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="47728-191">Bunu başarmak için Çözüm Gezgini'nde proje düğümüne sağ tıklayın ve Yeni Öğe Ekle'yi seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-191">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="47728-192">Veri kümesi seçeneği şablonları listesinden seçin ve adlandırın **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="47728-192">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="47728-193">[![Yeni bir veri kümesi projenize eklemek için seçin](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="47728-193">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="47728-194">**Şekil 4**: yeni veri kümesi için projenize eklemek için seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="47728-194">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="47728-195">Ekle, veri kümesine eklemek için istendiğinde tıkladıktan sonra **uygulama\_kod** klasörü, Evet'i seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-195">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="47728-196">Yazılan veri kümesi Tasarımcısı sonra görüntülenir ve ilk TableAdapter yazılan veri kümesine eklemenize olanak sağlayan TableAdapter Yapılandırma Sihirbazı başlar.</span><span class="sxs-lookup"><span data-stu-id="47728-196">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="47728-197">Yazılan veri kümesi veri kesin türü belirtilmiş koleksiyonu olarak hizmet verir; her biri sırayla kesin türü belirtilmiş DataRow örneklerini oluşan kesin türü belirtilmiş DataTable örnekleri, oluşur.</span><span class="sxs-lookup"><span data-stu-id="47728-197">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="47728-198">Bu öğretici serisinde çalışmak için ihtiyacımız temel alınan veritabanı tabloların her biri için kesin türü belirtilmiş bir DataTable oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="47728-198">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="47728-199">DataTable için oluşturmayla başlayalım **ürünleri** tablo.</span><span class="sxs-lookup"><span data-stu-id="47728-199">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="47728-200">Kesin türü belirtilmiş DataTables kendi temel veritabanı tablodan veri erişim hakkında hiçbir bilgi içermez aklınızda bulundurun.</span><span class="sxs-lookup"><span data-stu-id="47728-200">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="47728-201">DataTable doldurmak için verileri almak için veri erişim katmanı işlevleri bir TableAdapter sınıf kullanırız.</span><span class="sxs-lookup"><span data-stu-id="47728-201">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="47728-202">İçin bizim **ürünleri** DataTable, TableAdapter yöntemleri içerecek **GetProducts()**,  **GetProductByCategoryID (*adlı kullanıcı, Categoryıd'si*) ** ve benzeri sunu katmanı çağıran.</span><span class="sxs-lookup"><span data-stu-id="47728-202">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="47728-203">DataTable nesnesinin katmanlar arasında veri iletmek için kullanılan türü kesin belirlenmiş nesnelerin olarak hizmet verecek rolüdür.</span><span class="sxs-lookup"><span data-stu-id="47728-203">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="47728-204">TableAdapter Yapılandırma Sihirbazı'nı çalışmak için hangi veritabanı seçmenizi isteyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="47728-204">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="47728-205">Aşağı açılan liste Server Explorer'da bu veritabanlarını gösterir.</span><span class="sxs-lookup"><span data-stu-id="47728-205">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="47728-206">Sunucu Gezgini Northwind veritabanı eklemediyseniz, bunu yapmak için şu anda yeni bağlantı düğmeyi tıklatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-206">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="47728-207">[![Northwind veritabanı aşağı açılan listeden seçin](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="47728-207">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="47728-208">**Şekil 5**: Northwind veritabanı aşağı açılan listeden seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="47728-208">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="47728-209">Veritabanını seçtikten sonra İleri'yi tıklatmadan, bağlantı dizesinde kaydetmek isteyip istemediğiniz sorulur **Web.config** dosya.</span><span class="sxs-lookup"><span data-stu-id="47728-209">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="47728-210">Bağlantı dizesi kaydederek, sabit bir bağlantı dizesi bilgisi gelecekte değişirse, şeyler basitleştirir TableAdapter sınıflarda kodlanmış sahip kaçının.</span><span class="sxs-lookup"><span data-stu-id="47728-210">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="47728-211">Yapılandırma dosyasında bağlantı dizesini kaydetmeyi seçerseniz, yerleştirilir  **&lt;connectionStrings&gt;**  olabilir bölüm [isteğe bağlı olarak şifrelenmiş](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) geliştirilmiş için Güvenlik ya da yöneticiler için daha uygundur IIS GUI yönetim aracı içinde yeni ASP.NET 2.0 özellik sayfası aracılığıyla daha sonra değiştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="47728-211">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="47728-212">[![Bağlantı dizesi Web.config dosyasına kaydedin](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="47728-212">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="47728-213">**Şekil 6**: bağlantı dizesini Kaydet **Web.config** ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="47728-213">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="47728-214">Ardından, kesin türü belirtilmiş veri kümesini doldururken kullanmak bizim TableAdapter için ilk yöntem sunar ve ilk kesin türü belirtilmiş DataTable için şema tanımlamak ihtiyacımız.</span><span class="sxs-lookup"><span data-stu-id="47728-214">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="47728-215">Bu iki adımı aynı anda bizim DataTable yansıtılan istiyoruz tablosundan sütunların döndüren bir sorgu oluşturarak yapılır.</span><span class="sxs-lookup"><span data-stu-id="47728-215">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="47728-216">Sihirbazın sonunda Biz bu sorgu için bir yöntem adı verin.</span><span class="sxs-lookup"><span data-stu-id="47728-216">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="47728-217">Bu yöntem, elde edilir sonra bizim sunu katmanı çağrılabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-217">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="47728-218">Yöntemi, tanımlı sorguyu yürütmek ve kesin türü belirtilmiş bir DataTable doldurabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-218">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="47728-219">SQL sorgusu tanımlama başlamak için biz öncelikle TableAdapter sorgu sorunu nasıl istiyoruz belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-219">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="47728-220">Biz geçici SQL deyimini kullanın, yeni bir saklı yordam oluşturun veya varolan bir saklı yordamı kullanın.</span><span class="sxs-lookup"><span data-stu-id="47728-220">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="47728-221">Geçici SQL deyimleri bu öğreticileri için kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="47728-221">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="47728-222">Başvurmak [Brian Noyes](http://briannoyes.net/)kullanıcının makalesi, [Visual Studio 2005 veri kümesi Tasarımcısı ile veri erişim katmanı yapı](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) saklı yordamları kullanma örneği için.</span><span class="sxs-lookup"><span data-stu-id="47728-222">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="47728-223">[![Geçici SQL deyimi kullanarak verileri Sorgulama](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="47728-223">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="47728-224">**Şekil 7**: geçici SQL deyimi kullanarak verileri Sorgulama ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="47728-224">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="47728-225">Bu noktada SQL sorgusunda el ile yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-225">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="47728-226">İlk yöntem TableAdapter içinde oluştururken, genellikle karşılık gelen DataTable ifade edilmesi gerekir bu sütunları döndürüldüğü bir sorgu istiyorsanız.</span><span class="sxs-lookup"><span data-stu-id="47728-226">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="47728-227">Biz tüm sütunları ve bulunan tüm satırlar döndüren bir sorgu oluşturarak gerçekleştirebilir **ürünleri** tablosu:</span><span class="sxs-lookup"><span data-stu-id="47728-227">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="47728-228">[![SQL sorgusu metin kutusuna girin](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="47728-228">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="47728-229">**Şekil 8**: SQL sorgusu içine metin kutusuna girin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="47728-229">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="47728-230">Alternatif olarak, Sorgu Oluşturucu'yu kullanın ve grafik sorgu Şekil 9'da gösterildiği gibi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="47728-230">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="47728-231">[![Sorgu grafik, sorgu Düzenleyicisi'ni kullanarak oluşturma](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="47728-231">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="47728-232">**Şekil 9**: Sorgu grafik, sorgu Düzenleyicisi aracılığıyla oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="47728-232">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="47728-233">Sorguyu oluşturduktan sonra ancak sonraki ekrana geçmeden önce Gelişmiş Seçenekler düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="47728-233">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="47728-234">Web sitesi projelerinde "Generate INSERT, Update ve Delete deyimlerinde" yalnızca Gelişmiş seçeneği varsayılan olarak seçili olan; bir sınıf kitaplığı ya da Windows projesi bu sihirbazı çalıştırırsanız "iyimser eşzamanlılık kullan" seçeneğini da seçilir.</span><span class="sxs-lookup"><span data-stu-id="47728-234">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="47728-235">Şu an için "iyimser eşzamanlılık kullan" seçeneğinin işaretini kaldırın.</span><span class="sxs-lookup"><span data-stu-id="47728-235">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="47728-236">Sonraki öğreticilerde biz iyimser eşzamanlılık inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="47728-236">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="47728-237">[![Yalnızca Generate INSERT, Update ve Delete deyimleri seçeneği seçin](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="47728-237">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="47728-238">**Şekil 10**: yalnızca Generate INSERT, Update ve Delete deyimleri seçeneği seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="47728-238">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="47728-239">Gelişmiş Seçenekleri doğruladıktan sonra son ekran devam etmek için İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="47728-239">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="47728-240">Burada size TableAdapter eklemek için hangi yöntemlerin seçmeniz istenir.</span><span class="sxs-lookup"><span data-stu-id="47728-240">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="47728-241">Veri doldurmak için iki modeli vardır:</span><span class="sxs-lookup"><span data-stu-id="47728-241">There are two patterns for populating data:</span></span>

- <span data-ttu-id="47728-242">**DataTable dolgu** bir parametre olarak bir DataTable tablosundaki alır ve bunu doldurduğundan bir yöntem oluşturulur bu yaklaşımda sorgu sonuçlarına dayalı.</span><span class="sxs-lookup"><span data-stu-id="47728-242">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="47728-243">ADO.NET DataAdapter sınıfı, örneğin, bu deseni uygular, **Fill()** yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-243">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="47728-244">**DataTable dönmek** bu yaklaşımı yöntemi oluşturur ve sizin için DataTable doldurur ve yöntemleri dönüş değeri olarak döndürür.</span><span class="sxs-lookup"><span data-stu-id="47728-244">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="47728-245">Birini veya her ikisini bu desenleri uygulamak TableAdapter olabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-245">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="47728-246">Burada sağlanan yöntemleri de yeniden adlandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-246">You can also rename the methods provided here.</span></span> <span data-ttu-id="47728-247">Şimdi biz yalnızca bu öğreticileri boyunca ikinci düzeni kullanmaya başlayacağınız olsa bile iki onay kutusunun işaretli bırakın.</span><span class="sxs-lookup"><span data-stu-id="47728-247">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="47728-248">Ayrıca, şirketinizdeki yerine genel yeniden adlandırma **GetData** yönteme **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="47728-248">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="47728-249">"GenerateDBDirectMethods," son onay kutusu işaretli değilse oluşturur **INSERT()**, **Update()**, ve **Delete()** TableAdapter için yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="47728-249">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="47728-250">Bu seçeneği işaretlemeden bırakın, tüm güncelleştirmeler TableAdapter'ın tek yapılması gerekir **Update()** yazılan veri kümesi, bir DataTable, tek bir DataRow satırının veya DataRow dizisini alır yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-250">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="47728-251">(Seçtiğiniz varsa denetlenmeyen "Generate INSERT, Update ve Delete deyimleri" Bu checkbox'ın gelişmiş özelliklerinden Şekil 9'daki seçeneği ayarı herhangi bir etkisi olacaktır.) Şimdi bu onay kutusu seçili bırakın.</span><span class="sxs-lookup"><span data-stu-id="47728-251">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="47728-252">[![GetData için yöntem adını GetProducts değiştirin](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="47728-252">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="47728-253">**Şekil 11**: yöntem adını değiştirmek **GetData** için **GetProducts** ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="47728-253">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="47728-254">Son'u tıklatarak Sihirbazı tamamlayın.</span><span class="sxs-lookup"><span data-stu-id="47728-254">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="47728-255">Sihirbaz kapandıktan sonra size yeni oluşturduğumuz DataTable gösteren veri kümesi Tasarımcısı döndürülür.</span><span class="sxs-lookup"><span data-stu-id="47728-255">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="47728-256">Sütunlarda listesini görebilir **ürünleri** DataTable (**ProductID**, **ProductName**, vb.), yöntemlerinin yanı sıra  **Düzenleyen** (**Fill()** ve **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="47728-256">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="47728-257">[![Yazılan veri kümesine düzenleyen ve ürünleri DataTable eklendi](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="47728-257">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="47728-258">**Şekil 12**: **ürünleri** DataTable ve **düzenleyen** yazılan veri kümesi için eklenene ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="47728-258">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="47728-259">Bu noktada tek DataTable ile yazılmış bir veri kümesi sahibiz (**Northwind.Products**) ve kesin türü belirtilmiş bir DataAdapter sınıfı (**NorthwindTableAdapters.ProductsTableAdapter**) ile bir  **GetProducts()** yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-259">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="47728-260">Bu nesneler, kod gibi tüm ürünlerin listesini erişmek için kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="47728-260">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="47728-261">Bu kod bize bir bit veri erişim özgü kod yazmaya gerektirmiyordu.</span><span class="sxs-lookup"><span data-stu-id="47728-261">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="47728-262">Biz herhangi ADO.NET sınıflarını örneği yok, herhangi bir bağlantı dizesi için SQL sorguları başvurmak olmadığına veya saklı yordamlar.</span><span class="sxs-lookup"><span data-stu-id="47728-262">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="47728-263">Bunun yerine, TableAdapter alt düzey veri erişim kodu bize sağlar.</span><span class="sxs-lookup"><span data-stu-id="47728-263">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="47728-264">Bu örnekte kullanılan her de güçlü IntelliSense ve derleme zamanı tür denetimi sağlamak Visual Studio izin vererek yazılmış, nesnesidir.</span><span class="sxs-lookup"><span data-stu-id="47728-264">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="47728-265">Ve TableAdapter tarafından döndürülen tüm DataTables en iyi GridView, DetailsView, DropDownList, CheckBoxList ve diğerleri birçok gibi Web denetimleri ASP.NET verilere bağlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-265">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="47728-266">Aşağıdaki örnek tarafından döndürülen DataTable bağlama gösterilmektedir **GetProducts()** satırlardaki yalnızca bir scant üç kod içinde GridView yönteme **sayfa\_yük** olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="47728-266">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="47728-267">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="47728-267">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="47728-268">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="47728-268">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="47728-269">[![Ürünleri listeler bir GridView görüntülenir](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="47728-269">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="47728-270">**Şekil 13**: ürünleri listeler, bir GridView görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="47728-270">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="47728-271">Bu örnek şu üç kod satırı bizim ASP.NET sayfa yazma gerekirken **sayfa\_yük** olay işleyicisi, gelecekte inceleyeceğiz ObjectDataSource bildirimli olarak verileri almak için nasıl kullanılacağını öğreticileri DAL.</span><span class="sxs-lookup"><span data-stu-id="47728-271">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="47728-272">ObjectDataSource ile herhangi bir kod yazmak zorunda kalırsınız değil ve disk belleği ve sıralama desteği de alırsınız!</span><span class="sxs-lookup"><span data-stu-id="47728-272">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="47728-273">3. adım: Parametreli veri erişim katmanı yöntemlere ekleme</span><span class="sxs-lookup"><span data-stu-id="47728-273">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="47728-274">Bu noktada bizim **düzenleyen** sınıfına sahip bir yöntem **GetProducts()**, döndüğü tüm ürünleri veritabanında.</span><span class="sxs-lookup"><span data-stu-id="47728-274">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="47728-275">Tüm ürünleri ile çalışmak için kesinlikle yararlı olsa da, biz belirli bir ürün veya belirli bir kategoriye ait tüm ürünleri hakkında bilgi almak için ne zaman isteyeceksiniz zamanlar vardır.</span><span class="sxs-lookup"><span data-stu-id="47728-275">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="47728-276">Bu tür işlevler bizim veri erişim katmanı eklemek için şu parametreli yöntemleri TableAdapter ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-276">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="47728-277">Ekleyelim  **GetProductsByCategoryID (*adlı kullanıcı, Categoryıd'si*) ** yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-277">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="47728-278">DAL, veri kümesi Tasarımcısı için dönüş yeni bir yöntem eklemek için sağ **düzenleyen** bölümünde ve Sorgu Ekle'ı seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-278">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![TableAdapter üzerinde sağ tıklayın ve sorgu ekleme](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="47728-280">**Şekil 14**: TableAdapter üzerinde sağ tıklayın ve sorgu ekleme</span><span class="sxs-lookup"><span data-stu-id="47728-280">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="47728-281">Biz öncelikle olup olmadığını biz geçici SQL deyimi ya da yeni veya varolan bir saklı yordamı kullanarak veritabanına erişmek istemediğiniz sorulur.</span><span class="sxs-lookup"><span data-stu-id="47728-281">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="47728-282">Geçici SQL deyimi yeniden kullanmak için şimdi seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-282">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="47728-283">Ardından, ne tür bir SQL sorgusu biz kullanmak istediğiniz sorulur.</span><span class="sxs-lookup"><span data-stu-id="47728-283">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="47728-284">Belirtilen bir kategoriye ait tüm ürünleri döndürülecek istiyoruz olduğundan, biz yazmak istediğiniz bir **seçin** satırlar döndüren bir ifade.</span><span class="sxs-lookup"><span data-stu-id="47728-284">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="47728-285">[![Satırlar döndüren bir SELECT deyimi oluşturmak için seçin](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="47728-285">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="47728-286">**Şekil 15**: Create seçin bir **seçin** deyimi döndürür satırlarını ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="47728-286">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="47728-287">Sonraki adım, verilere erişmek için kullanılan SQL sorgusu tanımlamaktır.</span><span class="sxs-lookup"><span data-stu-id="47728-287">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="47728-288">Belirli bir kategoriye ait ürünleri döndürülecek istiyoruz olduğundan, aynı kullanmam **seçin** from deyimi **GetProducts()**, ancak aşağıdaki ekleyin **burada** yan tümcesi: **burada adlı kullanıcı, Categoryıd'si = @CategoryID** .</span><span class="sxs-lookup"><span data-stu-id="47728-288">Since we want to return only those products that belong to a particular category, I use the same **SELECT** statement from **GetProducts()**, but add the following **WHERE** clause: **WHERE CategoryID = @CategoryID**.</span></span> <span data-ttu-id="47728-289"> **@CategoryID**  Parametresi TableAdapter sihirbazın oluşturma yöntemi (yani, boş değer atanabilir bir tamsayı) karşılık gelen türünde bir giriş parametresi gerektiğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="47728-289">The **@CategoryID** parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="47728-290">[![Yalnızca belirtilen bir kategorideki ürünleri döndürmek için bir sorgu girin](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="47728-290">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="47728-291">**Şekil 16**: yalnızca dönüş ürünlere belirtilen bir kategorideki bir sorgu girin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="47728-291">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="47728-292">Hangi veri yanı sıra kullanmak için oluşturulan yöntemler adlarını özelleştirin desenleri erişim seçeneğini belirledik son adımı.</span><span class="sxs-lookup"><span data-stu-id="47728-292">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="47728-293">Dolgu deseni için adına değiştirelim **FillByCategoryID** ve dönüş için bir DataTable dönmek deseni (  **almak*X*** yöntemleri), kullanalım  **GetProductsByCategoryID**.</span><span class="sxs-lookup"><span data-stu-id="47728-293">For the Fill pattern, let's change the name to **FillByCategoryID** and for the return a DataTable return pattern (the **Get*X*** methods), let's use **GetProductsByCategoryID**.</span></span>


<span data-ttu-id="47728-294">[![TableAdapter yöntemleri için adlar seçin](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="47728-294">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="47728-295">**Şekil 17**: TableAdapter yöntemleri için adlar seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="47728-295">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="47728-296">Sihirbazı tamamladıktan sonra veri kümesi Tasarımcısı yeni TableAdapter yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-296">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Kategoriye göre ürünler olabilir şimdi sorgulanamadı](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="47728-298">**Şekil 18**: ürünleri olabilir şimdi izin ver sorgulanan kategoriye göre</span><span class="sxs-lookup"><span data-stu-id="47728-298">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="47728-299">Eklemek için bir dakikanızı ayırın bir  **GetProductByProductID (*ProductID*) ** teknikle yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-299">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="47728-300">Bu parametreli sorgular doğrudan veri kümesi Tasarımcısı'ndan sınanabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-300">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="47728-301">TableAdapter yönteminde sağ tıklayın ve önizleme verileri seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-301">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="47728-302">Ardından, Önizleme'yi tıklatın ve parametrelerini kullanmak için değerleri girin.</span><span class="sxs-lookup"><span data-stu-id="47728-302">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="47728-303">[![Bu ürünler ait İçecekler kategorisini gösterilir](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="47728-303">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="47728-304">**Şekil 19**: olanlar İçecekler kategorisini ürünleri ait gösterilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="47728-304">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="47728-305">İle  **GetProductsByCategoryID (*adlı kullanıcı, Categoryıd'si*) ** bizim DAL yönteminde, biz şimdi oluşturabilir, belirtilen bir kategorideki yalnızca ürünleri görüntüler ASP.NET sayfası.</span><span class="sxs-lookup"><span data-stu-id="47728-305">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="47728-306">Aşağıdaki örnek olan, Meşrubat kategorideki tüm ürünleri gösterir bir **adlı kullanıcı, Categoryıd'si** 1.</span><span class="sxs-lookup"><span data-stu-id="47728-306">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="47728-307">Beverages.asp</span><span class="sxs-lookup"><span data-stu-id="47728-307">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="47728-308">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="47728-308">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="47728-309">[![Bu ürünlerden Meşrubat kategorisinde görüntülenir](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="47728-309">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="47728-310">**Şekil 20**: olanlar İçecekler kategorisini ürünlerinde görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="47728-310">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="47728-311">4. adım: Ekleme, güncelleştirme ve verileri silme</span><span class="sxs-lookup"><span data-stu-id="47728-311">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="47728-312">Ekleme, güncelleştirme ve verileri silme için yaygın olarak kullanılan iki modeli vardır.</span><span class="sxs-lookup"><span data-stu-id="47728-312">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="47728-313">Veritabanını doğrudan düzeni çağrısı, ilk desen yöntemleri, çağrıldığında, oluşturursunuz sorunu bir **Ekle**, **güncelleştirme**, veya **silmek** komutu tek veritabanı kaydını üzerinde çalışır veritabanı.</span><span class="sxs-lookup"><span data-stu-id="47728-313">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="47728-314">Bu tür yöntemleri genellikle karşılık skaler değerler (tamsayı, dize, Boole değerlerini, tarih/saat ve benzeri) bir dizi eklemek, güncelleştirmek veya silmek için değerleri geçirildi.</span><span class="sxs-lookup"><span data-stu-id="47728-314">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="47728-315">Örneğin, için bu deseni ile **ürünleri** tablo delete yöntemini bir tamsayı parametresinde olması belirten **ProductID** INSERT yöntemi götürecek sırada silinecek kaydının bir dize **ProductName**, için ondalık **UnitPrice**, tamsayı **UnitsOnStock**ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="47728-315">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="47728-316">[![Her bir INSERT, Update ve Delete isteği veritabanı anında gönderilir](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="47728-316">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="47728-317">**Şekil 21**: her INSERT, Update ve Delete isteği gönderilir veritabanı anında ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="47728-317">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="47728-318">Bir tüm veri kümesi, DataTable ya da bir yöntem çağrısı DataRow koleksiyonunda düzeni toplu güncelleştirme bakın, diğer bütün düzeni güncelleştirmektir.</span><span class="sxs-lookup"><span data-stu-id="47728-318">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="47728-319">Bu desen ile bir geliştirici siler, ekler ve bir DataTable tablosundaki DataRow değiştirir ve sonra bu DataRow ya da DataTable bir güncelleştirme yöntemi geçirir.</span><span class="sxs-lookup"><span data-stu-id="47728-319">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="47728-320">Bu yöntem ardından geçirilen DataRow numaralandırır, bunlar değiştiren, eklenen veya silinen olup olmadığını belirler (DataRow nesnesinin aracılığıyla [RowState özelliği](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) değeri) ve her kayıt için uygun veritabanı isteği gönderir.</span><span class="sxs-lookup"><span data-stu-id="47728-320">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="47728-321">[![Update yöntemi çağrıldığında tüm değişiklikler veritabanı ile eşitlenir](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="47728-321">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="47728-322">**Şekil 22**: tüm değişiklikler, veritabanı ile eşitlenir, güncelleştirme yöntemi çağrıldığında ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="47728-322">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="47728-323">TableAdapter varsayılan olarak toplu güncelleştirme deseni kullanır, ancak ayrıca DB doğrudan düzenini destekler.</span><span class="sxs-lookup"><span data-stu-id="47728-323">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="47728-324">Biz "Generate INSERT, Update ve Delete deyimlerinde" Gelişmiş özelliklerinden bizim TableAdapter oluştururken seçeneği bu yana **düzenleyen** içeren bir **Update()** yöntemi hangi toplu güncelleştirme deseni uygular.</span><span class="sxs-lookup"><span data-stu-id="47728-324">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="47728-325">Özellikle, TableAdapter içeren bir **Update()** yazılan veri kümesi, kesin türü belirtilmiş bir DataTable ya da bir veya daha fazla DataRow geçirilen yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-325">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="47728-326">Bırakılırsa ne zaman ilk DB doğrudan deseni TableAdapter oluşturma da aracılığıyla uygulanacak "GenerateDBDirectMethods" onay kutusunu işaretli **INSERT()**, **Update()**, ve **Delete()**  yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="47728-326">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="47728-327">TableAdapter'ın her iki veri değişikliği modelleri kullanmanıza **InsertCommand**, **UpdateCommand**, ve **DeleteCommand** vermek için özellikler kendi **Ekle** , **Güncelleştirme**, ve **silmek** veritabanına komutları.</span><span class="sxs-lookup"><span data-stu-id="47728-327">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="47728-328">İncelemek ve değiştirmek **InsertCommand**, **UpdateCommand**, ve **DeleteCommand** veri kümesi Tasarımcısı'nda TableAdapter tıklayarak ve ardından giderek özellikleri Özellikler penceresi için.</span><span class="sxs-lookup"><span data-stu-id="47728-328">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="47728-329">(TableAdapter ve seçili olduğundan emin olun **düzenleyen** Özellikleri penceresinde açılır listesinden seçilen bir nesnedir.)</span><span class="sxs-lookup"><span data-stu-id="47728-329">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="47728-330">[![TableAdapter InsertCommand, UpdateCommand ve DeleteCommand özellikleri vardır](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="47728-330">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="47728-331">**Şekil 23**: TableAdapter sahip **InsertCommand**, **UpdateCommand**, ve **DeleteCommand** özellikleri ([görüntülemek için tıklatın tam boyutlu görüntüyü](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="47728-331">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="47728-332">İnceleyin veya bu veritabanı komut özelliklerden herhangi birini değiştirmek için tıklayın **CommandText** Sorgu Oluşturucu Kurulumu getirecek alt.</span><span class="sxs-lookup"><span data-stu-id="47728-332">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="47728-333">[![INSERT, UPDATE ve DELETE deyimleri Sorgu Oluşturucu'da yapılandırma](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="47728-333">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="47728-334">**Şekil 24**: yapılandırmak **Ekle**, **güncelleştirme**, ve **silmek** Sorgu Oluşturucusu deyimlerinde ([tam boyutlu görüntüyü görüntülemek için tıklatın ](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="47728-334">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="47728-335">Aşağıdaki kod örneğinde toplu güncelleştirme düzeni değil üretilmeyen ve stok veya daha az 25 birimleri olan tüm ürünleri fiyat çift için nasıl kullanılacağını gösterir:</span><span class="sxs-lookup"><span data-stu-id="47728-335">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="47728-336">Aşağıdaki kod, program aracılığıyla belirli bir ürünü silin, sonra bir güncelleştirme için DB doğrudan düzeni kullanın ve yeni bir tane eklemek verilmektedir:</span><span class="sxs-lookup"><span data-stu-id="47728-336">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="47728-337">Oluşturma özel INSERT, Update ve Delete yöntemleri</span><span class="sxs-lookup"><span data-stu-id="47728-337">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="47728-338">**INSERT()**, **Update()**, ve **Delete()** DB doğrudan yöntemi tarafından oluşturulan yöntemler özellikle fazla sayıda sütun sahip tablolar için biraz sıkıcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="47728-338">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="47728-339">Önceki kod örneğinde, ne özellikle NET değil IntelliSense'nın Yardım olmadan arayan **ürünleri** her giriş parametresi olarak tablo sütunu eşlendiğini **Update()** ve **INSERT()**  yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="47728-339">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="47728-340">Biz yalnızca istediğinizde tek bir sütun veya iki güncelleştirmek veya özelleştirilmiş istediğiniz zamanlar olabilir **INSERT()** olur, belki de yöntemi dönüş yeni eklenen kaydın değeri **kimlik** (otomatik artım) alan.</span><span class="sxs-lookup"><span data-stu-id="47728-340">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="47728-341">Özel bir yöntem oluşturmak için veri kümesi Tasarımcısı döndür.</span><span class="sxs-lookup"><span data-stu-id="47728-341">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="47728-342">TableAdapter üzerinde sağ tıklayın ve TableAdapter sihirbazın döndüren sorgu Ekle'ı seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-342">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="47728-343">İkinci ekranda biz oluşturmak için sorgu türünü belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-343">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="47728-344">Yeni bir ürün ekler ve yeni eklenen kaydın değerini döndüren bir yöntem oluşturalım **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="47728-344">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="47728-345">Bu nedenle, oluşturmak için kabul bir **Ekle** sorgu.</span><span class="sxs-lookup"><span data-stu-id="47728-345">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="47728-346">[![Ürünler tablosuna yeni bir satır eklemek için bir yöntem oluşturma](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="47728-346">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="47728-347">**Şekil 25**: yeni satır eklemek için bir yöntem oluşturma **ürünleri** tablosu ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="47728-347">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="47728-348">Sonraki ekranda **InsertCommand**'s **CommandText** görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="47728-348">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="47728-349">Bu sorgu ekleyerek büyütmek **kapsam seçin\_IDENTITY()** sorgu sonunda, eklenen son kimlik değeri döndürecektir bir **kimlik** aynı kapsamda sütun.</span><span class="sxs-lookup"><span data-stu-id="47728-349">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="47728-350">(Bkz [teknik belgeler](https://msdn.microsoft.com/en-us/library/ms190315.aspx) hakkında daha fazla bilgi için **kapsam\_IDENTITY()** ve büyük olasılıkla istediğiniz neden [kapsamı kullan\_yerine IDENTITY() @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Bitirdiğinizden emin olun **Ekle** eklemeden önce deyimi noktalı virgül ile **seçin** deyimi.</span><span class="sxs-lookup"><span data-stu-id="47728-350">(See the [technical documentation](https://msdn.microsoft.com/en-us/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="47728-351">[![SCOPE_IDENTITY() değerini döndürmek için sorgu büyütmek](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="47728-351">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="47728-352">**Şekil 26**: Return sorguya büyütmek **kapsam\_IDENTITY()** değeri ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="47728-352">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="47728-353">Son olarak, yeni yöntem adı **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="47728-353">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="47728-354">[![Yeni yöntem adı InsertProduct için ayarlama](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="47728-354">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="47728-355">**Şekil 27**: yeni yöntem adı ayarlamak **InsertProduct** ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="47728-355">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="47728-356">Göreceksiniz veri kümesi Tasarımcısı döndüğünüzde **düzenleyen** yeni bir yöntem içerir **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="47728-356">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="47728-357">Bu yeni yöntemi her sütun için bir parametre yoksa **ürünleri** tablo olasılığı olan unuttunuz sonlandırmak **Ekle** deyimi noktalı virgül ile.</span><span class="sxs-lookup"><span data-stu-id="47728-357">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="47728-358">Yapılandırma **InsertProduct** yöntemi ve bir noktalı virgül sınırlandırma olduğundan emin olun **Ekle** ve **seçin** deyimleri.</span><span class="sxs-lookup"><span data-stu-id="47728-358">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="47728-359">Varsayılan olarak, etkilenen satırların sayısı döndürmeleri anlamına gelir, yöntemleri sorunu sorgu olmayan yöntemleri ekleyin.</span><span class="sxs-lookup"><span data-stu-id="47728-359">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="47728-360">Ancak, istiyoruz **InsertProduct** etkilenen satırların sayısını değil sorgu tarafından döndürülen değer döndürmek için yöntem.</span><span class="sxs-lookup"><span data-stu-id="47728-360">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="47728-361">Bunu gerçekleştirmek için ayarlamak **InsertProduct** yöntemin **ExecuteMode** özelliğine **skaler**.</span><span class="sxs-lookup"><span data-stu-id="47728-361">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="47728-362">[![Skaler için ExecuteMode özelliğini değiştirin](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="47728-362">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="47728-363">**Şekil 28**: değişiklik **ExecuteMode** özelliğine **skaler** ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="47728-363">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="47728-364">Aşağıdaki kodda gösterildiği bu yeni **InsertProduct** eylem yönteminde:</span><span class="sxs-lookup"><span data-stu-id="47728-364">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="47728-365">5. adım: veri erişim katmanı Tamamlanıyor</span><span class="sxs-lookup"><span data-stu-id="47728-365">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="47728-366">Unutmayın **ProductsTableAdapters** sınıf döndürür **adlı kullanıcı, Categoryıd'si** ve **SupplierID** gelen değerleri **ürünleri** tablo, ancak içermeyen **CategoryName** sütundan **kategorileri** tablo veya **ŞirketAdı** sütundan **Üreticiler**bu büyük olasılıkla istiyoruz ürün bilgileri gösterilirken görüntülenecek sütunları olsa da, tablo.</span><span class="sxs-lookup"><span data-stu-id="47728-366">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="47728-367">TableAdapter'ın ilk yöntemi büyütmek **GetProducts()**, her ikisi de dahil etmek için **CategoryName** ve **ŞirketAdı** güncelleştirecek sütun değerleri Bu da yeni sütunlar eklenecek DataTable kesin türü belirtilmiş.</span><span class="sxs-lookup"><span data-stu-id="47728-367">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="47728-368">Bu bir sorun ancak olarak TableAdapter'ın yöntemleri ekleme, güncelleştirme, oluşturabilir ve silme veri dışına ilk bu yöntem temel alır.</span><span class="sxs-lookup"><span data-stu-id="47728-368">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="47728-369">Ekleme, güncelleştirme ve silme için Neyse ki, otomatik olarak oluşturulan yöntemleri alt sorgularda etkilenen **seçin** yan tümcesi.</span><span class="sxs-lookup"><span data-stu-id="47728-369">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="47728-370">Bizim sorguları ekleme dikkat ederek tarafından **kategorileri** ve **Üreticiler** alt sorgular, olarak yerine **katılma** s, ki kaçının verileri değiştirmek için bu yöntemleri rework zorunda.</span><span class="sxs-lookup"><span data-stu-id="47728-370">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="47728-371">Sağ **GetProducts()** yönteminde **düzenleyen** ve Yapılandır'ı seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-371">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="47728-372">Daha sonra ayarlamak **seçin** yan tümcesi görünüyor. böylece ister:</span><span class="sxs-lookup"><span data-stu-id="47728-372">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="47728-373">[![SELECT deyimi güncelleştirmesi GetProducts() yöntemi](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="47728-373">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="47728-374">**Şekil 29**: güncelleştirme **seçin** bildirimi **GetProducts()** yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="47728-374">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="47728-375">Güncelleştirdikten sonra **GetProducts()** DataTable, iki yeni sütun içereceği bu yeni bir sorgu kullanılacak yöntemi: **CategoryName** ve **üretici**.</span><span class="sxs-lookup"><span data-stu-id="47728-375">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![Ürünler DataTable iki yeni sütun var.](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="47728-377">**Şekil 30**: **ürünleri** DataTable iki yeni sütun var.</span><span class="sxs-lookup"><span data-stu-id="47728-377">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="47728-378">Güncelleştirme için bir dakikanızı ayırın **seçin** yan tümcesinde  **GetProductsByCategoryID (*adlı kullanıcı, Categoryıd'si*) ** de yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-378">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="47728-379">Güncelleştirmezseniz **GetProducts()** **seçin** kullanarak **katılma** sözdizimi veri kümesi Tasarımcısı edemez ekleme, güncelleştirme ve silme yöntemleri otomatik olarak oluşturmak DB kullanılarak veritabanı veri düzeni doğrudan.</span><span class="sxs-lookup"><span data-stu-id="47728-379">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="47728-380">Bunun yerine, ile yaptığımız gibi el ile çok oluşturmanız gerekecek **InsertProduct** bu öğreticideki yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-380">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="47728-381">Ayrıca, el ile sağlamak zorunda kalırsınız **InsertCommand**, **UpdateCommand**, ve **DeleteCommand** özellik değerlerinin düzeni güncelleştirme toplu kullanmak istiyorsanız.</span><span class="sxs-lookup"><span data-stu-id="47728-381">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="47728-382">Kalan TableAdapters ekleme</span><span class="sxs-lookup"><span data-stu-id="47728-382">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="47728-383">Şimdiye kadar biz yalnızca bir tek veritabanı tablosu için tek bir TableAdapter ile çalışma sırasında inceledik.</span><span class="sxs-lookup"><span data-stu-id="47728-383">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="47728-384">Ancak, Northwind veritabanı çalışmak için web uygulamamızı ihtiyacımız birkaç ilişkili tabloları içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-384">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="47728-385">DataTables ilgili yazılmış bir veri kümesi birden çok içerebilir.</span><span class="sxs-lookup"><span data-stu-id="47728-385">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="47728-386">Bu nedenle, bizim DAL tamamlamak için size DataTables Biz bu öğreticileri kullanmaya başlayacağınız diğer tablolar için eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-386">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="47728-387">Yeni bir TableAdapter yazılmış bir veri kümesine eklemek için veri kümesi Tasarımcısı'nı açın, Tasarımcısı'nda sağ tıklayın ve Ekle'yi seçin / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="47728-387">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="47728-388">Bu, yeni bir DataTable ve TableAdapter oluşturma ve biz Bu öğreticide daha önce incelenmesi Sihirbazı size yol.</span><span class="sxs-lookup"><span data-stu-id="47728-388">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="47728-389">Aşağıdaki TableAdapters ve aşağıdaki sorguları kullanarak yöntemleri oluşturmak için birkaç dakika sürebilir.</span><span class="sxs-lookup"><span data-stu-id="47728-389">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="47728-390">Unutmayın sorgularda **düzenleyen** her ürünün kategori ve sağlayıcı adları şablonlarınızdan alt sorgular içerir.</span><span class="sxs-lookup"><span data-stu-id="47728-390">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="47728-391">Ayrıca, aşağıdaki, zaten eklediğiniz **düzenleyen** sınıfının **GetProducts()** ve  **GetProductsByCategoryID (*adlı kullanıcı, Categoryıd'si*) ** yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="47728-391">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="47728-392">**Düzenleyen**</span><span class="sxs-lookup"><span data-stu-id="47728-392">**ProductsTableAdapter**</span></span>

    - <span data-ttu-id="47728-393">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="47728-393">**GetProducts**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
    - <span data-ttu-id="47728-394">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="47728-394">**GetProductsByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
    - <span data-ttu-id="47728-395">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="47728-395">**GetProductsBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
    - <span data-ttu-id="47728-396">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="47728-396">**GetProductByProductID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="47728-397">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="47728-397">**CategoriesTableAdapter**</span></span>

    - <span data-ttu-id="47728-398">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="47728-398">**GetCategories**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
    - <span data-ttu-id="47728-399">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="47728-399">**GetCategoryByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="47728-400">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="47728-400">**SuppliersTableAdapter**</span></span>

    - <span data-ttu-id="47728-401">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="47728-401">**GetSuppliers**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
    - <span data-ttu-id="47728-402">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="47728-402">**GetSuppliersByCountry**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
    - <span data-ttu-id="47728-403">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="47728-403">**GetSupplierBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="47728-404">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="47728-404">**EmployeesTableAdapter**</span></span>

    - <span data-ttu-id="47728-405">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="47728-405">**GetEmployees**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
    - <span data-ttu-id="47728-406">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="47728-406">**GetEmployeesByManager**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
    - <span data-ttu-id="47728-407">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="47728-407">**GetEmployeeByEmployeeID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="47728-408">[![Dört TableAdapters ekledikten sonra veri kümesi Tasarımcısı](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="47728-408">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="47728-409">**Şekil 31**: veri kümesi Tasarımcısı sonra dört TableAdapters eklenmiştir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="47728-409">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="47728-410">DAL için özel kod ekleme</span><span class="sxs-lookup"><span data-stu-id="47728-410">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="47728-411">DataTables yazılan veri kümesine eklenir ve TableAdapters bir XML şema tanımı dosyası olarak ifade edilir (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="47728-411">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="47728-412">Üzerinde sağ tıklayarak bu şema bilgileri görüntüleyebilirsiniz **Northwind.xsd** dosya Çözüm Gezgini'nde ve Görünüm Kodu seçme.</span><span class="sxs-lookup"><span data-stu-id="47728-412">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="47728-413">[![Veri kümesi kategoriye için XML şema tanımı (XSD) dosyası belirtilmiş](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="47728-413">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="47728-414">**Şekil 32**: XML şema tanımı (XSD) dosya kategoriye yazılan veri kümesi için ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="47728-414">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="47728-415">Bu şema bilgileri derlendiğinde veya bu noktada, üzerinden hata ayıklayıcısını kullanmaya geçebilirsiniz (gerekirse) çalışma zamanında çalışma zamanında C# veya Visual Basic kodu çevrilir.</span><span class="sxs-lookup"><span data-stu-id="47728-415">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="47728-416">Görüntülemek için bu otomatik olarak oluşturulan kodu gidin sınıf görünümü ve ayrıntıya TableAdapter ya da yazılı DataSet sınıfları.</span><span class="sxs-lookup"><span data-stu-id="47728-416">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="47728-417">Sınıf Görünümü ekranınızdaki görmüyorsanız, Görünüm menüsüne gidin ve buradan seçin veya Ctrl + Shift + C ulaştı.</span><span class="sxs-lookup"><span data-stu-id="47728-417">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="47728-418">Sınıf görünümünden özellikleri, yöntemleri ve yazılan veri kümesi ve TableAdapter sınıflarının olayları görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="47728-418">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="47728-419">Belirli bir yöntem için kod görüntülemek üzere Sınıf Görünümü'nde yöntemi adına çift tıklayın veya üzerinde sağ tıklayın ve Tanıma Git seçin.</span><span class="sxs-lookup"><span data-stu-id="47728-419">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Git tanımına sınıfı görünümünden seçerek otomatik olarak oluşturulan kodu inceleyin.](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="47728-421">**Şekil 33**: Git tanımına sınıfı görünümünden seçerek otomatik olarak oluşturulan kodu inceleyin.</span><span class="sxs-lookup"><span data-stu-id="47728-421">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="47728-422">Otomatik olarak oluşturulan kodu harika zaman tasarrufu olabilirler, ancak kod genellikle çok geneldir ve bir uygulamanın benzersiz gereksinimlerini karşılamak için özelleştirilmiş olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="47728-422">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="47728-423">Otomatik olarak oluşturulan kodu genişletme rağmen oluşturulan kodda aracı "yeniden" ve özelleştirmelerinizi üzerine yazmak için zamanı göstermeyebilir riskidir.</span><span class="sxs-lookup"><span data-stu-id="47728-423">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="47728-424">.NET 2. 0'ın yeni parçalı sınıf konseptiyle, bir sınıfın birden çok dosyaya bölme kolaydır.</span><span class="sxs-lookup"><span data-stu-id="47728-424">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="47728-425">Bu bizim özelleştirmeleri üzerine Visual Studio hakkında endişelenmeye gerek kalmadan otomatik olarak oluşturulan sınıfları kendi yöntemleri, özellikleri ve olayları eklemek bize sağlar.</span><span class="sxs-lookup"><span data-stu-id="47728-425">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="47728-426">DAL özelleştirmek nasıl yapılacağını göstermek üzere ekleyelim bir **GetProducts()** yönteme **SuppliersRow** sınıfı.</span><span class="sxs-lookup"><span data-stu-id="47728-426">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="47728-427">**SuppliersRow** sınıfı temsil eder, tek bir kayıtta **Üreticiler** tablo; birçok ürün her tedarikçi can sağlayıcısına sıfır şekilde **GetProducts()** olanlar döndürür Belirtilen sağlayıcı ürünler.</span><span class="sxs-lookup"><span data-stu-id="47728-427">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="47728-428">Gerçekleştirmek için yeni bir sınıf dosyasında oluşturma **uygulama\_kod** adlı klasörü **SuppliersRow.cs** ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="47728-428">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="47728-429">Bu parçalı sınıf derleyiciye olduğunda oluşturma **Northwind.SuppliersRow** eklemek için sınıfı **GetProducts()** biz yalnızca tanımlanmış yöntemi.</span><span class="sxs-lookup"><span data-stu-id="47728-429">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="47728-430">Projenizi derleme ve sınıf görünümüne dönmek göreceğiniz **GetProducts()** bir yöntemi olarak listelenmiş **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="47728-430">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![Şimdi bir Northwind.SuppliersRow sınıfının GetProducts() yöntemi parçasıdır](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="47728-432">**Şekil 34**: **GetProducts()** yöntemdir şimdi parçası **Northwind.SuppliersRow** sınıfı</span><span class="sxs-lookup"><span data-stu-id="47728-432">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="47728-433">**GetProducts()** yöntemi şimdi ürün kümesi belirli bir üretici için aşağıdaki kodu gösterildiği gibi numaralandırmak için kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="47728-433">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="47728-434">Bu veriler ayrıca ASP hiçbirinde görüntülenebilir. NET'in veri Web denetler.</span><span class="sxs-lookup"><span data-stu-id="47728-434">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="47728-435">Şu sayfayı iki alan GridView denetimini kullanır:</span><span class="sxs-lookup"><span data-stu-id="47728-435">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="47728-436">Her sağlayıcı adını görüntüler BoundField ve</span><span class="sxs-lookup"><span data-stu-id="47728-436">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="47728-437">Tarafından döndürülen sonuçlar bağlı Bulletedlıst denetimi içeren bir TemplateField **GetProducts()** her sağlayıcı için yöntem.</span><span class="sxs-lookup"><span data-stu-id="47728-437">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="47728-438">Biz sonraki öğreticilerde gibi ana-ayrıntı raporları görüntülemek nasıl inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="47728-438">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="47728-439">Şu an için bu örnek için eklenen özel yöntemini kullanarak göstermek için tasarlanmıştır **Northwind.SuppliersRow** sınıfı.</span><span class="sxs-lookup"><span data-stu-id="47728-439">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="47728-440">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="47728-440">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="47728-441">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="47728-441">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="47728-442">[![Sol sütunda sağ Their ürünleri tedarikçi şirket adı listelenir](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="47728-442">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="47728-443">**Şekil 35**: tedarikçi şirket adı Their ürünleri sağ sol sütununda listelenen ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="47728-443">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="47728-444">Özet</span><span class="sxs-lookup"><span data-stu-id="47728-444">Summary</span></span>

<span data-ttu-id="47728-445">Ne zaman DAL oluşturma bir web uygulaması oluşturma, sunu katmanı oluşturmaya başlamadan önce gerçekleşen ilk adımlarınız biri olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="47728-445">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="47728-446">Visual Studio ile yazılan veri kümelerinde dayalı bir DAL oluşturma 10-15 dakika içinde bir satır kod yazmadan yapılabilecek bir görevdir.</span><span class="sxs-lookup"><span data-stu-id="47728-446">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="47728-447">İlerleyen öğreticileri bu DAL oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="47728-447">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="47728-448">İçinde [sonraki öğretici](creating-a-business-logic-layer-cs.md) biz iş kuralları sayısını tanımlamak ve içinde ayrı bir iş mantığı katmanı uygulamak bkz.</span><span class="sxs-lookup"><span data-stu-id="47728-448">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="47728-449">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="47728-449">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="47728-450">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="47728-450">Further Reading</span></span>

<span data-ttu-id="47728-451">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="47728-451">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="47728-452">Kesin türü belirtilmiş TableAdapters ve DataTables VS 2005 ve ASP.NET 2.0 kullanarak bir DAL oluşturma</span><span class="sxs-lookup"><span data-stu-id="47728-452">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="47728-453">Veri katmanı bileşenleri tasarlama ve katmanları arasında veri geçirme</span><span class="sxs-lookup"><span data-stu-id="47728-453">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/en-us/library/ms978496.aspx)
- [<span data-ttu-id="47728-454">Visual Studio 2005 veri kümesi Tasarımcısı ile veri erişim katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="47728-454">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="47728-455">ASP.NET 2.0 yapılandırma bilgilerini şifrelemek uygulamaları</span><span class="sxs-lookup"><span data-stu-id="47728-455">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="47728-456">TableAdapter genel bakış</span><span class="sxs-lookup"><span data-stu-id="47728-456">TableAdapter Overview</span></span>](https://msdn.microsoft.com/en-us/library/bz9tthwx.aspx)
- [<span data-ttu-id="47728-457">Türü belirtilmiş bir veri kümesi ile çalışma</span><span class="sxs-lookup"><span data-stu-id="47728-457">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/en-us/library/esbykkzb.aspx)
- [<span data-ttu-id="47728-458">Visual Studio 2005 ve ASP.NET 2.0 kesin türü belirtilmiş veri erişimi kullanma</span><span class="sxs-lookup"><span data-stu-id="47728-458">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="47728-459">TableAdapter yöntemleri genişletme</span><span class="sxs-lookup"><span data-stu-id="47728-459">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="47728-460">Bir saklı yordam skaler verilerini alma</span><span class="sxs-lookup"><span data-stu-id="47728-460">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="47728-461">Bu öğreticide yer alan konularda video eğitim</span><span class="sxs-lookup"><span data-stu-id="47728-461">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="47728-462">ASP.NET uygulamalarında veri erişim katmanları</span><span class="sxs-lookup"><span data-stu-id="47728-462">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="47728-463">Nasıl el ile bir veri kümesi Datagrid denetimine bağlama</span><span class="sxs-lookup"><span data-stu-id="47728-463">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="47728-464">Bir ASP uygulamasından nasıl veri kümelerini ve filtreleri ile çalışma</span><span class="sxs-lookup"><span data-stu-id="47728-464">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="47728-465">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="47728-465">About the Author</span></span>

<span data-ttu-id="47728-466">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="47728-466">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="47728-467">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="47728-467">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="47728-468">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="47728-468">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="47728-469">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="47728-469">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="47728-470">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="47728-470">Special Thanks To</span></span>

<span data-ttu-id="47728-471">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="47728-471">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="47728-472">Bu öğretici için sağlama gözden geçirenler Cüneyt yeşil, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez ve Carlos Santos yoktu.</span><span class="sxs-lookup"><span data-stu-id="47728-472">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="47728-473">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="47728-473">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="47728-474">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="47728-474">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="47728-475">Sonraki</span><span class="sxs-lookup"><span data-stu-id="47728-475">Next</span></span>](creating-a-business-logic-layer-cs.md)
