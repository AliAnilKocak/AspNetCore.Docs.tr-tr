---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: BLL ve DAL düzeyi özel durumları (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, tactfully düzenlenebilir bir DataList'ın güncelleştirme iş akışı sırasında oluşturulan özel durumları işleme göreceğiz.
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 0ee0eeff08b6ba490b401540de833eecd7122a17
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30880108"
---
<a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="4d652-103">BLL ve DAL düzeyi özel durumları (VB)</span><span class="sxs-lookup"><span data-stu-id="4d652-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>
====================
<span data-ttu-id="4d652-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4d652-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4d652-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) veya [PDF indirin](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4d652-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="4d652-106">Bu öğreticide, tactfully düzenlenebilir bir DataList'ın güncelleştirme iş akışı sırasında oluşturulan özel durumları işleme göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="4d652-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="4d652-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="4d652-107">Introduction</span></span>

<span data-ttu-id="4d652-108">İçinde [genel bakış düzenlemesini ve DataList verileri silme](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) öğretici, oluşturduğumuz basit düzenleme ve silme özellikleri sunulan bir DataList.</span><span class="sxs-lookup"><span data-stu-id="4d652-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="4d652-109">Tam olarak işlevsel durumdayken düzenleme sırasında oluşan herhangi bir hata olarak pek kolay veya silme işlemi işlenmeyen bir özel durumla sonuçlandı.</span><span class="sxs-lookup"><span data-stu-id="4d652-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="4d652-110">Örneğin, ürün s adını atlama veya, bir ürün düzenlerken, çok fiyat değerini girerek uygun maliyetli!, bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="4d652-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="4d652-111">Kodda bu özel durum yakalandı olduğundan, ardından web sayfasında s özel durum ayrıntıları görüntüler ASP.NET çalışma zamanı kadar köpürür.</span><span class="sxs-lookup"><span data-stu-id="4d652-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="4d652-112">İçinde gördüğümüz gibi [işleme BLL - ve ASP.NET sayfası DAL düzeyi durumlar](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) öğretici, iş mantığı ya da veri erişim katmanları derinliklerine özel durum oluşturuldu özel durum ayrıntıları döndürülür ObjectDataSource ve ardından GridView için.</span><span class="sxs-lookup"><span data-stu-id="4d652-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="4d652-113">Düzgün biçimde oluşturarak bu özel durumları işleme gördüğümüz `Updated` veya `RowUpdated` ObjectDataSource veya için bir özel durum denetimi ve özel durumun işlendiğini gösteren GridView, olay işleyicileri.</span><span class="sxs-lookup"><span data-stu-id="4d652-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="4d652-114">DataList öğreticilerimizi, ancak geçekleştirilen t ObjectDataSource güncelleştirmek ve verileri silme için kullanma.</span><span class="sxs-lookup"><span data-stu-id="4d652-114">Our DataList tutorials, however, aren t using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="4d652-115">Bunun yerine, doğrudan BLL karşı çalışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="4d652-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="4d652-116">Özel durumlar BLL veya DAL kaynaklanan algılamak için özel durum kodu ASP.NET sayfamızı plan kod içinde işleme uygulamak ihtiyacımız.</span><span class="sxs-lookup"><span data-stu-id="4d652-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="4d652-117">Bu öğreticide daha tactfully iş akışı güncelleştiriliyor düzenlenebilir DataList s sırasında oluşturulan özel durumları işleme göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="4d652-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="4d652-118">İçinde *, bir genel bakış düzenleme ve silme verileri DataList* öğretici, düzenleme ve DataList veri silmek için farklı teknikleri biz ele alınan bazı teknikleri söz konusu güncelleştirmek için bir ObjectDataSource kullanarak ve siliniyor.</span><span class="sxs-lookup"><span data-stu-id="4d652-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="4d652-119">Bu teknikler işe alırsanız ObjectDataSource s'nda özel durumlara BLL veya DAL işleyebilir `Updated` veya `Deleted` olay işleyicileri.</span><span class="sxs-lookup"><span data-stu-id="4d652-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="4d652-120">1. adım: bir düzenlenebilir DataList oluşturma</span><span class="sxs-lookup"><span data-stu-id="4d652-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="4d652-121">Güncelleştirme iş akışı sırasında oluşan özel durum işleme hakkında endişelenmeniz önce ilk düzenlenebilir bir DataList oluşturmak s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="4d652-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="4d652-122">Açık `ErrorHandling.aspx` sayfasındaki `EditDeleteDataList` klasörünü kümesi DataList Designer'a Ekle kendi `ID` özelliğine `Products`, ve adlı yeni bir ObjectDataSource ekleme `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="4d652-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="4d652-123">ObjectDataSource kullanmak için yapılandırma `ProductsBLL` s sınıfı `GetProducts()` seçme yöntemini kaydeder; INSERT, UPDATE, aşağı açılır listeler ayarlayın ve sekmeleri (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="4d652-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="4d652-124">[![GetProducts() yöntemi kullanılarak ürün bilgilerini döndürür](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4d652-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="4d652-125">**Şekil 1**: ürün bilgileri kullanarak dönmek `GetProducts()` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4d652-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>


<span data-ttu-id="4d652-126">ObjectDataSource Sihirbazı'nı tamamladıktan sonra Visual Studio otomatik olarak oluşturacak bir `ItemTemplate` DataList için.</span><span class="sxs-lookup"><span data-stu-id="4d652-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="4d652-127">Bunu yerine bir `ItemTemplate` , her ürün s adı ve fiyat görüntüler ve bir Düzenle düğmesi içerir.</span><span class="sxs-lookup"><span data-stu-id="4d652-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="4d652-128">Ardından, oluşturun bir `EditItemTemplate` adını ve fiyat güncelleştir ve İptal düğmeleri için metin kutusuna Web denetimi ile.</span><span class="sxs-lookup"><span data-stu-id="4d652-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="4d652-129">Son olarak, s DataList ayarlamak `RepeatColumns` özelliğini 2.</span><span class="sxs-lookup"><span data-stu-id="4d652-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="4d652-130">Bu değişikliklerden sonra sayfa s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="4d652-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="4d652-131">Düzenleme, iptal, emin olmak için bir kez daha denetleyin ve güncelleştirme düğmeleri kendi `CommandName` düzenlemek, iptal etmek ve sırasıyla güncelleştirmek için özellikleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="4d652-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="4d652-132">Bu öğretici için DataList s Görünüm durumunun etkinleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4d652-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="4d652-133">Bir tarayıcı aracılığıyla bizim ilerleme durumunu görüntülemek için bir dakikanızı ayırın (bkz: Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="4d652-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="4d652-134">[![Her ürünün bir Düzenle düğmesi içerir](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4d652-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="4d652-135">**Şekil 2**: her ürünün bir Düzenle düğmesi içerir ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4d652-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>


<span data-ttu-id="4d652-136">Şu anda Düzenle düğmesi yalnızca geri gönderimin neden olur, mevcut değil t henüz olun ürün düzenlenebilir.</span><span class="sxs-lookup"><span data-stu-id="4d652-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="4d652-137">Düzenleme etkinleştirmek için olay işleyicileri DataList s oluşturmak ihtiyacımız `EditCommand`, `CancelCommand`, ve `UpdateCommand` olaylar.</span><span class="sxs-lookup"><span data-stu-id="4d652-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="4d652-138">`EditCommand` Ve `CancelCommand` yalnızca update s DataList events `EditItemIndex` özelliği ve DataList verileri yeniden bağlayın:</span><span class="sxs-lookup"><span data-stu-id="4d652-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="4d652-139">`UpdateCommand` Olay işleyicisi biraz daha karmaşık.</span><span class="sxs-lookup"><span data-stu-id="4d652-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="4d652-140">Düzenlenen ürün s okumak gereken `ProductID` gelen `DataKeys` koleksiyonu s ürün adı ve kutularındaki fiyatından yanı sıra `EditItemTemplate`ve ardından arama `ProductsBLL` s sınıfı `UpdateProduct` DataList dönmeden önce yöntemi önceden düzenleme durumuna.</span><span class="sxs-lookup"><span data-stu-id="4d652-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="4d652-141">Şimdilik, let s yalnızca tam aynı koddan kullanmak `UpdateCommand` olay işleyicisini *genel bakış düzenlemesini ve DataList verileri silme* Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="4d652-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="4d652-142">2. adımda özel durumları düzgün bir şekilde işlemek üzere kod ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="4d652-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="4d652-143">Geçersiz giriş karşısında hangi düzgün biçimlendirilmemiş birim fiyat, bir geçersiz birim fiyat değeri gibi-$5.00 ya da özel durum oluşturuldu ürün s adı atlandığını biçiminde olabilir.</span><span class="sxs-lookup"><span data-stu-id="4d652-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="4d652-144">Bu yana `UpdateCommand` olay işleyicisi hiçbir özel durum kodu bu noktada işleme içermez, özel durum ASP.NET çalışma zamanı en son kullanıcıya burada görüntülenir Kabarcık (bkz: Şekil 3).</span><span class="sxs-lookup"><span data-stu-id="4d652-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![İşlenmeyen bir özel durum oluştuğunda, son kullanıcı bir hata sayfası görür.](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="4d652-146">**Şekil 3**: işlenmeyen bir özel durum oluştuğunda, son kullanıcı bir hata sayfası görür.</span><span class="sxs-lookup"><span data-stu-id="4d652-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="4d652-147">2. adım: Düzgün biçimde UpdateCommand olay işleyicisi özel durumları işleme</span><span class="sxs-lookup"><span data-stu-id="4d652-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="4d652-148">Özel durumlar oluşabilir güncelleştirme iş akışı sırasında `UpdateCommand` olay işleyicisi, BLL veya DAL.</span><span class="sxs-lookup"><span data-stu-id="4d652-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="4d652-149">Örneğin, bir kullanıcı çok fiyatı girerse pahalı, `Decimal.Parse` deyiminde `UpdateCommand` olay işleyicisi oluşturur bir `FormatException` özel durum.</span><span class="sxs-lookup"><span data-stu-id="4d652-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="4d652-150">Ürün adı kullanıcı çıkarırsa veya fiyat negatif bir değer varsa, DAL bir özel durum oluşturacak.</span><span class="sxs-lookup"><span data-stu-id="4d652-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="4d652-151">Özel durum oluştuğunda bilgilendirici bir ileti sayfasında görüntülenecek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="4d652-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="4d652-152">Bir etiket Web ekleme özelliği sayfasına denetim `ID` ayarlanır `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="4d652-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="4d652-153">Atayarak kalın ve italik yazı tipini bir kırmızı, çok büyük görüntülenecek etiket s metin yapılandırmak, `CssClass` özelliğine `Warning` tanımlanan CSS sınıfı `Styles.css` dosya.</span><span class="sxs-lookup"><span data-stu-id="4d652-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="4d652-154">Hata oluştuğunda, yalnızca bir kez görüntülenecek etiket istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="4d652-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="4d652-155">Diğer bir deyişle, sonraki Geri göndermeler üzerinde etiket s uyarı iletisi kaybolur.</span><span class="sxs-lookup"><span data-stu-id="4d652-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="4d652-156">Bu da s etiket temizleyerek gerçekleştirilebilir `Text` özelliği veya ayarları kendi `Visible` özelliğine `False` içinde `Page_Load` olay işleyicisi (geri yaptığımız gibi [işleme BLL - ve bir ASP DAL düzeyi özel durumları .NET sayfası](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) öğretici) veya etiket s görünüm durumu desteğini devre dışı bırakma.</span><span class="sxs-lookup"><span data-stu-id="4d652-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="4d652-157">İkinci seçeneği kullanın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="4d652-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="4d652-158">Bir özel durum oluştuğunda, özel durumu ayrıntılarını atamanız `ExceptionDetails` etiket denetimini s `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="4d652-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="4d652-159">Görünüm durumunu, sonraki Geri göndermeler üzerinde devre dışı olduğundan `Text` özellik s programlı değişiklikler kaybolur, böylece uyarı iletisi gizleme geri varsayılan metni (boş bir dize), döndürülüyor.</span><span class="sxs-lookup"><span data-stu-id="4d652-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="4d652-160">Sayfada yararlı bir ileti görüntülemek için bir hata olduğunda yükseltildiğinde belirlemek için eklemek ihtiyacımız bir `Try ... Catch` için engelleyin `UpdateCommand` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="4d652-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="4d652-161">`Try` Bölümü bir özel durum açabilir kodunu içerir ancak `Catch` bloğu karşısında bir özel durum yürütülen kodu içerir.</span><span class="sxs-lookup"><span data-stu-id="4d652-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="4d652-162">Kullanıma [özel durum işleme Temelleri](https://msdn.microsoft.com/library/2w8f0bss.aspx) üzerinde bölümünde daha fazla bilgi için .NET Framework belgelerinde `Try ... Catch` bloğu.</span><span class="sxs-lookup"><span data-stu-id="4d652-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="4d652-163">Ne zaman herhangi bir türde özel durum kodu içinde tarafından `Try` bloğu `Catch` blok s kodu yürütme başlayacak.</span><span class="sxs-lookup"><span data-stu-id="4d652-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="4d652-164">Oluşturulan özel durumun türünü `DbException`, `NoNullAllowedException`, `ArgumentException`ve benzeri ne üzerinde tam olarak bağlıdır hata ilk başta precipitated.</span><span class="sxs-lookup"><span data-stu-id="4d652-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="4d652-165">Varsa burada s bir sorun veritabanı düzeyinde bir `DbException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="4d652-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="4d652-166">İçin geçersiz bir değer girdiyseniz `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, veya `ReorderLevel` alanları, bir `ArgumentException` Bu alan değerlerini doğrulamak için kod eklediğimiz gibi durum oluşturulacak `ProductsDataTable` sınıfı (bkz: [ Bir iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) öğretici).</span><span class="sxs-lookup"><span data-stu-id="4d652-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="4d652-167">İleti metni özel durumu yakalandı türüne alma tarafından size daha yararlı bir açıklama son kullanıcıya sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="4d652-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="4d652-168">Neredeyse aynı formda kullanılan aşağıdaki kod geri [işleme BLL - ve ASP.NET sayfası DAL düzeyi durumlar](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) Eğitmeni bu düzeyde ayrıntı sağlar:</span><span class="sxs-lookup"><span data-stu-id="4d652-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="4d652-169">Bu öğreticiyi tamamlamak için yalnızca çağrısı `DisplayExceptionDetails` yönteminden `Catch` yakalanan geçirme blok `Exception` örneği (`ex`).</span><span class="sxs-lookup"><span data-stu-id="4d652-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="4d652-170">İle `Try ... Catch` yerinde engellemek, Şekil 4 ve 5 Göster kullanıcıları daha bilgilendirici bir hata iletisi ile sunulur.</span><span class="sxs-lookup"><span data-stu-id="4d652-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="4d652-171">Bir özel durum DataList karşısında kalan unutmayın düzenleme modunda.</span><span class="sxs-lookup"><span data-stu-id="4d652-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="4d652-172">Özel durum oluştu sonra denetim akışı hemen yönlendirilir olmasıdır `Catch` DataList önceden düzenleme durumuna geri döner kod atlayarak bloğu.</span><span class="sxs-lookup"><span data-stu-id="4d652-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="4d652-173">[![Gerekli bir alan bir kullanıcı çıkarırsa bir hata iletisi görüntülenir](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="4d652-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="4d652-174">**Şekil 4**: gerekli bir alan bir kullanıcı çıkarırsa bir hata iletisi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="4d652-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>


<span data-ttu-id="4d652-175">[![Bir hata iletisi görüntülenen zaman girilmesi negatif bir fiyat olur](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="4d652-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="4d652-176">**Şekil 5**: bir hata iletisi şudur görüntülenen zaman girme negatif bir fiyat ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="4d652-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="4d652-177">Özet</span><span class="sxs-lookup"><span data-stu-id="4d652-177">Summary</span></span>

<span data-ttu-id="4d652-178">ObjectDataSource ve GridView herhangi güncelleştirme ve silme iş akışı sırasında ortaya çıktı özel durumlar olarak özel durum işlenmişse olup olmadığını belirtmek için ayarlayabileceğiniz özellikler hakkında bilgi içeren sonrası düzeyi olay işleyicileri sağlar İşlenmiş.</span><span class="sxs-lookup"><span data-stu-id="4d652-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="4d652-179">Bu özellikler, ancak kullanılamaz DataList ile çalışma ve BLL kullanarak doğrudan.</span><span class="sxs-lookup"><span data-stu-id="4d652-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="4d652-180">Bunun yerine, özel durum işleme uygulamak için sorumlu duyuyoruz.</span><span class="sxs-lookup"><span data-stu-id="4d652-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="4d652-181">Özel durum işleme iş akışı ekleyerek güncelleştirme düzenlenebilir bir DataList s ekleme gördüğümüz Bu öğreticide bir `Try ... Catch` için engelleyin `UpdateCommand` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="4d652-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="4d652-182">Güncelleştirme iş akışı sırasında bir özel durum oluşursa `Catch` blok s kodu yürütür, yararlı bilgileri görüntüleme `ExceptionDetails` etiketi.</span><span class="sxs-lookup"><span data-stu-id="4d652-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="4d652-183">Bu noktada, ilk başta gerçekleştiği gelen özel durumlarını önlemek için hiçbir çaba DataList yapar.</span><span class="sxs-lookup"><span data-stu-id="4d652-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="4d652-184">Biliyoruz negatif bir fiyat bir özel durum neden olur, biz başlattıysanız rağmen t proaktif olarak bir kullanıcı bu tür geçersiz giriş girmesini engellemek için herhangi bir işlevsellik henüz eklendi.</span><span class="sxs-lookup"><span data-stu-id="4d652-184">Even though we know that a negative price will result in an exception, we haven t yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="4d652-185">Bizim sonraki öğreticide tarafından geçersiz kullanıcı girişini doğrulama denetimleri ekleyerek neden özel durumlarını azaltılmasına yardımcı olmak nasıl göreceğiz `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4d652-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="4d652-186">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="4d652-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="4d652-187">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="4d652-187">Further Reading</span></span>

<span data-ttu-id="4d652-188">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="4d652-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4d652-189">Özel Durumlar için Tasarım Yönergeleri</span><span class="sxs-lookup"><span data-stu-id="4d652-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="4d652-190">[Hata günlük modülleri ve işleyicileri (ELMAH)](http://workspaces.gotdotnet.com/elmah) (günlük kaydı hataları için bir açık kaynak kitaplığı)</span><span class="sxs-lookup"><span data-stu-id="4d652-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="4d652-191">[.NET Framework 2.0 için Kurumsal Kitaplığı](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (özel durum yönetimi uygulama bloğu içerir)</span><span class="sxs-lookup"><span data-stu-id="4d652-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4d652-192">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="4d652-192">About the Author</span></span>

<span data-ttu-id="4d652-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="4d652-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4d652-194">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="4d652-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4d652-195">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4d652-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4d652-196">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4d652-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4d652-197">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="4d652-197">Special Thanks To</span></span>

<span data-ttu-id="4d652-198">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="4d652-198">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4d652-199">Bu öğretici için sağlama İnceleme Ken Pespisa oluştu.</span><span class="sxs-lookup"><span data-stu-id="4d652-199">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="4d652-200">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="4d652-200">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4d652-201">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4d652-201">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4d652-202">[Önceki](performing-batch-updates-vb.md)
> [sonraki](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4d652-202">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>
