---
uid: web-forms/overview/data-access/database-driven-site-maps/building-a-custom-database-driven-site-map-provider-vb
title: "Özel veritabanı kaynaklı Site haritası sağlayıcısı (VB) oluşturma | Microsoft Docs"
author: rick-anderson
description: "Varsayılan site haritası sağlayıcısı, ASP.NET 2.0 statik bir XML dosyasından verisini alır. XML tabanlı sağlayıcı çok sayıda küçük ve orta boyut uygun olmasına rağmen..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: f904cd2c-a408-4484-9324-8b8d7fe33893
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/database-driven-site-maps/building-a-custom-database-driven-site-map-provider-vb
msc.type: authoredcontent
ms.openlocfilehash: e9b71ed89dce4e973a9096a9e2326d2c16c30673
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="building-a-custom-database-driven-site-map-provider-vb"></a><span data-ttu-id="44f9b-104">Özel veritabanı kaynaklı Site haritası sağlayıcısı (VB) oluşturma</span><span class="sxs-lookup"><span data-stu-id="44f9b-104">Building a Custom Database-Driven Site Map Provider (VB)</span></span>
====================
<span data-ttu-id="44f9b-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="44f9b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="44f9b-106">[Kodu indirme](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_62_VB.zip) veya [PDF indirin](building-a-custom-database-driven-site-map-provider-vb/_static/datatutorial62vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="44f9b-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_62_VB.zip) or [Download PDF](building-a-custom-database-driven-site-map-provider-vb/_static/datatutorial62vb1.pdf)</span></span>

> <span data-ttu-id="44f9b-107">Varsayılan site haritası sağlayıcısı, ASP.NET 2.0 statik bir XML dosyasından verisini alır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-107">The default site map provider in ASP.NET 2.0 retrieves its data from a static XML file.</span></span> <span data-ttu-id="44f9b-108">XML tabanlı sağlayıcısı için çok sayıda küçük ve orta ölçekli Web siteleri uygun olsa da, büyük Web uygulamalarını daha dinamik site haritası gerektirir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-108">While the XML-based provider is suitable to many small and medium-sized Web sites, larger Web applications require a more dynamic site map.</span></span> <span data-ttu-id="44f9b-109">İş mantığı katmanından verisini alır özel site haritası sağlayıcısı oluşturmak, Bu öğretici kapsamında, hangi sırayla veritabanından veri alır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-109">In this tutorial we'll build a custom site map provider that retrieves its data from the Business Logic Layer, which in turn retrieves data from the database.</span></span>


## <a name="introduction"></a><span data-ttu-id="44f9b-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="44f9b-110">Introduction</span></span>

<span data-ttu-id="44f9b-111">ASP.NET 2.0 s site haritası özelliği bir XML dosyası gibi bir web uygulaması s site haritası bazı kalıcı ortamda tanımlamak bir sayfa Geliştirici sağlar.</span><span class="sxs-lookup"><span data-stu-id="44f9b-111">ASP.NET 2.0 s site map feature enables a page developer to define a web application s site map in some persistent medium, such as in an XML file.</span></span> <span data-ttu-id="44f9b-112">Bir kez tanımlandıktan sonra site haritası verileri programlı olarak aracılığıyla erişilebilen [ `SiteMap` sınıfı](https://msdn.microsoft.com/library/system.web.sitemap.aspx) içinde [ `System.Web` ad alanı](https://msdn.microsoft.com/library/system.web.aspx) veya gezinti çeşitli Web denetimleri gibi SiteMapPath, menü ve TreeView denetimleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-112">Once defined, the site map data can be accessed programmatically through the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx) in the [`System.Web` namespace](https://msdn.microsoft.com/library/system.web.aspx) or through a variety of navigation Web controls, such as the SiteMapPath, Menu, and TreeView controls.</span></span> <span data-ttu-id="44f9b-113">Site eşlemesi sistemini kullanan [sağlayıcı modeli](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) böylece farklı site haritası serileştirme uygulamaları oluşturulabilir ve bir web uygulamasına takılı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-113">The site map system uses the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) so that different site map serialization implementations can be created and plugged into a web application.</span></span> <span data-ttu-id="44f9b-114">ASP.NET 2.0 ile birlikte gelen varsayılan site haritası sağlayıcısı, site haritası yapısı bir XML dosyasında devam ettirir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-114">The default site map provider that ships with ASP.NET 2.0 persists site map structure in an XML file.</span></span> <span data-ttu-id="44f9b-115">Geri [ana sayfalar ve Site gezintisi](../introduction/master-pages-and-site-navigation-vb.md) adlı bir dosya oluşturduğumuz öğretici `Web.sitemap` bu yapı yer alan ve onun XML her yeni bir öğretici bölümle güncelleştirme.</span><span class="sxs-lookup"><span data-stu-id="44f9b-115">Back in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial we created a file named `Web.sitemap` that contained this structure and have been updating its XML with each new tutorial section.</span></span>

<span data-ttu-id="44f9b-116">İyi site haritası s yapısı bu öğreticileri için oldukça, gibi statikse varsayılan XML tabanlı site haritası sağlayıcısı çalışır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-116">The default XML-based site map provider works well if the site map s structure is fairly static, such as for these tutorials.</span></span> <span data-ttu-id="44f9b-117">Birçok senaryolarda, ancak daha dinamik site haritası gereklidir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-117">In many scenarios, however, a more dynamic site map is needed.</span></span> <span data-ttu-id="44f9b-118">Şekil 1, her kategori ve ürün nerede görüneceğini Web sitesi s yapısı bölümlerde olarak gösterilen site haritası göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="44f9b-118">Consider the site map shown in Figure 1, where each category and product appear as sections in the website s structure.</span></span> <span data-ttu-id="44f9b-119">Bu site haritası, kök düğüme karşılık gelen web sayfasını ziyaret tüm kategorileri, belirli kategori s web sayfasını ziyaret bu kategori s ürünleri listeler ve belirli ürün s web sayfası görüntüleme, ürün s ayrıntıları gösterir ancak listesi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-119">With this site map, visiting the web page corresponding to the root node might list all of the categories, whereas visiting a particular category s web page would list that category s products and viewing a particular product s web page would show that product s details.</span></span>


<span data-ttu-id="44f9b-120">[![Kategorileri ve ürünleri oluşma şekli Site Haritası s yapısı](building-a-custom-database-driven-site-map-provider-vb/_static/image1.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-120">[![The Categories and Products Makeup the Site Map s Structure](building-a-custom-database-driven-site-map-provider-vb/_static/image1.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image1.png)</span></span>

<span data-ttu-id="44f9b-121">**Şekil 1**: kategorileri ve ürünleri oluşma şekli Site Haritası s yapısı ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-121">**Figure 1**: The Categories and Products Makeup the Site Map s Structure ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image2.png))</span></span>


<span data-ttu-id="44f9b-122">Bu kategori ve ürün tabanlı yapı içine sabit kodlanmış olabilir ancak `Web.sitemap` dosya, dosyayı her zaman bir kategori güncellenmesi gerekiyor veya ürün eklenemez, kaldırılamaz veya yeniden adlandırılamaz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-122">While this category- and product-based structure could be hard-coded into the `Web.sitemap` file, the file would need to be updated each time a category or product was added, removed, or renamed.</span></span> <span data-ttu-id="44f9b-123">Yapısını veritabanından ya da ideal olarak, iş mantığı katmanından uygulama s mimarisinin alındığında, sonuç olarak, site haritası Bakımı büyük ölçüde basitleştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="44f9b-123">Consequently, the site map maintenance would be greatly simplified if its structure was retrieved from the database or, ideally, from the Business Logic Layer of the application s architecture.</span></span> <span data-ttu-id="44f9b-124">Böylece, ürünler ve kategoriler eklenen gibi yeniden adlandırılmış veya silinmiş, site haritası otomatik olarak bu değişiklikleri yansıtacak şekilde güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-124">That way, as products and categories were added, renamed, or deleted, the site map would automatically update to reflect these changes.</span></span>

<span data-ttu-id="44f9b-125">ASP.NET 2.0 s site haritası serileştirme sağlayıcı modeli üzerinde kurulu olduğundan, veritabanı veya mimarisi gibi bir alternatif veri deposundaki verileri alan kendi özel site haritası sağlayıcısı oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-125">Since ASP.NET 2.0 s site map serialization is built atop the provider model, we can create our own custom site map provider that grabs its data from an alternate data store, such as the database or architecture.</span></span> <span data-ttu-id="44f9b-126">Bu öğreticide BLL verileri alır özel bir sağlayıcı biz yapı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-126">In this tutorial we'll build a custom provider that retrieves its data from the BLL.</span></span> <span data-ttu-id="44f9b-127">Let s başlayın!</span><span class="sxs-lookup"><span data-stu-id="44f9b-127">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="44f9b-128">Bu öğreticide oluşturduğunuz özel site haritası sağlayıcısı uygulama s mimarisi ve veri modeline sıkı şekilde bağlı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-128">The custom site map provider created in this tutorial is tightly coupled to the application s architecture and data model.</span></span> <span data-ttu-id="44f9b-129">Jeff Prosise s [SQL Server'daki Site Haritaları depolama](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) ve [SQL Site haritası sağlayıcısı önceden beklediğinden](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx) makaleleri SQL Server'da site haritası verileri depolamak için genelleştirilmiş bir yaklaşım inceleyin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-129">Jeff Prosise s [Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) and [The SQL Site Map Provider You ve Been Waiting For](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx) articles examine a generalized approach to storing site map data in SQL Server.</span></span>


## <a name="step-1-creating-the-custom-site-map-provider-web-pages"></a><span data-ttu-id="44f9b-130">1. adım: özel Site haritası sağlayıcısı Web sayfaları oluşturma</span><span class="sxs-lookup"><span data-stu-id="44f9b-130">Step 1: Creating the Custom Site Map Provider Web Pages</span></span>

<span data-ttu-id="44f9b-131">Özel site haritası sağlayıcısı oluşturmaya başlamadan önce öncelikle Bu öğretici için yapmamız gereken ASP.NET sayfaları ekleme s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-131">Before we start creating a custom site map provider, let s first add the ASP.NET pages we'll need for this tutorial.</span></span> <span data-ttu-id="44f9b-132">Adlı yeni bir klasör eklemeye başlayın `SiteMapProvider`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-132">Start by adding a new folder named `SiteMapProvider`.</span></span> <span data-ttu-id="44f9b-133">Ardından, o klasördeki her sayfayla ilişkilendirilecek emin olmak için aşağıdaki ASP.NET sayfaları ekleme `Site.master` ana sayfa:</span><span class="sxs-lookup"><span data-stu-id="44f9b-133">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ProductsByCategory.aspx`
- `ProductDetails.aspx`

<span data-ttu-id="44f9b-134">Ayrıca bir `CustomProviders` alt klasöre `App_Code` klasör.</span><span class="sxs-lookup"><span data-stu-id="44f9b-134">Also add a `CustomProviders` subfolder to the `App_Code` folder.</span></span>


![Site haritası sağlayıcısı ile ilgili öğreticiler için ASP.NET sayfaları ekleme](building-a-custom-database-driven-site-map-provider-vb/_static/image2.gif)

<span data-ttu-id="44f9b-136">**Şekil 2**: Site için ASP.NET sayfaları sağlayıcısı ile ilgili öğreticiler eşleme Ekle</span><span class="sxs-lookup"><span data-stu-id="44f9b-136">**Figure 2**: Add the ASP.NET Pages for the Site Map Provider-Related Tutorials</span></span>


<span data-ttu-id="44f9b-137">Bu bölüm için yalnızca bir Öğreticisi olduğundan, biz t gerek güncelleştireceğinizi `Default.aspx` s bölümü öğreticiler listesi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-137">Since there is only one tutorial for this section, we don t need `Default.aspx` to list the section s tutorials.</span></span> <span data-ttu-id="44f9b-138">Bunun yerine, `Default.aspx` kategorileri GridView denetiminde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-138">Instead, `Default.aspx` will display the categories in a GridView control.</span></span> <span data-ttu-id="44f9b-139">Biz bu 2. adımda üstesinden gelmek.</span><span class="sxs-lookup"><span data-stu-id="44f9b-139">We'll tackle this in Step 2.</span></span>

<span data-ttu-id="44f9b-140">Ardından, güncelleştirme `Web.sitemap` bir başvuru eklemek için `Default.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="44f9b-140">Next, update `Web.sitemap` to include a reference to the `Default.aspx` page.</span></span> <span data-ttu-id="44f9b-141">Özellikle, aşağıdaki biçimlendirme sonra önbelleğe alma ekleme `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="44f9b-141">Specifically, add the following markup after the Caching `<siteMapNode>`:</span></span>


[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample1.xml)]

<span data-ttu-id="44f9b-142">Güncelleştirdikten sonra `Web.sitemap`, bir tarayıcı aracılığıyla öğreticileri Web sitesini görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-142">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="44f9b-143">Soldaki menüde artık tek site haritası Sağlayıcısı Öğreticisi için bir öğe içeriyor.</span><span class="sxs-lookup"><span data-stu-id="44f9b-143">The menu on the left now includes an item for the sole site map provider tutorial.</span></span>


![Site Haritası artık Site Haritası Sağlayıcısı Öğreticisi için bir giriş içerir](building-a-custom-database-driven-site-map-provider-vb/_static/image3.gif)

<span data-ttu-id="44f9b-145">**Şekil 3**: Site Haritası artık Site Haritası Sağlayıcısı Öğreticisi için bir giriş içerir</span><span class="sxs-lookup"><span data-stu-id="44f9b-145">**Figure 3**: The Site Map Now Includes an Entry for the Site Map Provider Tutorial</span></span>


<span data-ttu-id="44f9b-146">Bu öğretici s ana odak özel site haritası sağlayıcısı oluşturma ve bu sağlayıcıyı kullanmak için bir web uygulaması yapılandırma göstermektir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-146">This tutorial s main focus is to illustrate creating a custom site map provider and configuring a web application to use that provider.</span></span> <span data-ttu-id="44f9b-147">Özellikle, biz Şekil 1'de gösterildiği gibi her kategori hem de ürün için bir düğüm birlikte bir kök düğümü içeren site haritası döndüren bir sağlayıcı yapı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-147">In particular, we'll build a provider that returns a site map that includes a root node along with a node for each category and product, as depicted in Figure 1.</span></span> <span data-ttu-id="44f9b-148">Genel olarak, site haritası içindeki her bir düğümün bir URL belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-148">In general, each node in the site map may specify a URL.</span></span> <span data-ttu-id="44f9b-149">Bizim site haritası için kök düğümü s URL olacaktır `~/SiteMapProvider/Default.aspx`, hangi listeler veritabanındaki kategorilerin tümünü.</span><span class="sxs-lookup"><span data-stu-id="44f9b-149">For our site map, the root node s URL will be `~/SiteMapProvider/Default.aspx`, which will list all of the categories in the database.</span></span> <span data-ttu-id="44f9b-150">Her kategori düğümü site haritası işaret eden bir URL gerekir `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID`, hangi listeler tüm ürünleri belirtilen *adlı kullanıcı, Categoryıd'si*.</span><span class="sxs-lookup"><span data-stu-id="44f9b-150">Each category node in the site map will have a URL that points to `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID`, which will list all of the products in the specified *categoryID*.</span></span> <span data-ttu-id="44f9b-151">Son olarak, her ürünün site haritası düğümü işaret edecek `~/SiteMapProvider/ProductDetails.aspx?ProductID=productID`, belirli ürün s ayrıntıları görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-151">Finally, each product site map node will point to `~/SiteMapProvider/ProductDetails.aspx?ProductID=productID`, which will display the specific product s details.</span></span>

<span data-ttu-id="44f9b-152">Başlatmak için oluşturmamız gerekir `Default.aspx`, `ProductsByCategory.aspx`, ve `ProductDetails.aspx` sayfaları.</span><span class="sxs-lookup"><span data-stu-id="44f9b-152">To start we need to create the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages.</span></span> <span data-ttu-id="44f9b-153">Bu sayfaları adım 2, 3 ve 4 ' sırasıyla tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-153">These pages are completed in Steps 2, 3, and 4, respectively.</span></span> <span data-ttu-id="44f9b-154">Bu tür sayfalı ana/ayrıntı raporları Bu öğreticinin thrust site haritası sağlayıcıları olduğundan ve geçmiş öğreticiler oluşturma ele aldıktan sonra şu adımları 2'den 4'ten hurry.</span><span class="sxs-lookup"><span data-stu-id="44f9b-154">Since the thrust of this tutorial is on site map providers, and since past tutorials have covered creating these sorts of multi-page master/detail reports, we will hurry through Steps 2 through 4.</span></span> <span data-ttu-id="44f9b-155">Birden fazla sayfayı dolduran ana/ayrıntı raporları oluşturma Yenileyici gerekiyorsa, geri bakın [ana/ayrıntı filtreleme arasında iki sayfa](../masterdetail/master-detail-filtering-across-two-pages-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-155">If you need a refresher on creating master/detail reports that span multiple pages, refer back to the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial.</span></span>

## <a name="step-2-displaying-a-list-of-categories"></a><span data-ttu-id="44f9b-156">2. adım: Kategoriler listesini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="44f9b-156">Step 2: Displaying a List of Categories</span></span>

<span data-ttu-id="44f9b-157">Açık `Default.aspx` sayfasındaki `SiteMapProvider` klasörü ve sürükleme GridView ayarı tasarımcıya araç kendi `ID` için `Categories`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-157">Open the `Default.aspx` page in the `SiteMapProvider` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="44f9b-158">İsteğe bağlı olarak GridView s akıllı etiketten adlı yeni bir ObjectDataSource bağlamak `CategoriesDataSource` ve verileri kullanarak alır şekilde yapılandırın `CategoriesBLL` s sınıfı `GetCategories` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-158">From the GridView s smart tag, bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it so that it retrieves its data using the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="44f9b-159">Bu GridView yalnızca kategorileri görüntüler ve verileri değiştirme olanağı sağlamadığını olduğundan, güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="44f9b-159">Since this GridView just displays the categories and does not provide data modification capabilities, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="44f9b-160">[![ObjectDataSource GetCategories yöntemi kullanarak kategorileri döndürmek için yapılandırma](building-a-custom-database-driven-site-map-provider-vb/_static/image4.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-160">[![Configure the ObjectDataSource to Return Categories Using the GetCategories Method](building-a-custom-database-driven-site-map-provider-vb/_static/image4.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image3.png)</span></span>

<span data-ttu-id="44f9b-161">**Şekil 4**: ObjectDataSource kategorileri kullanarak dönmek için yapılandırma `GetCategories` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-161">**Figure 4**: Configure the ObjectDataSource to Return Categories Using the `GetCategories` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image4.png))</span></span>


<span data-ttu-id="44f9b-162">[![Güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) silme](building-a-custom-database-driven-site-map-provider-vb/_static/image5.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-162">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.png)</span></span>

<span data-ttu-id="44f9b-163">**Şekil 5**: aşağı açılan listeler güncelleştirme, ekleme ve silme sekmeler (hiçbiri) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-163">**Figure 5**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image6.png))</span></span>


<span data-ttu-id="44f9b-164">Veri Kaynağı Yapılandırma Sihirbazı'nı tamamladıktan sonra Visual Studio için BoundField ekleyecektir `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, ve `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-164">After completing the Configure Data Source wizard, Visual Studio will add a BoundField for `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath`.</span></span> <span data-ttu-id="44f9b-165">GridView yalnızca içerecek şekilde düzenleyin `CategoryName` ve `Description` BoundFields ve güncelleştirme `CategoryName` BoundField s `HeaderText` kategorisine özelliği.</span><span class="sxs-lookup"><span data-stu-id="44f9b-165">Edit the GridView so that it only contains the `CategoryName` and `Description` BoundFields and update the `CategoryName` BoundField s `HeaderText` property to Category .</span></span>

<span data-ttu-id="44f9b-166">Ardından, bir HyperLinkField ekleyin ve bu nedenle getirin, BT'nin s en solundaki alan.</span><span class="sxs-lookup"><span data-stu-id="44f9b-166">Next, add a HyperLinkField and position it so that it s the left-most field.</span></span> <span data-ttu-id="44f9b-167">Ayarlama `DataNavigateUrlFields` özelliğine `CategoryID` ve `DataNavigateUrlFormatString` özelliğine `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID={0}`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-167">Set the `DataNavigateUrlFields` property to `CategoryID` and the `DataNavigateUrlFormatString` property to `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID={0}`.</span></span> <span data-ttu-id="44f9b-168">Ayarlama `Text` özelliğini ürünleri görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-168">Set the `Text` property to View Products .</span></span>


![Kategoriler GridView bir HyperLinkField ekleyin](building-a-custom-database-driven-site-map-provider-vb/_static/image6.gif)

<span data-ttu-id="44f9b-170">**Şekil 6**: bir HyperLinkField eklemek `Categories` GridView</span><span class="sxs-lookup"><span data-stu-id="44f9b-170">**Figure 6**: Add a HyperLinkField to the `Categories` GridView</span></span>


<span data-ttu-id="44f9b-171">ObjectDataSource oluşturup GridView s alanlarını özelleştirme sonra iki denetimi bildirim temelli biçimlendirme aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="44f9b-171">After creating the ObjectDataSource and customizing the GridView s fields, the two controls declarative markup will look like the following:</span></span>


[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample2.aspx)]

<span data-ttu-id="44f9b-172">Şekil 7 gösterir `Default.aspx` bir tarayıcıdan görüntülendiğinde.</span><span class="sxs-lookup"><span data-stu-id="44f9b-172">Figure 7 shows `Default.aspx` when viewed through a browser.</span></span> <span data-ttu-id="44f9b-173">Bir kategori s ürünleri görüntüleyin tıklamak bağlantıyı size götürür `ProductsByCategory.aspx?CategoryID=categoryID`, hangi adım 3'te oluşturulmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="44f9b-173">Clicking a category s View Products link takes you to `ProductsByCategory.aspx?CategoryID=categoryID`, which we will build in Step 3.</span></span>


<span data-ttu-id="44f9b-174">[![Bir görünümü ürünleri bağlantısı ile boyunca listelenen her kategori olduğu](building-a-custom-database-driven-site-map-provider-vb/_static/image7.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-174">[![Each Category is Listed Along with a View Products Link](building-a-custom-database-driven-site-map-provider-vb/_static/image7.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image7.png)</span></span>

<span data-ttu-id="44f9b-175">**Şekil 7**: her kategorisidir listelenen boyunca bir görünüm ürünleri bağlantıyla ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-175">**Figure 7**: Each Category is Listed Along with a View Products Link ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image8.png))</span></span>


## <a name="step-3-listing-the-selected-category-s-products"></a><span data-ttu-id="44f9b-176">3. adım: seçilen kategori s ürünleri listeleme</span><span class="sxs-lookup"><span data-stu-id="44f9b-176">Step 3: Listing the Selected Category s Products</span></span>

<span data-ttu-id="44f9b-177">Açık `ProductsByCategory.aspx` sayfasında ve adlandırma GridView, ekleme `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-177">Open the `ProductsByCategory.aspx` page and add a GridView, naming it `ProductsByCategory`.</span></span> <span data-ttu-id="44f9b-178">Akıllı etiketten GridView adlı yeni bir ObjectDataSource bağlama `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-178">From its smart tag, bind the GridView to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="44f9b-179">ObjectDataSource kullanmak için yapılandırma `ProductsBLL` s sınıfı `GetProductsByCategoryID(categoryID)` yöntemi ve kümesi aşağı açılan listeler (hiçbiri) güncelleştirme, ekleme ve silme sekmeleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-179">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and set the drop-down lists to (None) in the UPDATE, INSERT, and DELETE tabs.</span></span>


<span data-ttu-id="44f9b-180">[![ProductsBLL sınıfı s GetProductsByCategoryID(categoryID) yöntemi kullanın.](building-a-custom-database-driven-site-map-provider-vb/_static/image8.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-180">[![Use the ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](building-a-custom-database-driven-site-map-provider-vb/_static/image8.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image9.png)</span></span>

<span data-ttu-id="44f9b-181">**Şekil 8**: kullanım `ProductsBLL` s sınıfı `GetProductsByCategoryID(categoryID)` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-181">**Figure 8**: Use the `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image10.png))</span></span>


<span data-ttu-id="44f9b-182">Veri Kaynağı Yapılandırma Sihirbazı'nı son adımda ister bir parametre kaynağına ilişkin *adlı kullanıcı, Categoryıd'si*.</span><span class="sxs-lookup"><span data-stu-id="44f9b-182">The final step in the Configure Data Source wizard prompts for a parameter source for *categoryID*.</span></span> <span data-ttu-id="44f9b-183">Bu bilgiler sorgu dizesi alanı geçirilen beri `CategoryID`, sorgu dizesi aşağı açılan listeden seçin ve Şekil 9'da gösterildiği gibi adlı kullanıcı, Categoryıd'si QueryStringField metin kutusuna girin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-183">Since this information is passed through the querystring field `CategoryID`, select QueryString from the drop-down list and enter CategoryID in the QueryStringField textbox as shown in Figure 9.</span></span> <span data-ttu-id="44f9b-184">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-184">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="44f9b-185">[![Adlı kullanıcı, Categoryıd'si parametresi için adlı kullanıcı, Categoryıd'si Querystring alanını kullan](building-a-custom-database-driven-site-map-provider-vb/_static/image9.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-185">[![Use the CategoryID Querystring Field for the categoryID Parameter](building-a-custom-database-driven-site-map-provider-vb/_static/image9.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image11.png)</span></span>

<span data-ttu-id="44f9b-186">**Şekil 9**: kullanım `CategoryID` sorgu dizesi alanı için *adlı kullanıcı, Categoryıd'si* parametre ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-186">**Figure 9**: Use the `CategoryID` Querystring Field for the *categoryID* Parameter ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image12.png))</span></span>


<span data-ttu-id="44f9b-187">Sihirbazı tamamladıktan sonra Visual Studio karşılık gelen BoundFields ve bir CheckBoxField ürün veri alanları GridView ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-187">After completing the wizard, Visual Studio will add corresponding BoundFields and a CheckBoxField to the GridView for the product data fields.</span></span> <span data-ttu-id="44f9b-188">Kaldırma dışındaki tüm `ProductName`, `UnitPrice`, ve `SupplierName` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="44f9b-188">Remove all but the `ProductName`, `UnitPrice`, and `SupplierName` BoundFields.</span></span> <span data-ttu-id="44f9b-189">Bu üç BoundFields özelleştirme `HeaderText` ürün, fiyat ve tedarikçi, sırasıyla okumak için özellikler.</span><span class="sxs-lookup"><span data-stu-id="44f9b-189">Customize these three BoundFields `HeaderText` properties to read Product, Price, and Supplier, respectively.</span></span> <span data-ttu-id="44f9b-190">Biçim `UnitPrice` BoundField bir para birimi olarak.</span><span class="sxs-lookup"><span data-stu-id="44f9b-190">Format the `UnitPrice` BoundField as a currency.</span></span>

<span data-ttu-id="44f9b-191">Ardından, bir HyperLinkField ekleyin ve en solundaki konuma taşıyın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-191">Next, add a HyperLinkField and move it to the left-most position.</span></span> <span data-ttu-id="44f9b-192">Ayarlama, `Text` ayrıntılarını görüntüleme özelliğini kendi `DataNavigateUrlFields` özelliğine `ProductID`ve kendi `DataNavigateUrlFormatString` özelliğine `~/SiteMapProvider/ProductDetails.aspx?ProductID={0}`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-192">Set its `Text` property to View Details, its `DataNavigateUrlFields` property to `ProductID`, and its `DataNavigateUrlFormatString` property to `~/SiteMapProvider/ProductDetails.aspx?ProductID={0}`.</span></span>


![İçin ProductDetails.aspx gösteren bir görünüm ayrıntıları HyperLinkField Ekle](building-a-custom-database-driven-site-map-provider-vb/_static/image10.gif)

<span data-ttu-id="44f9b-194">**Şekil 10**: bir görünüm ayrıntıları işaret HyperLinkField Ekle`ProductDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="44f9b-194">**Figure 10**: Add a View Details HyperLinkField that Points to `ProductDetails.aspx`</span></span>


<span data-ttu-id="44f9b-195">Bu özelleştirmeler yaptıktan sonra GridView ve ObjectDataSource s bildirim temelli biçimlendirme aşağıdakine benzemelidir:</span><span class="sxs-lookup"><span data-stu-id="44f9b-195">After making these customizations, the GridView and ObjectDataSource s declarative markup should resemble the following:</span></span>


[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample3.aspx)]

<span data-ttu-id="44f9b-196">Dönüş görüntülemeye `Default.aspx` Meşrubat için bağlantı aracılığıyla bir tarayıcı ve ürünleri görüntüleyin'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-196">Return to viewing `Default.aspx` through a browser and click on the View Products link for Beverages.</span></span> <span data-ttu-id="44f9b-197">Bu, olanak sürecek `ProductsByCategory.aspx?CategoryID=1`, Meşrubat kategorisine ait Northwind veritabanı adları, Fiyatlar ve ürünleri tedarikçileri görüntüleme (bkz. Şekil 11).</span><span class="sxs-lookup"><span data-stu-id="44f9b-197">This will take you to `ProductsByCategory.aspx?CategoryID=1`, displaying the names, prices, and suppliers of the products in the Northwind database that belong to the Beverages category (see Figure 11).</span></span> <span data-ttu-id="44f9b-198">Daha fazla kullanıcı kategorisi listesi sayfasına dönmek için bir bağlantı eklemek için bu sayfayı geliştirmek çekinmeyin (`Default.aspx`) ve seçilen kategori s ad ve açıklama görüntüleyen bir DetailsView veya FormView denetim.</span><span class="sxs-lookup"><span data-stu-id="44f9b-198">Feel free to further enhance this page to include a link to return users to the category listing page (`Default.aspx`) and a DetailsView or FormView control that displays the selected category s name and description.</span></span>


<span data-ttu-id="44f9b-199">[![Meşrubat adları, Fiyatlar ve Üreticiler görüntülenir](building-a-custom-database-driven-site-map-provider-vb/_static/image11.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-199">[![The Beverages Names, Prices, and Suppliers are Displayed](building-a-custom-database-driven-site-map-provider-vb/_static/image11.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image13.png)</span></span>

<span data-ttu-id="44f9b-200">**Şekil 11**: Meşrubat adları, Fiyatlar ve Üreticiler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-200">**Figure 11**: The Beverages Names, Prices, and Suppliers are Displayed ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image14.png))</span></span>


## <a name="step-4-showing-a-product-s-details"></a><span data-ttu-id="44f9b-201">4. adım: bir ürün s ayrıntıları gösterme</span><span class="sxs-lookup"><span data-stu-id="44f9b-201">Step 4: Showing a Product s Details</span></span>

<span data-ttu-id="44f9b-202">Son sayfa `ProductDetails.aspx`, seçilen ürün ayrıntılarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="44f9b-202">The final page, `ProductDetails.aspx`, displays the selected products details.</span></span> <span data-ttu-id="44f9b-203">Açık `ProductDetails.aspx` ve bir DetailsView tasarımcıya araç çubuğuna sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-203">Open `ProductDetails.aspx` and drag a DetailsView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="44f9b-204">DetailsView s ayarlamak `ID` özelliğine `ProductInfo` ve temizleyin, `Height` ve `Width` özellik değerleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-204">Set the DetailsView s `ID` property to `ProductInfo` and clear out its `Height` and `Width` property values.</span></span> <span data-ttu-id="44f9b-205">Akıllı etiketten DetailsView adlı yeni bir ObjectDataSource bağlamak `ProductDataSource`, kendi verisinden çekmesini ObjectDataSource yapılandırma `ProductsBLL` s sınıfı `GetProductByProductID(productID)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-205">From its smart tag, bind the DetailsView to a new ObjectDataSource named `ProductDataSource`, configuring the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="44f9b-206">Önceki web sayfalarıyla adımları 2 ve 3'te oluşturulan gibi güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="44f9b-206">As with the previous web pages created in Steps 2 and 3, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="44f9b-207">[![ObjectDataSource GetProductByProductID(productID) yöntemi kullanmak üzere yapılandırma](building-a-custom-database-driven-site-map-provider-vb/_static/image12.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-207">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](building-a-custom-database-driven-site-map-provider-vb/_static/image12.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.png)</span></span>

<span data-ttu-id="44f9b-208">**Şekil 12**: ObjectDataSource kullanılacak yapılandırma `GetProductByProductID(productID)` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-208">**Figure 12**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image16.png))</span></span>


<span data-ttu-id="44f9b-209">Veri Kaynağı Yapılandırma Sihirbazı'nın son adımı ister kaynağı için *ProductID* parametresi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-209">The last step of the Configure Data Source wizard prompts for the source of the *productID* parameter.</span></span> <span data-ttu-id="44f9b-210">Bu veriler sorgu dizesi alanı gelir beri `ProductID`, aşağı açılan liste QueryString ve ProductID için QueryStringField textbox olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-210">Since this data comes through the querystring field `ProductID`, set the drop-down list to QueryString and the QueryStringField textbox to ProductID.</span></span> <span data-ttu-id="44f9b-211">Son olarak, Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-211">Finally, click the Finish button to complete the wizard.</span></span>


<span data-ttu-id="44f9b-212">[![Parametre değerini ProductID Querystring alanından çekme ProductID yapılandırın](building-a-custom-database-driven-site-map-provider-vb/_static/image13.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-212">[![Configure the productID Parameter to Pull its Value from the ProductID Querystring Field](building-a-custom-database-driven-site-map-provider-vb/_static/image13.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image17.png)</span></span>

<span data-ttu-id="44f9b-213">**Şekil 13**: yapılandırmak *ProductID* değerinden çekmesini parametresi `ProductID` Querystring alan ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-213">**Figure 13**: Configure the *productID* Parameter to Pull its Value from the `ProductID` Querystring Field ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image18.png))</span></span>


<span data-ttu-id="44f9b-214">Veri Kaynağı Yapılandırma Sihirbazı'nı tamamladıktan sonra Visual Studio karşılık gelen BoundFields ve bir CheckBoxField ürün veri alanları için DetailsView'da oluşturur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-214">After completing the Configure Data Source wizard, Visual Studio will create corresponding BoundFields and a CheckBoxField in the DetailsView for the product data fields.</span></span> <span data-ttu-id="44f9b-215">Kaldırma `ProductID`, `SupplierID`, ve `CategoryID` BoundFields ve geri kalan alanları uygun gördüğünüz şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-215">Remove the `ProductID`, `SupplierID`, and `CategoryID` BoundFields and configure the remaining fields as you see fit.</span></span> <span data-ttu-id="44f9b-216">My DetailsView ve ObjectDataSource s bildirim temelli biçimlendirmesi estetik yapılandırmaları sayıda sonra aşağıdaki gibi Aranan:</span><span class="sxs-lookup"><span data-stu-id="44f9b-216">After a handful of aesthetic configurations, my DetailsView and ObjectDataSource s declarative markup looked like the following:</span></span>


[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample4.aspx)]

<span data-ttu-id="44f9b-217">Bu sayfayı test etmek için dönmek `Default.aspx` ve görünüm ürünleri İçecekler kategorisini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-217">To test this page, return to `Default.aspx` and click on View Products for the Beverages category.</span></span> <span data-ttu-id="44f9b-218">Listenin içecek ürünleri gelen Chai Çay ayrıntılarını görüntüle bağlantısını tıklayın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-218">From the listing of beverage products, click on the View Details link for Chai Tea.</span></span> <span data-ttu-id="44f9b-219">Bu, olanak sürecek `ProductDetails.aspx?ProductID=1`, (bkz. Şekil 14) ayrıntıları Chai Çay s gösterir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-219">This will take you to `ProductDetails.aspx?ProductID=1`, which shows a Chai Tea s details (see Figure 14).</span></span>


<span data-ttu-id="44f9b-220">[![Chai Çay s tedarikçi, kategori, fiyat ve diğer bilgileri görüntülenir](building-a-custom-database-driven-site-map-provider-vb/_static/image14.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-220">[![Chai Tea s Supplier, Category, Price, and Other Information is Displayed](building-a-custom-database-driven-site-map-provider-vb/_static/image14.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image19.png)</span></span>

<span data-ttu-id="44f9b-221">**Şekil 14**: Chai Çay s tedarikçi, kategori, fiyat ve diğer bilgileri görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-221">**Figure 14**: Chai Tea s Supplier, Category, Price, and Other Information is Displayed ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image20.png))</span></span>


## <a name="step-5-understanding-the-inner-workings-of-a-site-map-provider"></a><span data-ttu-id="44f9b-222">5. adım: bir Site haritası sağlayıcısı çalışmalar anlama</span><span class="sxs-lookup"><span data-stu-id="44f9b-222">Step 5: Understanding the Inner Workings of a Site Map Provider</span></span>

<span data-ttu-id="44f9b-223">Site haritasını web sunucusu s bellekte koleksiyonu olarak temsil edilir `SiteMapNode` bir hiyerarşi form örnekleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-223">The site map is represented in the web server s memory as a collection of `SiteMapNode` instances that form a hierarchy.</span></span> <span data-ttu-id="44f9b-224">Tam olarak bir kök olmalıdır, tüm kök olmayan düğüm tam olarak bir üst düğüme sahip olmalıdır ve tüm düğümleri alt rastgele bir sayı olabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-224">There must be exactly one root, all non-root nodes must have exactly one parent node, and all nodes may have an arbitrary number of children.</span></span> <span data-ttu-id="44f9b-225">Her `SiteMapNode` nesnesi, Web sitesi s yapısında bölümüne temsil eder; Bu bölümleri yaygın olarak karşılık gelen bir web sayfası vardır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-225">Each `SiteMapNode` object represents a section in the website s structure; these sections commonly have a corresponding web page.</span></span> <span data-ttu-id="44f9b-226">Sonuç olarak, [ `SiteMapNode` sınıfı](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) gibi özelliklere sahip `Title`, `Url`, ve `Description`, bölüm için bilgiler sağladığınız `SiteMapNode` temsil eder.</span><span class="sxs-lookup"><span data-stu-id="44f9b-226">Consequently, the [`SiteMapNode` class](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) has properties like `Title`, `Url`, and `Description`, which provide information for the section the `SiteMapNode` represents.</span></span> <span data-ttu-id="44f9b-227">Ayrıca bir `Key` her benzersiz olarak tanımlayan özellik `SiteMapNode` Bu hiyerarşi kurmak için kullanılan özellikleri yanı sıra hiyerarşi içinde `ChildNodes`, `ParentNode`, `NextSibling`, `PreviousSibling`, vb.</span><span class="sxs-lookup"><span data-stu-id="44f9b-227">There is also a `Key` property that uniquely identifies each `SiteMapNode` in the hierarchy, as well as properties used to establish this hierarchy `ChildNodes`, `ParentNode`, `NextSibling`, `PreviousSibling`, and so forth.</span></span>

<span data-ttu-id="44f9b-228">Şekil 15 genel site haritası yapısı Şekil 1'den ancak ince ayrıntılı olarak ince ince uygulama ayrıntılarını gösterir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-228">Figure 15 shows the general site map structure from Figure 1, but with the implementation details sketched out in finer detail.</span></span>


<span data-ttu-id="44f9b-229">[![Her SiteMapNode özellikler gibi başlık, Url, anahtar vb. vardır](building-a-custom-database-driven-site-map-provider-vb/_static/image16.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="44f9b-229">[![Each SiteMapNode has Properties Like Title, Url, Key, and So On](building-a-custom-database-driven-site-map-provider-vb/_static/image16.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.gif)</span></span>

<span data-ttu-id="44f9b-230">**Şekil 15**: her `SiteMapNode` özellikler gibi sahip `Title`, `Url`, `Key`ve benzeri ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="44f9b-230">**Figure 15**: Each `SiteMapNode` has Properties Like `Title`, `Url`, `Key`, and So On ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image17.gif))</span></span>


<span data-ttu-id="44f9b-231">Site haritasını üzerinden erişilebilir [ `SiteMap` sınıfı](https://msdn.microsoft.com/library/system.web.sitemap.aspx) içinde [ `System.Web` ad alanı](https://msdn.microsoft.com/library/system.web.aspx).</span><span class="sxs-lookup"><span data-stu-id="44f9b-231">The site map is accessible through the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx) in the [`System.Web` namespace](https://msdn.microsoft.com/library/system.web.aspx).</span></span> <span data-ttu-id="44f9b-232">Bu sınıf s `RootNode` özelliği döndürür site haritası s kök `SiteMapNode` örnek; `CurrentNode` döndürür `SiteMapNode` , `Url` özelliği şu anda istenen sayfanın URL'sini eşleşir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-232">This class s `RootNode` property returns the site map s root `SiteMapNode` instance; `CurrentNode` returns the `SiteMapNode` whose `Url` property matches the URL of the currently requested page.</span></span> <span data-ttu-id="44f9b-233">Bu sınıf, ASP.NET 2.0 s Gezinti Web denetimleri tarafından dahili olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-233">This class is used internally by ASP.NET 2.0 s navigation Web controls.</span></span>

<span data-ttu-id="44f9b-234">Zaman `SiteMap` s sınıfı özellikleri erişilir, onu bazı kalıcı Orta site haritası yapısından belleğe seri gerekir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-234">When the `SiteMap` class s properties are accessed, it must serialize the site map structure from some persistent medium into memory.</span></span> <span data-ttu-id="44f9b-235">Ancak, site haritası serileştirme mantığı uygulamasına kodlanmış sabit değil `SiteMap` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-235">However, the site map serialization logic is not hard coded into the `SiteMap` class.</span></span> <span data-ttu-id="44f9b-236">Bunun yerine, çalışma zamanında `SiteMap` sınıfı belirler hangi site haritası *sağlayıcı* seri hale getirme için kullanılacak.</span><span class="sxs-lookup"><span data-stu-id="44f9b-236">Instead, at runtime the `SiteMap` class determines which site map *provider* to use for serialization.</span></span> <span data-ttu-id="44f9b-237">Varsayılan olarak, [ `XmlSiteMapProvider` sınıfı](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx) kullanılır, doğru biçimlendirilmiş XML dosyasından site haritası s yapısı okur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-237">By default, the [`XmlSiteMapProvider` class](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx) is used, which reads the site map s structure from a properly-formatted XML file.</span></span> <span data-ttu-id="44f9b-238">Ancak, biraz iş ile kendi özel site haritası sağlayıcısı oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-238">However, with a little bit of work we can create our own custom site map provider.</span></span>

<span data-ttu-id="44f9b-239">Tüm site haritası sağlayıcıları öğesinden türetilmelidir [ `SiteMapProvider` sınıfı](https://msdn.microsoft.com/library/system.web.sitemapprovider.aspx), temel yöntemleri içerir ve site için gereken özellikleri eşlemek sağlayıcıları, ancak çoğu uygulama ayrıntılarını atlar.</span><span class="sxs-lookup"><span data-stu-id="44f9b-239">All site map providers must be derived from the [`SiteMapProvider` class](https://msdn.microsoft.com/library/system.web.sitemapprovider.aspx), which includes the essential methods and properties needed for site map providers, but omits many of the implementation details.</span></span> <span data-ttu-id="44f9b-240">İkinci sınıfı [ `StaticSiteMapProvider` ](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.aspx), genişletir `SiteMapProvider` sınıfı ve gerekli işlevselliği, daha sağlam bir uygulama içerir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-240">A second class, [`StaticSiteMapProvider`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.aspx), extends the `SiteMapProvider` class and contains a more robust implementation of the needed functionality.</span></span> <span data-ttu-id="44f9b-241">Dahili olarak, `StaticSiteMapProvider` depolar `SiteMapNode` site örneklerini harita bir `Hashtable` ve yöntemleri ister sağlar `AddNode(child, parent)`, `RemoveNode(siteMapNode),` ve `Clear()` ekleme ve kaldırma `SiteMapNode` iç s `Hashtable`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-241">Internally, the `StaticSiteMapProvider` stores the `SiteMapNode` instances of the site map in a `Hashtable` and provides methods like `AddNode(child, parent)`, `RemoveNode(siteMapNode),` and `Clear()` that add and remove `SiteMapNode` s to the internal `Hashtable`.</span></span> <span data-ttu-id="44f9b-242">`XmlSiteMapProvider`türetilmiş `StaticSiteMapProvider`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-242">`XmlSiteMapProvider` is derived from `StaticSiteMapProvider`.</span></span>

<span data-ttu-id="44f9b-243">Özel site haritası sağlayıcısı oluşturma zaman genişletir `StaticSiteMapProvider`, geçersiz kılınmalıdır soyut iki yöntem vardır: [ `BuildSiteMap` ](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.buildsitemap.aspx) ve [ `GetRootNodeCore` ](https://msdn.microsoft.com/library/system.web.sitemapprovider.getrootnodecore.aspx).</span><span class="sxs-lookup"><span data-stu-id="44f9b-243">When creating a custom site map provider that extends `StaticSiteMapProvider`, there are two abstract methods that must be overridden: [`BuildSiteMap`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.buildsitemap.aspx) and [`GetRootNodeCore`](https://msdn.microsoft.com/library/system.web.sitemapprovider.getrootnodecore.aspx).</span></span> <span data-ttu-id="44f9b-244">`BuildSiteMap`, adından da anlaşılacağı gibi site haritası yapısının kalıcı depolama biriminden yüklenmesi ve bellekte oluşturma sorumludur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-244">`BuildSiteMap`, as its name implies, is responsible for loading the site map structure from persistent storage and constructing it in memory.</span></span> <span data-ttu-id="44f9b-245">`GetRootNodeCore`kök düğüm site eşlemesinde döndürür.</span><span class="sxs-lookup"><span data-stu-id="44f9b-245">`GetRootNodeCore` returns the root node in the site map.</span></span>

<span data-ttu-id="44f9b-246">Önce bir web uygulaması uygulama s yapılandırmasında kaydedilmelidir site haritası sağlayıcısı kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-246">Before a web application can use a site map provider it must be registered in the application s configuration.</span></span> <span data-ttu-id="44f9b-247">Varsayılan olarak, `XmlSiteMapProvider` sınıf adını kullanarak kayıtlı `AspNetXmlSiteMapProvider`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-247">By default, the `XmlSiteMapProvider` class is registered using the name `AspNetXmlSiteMapProvider`.</span></span> <span data-ttu-id="44f9b-248">Ek site haritası sağlayıcıları kaydetmek için aşağıdaki biçimlendirme eklemek `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="44f9b-248">To register additional site map providers, add the following markup to `Web.config`:</span></span>


[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample5.xml)]

<span data-ttu-id="44f9b-249">*Adı* değer sağlayıcı okunabilir bir ad atar *türü* site haritası sağlayıcısı tam olarak nitelenmiş tür adını belirtir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-249">The *name* value assigns a human-readable name to the provider while *type* specifies the fully-qualified type name of the site map provider.</span></span> <span data-ttu-id="44f9b-250">Somut değerlerini ele alacağız *adı* ve *türü* değerleri adım 7'de, sonra ullanıcı oluşturduğumuz bizim Özel site haritası sağlayıcısı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-250">We'll explore concrete values for the *name* and *type* values in Step 7, after we ve created our custom site map provider.</span></span>

<span data-ttu-id="44f9b-251">Erişilen gelen ilk kez site haritası sağlayıcı sınıfının örneği `SiteMap` sınıfı ve web uygulamasının kullanım süresi için bellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-251">The site map provider class is instantiated the first time it is accessed from the `SiteMap` class and remains in memory for the lifetime of the web application.</span></span> <span data-ttu-id="44f9b-252">Yalnızca bir örneği birden çok, eşzamanlı web sitesi ziyaretçilerden çağrılan site haritası sağlayıcısı olduğundan, s sağlayıcısı yöntemleri olmasını kesinlik temelli *iş parçacığı*.</span><span class="sxs-lookup"><span data-stu-id="44f9b-252">Since there is only one instance of the site map provider that may be invoked from multiple, concurrent web site visitors, it is imperative that the provider s methods be *thread-safe*.</span></span>

<span data-ttu-id="44f9b-253">Performans ve ölçeklenebilirlik, onu s biz bellek içi sitenin önbelleğe önemli eşleme yapısı ve bu önbelleğe her zaman yeniden yerine yapısı dönmek `BuildSiteMap` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-253">For performance and scalability reasons, it s important that we cache the in-memory site map structure and return this cached structure rather than recreating it every time the `BuildSiteMap` method is invoked.</span></span> <span data-ttu-id="44f9b-254">`BuildSiteMap`Sayfa ve site haritası yapısının derinliği kullanımda Gezinti denetimlere bağlı olarak kullanıcı başına sayfa isteği başına birkaç kez çağrılabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-254">`BuildSiteMap` may be called several times per page request per user, depending on the navigation controls in use on the page and the depth of the site map structure.</span></span> <span data-ttu-id="44f9b-255">Biz site haritası yapısında önbelleğe alma, her durumda, `BuildSiteMap` çalıştırıldığında her zaman biz (hangi sorguda veritabanına neden olur) mimarisi ürün ve kategori bilgilerini yeniden almaya gerekir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-255">In any case, if we do not cache the site map structure in `BuildSiteMap` then each time it is invoked we would need to re-retrieve the product and category information from the architecture (which would result in a query to the database).</span></span> <span data-ttu-id="44f9b-256">Biz önceki önbelleğe alma eğitimlerine açıklandığı gibi önbelleğe alınan veriler eski haline gelebilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-256">As we discussed in the previous caching tutorials, cached data can become stale.</span></span> <span data-ttu-id="44f9b-257">Bu mücadele etmek için size zaman - ya da SQL önbellek bağımlılık tabanlı expiries kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-257">To combat this, we can use either time- or SQL cache dependency-based expiries.</span></span>

> [!NOTE]
> <span data-ttu-id="44f9b-258">Bir site haritası sağlayıcısı isteğe bağlı olarak geçersiz kılabilir [ `Initialize` yöntemi](https://msdn.microsoft.com/library/system.web.sitemapprovider.initialize.aspx).</span><span class="sxs-lookup"><span data-stu-id="44f9b-258">A site map provider may optionally override the [`Initialize` method](https://msdn.microsoft.com/library/system.web.sitemapprovider.initialize.aspx).</span></span> <span data-ttu-id="44f9b-259">`Initialize`site haritası sağlayıcısı ilk örneği ve sağlayıcı atanan özel öznitelikleri geçirilen değiştiğinde çağrılan `Web.config` içinde `<add>` öğesi gibi: `<add name="name" type="type" customAttribute="value" />`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-259">`Initialize` is invoked when the site map provider is first instantiated and is passed any custom attributes assigned to the provider in `Web.config` in the `<add>` element like: `<add name="name" type="type" customAttribute="value" />`.</span></span> <span data-ttu-id="44f9b-260">Sağlayıcı s kodu değiştirmek zorunda kalmadan çeşitli site haritası sağlayıcısı ile ilgili ayarları belirtmek bir sayfa Geliştirici izin vermek istiyorsanız yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-260">It is useful if you want to allow a page developer to specify various site map provider-related settings without having to modify the provider s code.</span></span> <span data-ttu-id="44f9b-261">Biz kategori ve ürünleri verileri doğrudan veritabanından tersine mimarisi d biz yoluyla büyük olasılıkla okuma Örneğin, veritabanı bağlantı dizesi aracılığıyla belirtin sayfasında Geliştirici izin vermek istiyorsanız `Web.config` sabit kodlanmış kullanarak yerine Sağlayıcı s kodu değeri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-261">For example, if we were reading the category and products data directly from the database as opposed to through the architecture, we d likely want to let the page developer specify the database connection string through `Web.config` rather than using a hard coded value in the provider s code.</span></span> <span data-ttu-id="44f9b-262">Biz adım 6'yapı özel site haritası sağlayıcısı bu kılmaz `Initialize` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-262">The custom site map provider we'll build in Step 6 does not override this `Initialize` method.</span></span> <span data-ttu-id="44f9b-263">Kullanma örneği için `Initialize` yöntemi, başvurmak [Jeff Prosise](http://www.wintellect.com/Weblogs/CategoryView,category,Jeff%20Prosise.aspx) s [SQL Server'daki Site Haritaları depolama](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) makalesi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-263">For an example of using the `Initialize` method, refer to [Jeff Prosise](http://www.wintellect.com/Weblogs/CategoryView,category,Jeff%20Prosise.aspx) s [Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) article.</span></span>


## <a name="step-6-creating-the-custom-site-map-provider"></a><span data-ttu-id="44f9b-264">6. adım: özel Site haritası sağlayıcısı oluşturma</span><span class="sxs-lookup"><span data-stu-id="44f9b-264">Step 6: Creating the Custom Site Map Provider</span></span>

<span data-ttu-id="44f9b-265">Kategoriler ve ürünler Northwind veritabanı, site haritası derlemeler özel site haritası sağlayıcısı oluşturmak için genişleten bir sınıfı oluşturmak ihtiyacımız `StaticSiteMapProvider`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-265">To create a custom site map provider that builds the site map from the categories and products in the Northwind database, we need to create a class that extends `StaticSiteMapProvider`.</span></span> <span data-ttu-id="44f9b-266">1. Adım'ı eklemek için sorulan bir `CustomProviders` klasöründe `App_Code` klasör - adlı bu klasöre yeni bir sınıf ekleyin `NorthwindSiteMapProvider`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-266">In Step 1 I asked you to add a `CustomProviders` folder in the `App_Code` folder - add a new class to this folder named `NorthwindSiteMapProvider`.</span></span> <span data-ttu-id="44f9b-267">Aşağıdaki kodu ekleyin `NorthwindSiteMapProvider` sınıfı:</span><span class="sxs-lookup"><span data-stu-id="44f9b-267">Add the following code to the `NorthwindSiteMapProvider` class:</span></span>


[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample6.vb)]

<span data-ttu-id="44f9b-268">Bu sınıf s keşfe s izin `BuildSiteMap` ile başlayan yöntemi bir [ `lock` deyimi](https://msdn.microsoft.com/library/c5kehkcz.aspx).</span><span class="sxs-lookup"><span data-stu-id="44f9b-268">Let s start with exploring this class s `BuildSiteMap` method, which starts with a [`lock` statement](https://msdn.microsoft.com/library/c5kehkcz.aspx).</span></span> <span data-ttu-id="44f9b-269">`lock` Deyimi yalnızca tek bir iş parçacığı girmek için aynı anda böylece, kodu erişim seri hale getirme ve sağlar birbirine s parmaklarının atlama iki eş zamanlı iş parçacıkları engelliyor.</span><span class="sxs-lookup"><span data-stu-id="44f9b-269">The `lock` statement only allows one thread at a time to enter, thereby serializing access to its code and preventing two concurrent threads from stepping on one another s toes.</span></span>

<span data-ttu-id="44f9b-270">Sınıf düzeyi `SiteMapNode` değişkeni `root` site haritası yapısı önbelleğe almak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-270">The class-level `SiteMapNode` variable `root` is used to cache the site map structure.</span></span> <span data-ttu-id="44f9b-271">Site haritasını ilk kez veya temel alınan veri değiştirildikten sonra ilk kez oluşturulduğunda `root` olacaktır `Nothing` ve site haritası yapısı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-271">When the site map is constructed for the first time, or for the first time after the underlying data has been modified, `root` will be `Nothing` and the site map structure will be constructed.</span></span> <span data-ttu-id="44f9b-272">Site haritası s kök düğümü atandığı `root` sonraki bu yöntem, oluşturma sırasında işlem çağrılırken, `root` değişmeyecek `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-272">The site map s root node is assigned to `root` during the construction process so that the next time this method is called, `root` will not be `Nothing`.</span></span> <span data-ttu-id="44f9b-273">Sonuç olarak, sürece `root` değil `Nothing` yeniden oluşturmak zorunda kalmadan, site haritası yapısı çağırana döndürülür.</span><span class="sxs-lookup"><span data-stu-id="44f9b-273">Consequently, so long as `root` is not `Nothing` the site map structure will be returned to the caller without having to recreate it.</span></span>

<span data-ttu-id="44f9b-274">Kök ise `Nothing`, ürün ve kategori bilgileri site haritası yapısı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-274">If root is `Nothing`, the site map structure is created from the product and category information.</span></span> <span data-ttu-id="44f9b-275">Site haritasını oluşturarak yerleşik `SiteMapNode` örnekleri ve hiyerarşisi aracılığıyla çağrı oluşturuluyor `StaticSiteMapProvider` s sınıfı `AddNode` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-275">The site map is built by creating the `SiteMapNode` instances and then forming the hierarchy through calls to the `StaticSiteMapProvider` class s `AddNode` method.</span></span> <span data-ttu-id="44f9b-276">`AddNode`getirilebilir depolama iç muhasebe gerçekleştirir `SiteMapNode` içinde örnekler bir `Hashtable`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-276">`AddNode` performs the internal bookkeeping, storing the assorted `SiteMapNode` instances in a `Hashtable`.</span></span> <span data-ttu-id="44f9b-277">Hiyerarşi oluşturma başlamadan önce arayarak Başlat `Clear` iç öğeleri çıkışı temizler yöntemi `Hashtable`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-277">Before we start constructing the hierarchy, we start by calling the `Clear` method, which clears out the elements from the internal `Hashtable`.</span></span> <span data-ttu-id="44f9b-278">Ardından, `ProductsBLL` s sınıfı `GetProducts` yöntemi ve elde edilen `ProductsDataTable` yerel değişkenleri depolanır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-278">Next, the `ProductsBLL` class s `GetProducts` method and the resulting `ProductsDataTable` are stored in local variables.</span></span>

<span data-ttu-id="44f9b-279">Kök düğüm oluşturarak ve atanarak site haritası s yapım başlar `root`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-279">The site map s construction begins by creating the root node and assigning it to `root`.</span></span> <span data-ttu-id="44f9b-280">Aşırı yüklemesini [ `SiteMapNode` s Oluşturucusu](https://msdn.microsoft.com/library/system.web.sitemapnode.sitemapnode.aspx) burada ve bu boyunca kullanılan `BuildSiteMap` aşağıdaki bilgileri geçirilir:</span><span class="sxs-lookup"><span data-stu-id="44f9b-280">The overload of the [`SiteMapNode` s constructor](https://msdn.microsoft.com/library/system.web.sitemapnode.sitemapnode.aspx) used here and throughout this `BuildSiteMap` is passed the following information:</span></span>

- <span data-ttu-id="44f9b-281">Site haritası sağlayıcısı başvuru (`Me`).</span><span class="sxs-lookup"><span data-stu-id="44f9b-281">A reference to the site map provider (`Me`).</span></span>
- <span data-ttu-id="44f9b-282">`SiteMapNode` s `Key`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-282">The `SiteMapNode` s `Key`.</span></span> <span data-ttu-id="44f9b-283">Bu değer her biri için benzersiz olmalıdır, gerekli `SiteMapNode`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-283">This required value must be unique for each `SiteMapNode`.</span></span>
- <span data-ttu-id="44f9b-284">`SiteMapNode` s `Url`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-284">The `SiteMapNode` s `Url`.</span></span> <span data-ttu-id="44f9b-285">`Url`isteğe bağlıdır, ancak verdiyse, her `SiteMapNode` s `Url` değer benzersiz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-285">`Url` is optional, but if provided, each `SiteMapNode` s `Url` value must be unique.</span></span>
- <span data-ttu-id="44f9b-286">`SiteMapNode` s `Title`, hangi gereklidir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-286">The `SiteMapNode` s `Title`, which is required.</span></span>

<span data-ttu-id="44f9b-287">`AddNode(root)` Yöntem çağrısı ekler `SiteMapNode` `root` kök olarak site haritası için.</span><span class="sxs-lookup"><span data-stu-id="44f9b-287">The `AddNode(root)` method call adds the `SiteMapNode` `root` to the site map as the root.</span></span> <span data-ttu-id="44f9b-288">Ardından, her `ProductRow` içinde `ProductsDataTable` numaralandırılır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-288">Next, each `ProductRow` in the `ProductsDataTable` is enumerated.</span></span> <span data-ttu-id="44f9b-289">Zaten var. bir `SiteMapNode` için geçerli ürün s kategorisi, başvurulan.</span><span class="sxs-lookup"><span data-stu-id="44f9b-289">If there already exists a `SiteMapNode` for the current product s category, it is referenced.</span></span> <span data-ttu-id="44f9b-290">Aksi takdirde, yeni bir `SiteMapNode` kategori oluşturulur ve bir alt öğesi olarak eklenir için `SiteMapNode``root` aracılığıyla `AddNode(categoryNode, root)` yöntem çağrısı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-290">Otherwise, a new `SiteMapNode` for the category is created and added as a child of the `SiteMapNode``root` through the `AddNode(categoryNode, root)` method call.</span></span> <span data-ttu-id="44f9b-291">Uygun kategoriyi sonra `SiteMapNode` düğüm bulunamadı veya oluşturduğunuz bir `SiteMapNode` geçerli ürün için oluşturulur ve bir alt kategori öğesi olarak eklenir `SiteMapNode` aracılığıyla `AddNode(productNode, categoryNode)`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-291">After the appropriate category `SiteMapNode` node has been found or created, a `SiteMapNode` is created for the current product and added as a child of the category `SiteMapNode` via `AddNode(productNode, categoryNode)`.</span></span> <span data-ttu-id="44f9b-292">Unutmayın kategori `SiteMapNode` s `Url` özellik değeri `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID` while ürün `SiteMapNode` s `Url` özelliği atandığında `~/SiteMapNode/ProductDetails.aspx?ProductID=productID`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-292">Note that the category `SiteMapNode` s `Url` property value is `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID` while the product `SiteMapNode` s `Url` property is assigned `~/SiteMapNode/ProductDetails.aspx?ProductID=productID`.</span></span>

> [!NOTE]
> <span data-ttu-id="44f9b-293">Bir veritabanına sahip bu ürünlerden `NULL` değerini kendi `CategoryID` kategorisi altında gruplanmış `SiteMapNode` , `Title` özelliği yok ve özelliği ayarlanmış `Url` özelliği boş bir dize olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-293">Those products that have a database `NULL` value for their `CategoryID` are grouped under a category `SiteMapNode` whose `Title` property is set to None and whose `Url` property is set to an empty string.</span></span> <span data-ttu-id="44f9b-294">Ayarlama karar `Url` bu yana boş bir dizesine `ProductBLL` s sınıfı `GetProductsByCategory(categoryID)` yöntemi şu anda yalnızca bu ürünlerle döndürülecek özelliği eksik bir `NULL` `CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-294">I decided to set `Url` to an empty string since the `ProductBLL` class s `GetProductsByCategory(categoryID)` method currently lacks the capability to return just those products with a `NULL` `CategoryID` value.</span></span> <span data-ttu-id="44f9b-295">Ayrıca, nasıl gezinme denetimlerini işlemeye göstermek istediğinizde bir `SiteMapNode` için bir değer eksik kendi `Url` özelliği.</span><span class="sxs-lookup"><span data-stu-id="44f9b-295">Also, I wanted to demonstrate how the navigation controls render a `SiteMapNode` that lacks a value for its `Url` property.</span></span> <span data-ttu-id="44f9b-296">Bu öğretici genişletmenizi teşvik böylece hiçbiri `SiteMapNode` s `Url` özelliği işaret `ProductsByCategory.aspx`, henüz ürünleriyle yalnızca görüntüler `NULL` `CategoryID` değerleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-296">I encourage you to extend this tutorial so that the None `SiteMapNode` s `Url` property points to `ProductsByCategory.aspx`, yet only displays the products with `NULL` `CategoryID` values.</span></span>


<span data-ttu-id="44f9b-297">Site haritası oluşturduktan sonra rasgele bir nesne üzerinde bir SQL önbellek bağımlılığı kullanarak veri önbelleği eklenen `Categories` ve `Products` aracılığıyla tabloları bir `AggregateCacheDependency` nesnesi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-297">After constructing the site map, an arbitrary object is added to the data cache using a SQL cache dependency on the `Categories` and `Products` tables through an `AggregateCacheDependency` object.</span></span> <span data-ttu-id="44f9b-298">Önceki öğreticide SQL önbellek bağımlılıkları kullanarak keşfedilen *kullanarak SQL önbellek bağımlılıkları*.</span><span class="sxs-lookup"><span data-stu-id="44f9b-298">We explored using SQL cache dependencies in the preceding tutorial, *Using SQL Cache Dependencies*.</span></span> <span data-ttu-id="44f9b-299">Özel site haritası sağlayıcısı ancak, bir aşırı yüklemesini veri önbelleği s kullanır `Insert` yöntemi görüyoruz henüz keşfetmek için ve.</span><span class="sxs-lookup"><span data-stu-id="44f9b-299">The custom site map provider, however, uses an overload of the data cache s `Insert` method that we ve yet to explore.</span></span> <span data-ttu-id="44f9b-300">Bu aşırı nesneyi önbellekten kaldırıldığında çağrılan bir temsilciyi son giriş parametresi olarak kabul eder.</span><span class="sxs-lookup"><span data-stu-id="44f9b-300">This overload accepts as its final input parameter a delegate that is called when the object is removed from the cache.</span></span> <span data-ttu-id="44f9b-301">Özellikle, size yeni bir geçirmek [ `CacheItemRemovedCallback` temsilci](https://msdn.microsoft.com/library/system.web.caching.cacheitemremovedcallback.aspx) işaret `OnSiteMapChanged` yöntemi aşağıya içinde tanımlanan `NorthwindSiteMapProvider` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-301">Specifically, we pass in a new [`CacheItemRemovedCallback` delegate](https://msdn.microsoft.com/library/system.web.caching.cacheitemremovedcallback.aspx) that points to the `OnSiteMapChanged` method defined further down in the `NorthwindSiteMapProvider` class.</span></span>

> [!NOTE]
> <span data-ttu-id="44f9b-302">Site haritasını bellek içi gösterimini sınıf düzeyi değişkeni önbelleğe `root`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-302">The in-memory representation of the site map is cached through the class-level variable `root`.</span></span> <span data-ttu-id="44f9b-303">Özel site haritası sağlayıcısı sınıfı ve bu örnek web uygulamasındaki tüm iş parçacıkları arasında paylaşıldığından yalnızca bir örnek olduğundan, bu sınıf değişkeni önbellek olarak görev yapar.</span><span class="sxs-lookup"><span data-stu-id="44f9b-303">Since there is only one instance of the custom site map provider class and since that instance is shared among all threads in the web application, this class variable serves as a cache.</span></span> <span data-ttu-id="44f9b-304">`BuildSiteMap` Yöntemi de kullandığı veri önbelleği temel veritabanı verilerde bildirim almak için yalnızca bir yol olarak `Categories` veya `Products` tabloları değişiklikleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-304">The `BuildSiteMap` method also uses the data cache, but only as a means to receive notification when the underlying database data in the `Categories` or `Products` tables changes.</span></span> <span data-ttu-id="44f9b-305">Veri önbelleğe koyulur değeri yalnızca geçerli tarih ve saat olduğuna dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-305">Note that the value put into the data cache is just the current date and time.</span></span> <span data-ttu-id="44f9b-306">Gerçek site haritası verileri *değil* veri önbelleğindeki yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-306">The actual site map data is *not* put in the data cache.</span></span>


<span data-ttu-id="44f9b-307">`BuildSiteMap` Yöntemi tamamlayan site haritası kök düğümünün döndürerek.</span><span class="sxs-lookup"><span data-stu-id="44f9b-307">The `BuildSiteMap` method completes by returning the root node of the site map.</span></span>

<span data-ttu-id="44f9b-308">Kalan yöntemleri oldukça basittir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-308">The remaining methods are fairly straightforward.</span></span> <span data-ttu-id="44f9b-309">`GetRootNodeCore`kök düğüm döndürmek için sorumludur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-309">`GetRootNodeCore` is responsible for returning the root node.</span></span> <span data-ttu-id="44f9b-310">Bu yana `BuildSiteMap` kökünü döndürür `GetRootNodeCore` yalnızca döndürür `BuildSiteMap` s dönüş değeri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-310">Since `BuildSiteMap` returns the root, `GetRootNodeCore` simply returns `BuildSiteMap` s return value.</span></span> <span data-ttu-id="44f9b-311">`OnSiteMapChanged` Yöntemi kümeleri `root` başa `Nothing` önbellek öğesi kaldırıldığında.</span><span class="sxs-lookup"><span data-stu-id="44f9b-311">The `OnSiteMapChanged` method sets `root` back to `Nothing` when the cache item is removed.</span></span> <span data-ttu-id="44f9b-312">Döndürülmek kök ile `Nothing`, sonraki `BuildSiteMap` olan çağrılır, site haritası yapısı yeniden oluşturulacak.</span><span class="sxs-lookup"><span data-stu-id="44f9b-312">With root set back to `Nothing`, the next time `BuildSiteMap` is invoked, the site map structure will be rebuilt.</span></span> <span data-ttu-id="44f9b-313">Son olarak, `CachedDate` özelliği, bu tür bir değeri varsa, veri önbelleğinde depolanan tarih ve saat değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="44f9b-313">Lastly, the `CachedDate` property returns the date and time value stored in the data cache, if such a value exists.</span></span> <span data-ttu-id="44f9b-314">Bu özellik sayfasında geliştirici tarafından site haritası verileri en son ne zaman önbelleğe ilişkili belirlemek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-314">This property can be used by a page developer to determine when the site map data was last cached.</span></span>

## <a name="step-7-registering-thenorthwindsitemapprovider"></a><span data-ttu-id="44f9b-315">7. adım: Kaydetme`NorthwindSiteMapProvider`</span><span class="sxs-lookup"><span data-stu-id="44f9b-315">Step 7: Registering the`NorthwindSiteMapProvider`</span></span>

<span data-ttu-id="44f9b-316">Kullanılacak web uygulamamız için sırayla `NorthwindSiteMapProvider` site haritası sağlayıcısı, adım 6'oluşturulan ihtiyacımız içine kaydettirmek `<siteMap>` bölümünü `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-316">In order for our web application to use the `NorthwindSiteMapProvider` site map provider created in Step 6, we need to register it in the `<siteMap>` section of `Web.config`.</span></span> <span data-ttu-id="44f9b-317">Özellikle, aşağıdaki biçimlendirmesi içinde eklemeniz `<system.web>` öğesinde `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="44f9b-317">Specifically, add the following markup within the `<system.web>` element in `Web.config`:</span></span>


[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample7.xml)]

<span data-ttu-id="44f9b-318">Bu biçimlendirme şu iki işlemi yapar: gösterir ilk olarak, yerleşik `AspNetXmlSiteMapProvider` varsayılan site haritası sağlayıcısı; ikinci olarak, adım 6 ' İnsan kolay adı Northwind oluşturulan özel site haritası sağlayıcısı kaydeder.</span><span class="sxs-lookup"><span data-stu-id="44f9b-318">This markup does two things: first, it indicates that the built-in `AspNetXmlSiteMapProvider` is the default site map provider; second, it registers the custom site map provider created in Step 6 with the human-friendly name Northwind .</span></span>

> [!NOTE]
> <span data-ttu-id="44f9b-319">Uygulama s içinde bulunan site haritası sağlayıcıları için `App_Code` klasörü, değeri `type` yalnızca sınıf adı bir özniteliktir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-319">For site map providers located in the application s `App_Code` folder, the value of the `type` attribute is simply the class name.</span></span> <span data-ttu-id="44f9b-320">Alternatif olarak, özel site haritası sağlayıcısı ayrı bir sınıf kitaplığı projesi ile web uygulaması s yerleştirilen derlenmiş derleme oluşturulmuş `/Bin` dizin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-320">Alternatively, the custom site map provider could have been created in a separate Class Library project with the compiled assembly placed in the web application s `/Bin` directory.</span></span> <span data-ttu-id="44f9b-321">Bu durumda, `type` öznitelik değeri olacaktır *Namespace*. *ClassName*, *AssemblyName* .</span><span class="sxs-lookup"><span data-stu-id="44f9b-321">In that case, the `type` attribute value would be *Namespace*.*ClassName*, *AssemblyName* .</span></span>


<span data-ttu-id="44f9b-322">Güncelleştirdikten sonra `Web.config`, herhangi bir sayfasından öğreticiler bir tarayıcıda görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-322">After updating `Web.config`, take a moment to view any page from the tutorials in a browser.</span></span> <span data-ttu-id="44f9b-323">Sol taraftaki gezinti arabirimi bölümleri görüntülenmeye devam eder ve öğreticiler tanımlanan Not `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-323">Note that the navigation interface on the left still shows the sections and tutorials defined in `Web.sitemap`.</span></span> <span data-ttu-id="44f9b-324">Biz sol olmasıdır `AspNetXmlSiteMapProvider` varsayılan sağlayıcı olarak.</span><span class="sxs-lookup"><span data-stu-id="44f9b-324">This is because we left `AspNetXmlSiteMapProvider` as the default provider.</span></span> <span data-ttu-id="44f9b-325">Kullanan bir gezinti kullanıcı arabirimi öğesi oluşturmak için `NorthwindSiteMapProvider`, biz Northwind site haritası sağlayıcısı kullanılması gerektiğini açıkça belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-325">In order to create a navigation user interface element that uses the `NorthwindSiteMapProvider`, we'll need to explicitly specify that the Northwind site map provider should be used.</span></span> <span data-ttu-id="44f9b-326">Bu adım 8'de nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-326">We'll see how to accomplish this in Step 8.</span></span>

## <a name="step-8-displaying-site-map-information-using-the-custom-site-map-provider"></a><span data-ttu-id="44f9b-327">8. adım: özel Site haritası sağlayıcısı kullanarak Site Haritası bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="44f9b-327">Step 8: Displaying Site Map Information Using the Custom Site Map Provider</span></span>

<span data-ttu-id="44f9b-328">Özel site haritası sağlayıcısı oluşturulan ve kayıtlı `Web.config`, biz Gezinti denetimler eklemek için hazır re `Default.aspx`, `ProductsByCategory.aspx`, ve `ProductDetails.aspx` içinde sayfaları `SiteMapProvider` klasör.</span><span class="sxs-lookup"><span data-stu-id="44f9b-328">With the custom site map provider created and registered in `Web.config`, we re ready to add navigation controls to the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages in the `SiteMapProvider` folder.</span></span> <span data-ttu-id="44f9b-329">Başlangıç açarak `Default.aspx` sayfasında ve sürükleyin bir `SiteMapPath` tasarımcıya araç.</span><span class="sxs-lookup"><span data-stu-id="44f9b-329">Start by opening the `Default.aspx` page and drag a `SiteMapPath` from the Toolbox onto the Designer.</span></span> <span data-ttu-id="44f9b-330">ASP araç gezinti bölümünde bulunur.</span><span class="sxs-lookup"><span data-stu-id="44f9b-330">The SiteMapPath control is located in the Navigation section of the Toolbox.</span></span>


<span data-ttu-id="44f9b-331">[![Bir SiteMapPath için Default.aspx ekleme](building-a-custom-database-driven-site-map-provider-vb/_static/image19.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image18.gif)</span><span class="sxs-lookup"><span data-stu-id="44f9b-331">[![Add a SiteMapPath to Default.aspx](building-a-custom-database-driven-site-map-provider-vb/_static/image19.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image18.gif)</span></span>

<span data-ttu-id="44f9b-332">**Şekil 16**: bir SiteMapPath eklemek `Default.aspx` ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image20.gif))</span><span class="sxs-lookup"><span data-stu-id="44f9b-332">**Figure 16**: Add a SiteMapPath to `Default.aspx` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image20.gif))</span></span>


<span data-ttu-id="44f9b-333">ASP site haritası içindeki geçerli sayfa s konumunu belirten bir içerik haritası görüntüler.</span><span class="sxs-lookup"><span data-stu-id="44f9b-333">The SiteMapPath control displays a breadcrumb, indicating the current page s location within the site map.</span></span> <span data-ttu-id="44f9b-334">Ana sayfaya dön bir SiteMapPath eklediğimiz geri *ana sayfalar ve Site gezintisi* Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-334">We added a SiteMapPath to the top of the master page back in the *Master Pages and Site Navigation* tutorial.</span></span>

<span data-ttu-id="44f9b-335">Bir tarayıcı aracılığıyla bu sayfayı görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-335">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="44f9b-336">Şekil 16'eklenen SiteMapPath kendi verisinden çekme varsayılan site haritası sağlayıcısı kullanan `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-336">The SiteMapPath added in Figure 16 uses the default site map provider, pulling its data from `Web.sitemap`.</span></span> <span data-ttu-id="44f9b-337">Bu nedenle, içerik haritası giriş gösterir &gt; sağ üst köşesinde haritasındaki gibi Site Haritası özelleştirme.</span><span class="sxs-lookup"><span data-stu-id="44f9b-337">Therefore, the breadcrumb shows Home &gt; Customizing the Site Map, just like the breadcrumb in the upper-right corner.</span></span>


<span data-ttu-id="44f9b-338">[![Varsayılan Site haritası sağlayıcısı içerik haritası kullanır](building-a-custom-database-driven-site-map-provider-vb/_static/image22.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="44f9b-338">[![The Breadcrumb Uses the Default Site Map Provider](building-a-custom-database-driven-site-map-provider-vb/_static/image22.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.gif)</span></span>

<span data-ttu-id="44f9b-339">**Şekil 17**: içerik haritası varsayılan Site haritası sağlayıcısı kullanır ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="44f9b-339">**Figure 17**: The Breadcrumb Uses the Default Site Map Provider ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image23.gif))</span></span>


<span data-ttu-id="44f9b-340">Adım 6'oluşturduğumuz özel site haritası sağlayıcısı kullanın Şekil 16'eklenen SiteMapPath olacak şekilde ayarlanmış kendi [ `SiteMapProvider` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemappath.sitemapprovider.aspx) Northwind için ad size atanan `NorthwindSiteMapProvider` içinde `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-340">To have the SiteMapPath added in Figure 16 use the custom site map provider we created in Step 6, set its [`SiteMapProvider` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemappath.sitemapprovider.aspx) to Northwind, the name we assigned to the `NorthwindSiteMapProvider` in `Web.config`.</span></span> <span data-ttu-id="44f9b-341">Ne yazık ki, Tasarımcı varsayılan site haritası sağlayıcısı kullanmaya devam eder, ancak bu özellik değişikliği yaptıktan sonra bir tarayıcı aracılığıyla sayfasını ziyaret edin, içerik haritası şimdi özel site haritası sağlayıcısı kullandığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="44f9b-341">Unfortunately, the Designer continues to use the default site map provider, but if you visit the page through a browser after making this property change you'll see that the breadcrumb now uses the custom site map provider.</span></span>


<span data-ttu-id="44f9b-342">[![İçerik haritası artık özel Site haritası sağlayıcısı NorthwindSiteMapProvider kullanır](building-a-custom-database-driven-site-map-provider-vb/_static/image25.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image24.gif)</span><span class="sxs-lookup"><span data-stu-id="44f9b-342">[![The Breadcrumb Now Uses the Custom Site Map Provider NorthwindSiteMapProvider](building-a-custom-database-driven-site-map-provider-vb/_static/image25.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image24.gif)</span></span>

<span data-ttu-id="44f9b-343">**Şekil 18**: içerik haritası artık özel Site haritası sağlayıcısı kullanıyor `NorthwindSiteMapProvider` ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image26.gif))</span><span class="sxs-lookup"><span data-stu-id="44f9b-343">**Figure 18**: The Breadcrumb Now Uses the Custom Site Map Provider `NorthwindSiteMapProvider` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image26.gif))</span></span>


<span data-ttu-id="44f9b-344">ASP daha işlevsel bir kullanıcı arabirimi görüntüler `ProductsByCategory.aspx` ve `ProductDetails.aspx` sayfaları.</span><span class="sxs-lookup"><span data-stu-id="44f9b-344">The SiteMapPath control displays a more functional user interface in the `ProductsByCategory.aspx` and `ProductDetails.aspx` pages.</span></span> <span data-ttu-id="44f9b-345">Bir SiteMapPath ayarı bu sayfalara eklemek `SiteMapProvider` Northwind için hem de özelliği.</span><span class="sxs-lookup"><span data-stu-id="44f9b-345">Add a SiteMapPath to these pages, setting the `SiteMapProvider` property in both to Northwind.</span></span> <span data-ttu-id="44f9b-346">Gelen `Default.aspx` içecek ürünleri görüntüleyin bağlantısını ve ardından Chai Çay ayrıntılarını görüntüle bağlantısını tıklayın.</span><span class="sxs-lookup"><span data-stu-id="44f9b-346">From `Default.aspx` click on the View Products link for Beverages, and then on the View Details link for Chai Tea.</span></span> <span data-ttu-id="44f9b-347">Şekil 19 gösterildiği gibi geçerli site eşlemesi bölümü (Chai Çay) ve onun üst öğelerinin içerik haritası içerir: Meşrubat ve tüm kategoriler.</span><span class="sxs-lookup"><span data-stu-id="44f9b-347">As Figure 19 shows, the breadcrumb includes the current site map section ( Chai Tea ) and its ancestors: Beverages and All Categories .</span></span>


<span data-ttu-id="44f9b-348">[![İçerik haritası artık özel Site haritası sağlayıcısı NorthwindSiteMapProvider kullanır](building-a-custom-database-driven-site-map-provider-vb/_static/image27.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="44f9b-348">[![The Breadcrumb Now Uses the Custom Site Map Provider NorthwindSiteMapProvider](building-a-custom-database-driven-site-map-provider-vb/_static/image27.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.png)</span></span>

<span data-ttu-id="44f9b-349">**Şekil 19**: içerik haritası artık özel Site haritası sağlayıcısı kullanıyor `NorthwindSiteMapProvider` ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="44f9b-349">**Figure 19**: The Breadcrumb Now Uses the Custom Site Map Provider `NorthwindSiteMapProvider` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image22.png))</span></span>


<span data-ttu-id="44f9b-350">Menü ve TreeView denetimleri gibi SiteMapPath yanı sıra diğer gezinti kullanıcı arabirimi öğeleri kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-350">Other navigation user interface elements can be used in addition to the SiteMapPath, such as the Menu and TreeView controls.</span></span> <span data-ttu-id="44f9b-351">`Default.aspx`, `ProductsByCategory.aspx`, Ve `ProductDetails.aspx` Bu öğretici, örneğin, indirme sayfalarında, tüm içerir (bkz. Şekil 20) menü denetimleri.</span><span class="sxs-lookup"><span data-stu-id="44f9b-351">The `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages in the download for this tutorial, for example, all include Menu controls (see Figure 20).</span></span> <span data-ttu-id="44f9b-352">Bkz: [inceleniyor ASP.NET 2.0 s Site Gezinti özellikleri](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) ve [kullanarak Site Gezinti denetimlerinin](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/navigation/sitenavcontrols.aspx) bölümünü [ASP.NET 2.0 QuickStarts](https://quickstarts.asp.net/QuickStartv20/aspnet/) daha kapsamlı bir bakış için Gezinti denetimleri ve site sistemi, ASP.NET 2.0 eşleyin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-352">See [Examining ASP.NET 2.0 s Site Navigation Features](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) and the [Using Site Navigation Controls](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/navigation/sitenavcontrols.aspx) section of the [ASP.NET 2.0 QuickStarts](https://quickstarts.asp.net/QuickStartv20/aspnet/) for a more in-depth look at the navigation controls and site map system in ASP.NET 2.0.</span></span>


<span data-ttu-id="44f9b-353">[![Menü denetimi her kategori ve ürünleri listeler](building-a-custom-database-driven-site-map-provider-vb/_static/image29.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image28.gif)</span><span class="sxs-lookup"><span data-stu-id="44f9b-353">[![The Menu Control Lists Each of the Categories and Products](building-a-custom-database-driven-site-map-provider-vb/_static/image29.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image28.gif)</span></span>

<span data-ttu-id="44f9b-354">**Şekil 20**: menü denetim listeleri her kategori ve ürünleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image30.gif))</span><span class="sxs-lookup"><span data-stu-id="44f9b-354">**Figure 20**: The Menu Control Lists Each of the Categories and Products ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image30.gif))</span></span>


<span data-ttu-id="44f9b-355">Bu öğreticide daha önce belirtildiği gibi site haritası yapısı aracılığıyla programlı olarak erişilebilir `SiteMap` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-355">As mentioned earlier in this tutorial, the site map structure can be accessed programmatically through the `SiteMap` class.</span></span> <span data-ttu-id="44f9b-356">Aşağıdaki kod kök döndürür `SiteMapNode` varsayılan sağlayıcısı:</span><span class="sxs-lookup"><span data-stu-id="44f9b-356">The following code returns the root `SiteMapNode` of the default provider:</span></span>


[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample8.vb)]

<span data-ttu-id="44f9b-357">Bu yana `AspNetXmlSiteMapProvider` varsayılan sağlayıcı uygulamamız için tanımlanan kök düğümü Yukarıdaki kod döndürecekti `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="44f9b-357">Since the `AspNetXmlSiteMapProvider` is the default provider for our application, the above code would return the root node defined in `Web.sitemap`.</span></span> <span data-ttu-id="44f9b-358">Bir site haritası sağlayıcısı varsayılan dışındaki başvurmak için `SiteMap` s sınıfı [ `Providers` özelliği](https://msdn.microsoft.com/library/system.web.sitemap.providers.aspx) sözlüğüdür:</span><span class="sxs-lookup"><span data-stu-id="44f9b-358">To reference a site map provider other than the default, use the `SiteMap` class s [`Providers` property](https://msdn.microsoft.com/library/system.web.sitemap.providers.aspx) like so:</span></span>


[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample9.vb)]

<span data-ttu-id="44f9b-359">Burada *adı* özel site haritası sağlayıcısı (web uygulamamız için Northwind) adıdır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-359">Where *name* is the name of the custom site map provider ( Northwind, for our web application).</span></span>

<span data-ttu-id="44f9b-360">Bir site haritası sağlayıcısı için belirli bir üye erişmek için `SiteMap.Providers["name"]` sağlayıcı örneğini almak ve uygun türe dönüştürülemiyor.</span><span class="sxs-lookup"><span data-stu-id="44f9b-360">To access a member specific to a site map provider, use `SiteMap.Providers["name"]` to retrieve the provider instance and then cast it to the appropriate type.</span></span> <span data-ttu-id="44f9b-361">Örneğin, görüntülemek için `NorthwindSiteMapProvider` s `CachedDate` bir ASP.NET sayfası özelliğinde şu kodu kullanın:</span><span class="sxs-lookup"><span data-stu-id="44f9b-361">For example, to display the `NorthwindSiteMapProvider` s `CachedDate` property in an ASP.NET page, use the following code:</span></span>


[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample10.vb)]

> [!NOTE]
> <span data-ttu-id="44f9b-362">SQL önbellek bağımlılık özelliği test etmek emin olun.</span><span class="sxs-lookup"><span data-stu-id="44f9b-362">Be sure to test out the SQL cache dependency feature.</span></span> <span data-ttu-id="44f9b-363">Ziyaret sonra `Default.aspx`, `ProductsByCategory.aspx`, ve `ProductDetails.aspx` sayfaları, düzenleme, ekleme ve bölüm silme eğitimlerine birine gidin ve bir kategori veya ürün adını düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="44f9b-363">After visiting the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages, go to one of the tutorials in the Editing, Inserting, and Deleting section and edit the name of a category or product.</span></span> <span data-ttu-id="44f9b-364">Sayfalarında birine dönmek `SiteMapProvider` klasör.</span><span class="sxs-lookup"><span data-stu-id="44f9b-364">Then return to one of the pages in the `SiteMapProvider` folder.</span></span> <span data-ttu-id="44f9b-365">Temel alınan veritabanı değişikliği not etmek yoklama mekanizması için yeterli süre geçti varsayıldığında, site haritası yeni ürün veya kategori adı göstermek için güncelleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="44f9b-365">Assuming enough time has passed for the polling mechanism to note the change to the underlying database, the site map should be updated to show the new product or category name.</span></span>


## <a name="summary"></a><span data-ttu-id="44f9b-366">Özet</span><span class="sxs-lookup"><span data-stu-id="44f9b-366">Summary</span></span>

<span data-ttu-id="44f9b-367">ASP.NET 2.0 s site haritası özellikleri içeren bir `SiteMap` sınıfı, bir dizi yerleşik gezinti Web denetler ve site haritası bilgileri bekliyor bir varsayılan site haritası sağlayıcısı bir XML dosyasına kalıcı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-367">ASP.NET 2.0 s site map features includes a `SiteMap` class, a number of built-in navigation Web controls, and a default site map provider that expects the site map information persisted to an XML file.</span></span> <span data-ttu-id="44f9b-368">Site Eşlemesi bilgileri kaynağından bazı diğer gibi bir veritabanı, uygulama s mimarisi ya da özel site haritası sağlayıcısı oluşturmak için ihtiyacımız uzak bir Web hizmeti kullanmak için.</span><span class="sxs-lookup"><span data-stu-id="44f9b-368">In order to use site map information from some other source such as from a database, the application s architecture, or a remote Web service we need to create a custom site map provider.</span></span> <span data-ttu-id="44f9b-369">Bu, doğrudan veya dolaylı olarak, türeyen bir sınıf oluşturursunuz gelen `SiteMapProvider` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="44f9b-369">This involves creating a class that derives, directly or indirectly, from the `SiteMapProvider` class.</span></span>

<span data-ttu-id="44f9b-370">Bu öğreticide uygulama mimarisinden culled ürün ve kategori bilgileri site haritası dayanarak bir özel site haritası sağlayıcısı oluşturma gördük.</span><span class="sxs-lookup"><span data-stu-id="44f9b-370">In this tutorial we saw how to create a custom site map provider that based the site map on the product and category information culled from the application architecture.</span></span> <span data-ttu-id="44f9b-371">Genişletilmiş bizim sağlayıcısı `StaticSiteMapProvider` sınıfı ve entailed oluşturma bir `BuildSiteMap` veri alınan yöntemi site haritası hiyerarşisi oluşturulan ve sonuçta elde edilen sınıf düzeyinde bir değişkene yapısında önbelleğe alınmış.</span><span class="sxs-lookup"><span data-stu-id="44f9b-371">Our provider extended the `StaticSiteMapProvider` class and entailed creating a `BuildSiteMap` method that retrieved the data, constructed the site map hierarchy, and cached the resulting structure in a class-level variable.</span></span> <span data-ttu-id="44f9b-372">Bir SQL önbellek bağımlılığı bir geri çağırma işlevini ile önbelleğe alınmış geçersiz kılmak için kullandık ne zaman yapısı arka plandaki `Categories` veya `Products` veri değiştirdi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-372">We used a SQL cache dependency with a callback function to invalidate the cached structure when the underlying `Categories` or `Products` data is modified.</span></span>

<span data-ttu-id="44f9b-373">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="44f9b-373">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="44f9b-374">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="44f9b-374">Further Reading</span></span>

<span data-ttu-id="44f9b-375">Bu öğreticide konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="44f9b-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="44f9b-376">[SQL Server'da Site Haritaları depolama](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) ve [SQL Site haritası sağlayıcısı önceden beklediğinden](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx)</span><span class="sxs-lookup"><span data-stu-id="44f9b-376">[Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) and [The SQL Site Map Provider You ve Been Waiting For](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx)</span></span>
- [<span data-ttu-id="44f9b-377">ASP.NET 2.0 göz s sağlayıcı modeli</span><span class="sxs-lookup"><span data-stu-id="44f9b-377">A Look at ASP.NET 2.0 s Provider Model</span></span>](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)
- [<span data-ttu-id="44f9b-378">Sağlayıcı Araç Seti</span><span class="sxs-lookup"><span data-stu-id="44f9b-378">The Provider Toolkit</span></span>](https://msdn.microsoft.com/asp.net/aa336558.aspx)
- [<span data-ttu-id="44f9b-379">ASP.NET 2.0 inceleniyor s Site Gezinti özellikleri</span><span class="sxs-lookup"><span data-stu-id="44f9b-379">Examining ASP.NET 2.0 s Site Navigation Features</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="44f9b-380">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="44f9b-380">About the Author</span></span>

<span data-ttu-id="44f9b-381">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="44f9b-381">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="44f9b-382">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="44f9b-382">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="44f9b-383">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="44f9b-383">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="44f9b-384">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="44f9b-384">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="44f9b-385">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="44f9b-385">Special Thanks To</span></span>

<span data-ttu-id="44f9b-386">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="44f9b-386">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="44f9b-387">Bu öğretici için sağlama gözden geçirenler Dave Gardner, Zack Can, Teresa Murphy ve Bernadette Leigh yoktu.</span><span class="sxs-lookup"><span data-stu-id="44f9b-387">Lead reviewers for this tutorial were Dave Gardner, Zack Jones, Teresa Murphy, and Bernadette Leigh.</span></span> <span data-ttu-id="44f9b-388">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="44f9b-388">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="44f9b-389">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="44f9b-389">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="44f9b-390">Önceki</span><span class="sxs-lookup"><span data-stu-id="44f9b-390">Previous</span></span>](building-a-custom-database-driven-site-map-provider-cs.md)
