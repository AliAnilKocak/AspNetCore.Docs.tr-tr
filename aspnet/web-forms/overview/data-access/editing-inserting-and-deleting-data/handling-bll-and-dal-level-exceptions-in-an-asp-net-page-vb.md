---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb
title: "Bir ASP.NET sayfası (VB) BLL ve DAL düzeyi özel durumları işleme | Microsoft Docs"
author: rick-anderson
description: "Bu öğreticide bir özel durum ekleme, güncelleştirme veya silme işlemi, sırasında gerçekleşmesi gereken kolay, bilgilendirici hata iletisini görüntülemek nasıl göreceğiz..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 129d4338-1315-4f40-89b5-2b84b807707d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 2269458cbc41fd3a483aaade0f07288ee805bdd1
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="handling-bll--and-dal-level-exceptions-in-an-aspnet-page-vb"></a><span data-ttu-id="5b2f7-103">Bir ASP.NET sayfası (VB) BLL ve DAL düzeyi özel durumları işleme</span><span class="sxs-lookup"><span data-stu-id="5b2f7-103">Handling BLL- and DAL-Level Exceptions in an ASP.NET Page (VB)</span></span>
====================
<span data-ttu-id="5b2f7-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5b2f7-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_18_VB.exe) veya [PDF indirin](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/datatutorial18vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_18_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/datatutorial18vb1.pdf)</span></span>

> <span data-ttu-id="5b2f7-106">Bu öğreticide bir INSERT, update veya ASP.NET veri Web denetimi silme işlemi sırasında bir özel durum gerçekleşeceğini kolay, bilgilendirici hata iletisini görüntülemek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-106">In this tutorial we will see how to display a friendly, informative error message should an exception occur during an insert, update, or delete operation of an ASP.NET data Web control.</span></span>


## <a name="introduction"></a><span data-ttu-id="5b2f7-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="5b2f7-107">Introduction</span></span>

<span data-ttu-id="5b2f7-108">Bir Katmanlı Uygulama mimarisi kullanarak bir ASP.NET web uygulaması verilerle çalışma aşağıdaki üç genel adımları içerir:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-108">Working with data from an ASP.NET web application using a tiered application architecture involves the following three general steps:</span></span>

1. <span data-ttu-id="5b2f7-109">İş mantığı katmanı, hangi yöntemin çağrılması gerekir ve geçirileceğini hangi parametre değerleri belirler.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-109">Determine what method of the Business Logic Layer needs to be invoked and what parameter values to pass it.</span></span> <span data-ttu-id="5b2f7-110">Parametre değerleri sabit kodlanmış, programlı olarak atanmış olabilir veya girişleri kullanıcı tarafından girilen.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-110">The parameter values can be hard coded, programmatically-assigned, or inputs entered by the user.</span></span>
2. <span data-ttu-id="5b2f7-111">Invoke yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-111">Invoke the method.</span></span>
3. <span data-ttu-id="5b2f7-112">Sonuçları işleyin.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-112">Process the results.</span></span> <span data-ttu-id="5b2f7-113">Veri döndüren bir BLL yöntemi çağrılırken, bu verileri bir veri Web denetimi bağlama gerektirebilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-113">When calling a BLL method that returns data, this may involve binding the data to a data Web control.</span></span> <span data-ttu-id="5b2f7-114">Verileri değiştirme BLL yöntemleri için bu bir dönüş değerini temel veya düzgün biçimde 2. adımda çıkan herhangi bir özel durum işleme bazı eylemler gerçekleştirme içerebilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-114">For BLL methods that modify data, this may include performing some action based on a return value or gracefully handling any exception that arose in Step 2.</span></span>

<span data-ttu-id="5b2f7-115">İçinde gördüğümüz gibi [önceki öğretici](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md), ObjectDataSource ve Web denetimleri veri adımları 1 ve 3 için genişletilebilirlik noktaları sağlar.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-115">As we saw in the [previous tutorial](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md), both the ObjectDataSource and the data Web controls provide extensibility points for Steps 1 and 3.</span></span> <span data-ttu-id="5b2f7-116">GridView, örneğin, harekete kendi `RowUpdating` alan değerlerini kendi ObjectDataSource için 's atama önce olay `UpdateParameters` koleksiyonu; kendi `RowUpdated` ObjectDataSource işlemi tamamlandıktan sonra olayı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-116">The GridView, for example, fires its `RowUpdating` event prior to assigning its field values to its ObjectDataSource's `UpdateParameters` collection; its `RowUpdated` event is raised after the ObjectDataSource has completed the operation.</span></span>

<span data-ttu-id="5b2f7-117">Biz zaten adım 1 sırasında yangın ve nasıl giriş parametreleri özelleştirmek veya işlemi iptal etmek için kullanılabilmesi için görülen olayları incelendi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-117">We've already examined the events that fire during Step 1 and have seen how they can be used to customize the input parameters or cancel the operation.</span></span> <span data-ttu-id="5b2f7-118">Bu öğreticide biz uygulamamızla işlemi tamamlandıktan sonra harekete olayları kapatmanız.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-118">In this tutorial we'll turn our attention to the events that fire after the operation has completed.</span></span> <span data-ttu-id="5b2f7-119">Bunun yanı sıra, geçebiliriz bu sonrası düzeyi olay işleyicileri ile işlem sırasında bir özel durum oluştu, belirlemek ve standart ASP.NET varsayarak yerine kolay, bilgilendirici hata iletisi ekranda görüntüleme kolaylıkla, idare özel durum sayfası.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-119">With these post-level event handlers we can, among other things, determine if an exception occurred during the operation and handle it gracefully, displaying a friendly, informative error message on the screen rather than defaulting to the standard ASP.NET exception page.</span></span>

<span data-ttu-id="5b2f7-120">Bu sonrası düzeyi olaylar ile çalışmayı göstermek için düzenlenebilir GridView ürünleri listeler bir sayfa oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-120">To illustrate working with these post-level events, let's create a page that lists the products in an editable GridView.</span></span> <span data-ttu-id="5b2f7-121">Bir özel durum ise, bir ürün güncelleştirme başlatıldığında bizim ASP.NET sayfası bir sorun oluştu açıklayan GridView yukarıda kısa bir ileti görüntüler.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-121">When updating a product, if an exception is raised our ASP.NET page will display a short message above the GridView explaining that a problem has occurred.</span></span> <span data-ttu-id="5b2f7-122">Haydi başlayalım!</span><span class="sxs-lookup"><span data-stu-id="5b2f7-122">Let's get started!</span></span>

## <a name="step-1-creating-an-editable-gridview-of-products"></a><span data-ttu-id="5b2f7-123">1. adım: ürünlerin düzenlenebilir bir GridView oluşturma</span><span class="sxs-lookup"><span data-stu-id="5b2f7-123">Step 1: Creating an Editable GridView of Products</span></span>

<span data-ttu-id="5b2f7-124">Önceki öğreticide düzenlenebilir GridView yalnızca iki alanlarla oluşturduğumuz `ProductName` ve `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-124">In the previous tutorial we created an editable GridView with just two fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="5b2f7-125">Bu gerekli bir ek aşırı için oluşturma `ProductsBLL` sınıfının `UpdateProduct` yöntemi, yalnızca üç giriş parametreleri (ürün adı, birim fiyat ve kimliği) her ürün alanı için karşılıklı olarak bir parametre kabul eden.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-125">This required creating an additional overload for the `ProductsBLL` class's `UpdateProduct` method, one that only accepted three input parameters (the product's name, unit price, and ID) as opposed a parameter for each product field.</span></span> <span data-ttu-id="5b2f7-126">Bu öğretici için ürün adı, miktar birimi, birim fiyat ve birim başına stokta görüntüler, ancak yalnızca adını, birim fiyat ve birimleri düzenlenmesi stokta verir düzenlenebilir bir GridView oluşturma Bu teknik yeniden, uygulama yapalım.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-126">For this tutorial, let's practice this technique again, creating an editable GridView that displays the product's name, quantity per unit, unit price, and units in stock, but only allows the name, unit price, and units in stock to be edited.</span></span>

<span data-ttu-id="5b2f7-127">Bu senaryoda çalışmak için başka bir aşırı yüklemesini ihtiyacımız `UpdateProduct` yöntemi, dört parametre kabul eden: Ürün adı, birim fiyat, stock ve kimliği birim</span><span class="sxs-lookup"><span data-stu-id="5b2f7-127">To accommodate this scenario we'll need another overload of the `UpdateProduct` method, one that accepts four parameters: the product's name, unit price, units in stock, and ID.</span></span> <span data-ttu-id="5b2f7-128">Aşağıdaki yöntemi ekleyin `ProductsBLL` sınıfı:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-128">Add the following method to the `ProductsBLL` class:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample1.vb)]

<span data-ttu-id="5b2f7-129">Bu yöntem tam, biz bu dört belirli ürün alanları düzenleme için izin veren ASP.NET sayfası oluşturmak için hazır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-129">With this method complete, we're ready to create the ASP.NET page that allows for editing these four particular product fields.</span></span> <span data-ttu-id="5b2f7-130">Açık `ErrorHandling.aspx` sayfasındaki `EditInsertDelete` klasörü ve tasarımcı sayfadan GridView ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-130">Open the `ErrorHandling.aspx` page in the `EditInsertDelete` folder and add a GridView to the page through the Designer.</span></span> <span data-ttu-id="5b2f7-131">Yeni bir ObjectDataSource için GridView bağlamak eşleme `Select()` yönteme `ProductsBLL` sınıfının `GetProducts()` yöntemi ve `Update()` yönteme `UpdateProduct` yeni oluşturduğunuz aşırı.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-131">Bind the GridView to a new ObjectDataSource, mapping the `Select()` method to the `ProductsBLL` class's `GetProducts()` method and the `Update()` method to the `UpdateProduct` overload just created.</span></span>


<span data-ttu-id="5b2f7-132">[![Dört giriş parametreleri kabul UpdateProduct yöntemi aşırı yüklemesini kullanın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-132">[![Use the UpdateProduct Method Overload That Accepts Four Input Parameters](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="5b2f7-133">**Şekil 1**: kullanım `UpdateProduct` yöntemi aşırı olduğunu kabul dört giriş parametreleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-133">**Figure 1**: Use the `UpdateProduct` Method Overload That Accepts Four Input Parameters ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image3.png))</span></span>


<span data-ttu-id="5b2f7-134">Bu bir ObjectDataSource ile oluşturacak bir `UpdateParameters` ürün alanların her biri için dört parametre ve bir alanla GridView koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-134">This will create an ObjectDataSource with an `UpdateParameters` collection with four parameters and a GridView with a field for each of the product fields.</span></span> <span data-ttu-id="5b2f7-135">ObjectDataSource'nın bildirim temelli biçimlendirme atar `OldValuesParameterFormatString` özellik değeri `original_{0}`, neden olacak bir özel durum bizim BLL sınıfının adlı bir giriş parametresi beklemeyen beri `original_productID` iletilecek parametre.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-135">The ObjectDataSource's declarative markup assigns the `OldValuesParameterFormatString` property the value `original_{0}`, which will cause an exception since our BLL class's don't expect an input parameter named `original_productID` to be passed in.</span></span> <span data-ttu-id="5b2f7-136">Bu tamamen Tanımlayıcı Sözdizimi ayarı kaldırmayı unutmayın (veya varsayılan değerine ayarlı `{0}`).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-136">Don't forget to remove this setting altogether from the declarative syntax (or set it to the default value, `{0}`).</span></span>

<span data-ttu-id="5b2f7-137">Ardından, yalnızca dahil etmek GridView Karşılaştır `ProductName`, `QuantityPerUnit`, `UnitPrice`, ve `UnitsInStock` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-137">Next, pare down the GridView to include only the `ProductName`, `QuantityPerUnit`, `UnitPrice`, and `UnitsInStock` BoundFields.</span></span> <span data-ttu-id="5b2f7-138">Ayrıca gerekli bulduğunuz herhangi alan düzeyindeki biçimlendirme uygulamak çekinmeyin (değiştirme gibi `HeaderText` özellikleri).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-138">Also feel free to apply any field-level formatting you deem necessary (such as changing the `HeaderText` properties).</span></span>

<span data-ttu-id="5b2f7-139">Önceki öğreticide biz biçimlendirmek ne Aranan `UnitPrice` BoundField hem salt okunur modda ve düzenleme modunda bir para birimi olarak.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-139">In the previous tutorial we looked at how to format the `UnitPrice` BoundField as a currency both in read-only mode and edit mode.</span></span> <span data-ttu-id="5b2f7-140">Şimdi aynı burada yapın.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-140">Let's do the same here.</span></span> <span data-ttu-id="5b2f7-141">Bu gerekli BoundField's ayarını geri çağırma `DataFormatString` özelliğine `{0:c}`, kendi `HtmlEncode` özelliğine `false`ve kendi `ApplyFormatInEditMode` için `true`, Şekil 2'de gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-141">Recall that this required setting the BoundField's `DataFormatString` property to `{0:c}`, its `HtmlEncode` property to `false`, and its `ApplyFormatInEditMode` to `true`, as shown in Figure 2.</span></span>


<span data-ttu-id="5b2f7-142">[![Para birimi olarak görüntülenecek UnitPrice BoundField yapılandırın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-142">[![Configure the UnitPrice BoundField to Display as a Currency](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="5b2f7-143">**Şekil 2**: yapılandırmak `UnitPrice` bir para birimi olarak görüntülenecek BoundField ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-143">**Figure 2**: Configure the `UnitPrice` BoundField to Display as a Currency ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image6.png))</span></span>


<span data-ttu-id="5b2f7-144">Biçimlendirme `UnitPrice` düzenleme arabiriminde bir para birimi GridView için 's olay işleyicisi oluşturma gerektirdiğinden `RowUpdating` para birimi olarak biçimlendirilmiş dizeye ayrıştırır olay bir `decimal` değeri.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-144">Formatting the `UnitPrice` as a currency in the editing interface requires creating an event handler for the GridView's `RowUpdating` event that parses the currency-formatted string into a `decimal` value.</span></span> <span data-ttu-id="5b2f7-145">Sözcüğünün `RowUpdating` son öğretici olay işleyiciden da kontrol kullanıcı tarafından sağlanan emin olmak için bir `UnitPrice` değeri.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-145">Recall that the `RowUpdating` event handler from the last tutorial also checked to ensure that the user provided a `UnitPrice` value.</span></span> <span data-ttu-id="5b2f7-146">Ancak, Bu öğretici için şimdi fiyat atlayın izin verin.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-146">However, for this tutorial let's allow the user to omit the price.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample2.vb)]

<span data-ttu-id="5b2f7-147">Bizim GridView içeren bir `QuantityPerUnit` BoundField, ancak bu BoundField yalnızca görüntüleme amacıyla olmalıdır ve kullanıcı tarafından düzenlenebilir olmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-147">Our GridView includes a `QuantityPerUnit` BoundField, but this BoundField should be only for display purposes and should not be editable by the user.</span></span> <span data-ttu-id="5b2f7-148">Bu düzenlemek için yalnızca BoundFields ayarlamak `ReadOnly` özelliğine `true`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-148">To arrange this, simply set the BoundFields' `ReadOnly` property to `true`.</span></span>


<span data-ttu-id="5b2f7-149">[![QuantityPerUnit BoundField salt okunur yapma](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image8.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-149">[![Make the QuantityPerUnit BoundField Read-Only](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image8.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="5b2f7-150">**Şekil 3**: olun `QuantityPerUnit` BoundField salt okunur ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-150">**Figure 3**: Make the `QuantityPerUnit` BoundField Read-Only ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image9.png))</span></span>


<span data-ttu-id="5b2f7-151">Son olarak, GridView'ın akıllı etiket gelen düzenlemeyi etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-151">Finally, check the Enable Editing checkbox from the GridView's smart tag.</span></span> <span data-ttu-id="5b2f7-152">Bu adımları tamamladıktan sonra `ErrorHandling.aspx` sayfanın Tasarımcısı Şekil 4'e benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-152">After completing these steps the `ErrorHandling.aspx` page's Designer should look similar to Figure 4.</span></span>


<span data-ttu-id="5b2f7-153">[![Tüm gerekli BoundFields ve onay Kaldır onay kutusunu düzenlemeyi etkinleştir](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image11.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-153">[![Remove All But the Needed BoundFields and Check the Enable Editing Checkbox](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image11.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="5b2f7-154">**Şekil 4**: kaldırmak dışındaki tüm gerekli BoundFields ve denetimi etkinleştirmek düzenleme Checkbox ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-154">**Figure 4**: Remove All But the Needed BoundFields and Check the Enable Editing Checkbox ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image12.png))</span></span>


<span data-ttu-id="5b2f7-155">Bu noktada, tüm ürünlerin listesini sahibiz `ProductName`, `QuantityPerUnit`, `UnitPrice`, ve `UnitsInStock` alanları; ancak, yalnızca `ProductName`, `UnitPrice`, ve `UnitsInStock` alanları düzenlenebilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-155">At this point we have a list of all of the products' `ProductName`, `QuantityPerUnit`, `UnitPrice`, and `UnitsInStock` fields; however, only the `ProductName`, `UnitPrice`, and `UnitsInStock` fields can be edited.</span></span>


<span data-ttu-id="5b2f7-156">[![Kullanıcılar artık kolayca ürünlerin adları, Fiyatlar ve stok alanları birimlerinde düzenleyebilirsiniz](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image14.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-156">[![Users Can Now Easily Edit Products' Names, Prices, and Units In Stock Fields](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image14.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="5b2f7-157">**Şekil 5**: kullanıcılar yapabilirsiniz şimdi kolayca Düzenle ürünlerin adları, Fiyatlar ve birimler hisse senedi alanları ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-157">**Figure 5**: Users Can Now Easily Edit Products' Names, Prices, and Units In Stock Fields ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image15.png))</span></span>


## <a name="step-2-gracefully-handling-dal-level-exceptions"></a><span data-ttu-id="5b2f7-158">2. adım: Düzgün biçimde DAL düzeyi özel durumları işleme</span><span class="sxs-lookup"><span data-stu-id="5b2f7-158">Step 2: Gracefully Handling DAL-Level Exceptions</span></span>

<span data-ttu-id="5b2f7-159">Bizim düzenlenebilir GridView son derece kullanıcıların geçerli değerleri düzenlenen ürün adı, fiyat ve stok girdiğinizde çalışırken, geçersiz değerler girerek bir özel durum oluşur.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-159">While our editable GridView works wonderfully when users enter legal values for the edited product's name, price, and units in stock, entering illegal values results in an exception.</span></span> <span data-ttu-id="5b2f7-160">Örneğin, atlama `ProductName` değer neden bir [NoNullAllowedException](https://msdn.microsoft.com/library/default.asp?url=/library/cpref/html/frlrfsystemdatanonullallowedexceptionclasstopic.asp) bu yana durum oluşturulmasına `ProductName` özelliğinde `ProdcutsRow` sınıfına sahip kendi `AllowDBNull` özelliğini `false`if kapalı olduğu veritabanı bir `SqlException` TableAdapter ile veritabanına bağlanmaya çalışılırken oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-160">For example, omitting the `ProductName` value causes a [NoNullAllowedException](https://msdn.microsoft.com/library/default.asp?url=/library/cpref/html/frlrfsystemdatanonullallowedexceptionclasstopic.asp) to be thrown since the `ProductName` property in the `ProdcutsRow` class has its `AllowDBNull` property set to `false`; if the database is down, a `SqlException` will be thrown by the TableAdapter when attempting to connect to the database.</span></span> <span data-ttu-id="5b2f7-161">Herhangi bir eylemde bulunmadan, bu özel durumlar Kabarcık yukarı veri erişim katmanı, ASP.NET sayfası sonra iş mantığı katmanı ve son olarak ASP.NET çalışma zamanı için.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-161">Without taking any action, these exceptions bubble up from the Data Access Layer to the Business Logic Layer, then to the ASP.NET page, and finally to the ASP.NET runtime.</span></span>

<span data-ttu-id="5b2f7-162">Web uygulamanızın nasıl yapılandırılacağı ve uygulamadan ziyaret ettiğiniz olup olmadığına bağlı olarak `localhost`, işlenmeyen bir özel durum genel sunucu hatası sayfası, ayrıntılı hata raporu veya kullanıcı dostu bir web sayfası neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-162">Depending on how your web application is configured and whether or not you're visiting the application from `localhost`, an unhandled exception can result in either a generic server-error page, a detailed error report, or a user-friendly web page.</span></span> <span data-ttu-id="5b2f7-163">Bkz: [Web uygulama hata işleme ASP.NET](http://www.15seconds.com/issue/030102.htm) ve [customErrors öğesi](https://msdn.microsoft.com/library/h0hfz6fc(VS.80).aspx) ASP.NET çalışma zamanı yakalanmayan bir özel durum olarak nasıl yanıt vereceğini hakkında daha fazla bilgi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-163">See [Web Application Error Handling in ASP.NET](http://www.15seconds.com/issue/030102.htm) and the [customErrors Element](https://msdn.microsoft.com/library/h0hfz6fc(VS.80).aspx) for more information on how the ASP.NET runtime responds to an uncaught exception.</span></span>

<span data-ttu-id="5b2f7-164">Şekil 6 gösteren bir ürün belirtmeden güncellerken karşılaşılan ekran `ProductName` değeri.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-164">Figure 6 shows the screen encountered when attempting to update a product without specifying the `ProductName` value.</span></span> <span data-ttu-id="5b2f7-165">Bu ayrıntılı hata raporu görüntülenen çıkarken varsayılandır `localhost`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-165">This is the default detailed error report displayed when coming through `localhost`.</span></span>


<span data-ttu-id="5b2f7-166">[![Ürün adı olacak görünen özel durum ayrıntıları atlama](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image17.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-166">[![Omitting the Product's Name Will Display Exception Details](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image17.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="5b2f7-167">**Şekil 6**: Ürün adı olur görünen özel durum ayrıntıları atlama ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-167">**Figure 6**: Omitting the Product's Name Will Display Exception Details ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image18.png))</span></span>


<span data-ttu-id="5b2f7-168">Bu tür özel durum ayrıntıları bir uygulamayı test edilirken yararlı olsa da, bu tür bir ekran karşısında bir özel durum ile bir son kullanıcı sunan değerinden idealdir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-168">While such exception details are helpful when testing an application, presenting an end user with such a screen in the face of an exception is less than ideal.</span></span> <span data-ttu-id="5b2f7-169">Büyük olasılıkla bir son kullanıcı ne bilmiyor bir `NoNullAllowedException` olduğu veya neden neden oldu.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-169">An end user likely doesn't know what a `NoNullAllowedException` is or why it was caused.</span></span> <span data-ttu-id="5b2f7-170">Ürün güncelleştirilmeye çalışılırken sorunlar olduğunu açıklayan için daha kullanıcı dostu bir ileti kullanıcının sunması daha iyi bir yaklaşımdır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-170">A better approach is to present the user with a more user-friendly message explaining that there were problems attempting to update the product.</span></span>

<span data-ttu-id="5b2f7-171">Bir işlemi gerçekleştirirken bir özel durum oluşursa, ObjectDataSource ve veri Web denetimi sonrası düzeyi olayları algılaması ve ASP.NET çalışma zamanı kadar tırmanmasını gelen özel durum iptal etmek için bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-171">If an exception occurs when performing the operation, the post-level events in both the ObjectDataSource and the data Web control provide a means to detect it and cancel the exception from bubbling up to the ASP.NET runtime.</span></span> <span data-ttu-id="5b2f7-172">Bizim örneğimizde, olay işleyici GridView için 's oluşturalım `RowUpdated` bir özel durum harekete ve bu durumda, özel durum ayrıntıları bir etiket Web denetiminde görüntüler varsa, belirler olay.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-172">For our example, let's create an event handler for the GridView's `RowUpdated` event that determines if an exception has fired and, if so, displays the exception details in a Label Web control.</span></span>

<span data-ttu-id="5b2f7-173">ASP.NET sayfası ayarı için bir etiket eklemeye başlayın kendi `ID` özelliğine `ExceptionDetails` ve temizleme kendi `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-173">Start by adding a Label to the ASP.NET page, setting its `ID` property to `ExceptionDetails` and clearing out its `Text` property.</span></span> <span data-ttu-id="5b2f7-174">Bu ileti kullanıcının göz çizmek için ayarlamanız kendi `CssClass` özelliğine `Warning`, eklediğimiz için bir CSS sınıfı olduğu `Styles.css` önceki öğretici dosyasında.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-174">In order to draw the user's eye to this message, set its `CssClass` property to `Warning`, which is a CSS class we added to the `Styles.css` file in the previous tutorial.</span></span> <span data-ttu-id="5b2f7-175">Kırmızı, italik, kalın, çok büyük yazı tipiyle görüntülenecek etiketin metin bu CSS sınıfı neden geri çağırma.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-175">Recall that this CSS class causes the Label's text to be displayed in a red, italic, bold, extra large font.</span></span>


<span data-ttu-id="5b2f7-176">[![Bir etiket Web denetimi sayfasına ekleme](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image20.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-176">[![Add a Label Web Control to the Page](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image20.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="5b2f7-177">**Şekil 7**: sayfasına bir etiket Web denetim ekleme ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-177">**Figure 7**: Add a Label Web Control to the Page ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image21.png))</span></span>


<span data-ttu-id="5b2f7-178">Bu etiket Web denetimi yalnızca hemen sonra görünür olmasını istiyoruz bu yana bir özel durum oluştu, Ayarla kendi `Visible` özelliği false olarak `Page_Load` olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-178">Since we want this Label Web control to be visible only immediately after an exception has occurred, set its `Visible` property to false in the `Page_Load` event handler:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample3.vb)]

<span data-ttu-id="5b2f7-179">İlk sayfasını ziyaret edin ve sonraki Geri göndermeler Bu kod `ExceptionDetails` denetim olacaktır, `Visible` özelliğini `false`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-179">With this code, on the first page visit and subsequent postbacks the `ExceptionDetails` control will have its `Visible` property set to `false`.</span></span> <span data-ttu-id="5b2f7-180">GridView, kullanıcının tespit edebilirsiniz bir DAL veya BLL düzeyinde özel karşısında `RowUpdated` olay işleyicisi, biz ayarlayacak `ExceptionDetails` denetimin `Visible` özelliğinin true.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-180">In the face of a DAL- or BLL-level exception, which we can detect in the GridView's `RowUpdated` event handler, we will set the `ExceptionDetails` control's `Visible` property to true.</span></span> <span data-ttu-id="5b2f7-181">Web denetimi olay işleyicileri sonra oluşan bu yana `Page_Load` sayfa yaşam döngüsü olay işleyicisine etiketi gösterilecek.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-181">Since Web control event handlers occur after the `Page_Load` event handler in the page lifecycle, the Label will be shown.</span></span> <span data-ttu-id="5b2f7-182">Ancak, sonraki geri gönderme üzerinde `Page_Load` olay işleyicisi dönecek `Visible` özelliğini yeniden `false`, görünümden yeniden gizleme.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-182">However, on the next postback, the `Page_Load` event handler will revert the `Visible` property back to `false`, hiding it from view again.</span></span>

> [!NOTE]
> <span data-ttu-id="5b2f7-183">Alternatif olarak, biz ayarı gerekliliğini kaldıramadı `ExceptionDetails` denetimin `Visible` özelliğinde `Page_Load` atayarak kendi `Visible` özelliği `false` Tanımlayıcı Sözdizimi ve (kendi ayarlayarakgörünümdurumunudevredışıbırakma`EnableViewState` özelliğine `false`).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-183">Alternatively, we could remove the necessity for setting the `ExceptionDetails` control's `Visible` property in `Page_Load` by assigning its `Visible` property `false` in the declarative syntax and disabling its view state (setting its `EnableViewState` property to `false`).</span></span> <span data-ttu-id="5b2f7-184">Sonraki Öğreticide bu alternatif bir yaklaşım kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-184">We'll use this alternative approach in a future tutorial.</span></span>


<span data-ttu-id="5b2f7-185">Etiket denetimi eklenen bizim sonraki adım olay işleyicisi GridView için 's oluşturmaktır `RowUpdated` olay.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-185">With the Label control added, our next step is to create the event handler for the GridView's `RowUpdated` event.</span></span> <span data-ttu-id="5b2f7-186">GridView Tasarımcısı'nda seçin, özellikleri penceresine gidin ve GridView'ın olayları listeleyen Şimşek Cıvata simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-186">Select the GridView in the Designer, go to the Properties window, and click the lightning bolt icon, listing the GridView's events.</span></span> <span data-ttu-id="5b2f7-187">Ayrıca bir girişi yok GridView'ın zaten olmalıdır `RowUpdating` olay, bu öğreticide daha önce bu olay için bir olay işleyicisi oluşturduğumuz gibi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-187">There should already be an entry there for the GridView's `RowUpdating` event, as we created an event handler for this event earlier in this tutorial.</span></span> <span data-ttu-id="5b2f7-188">İçin bir olay işleyicisi oluşturun `RowUpdated` de olay.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-188">Create an event handler for the `RowUpdated` event as well.</span></span>


![GridView's RowUpdated olayı için bir olay işleyicisi oluşturun](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image22.png)

<span data-ttu-id="5b2f7-190">**Şekil 8**: olay işleyicisi GridView için 's oluşturmak `RowUpdated` olayı</span><span class="sxs-lookup"><span data-stu-id="5b2f7-190">**Figure 8**: Create an Event Handler for the GridView's `RowUpdated` Event</span></span>


> [!NOTE]
> <span data-ttu-id="5b2f7-191">Aşağı açılan listeleri ile olay işleyicisi arka plandaki kod sınıfı dosyanın üst kısmında da oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-191">You can also create the event handler through the drop-down lists at the top of the code-behind class file.</span></span> <span data-ttu-id="5b2f7-192">GridView soldaki aşağı açılan listeden seçin ve `RowUpdated` sağdaki bir olay.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-192">Select the GridView from the drop-down list on the left and the `RowUpdated` event from the one on the right.</span></span>


<span data-ttu-id="5b2f7-193">Bu olay işleyicisi oluşturma aşağıdaki kod ASP.NET sayfa arka plan kodu sınıfına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-193">Creating this event handler will add the following code to the ASP.NET page's code-behind class:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample4.vb)]

<span data-ttu-id="5b2f7-194">Bu olay işleyicinin ikinci giriş parametresi türünde bir nesnedir [GridViewUpdatedEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdatedeventargs.aspx), özel durumları işlemek için ilgi üç özellik vardır:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-194">This event handler's second input parameter is an object of type [GridViewUpdatedEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdatedeventargs.aspx), which has three properties of interest for handling exceptions:</span></span>

- <span data-ttu-id="5b2f7-195">`Exception`oluşturulan özel durum referansı; hiçbir özel durum, bu özellik bir değeri olur`null`</span><span class="sxs-lookup"><span data-stu-id="5b2f7-195">`Exception` a reference to the thrown exception; if no exception has been thrown, this property will have a value of `null`</span></span>
- <span data-ttu-id="5b2f7-196">`ExceptionHandled`özel durum olarak yürütüldü olup olmadığını gösteren bir Boole değeri `RowUpdated` olay işleyicisi if `false` (varsayılan), özel durumu ASP.NET çalışma zamanı kadar percolating yeniden oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-196">`ExceptionHandled` a Boolean value that indicates whether or not the exception was handled in the `RowUpdated` event handler; if `false` (the default), the exception is re-thrown, percolating up to the ASP.NET runtime</span></span>
- <span data-ttu-id="5b2f7-197">`KeepInEditMode`varsa kümesine `true` düzenlenen GridView satır düzenleme modunda; kalır `false` (varsayılan), GridView satır, salt okunur moduna geri döner.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-197">`KeepInEditMode` if set to `true` the edited GridView row remains in edit mode; if `false` (the default), the GridView row reverts back to its read-only mode</span></span>

<span data-ttu-id="5b2f7-198">Bizim kodu daha sonra denetlemeli `Exception` değil `null`, işlem gerçekleştirilirken bir özel durumu gerçekleşti anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-198">Our code, then, should check to see if `Exception` is not `null`, meaning that an exception was raised while performing the operation.</span></span> <span data-ttu-id="5b2f7-199">Bu durumda, istiyoruz:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-199">If this is the case, we want to:</span></span>

- <span data-ttu-id="5b2f7-200">Kullanıcı dostu bir ileti görüntüler `ExceptionDetails` etiketi</span><span class="sxs-lookup"><span data-stu-id="5b2f7-200">Display a user-friendly message in the `ExceptionDetails` Label</span></span>
- <span data-ttu-id="5b2f7-201">Özel durumun işlendiğini gösterir</span><span class="sxs-lookup"><span data-stu-id="5b2f7-201">Indicate that the exception was handled</span></span>
- <span data-ttu-id="5b2f7-202">GridView satır düzenleme modunda tutun</span><span class="sxs-lookup"><span data-stu-id="5b2f7-202">Keep the GridView row in edit mode</span></span>

<span data-ttu-id="5b2f7-203">Bu aşağıdaki kod bu amaçları gerçekleştirir:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-203">This following code accomplishes these objectives:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample5.vb)]

<span data-ttu-id="5b2f7-204">Bu olay işleyicisi olup olmadığını denetleyerek başlar `e.Exception` olan `null`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-204">This event handler begins by checking to see if `e.Exception` is `null`.</span></span> <span data-ttu-id="5b2f7-205">Değilse `ExceptionDetails` etiketin `Visible` özelliği ayarlanmış `true` ve kendi `Text` "Ürün güncelleştirilirken bir sorun oluştu." özelliği</span><span class="sxs-lookup"><span data-stu-id="5b2f7-205">If it's not, the `ExceptionDetails` Label's `Visible` property is set to `true` and its `Text` property to "There was a problem updating the product."</span></span> <span data-ttu-id="5b2f7-206">Oluşturulan özel durumu ayrıntılarını bulunan `e.Exception` nesnenin `InnerException` özelliği.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-206">The details of the actual exception that was thrown reside in the `e.Exception` object's `InnerException` property.</span></span> <span data-ttu-id="5b2f7-207">Bu iç özel duruma incelenir ve belirli bir tür ise, ek, yararlı iletisine eklenir `ExceptionDetails` etiketin `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-207">This inner exception is examined and, if it is of a particular type, an additional, helpful message is appended to the `ExceptionDetails` Label's `Text` property.</span></span> <span data-ttu-id="5b2f7-208">Son olarak, `ExceptionHandled` ve `KeepInEditMode` özellikleri her ikisi de ayarlandığında `true`.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-208">Lastly, the `ExceptionHandled` and `KeepInEditMode` properties are both set to `true`.</span></span>

<span data-ttu-id="5b2f7-209">Şekil 9 ürün adı atlama bu sayfayı ekran görüntüsü gösterir; Şekil 10 geçersiz girerken sonuçları gösterir `UnitPrice` değerini (-50).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-209">Figure 9 shows a screen shot of this page when omitting the name of the product; Figure 10 shows the results when entering an illegal `UnitPrice` value (-50).</span></span>


<span data-ttu-id="5b2f7-210">[![ProductName BoundField bir değeri içermelidir](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image24.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-210">[![The ProductName BoundField Must Contain a Value](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image24.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image23.png)</span></span>

<span data-ttu-id="5b2f7-211">**Şekil 9**: `ProductName` BoundField bir değer içermesi gerekir ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-211">**Figure 9**: The `ProductName` BoundField Must Contain a Value ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image25.png))</span></span>


<span data-ttu-id="5b2f7-212">[![Negatif UnitPrice değerler izin verilmiyor:](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image27.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-212">[![Negative UnitPrice Values are Not Allowed](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image27.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image26.png)</span></span>

<span data-ttu-id="5b2f7-213">**Şekil 10**: negatif `UnitPrice` değerler izin ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-213">**Figure 10**: Negative `UnitPrice` Values are Not Allowed ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image28.png))</span></span>


<span data-ttu-id="5b2f7-214">Ayarlayarak `e.ExceptionHandled` özelliğine `true`, `RowUpdated` olay işleyicisi belirtilen özel durumun işlenip.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-214">By setting the `e.ExceptionHandled` property to `true`, the `RowUpdated` event handler has indicated that it has handled the exception.</span></span> <span data-ttu-id="5b2f7-215">Bu nedenle, özel durum ASP.NET çalışma zamanı kadar yayılması olmaz.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-215">Therefore, the exception won't propagate up to the ASP.NET runtime.</span></span>

> [!NOTE]
> <span data-ttu-id="5b2f7-216">Şekil 9 ve 10 nedeniyle geçersiz kullanıcı girişi yükseltilmiş özel durumları işlemek için normal bir şekilde gösterir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-216">Figures 9 and 10 show a graceful way to handle exceptions raised due to invalid user input.</span></span> <span data-ttu-id="5b2f7-217">İdeal olarak, ancak bu tür giriş geçersiz asla ulaşma iş mantığı katmanı ilk başta, ASP.NET sayfası çağırmadan önce kullanıcının girişleri geçerli olduğundan emin olun şekilde `ProductsBLL` sınıfının `UpdateProduct` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-217">Ideally, though, such invalid input will never reach the Business Logic Layer in the first place, as the ASP.NET page should ensure that the user's inputs are valid before invoking the `ProductsBLL` class's `UpdateProduct` method.</span></span> <span data-ttu-id="5b2f7-218">İş mantığı katmanı için gönderilen veri emin olmak için düzenleme ve ekleme arabirimlerine doğrulama denetimleri ekleme göreceğiz bizim sonraki öğreticide iş kuralları için uygundur.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-218">In our next tutorial we'll see how to add validation controls to the editing and inserting interfaces to ensure that the data submitted to the Business Logic Layer conforms to the business rules.</span></span> <span data-ttu-id="5b2f7-219">Doğrulama denetimleri yalnızca çağrılmasını engellemek `UpdateProduct` kullanıcı tarafından sağlanan veri geçerlidir, ancak aynı zamanda veri girişi sorunlarını tanımlamak için daha bilgilendirici bir kullanıcı deneyimi sağlamak kadar yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-219">The validation controls not only prevent the invocation of the `UpdateProduct` method until the user-supplied data is valid, but also provide a more informative user experience for identifying data entry problems.</span></span>


## <a name="step-3-gracefully-handling-bll-level-exceptions"></a><span data-ttu-id="5b2f7-220">3. adım: Düzgün biçimde BLL düzeyi özel durumları işleme</span><span class="sxs-lookup"><span data-stu-id="5b2f7-220">Step 3: Gracefully Handling BLL-Level Exceptions</span></span>

<span data-ttu-id="5b2f7-221">Eklerken, güncelleştirme ya da verileri silme veri erişim katmanı verilerle ilgili bir hata karşısında bir özel durum.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-221">When inserting, updating, or deleting data, the Data Access Layer may throw an exception in the face of a data-related error.</span></span> <span data-ttu-id="5b2f7-222">Veritabanı çevrimdışı olabilir, gerekli veritabanı tablo sütunu belirtilen bir değeri uygulanmamış veya bir tablo düzeyi kısıtlaması ihlal.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-222">The database may be offline, a required database table column might not have had a value specified, or a table-level constraint may have been violated.</span></span> <span data-ttu-id="5b2f7-223">Özel durumlar kesinlikle verilerle ilgili ek olarak, iş mantığı katmanı iş kurallarını ihlal olduğunda belirtmek için özel durumlar kullanın.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-223">In addition to strictly data-related exceptions, the Business Logic Layer can use exceptions to indicate when business rules have been violated.</span></span> <span data-ttu-id="5b2f7-224">İçinde [bir iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) öğretici, bir iş kuralı denetimi asıl Örneğin, eklediğimiz `UpdateProduct` aşırı yükleme.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-224">In the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial, for example, we added a business rule check to the original `UpdateProduct` overload.</span></span> <span data-ttu-id="5b2f7-225">Özellikle, kullanıcı bir ürün dönüştürülmesine olarak işaretlemenin oluştu, ürün, sağlayıcısı tarafından sağlanan tek olmaması gereklidir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-225">Specifically, if the user was marking a product as discontinued, we required that the product not be the only one provided by its supplier.</span></span> <span data-ttu-id="5b2f7-226">Bu durum ihlal varsa, bir `ApplicationException` belirtildi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-226">If this condition was violated, an `ApplicationException` was thrown.</span></span>

<span data-ttu-id="5b2f7-227">İçin `UpdateProduct` aşırı oluşturulan Bu öğreticide, yasaklar bir iş kuralı ekleyelim `UnitPrice` katından fazla özgün olan yeni bir değer ayarlanan alanının `UnitPrice` değeri.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-227">For the `UpdateProduct` overload created in this tutorial, let's add a business rule that prohibits the `UnitPrice` field from being set to a new value that's more than twice the original `UnitPrice` value.</span></span> <span data-ttu-id="5b2f7-228">Bunu gerçekleştirmek için ayarlamak `UpdateProduct` ; böylece bu denetimi gerçekleştirir ve oluşturur aşırı bir `ApplicationException` kuralı ihlal edilirse.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-228">To accomplish this, adjust the `UpdateProduct` overload so that it performs this check and throws an `ApplicationException` if the rule is violated.</span></span> <span data-ttu-id="5b2f7-229">Güncelleştirilen yöntemi aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="5b2f7-229">The updated method follows:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample6.vb)]

<span data-ttu-id="5b2f7-230">Bu değişiklikle katından fazla var olan fiyat herhangi bir fiyat güncelleştirme neden olacak bir `ApplicationException` oluşturulmasına.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-230">With this change, any price update that is more than twice the existing price will cause an `ApplicationException` to be thrown.</span></span> <span data-ttu-id="5b2f7-231">DAL, bu BLL yükseltilmiş gerçekleştirilen özel durum'olduğu gibi `ApplicationException` algılandı ve GridView içinde 's ele `RowUpdated` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-231">Just like the exception raised from the DAL, this BLL-raised `ApplicationException` can be detected and handled in the GridView's `RowUpdated` event handler.</span></span> <span data-ttu-id="5b2f7-232">Aslında, `RowUpdated` olay işleyicinin kod yazıldığı şekilde doğru bu özel durumun algılar ve görüntüler `ApplicationException`'s `Message` özellik değeri.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-232">In fact, the `RowUpdated` event handler's code, as written, will correctly detect this exception and display the `ApplicationException`'s `Message` property value.</span></span> <span data-ttu-id="5b2f7-233">Şekil 11 bir kullanıcı birden fazla çift kendi geçerli bedelinin $19.95 olduğu Chai fiyat $50,00, güncelleştirmeye çalıştığında ekran gösterir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-233">Figure 11 shows a screen shot when a user attempts to update the price of Chai to $50.00, which is more than double its current price of $19.95.</span></span>


<span data-ttu-id="5b2f7-234">[![İş kurallarını birden fazla ürünün fiyatını çift fiyat artışları izin verme](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image30.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-234">[![The Business Rules Disallow Price Increases That More Than Double a Product's Price](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image30.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image29.png)</span></span>

<span data-ttu-id="5b2f7-235">**Şekil 11**: birden fazla ürünün fiyatını çift izin verme fiyat artışları iş kuralları ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="5b2f7-235">**Figure 11**: The Business Rules Disallow Price Increases That More Than Double a Product's Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image31.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5b2f7-236">İdeal olarak, iş mantığı kuralları dışında yeniden işlenmesi `UpdateProduct` yöntemi aşırı ve ortak bir yöntem olarak.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-236">Ideally our business logic rules would be refactored out of the `UpdateProduct` method overloads and into a common method.</span></span> <span data-ttu-id="5b2f7-237">Okuyucu için bu bir alıştırma olarak kalır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-237">This is left as an exercise for the reader.</span></span>


## <a name="summary"></a><span data-ttu-id="5b2f7-238">Özet</span><span class="sxs-lookup"><span data-stu-id="5b2f7-238">Summary</span></span>

<span data-ttu-id="5b2f7-239">Ekleme, güncelleştirme ve silme işlemleri sırasında veri Web denetimi ve söz konusu ObjectDataSource öncesi ve sonrası düzeyi olayları bu bağlayıcının gerçek işlemi kov.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-239">During inserting, updating, and deleting operations, both the data Web control and the ObjectDataSource involved fire pre- and post-level events that bookend the actual operation.</span></span> <span data-ttu-id="5b2f7-240">Bu öğretici ve önceki bir düzenlenebilir GridView ile çalışırken GridView's gördüğümüz gibi `RowUpdating` ObjectDataSource tarafından 's ardından olay ateşlenir `Updating` hangi noktada güncelleştirme komutu ObjectDataSource için 's yapıldığında, olayı temel alınan nesnesi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-240">As we saw in this tutorial and the preceding one, when working with an editable GridView the GridView's `RowUpdating` event fires, followed by the ObjectDataSource's `Updating` event, at which point the update command is made to the ObjectDataSource's underlying object.</span></span> <span data-ttu-id="5b2f7-241">ObjectDataSource's işlemi tamamlandı sonra `Updated` GridView tarafından 's ardından olay ateşlenir `RowUpdated` olay.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-241">After the operation has completed, the ObjectDataSource's `Updated` event fires, followed by the GridView's `RowUpdated` event.</span></span>

<span data-ttu-id="5b2f7-242">Olay işleyicileri giriş parametreleri özelleştirmek için önceden düzeyi olayları ya da inceleyebilir ve işlem sonuçları yanıt için sonrası düzeyi olaylar oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-242">We can create event handlers for the pre-level events in order to customize the input parameters or for the post-level events in order to inspect and respond to the operation's results.</span></span> <span data-ttu-id="5b2f7-243">Sonrası düzeyi olay işleyicileri, işlem sırasında bir özel durum oluştu olup olmadığını algılamak için en yaygın olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-243">Post-level event handlers are most commonly used to detect whether an exception occurred during the operation.</span></span> <span data-ttu-id="5b2f7-244">Bir özel durum karşısında bu sonrası düzeyi olay işleyicileri isteğe bağlı olarak kendi başlarına özel durumu işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-244">In the face of an exception, these post-level event handlers can optionally handle the exception on their own.</span></span> <span data-ttu-id="5b2f7-245">Bu öğreticide bir kolay hata iletisi görüntüleyerek böyle bir özel durum işleme gördük.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-245">In this tutorial we saw how to handle such an exception by displaying a friendly error message.</span></span>

<span data-ttu-id="5b2f7-246">Sonraki öğreticide sorunları biçimlendirme verilerden oluşan özel durumlar olasılığını azaltmak nasıl göreceğiz (negatif girme gibi `UnitPrice`).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-246">In the next tutorial we'll see how to lessen the likelihood of exceptions arising from data formatting issues (such as entering a negative `UnitPrice`).</span></span> <span data-ttu-id="5b2f7-247">Özellikle, düzenleme ve ekleme arabirimleri doğrulama denetimleri ekleme inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-247">Specifically, we'll look at how to add validation controls to the editing and inserting interfaces.</span></span>

<span data-ttu-id="5b2f7-248">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="5b2f7-248">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5b2f7-249">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="5b2f7-249">About the Author</span></span>

<span data-ttu-id="5b2f7-250">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-250">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5b2f7-251">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-251">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5b2f7-252">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-252">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5b2f7-253">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5b2f7-253">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5b2f7-254">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="5b2f7-254">Special Thanks To</span></span>

<span data-ttu-id="5b2f7-255">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-255">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5b2f7-256">Bu öğretici için sağlama İnceleme Liz Shulok oluştu.</span><span class="sxs-lookup"><span data-stu-id="5b2f7-256">Lead reviewer for this tutorial was Liz Shulok.</span></span> <span data-ttu-id="5b2f7-257">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="5b2f7-257">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5b2f7-258">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-258">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="5b2f7-259">[Önceki](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)
[sonraki](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5b2f7-259">[Previous](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)
[Next](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)</span></span>
