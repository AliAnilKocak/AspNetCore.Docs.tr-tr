---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb
title: İyimser eşzamanlılık (VB) uygulama | Microsoft Docs
author: rick-anderson
description: Verileri düzenlemek birden çok kullanıcı sağlayan bir web uygulaması için iki kullanıcı aynı verileri aynı anda düzenleme riski yoktur. Bu tutori içinde...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 2646968c-2826-4418-b1d0-62610ed177e3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb
msc.type: authoredcontent
ms.openlocfilehash: 056d907e80b5bdfa1848b4b31cb03702ca823583
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
---
<a name="implementing-optimistic-concurrency-vb"></a><span data-ttu-id="eaaf7-104">İyimser eşzamanlılık (VB) uygulama</span><span class="sxs-lookup"><span data-stu-id="eaaf7-104">Implementing Optimistic Concurrency (VB)</span></span>
====================
<span data-ttu-id="eaaf7-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="eaaf7-106">[Örnek uygulamayı indirin](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_VB.exe) veya [PDF indirin](implementing-optimistic-concurrency-vb/_static/datatutorial21vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_VB.exe) or [Download PDF](implementing-optimistic-concurrency-vb/_static/datatutorial21vb1.pdf)</span></span>

> <span data-ttu-id="eaaf7-107">Verileri düzenlemek birden çok kullanıcı sağlayan bir web uygulaması için iki kullanıcı aynı verileri aynı anda düzenleme riski yoktur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-107">For a web application that allows multiple users to edit data, there is the risk that two users may be editing the same data at the same time.</span></span> <span data-ttu-id="eaaf7-108">Bu öğreticide Biz bu riski işlemek için iyimser eşzamanlılık denetimini uygulamanız.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-108">In this tutorial we'll implement optimistic concurrency control to handle this risk.</span></span>


## <a name="introduction"></a><span data-ttu-id="eaaf7-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="eaaf7-109">Introduction</span></span>

<span data-ttu-id="eaaf7-110">Yalnızca verileri görüntülemek kullanıcıların web uygulamaları için ya da kimin verileri değiştirebilir yalnızca tek bir kullanıcı eklemek için hiçbir tehdit yanlışlıkla başka birinin değişikliklerin üzerine iki eş zamanlı kullanıcı yoktur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-110">For web applications that only allow users to view data, or for those that include only a single user who can modify data, there's no threat of two concurrent users accidentally overwriting one another's changes.</span></span> <span data-ttu-id="eaaf7-111">Güncelleştirmek veya veri silmek birden çok kullanıcıların web uygulamaları için ancak yoktur olası bir kullanıcının değişikliklerin başka bir eş zamanlı kullanıcının ile artar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-111">For web applications that allow multiple users to update or delete data, however, there's the potential for one user's modifications to clash with another concurrent user's.</span></span> <span data-ttu-id="eaaf7-112">İki kullanıcı aynı anda tek bir kaydını düzenlerken herhangi bir yerde eşzamanlılık ilke olmadan kendi değişiklikleri kaydeder kullanıcının son ilk tarafından yapılan değişiklikleri geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-112">Without any concurrency policy in place, when two users are simultaneously editing a single record, the user who commits her changes last will override the changes made by the first.</span></span>

<span data-ttu-id="eaaf7-113">Örneğin, iki kullanıcılar, Jisun ve Sam, her ikisi de güncelleştirme ve ürünleri GridView denetimi aracılığıyla silme ziyaretçileri izin uygulamamızdaki sayfasını ziyaret düşünün.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-113">For example, imagine that two users, Jisun and Sam, were both visiting a page in our application that allowed visitors to update and delete the products through a GridView control.</span></span> <span data-ttu-id="eaaf7-114">Her ikisi de yaklaşık aynı zamanda GridView Düzenle düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-114">Both click the Edit button in the GridView around the same time.</span></span> <span data-ttu-id="eaaf7-115">Jisun ürün adı "Chai Çay" değiştirir ve güncelleştirme düğmesine tıklar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-115">Jisun changes the product name to "Chai Tea" and clicks the Update button.</span></span> <span data-ttu-id="eaaf7-116">Net sonucu olan bir `UPDATE` ayarlar veritabanına gönderilen deyimi *tüm* ürünün güncelleştirilebilir alanlarının (Jisun yalnızca bir alanın güncelleştirilmiş olmasa bile `ProductName`).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-116">The net result is an `UPDATE` statement that is sent to the database, which sets *all* of the product's updateable fields (even though Jisun only updated one field, `ProductName`).</span></span> <span data-ttu-id="eaaf7-117">Bu anda, veritabanı değerleri "Chai Çay," Meşrubat, vb. belirli bu ürün için Exotic Liquids sağlayıcı kategorisi vardır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-117">At this point in time, the database has the values "Chai Tea," the category Beverages, the supplier Exotic Liquids, and so on for this particular product.</span></span> <span data-ttu-id="eaaf7-118">Ancak, Sam'ın ekranında GridView hala ürün adı düzenlenebilir GridView satırda "Chai" gösterilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-118">However, the GridView on Sam's screen still shows the product name in the editable GridView row as "Chai".</span></span> <span data-ttu-id="eaaf7-119">Birkaç saniye sonra Jisun'ın değişiklikler kaydedildi Sam Condiments için kategori güncelleştirir ve güncelleştirme tıklar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-119">A few seconds after Jisun's changes have been committed, Sam updates the category to Condiments and clicks Update.</span></span> <span data-ttu-id="eaaf7-120">Bunun bir `UPDATE` "Chai," ürün adına ayarlar veritabanına gönderilen deyimi `CategoryID` karşılık gelen Meşrubat kategori kimliği ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-120">This results in an `UPDATE` statement sent to the database that sets the product name to "Chai," the `CategoryID` to the corresponding Beverages category ID, and so on.</span></span> <span data-ttu-id="eaaf7-121">Ürün adı Jisun'ın değişiklikleri üzerine yazıldı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-121">Jisun's changes to the product name have been overwritten.</span></span> <span data-ttu-id="eaaf7-122">Şekil 1 Bu dizi olayı grafik şeklinde gösterir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-122">Figure 1 graphically depicts this series of events.</span></span>


<span data-ttu-id="eaaf7-123">[![Ne zaman iki kullanıcı bir kayıt var. s olası diğerinin üzerine yazmak bir kullanıcının değişiklikleri için aynı anda güncelleştirme](implementing-optimistic-concurrency-vb/_static/image2.png)](implementing-optimistic-concurrency-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-123">[![When Two Users Simultaneously Update a Record There s Potential for One User 's Changes to Overwrite the Other 's](implementing-optimistic-concurrency-vb/_static/image2.png)](implementing-optimistic-concurrency-vb/_static/image1.png)</span></span>

<span data-ttu-id="eaaf7-124">**Şekil 1**: zaman iki kullanıcı aynı anda güncelleştirme bir kayıt var. s olası bir kullanıcının için üzerine yazma başkalarının değişiklikleri için ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-124">**Figure 1**: When Two Users Simultaneously Update a Record There s Potential for One User 's Changes to Overwrite the Other 's ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image3.png))</span></span>


<span data-ttu-id="eaaf7-125">Bir sayfa ziyaret eden iki kullanıcılar, benzer şekilde, bir kullanıcı başka bir kullanıcı tarafından silindiğinde kayıt ortasında olabilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-125">Similarly, when two users are visiting a page, one user might be in the midst of updating a record when it is deleted by another user.</span></span> <span data-ttu-id="eaaf7-126">Veya, bir kullanıcı bir sayfa yüklediğinde arasında Sil düğmesini tıklattığınızda, başka bir kullanıcı, kaydın içeriğini değiştirilmiş olabilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-126">Or, between when a user loads a page and when they click the Delete button, another user may have modified the contents of that record.</span></span>

<span data-ttu-id="eaaf7-127">Üç [eşzamanlılık denetimi](http://en.wikipedia.org/wiki/Concurrency_control) stratejileri kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-127">There are three [concurrency control](http://en.wikipedia.org/wiki/Concurrency_control) strategies available:</span></span>

- <span data-ttu-id="eaaf7-128">**Hiçbir şey yapma** -eşzamanlı kullanıcı aynı kaydı değiştiriyorsanız (varsayılan davranış) win son yürütme olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-128">**Do Nothing** -if concurrent users are modifying the same record, let the last commit win (the default behavior)</span></span>
- <span data-ttu-id="eaaf7-129">[**İyimser eşzamanlılık** ](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) -, olabilir ancak eşzamanlılık çakışıyor every şimdi ve daha sonra bu gibi çakışmaları olmaz ortaya; zaman çoğunluğu bu nedenle, bir çakışma çıkması durumunda yalnızca bildirmek kullanıcı varsayılır, yaptıkları değişiklikleri başka bir kullanıcı aynı veri değiştirildiğinden kaydedilemiyor</span><span class="sxs-lookup"><span data-stu-id="eaaf7-129">[**Optimistic Concurrency**](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) - assume that while there may be concurrency conflicts every now and then, the vast majority of the time such conflicts won't arise; therefore, if a conflict does arise, simply inform the user that their changes can't be saved because another user has modified the same data</span></span>
- <span data-ttu-id="eaaf7-130">**Eşzamanlılık** -eşzamanlılık çakışmaları olan sıradan bir hale ve kullanıcıların eklenmesini tolerans olmaz yaptıkları değişiklikleri nedeniyle başka bir kullanıcının eş zamanlı etkinlik kaydedilmiş doğru söylediyse varsayılır; Bu nedenle, bir kullanıcı kaydı güncelleme başladığında, kilitleme , böylece düzenleme veya kullanıcı, değişiklikleri uygulayan kadar bu kaydın silinmesi tüm diğer kullanıcıların önleme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-130">**Pessimistic Concurrency** - assume that concurrency conflicts are commonplace and that users won't tolerate being told their changes weren't saved due to another user's concurrent activity; therefore, when one user starts updating a record, lock it, thereby preventing any other users from editing or deleting that record until the user commits their modifications</span></span>

<span data-ttu-id="eaaf7-131">Tüm öğreticilerimizi bugüne kadarki varsayılan eşzamanlılık çözümleme stratejisi kullanmış - yani, biz win son yazma izin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-131">All of our tutorials thus far have used the default concurrency resolution strategy - namely, we've let the last write win.</span></span> <span data-ttu-id="eaaf7-132">Bu öğreticide biz iyimser eşzamanlılık denetimi nasıl inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-132">In this tutorial we'll examine how to implement optimistic concurrency control.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf7-133">Bu öğretici serisinde eşzamanlılık örnekleri ele olmaz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-133">We won't look at pessimistic concurrency examples in this tutorial series.</span></span> <span data-ttu-id="eaaf7-134">Eşzamanlılık gibi kilitler çünkü nadiren kullanılır değilse düzgün relinquished, diğer kullanıcıların verileri güncelleştirme engelleyebilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-134">Pessimistic concurrency is rarely used because such locks, if not properly relinquished, can prevent other users from updating data.</span></span> <span data-ttu-id="eaaf7-135">Örneğin, bir kullanıcıyı düzenlemek için bir kayıt kilitler ve gün onu kilidini önce için ayrıldığında, başka bir kullanıcı özgün kullanıcıya döndürür ve kendi güncelleştirme tamamlanana kadar bu kaydı güncelleştirmek mümkün olacaktır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-135">For example, if a user locks a record for editing and then leaves for the day before unlocking it, no other user will be able to update that record until the original user returns and completes his update.</span></span> <span data-ttu-id="eaaf7-136">Bu nedenle, eşzamanlılık kullanıldığı durumlarda yoktur genellikle ulaştıysanız, kilit iptal eden bir zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-136">Therefore, in situations where pessimistic concurrency is used, there's typically a timeout that, if reached, cancels the lock.</span></span> <span data-ttu-id="eaaf7-137">Kullanıcı sipariş işlemini tamamlarken, kısa bir süre için belirli katılımcı Konumu Kilitle bilet satış Web siteleri, eşzamanlılık denetim örneğidir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-137">Ticket sales websites, which lock a particular seating location for short period while the user completes the order process, is an example of pessimistic concurrency control.</span></span>


## <a name="step-1-looking-at-how-optimistic-concurrency-is-implemented"></a><span data-ttu-id="eaaf7-138">1. adım: Nasıl iyimser eşzamanlılık arayan uygulanır</span><span class="sxs-lookup"><span data-stu-id="eaaf7-138">Step 1: Looking at How Optimistic Concurrency is Implemented</span></span>

<span data-ttu-id="eaaf7-139">İyimser eşzamanlılık denetimini güncelleştirme veya silme işlemi başlattığınızda olduğu gibi güncelleştirildiğinde veya silindiğinde kayıt aynı değere sahip olduğundan emin olarak çalışır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-139">Optimistic concurrency control works by ensuring that the record being updated or deleted has the same values as it did when the updating or deleting process started.</span></span> <span data-ttu-id="eaaf7-140">Örneğin, düzenlenebilir GridView Düzenle düğmesine tıklandığında, kaydın değerleri veritabanından okunur ve metin kutuları ve diğer Web denetimleri görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-140">For example, when clicking the Edit button in an editable GridView, the record's values are read from the database and displayed in TextBoxes and other Web controls.</span></span> <span data-ttu-id="eaaf7-141">Bu orijinal değerleri GridView tarafından kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-141">These original values are saved by the GridView.</span></span> <span data-ttu-id="eaaf7-142">Kullanıcı kendi değişiklikleri yapar ve güncelleştirme düğmesine tıklar sonra daha sonra özgün değerler artı yeni değerleri için iş mantığı katmanı ve veri erişim katmanı için gönderilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-142">Later, after the user makes her changes and clicks the Update button, the original values plus the new values are sent to the Business Logic Layer, and then down to the Data Access Layer.</span></span> <span data-ttu-id="eaaf7-143">Veri erişim katmanı değerler hala veritabanı kullanıcı düzenleme başladı özgün değerler özdeş ise, yalnızca kaydı güncelleştirecek bir SQL deyimi kesmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-143">The Data Access Layer must issue a SQL statement that will only update the record if the original values that the user started editing are identical to the values still in the database.</span></span> <span data-ttu-id="eaaf7-144">Şekil 2 Bu olaylar dizisini gösterir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-144">Figure 2 depicts this sequence of events.</span></span>


<span data-ttu-id="eaaf7-145">[![Güncelleştirme veya silme için başarılı olması, özgün değerler geçerli veritabanı değerine eşit olmalıdır](implementing-optimistic-concurrency-vb/_static/image5.png)](implementing-optimistic-concurrency-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-145">[![For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values](implementing-optimistic-concurrency-vb/_static/image5.png)](implementing-optimistic-concurrency-vb/_static/image4.png)</span></span>

<span data-ttu-id="eaaf7-146">**Şekil 2**: For Update veya Delete Succeed, orijinal değerleri gerekir olması eşit geçerli veritabanı değerlerini ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-146">**Figure 2**: For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image6.png))</span></span>


<span data-ttu-id="eaaf7-147">İyimser eşzamanlılık uygulamak için çeşitli yaklaşım vardır (bkz [Peter A. Bromberg](http://peterbromberg.net/)'s [Optmistic eşzamanlılık güncelleştirme mantığı](http://www.eggheadcafe.com/articles/20050719.asp) bir dizi seçenek kısa göz için).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-147">There are various approaches to implementing optimistic concurrency (see [Peter A. Bromberg](http://peterbromberg.net/)'s [Optmistic Concurrency Updating Logic](http://www.eggheadcafe.com/articles/20050719.asp) for a brief look at a number of options).</span></span> <span data-ttu-id="eaaf7-148">ADO.NET yazılan veri kümesi yalnızca bir onay kutusu değer çizgilerinin ile yapılandırılmış bir uygulamasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-148">The ADO.NET Typed DataSet provides one implementation that can be configured with just the tick of a checkbox.</span></span> <span data-ttu-id="eaaf7-149">Yazılan veri kümesinde bir TableAdapter TableAdapter's güçlendirir için iyimser eşzamanlılık etkinleştirme `UPDATE` ve `DELETE` tüm özgün değerler karşılaştırması içerecek şekilde deyimleri `WHERE` yan tümcesi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-149">Enabling optimistic concurrency for a TableAdapter in the Typed DataSet augments the TableAdapter's `UPDATE` and `DELETE` statements to include a comparison of all of the original values in the `WHERE` clause.</span></span> <span data-ttu-id="eaaf7-150">Aşağıdaki `UPDATE` deyimi, örneğin, güncelleştirmeleri adını ve bir ürünün fiyat yalnızca geçerli veritabanı değerler GridView kaydında güncelleştirirken başlangıçta alınan değerleri eşit ise.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-150">The following `UPDATE` statement, for example, updates the name and price of a product only if the current database values are equal to the values that were originally retrieved when updating the record in the GridView.</span></span> <span data-ttu-id="eaaf7-151">`@ProductName` Ve `@UnitPrice` parametreleri, ancak kullanıcı tarafından girilen yeni değerleri içermesi `@original_ProductName` ve `@original_UnitPrice` Düzenle düğmesi tıklatıldığında GridView başlangıçta yüklenen değerleri içerir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-151">The `@ProductName` and `@UnitPrice` parameters contain the new values entered by the user, whereas `@original_ProductName` and `@original_UnitPrice` contain the values that were originally loaded into the GridView when the Edit button was clicked:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample1.sql)]

> [!NOTE]
> <span data-ttu-id="eaaf7-152">Bu `UPDATE` deyimi okunabilirlik için basitleştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-152">This `UPDATE` statement has been simplified for readability.</span></span> <span data-ttu-id="eaaf7-153">Uygulamada, `UnitPrice` iade `WHERE` yan yana daha karmaşık olacaktır `UnitPrice` içerebilir `NULL` s ve denetleniyor `NULL = NULL` her zaman False değerini döndürür (Bunun yerine kullanmalısınız `IS NULL`).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-153">In practice, the `UnitPrice` check in the `WHERE` clause would be more involved since `UnitPrice` can contain `NULL` s and checking if `NULL = NULL` always returns False (instead you must use `IS NULL`).</span></span>


<span data-ttu-id="eaaf7-154">Farklı bir arka plandaki kullanmanın yanı sıra `UPDATE` iyimser eşzamanlılık Ayrıca kendi DB imzası değiştirir kullanmak için bir TableAdapter yapılandırma deyimi, doğrudan yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-154">In addition to using a different underlying `UPDATE` statement, configuring a TableAdapter to use optimistic concurrency also modifies the signature of its DB direct methods.</span></span> <span data-ttu-id="eaaf7-155">Geri çağırma ilk öğreticimizi [ *veri erişim katmanı oluşturma*](../introduction/creating-a-data-access-layer-cs.md), DB doğrudan yöntemleri, skaler listesini kabul edildiği gibi giriş parametreleri değerleri (kesin türü belirtilmiş bir DataRow yerine veya DataTable örneği).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-155">Recall from our first tutorial, [*Creating a Data Access Layer*](../introduction/creating-a-data-access-layer-cs.md), that DB direct methods were those that accepts a list of scalar values as input parameters (rather than a strongly-typed DataRow or DataTable instance).</span></span> <span data-ttu-id="eaaf7-156">İyimser eşzamanlılık, doğrudan DB kullanırken `Update()` ve `Delete()` yöntemleri, özgün değerleri de giriş parametrelerini içerir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-156">When using optimistic concurrency, the DB direct `Update()` and `Delete()` methods include input parameters for the original values as well.</span></span> <span data-ttu-id="eaaf7-157">Ayrıca, batch kullanılarak için BLL kodunda güncelleştirme deseni ( `Update()` DataRow DataTables yerine ve skaler değerler kabul yöntemi aşırı) de değiştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-157">Moreover, the code in the BLL for using the batch update pattern (the `Update()` method overloads that accept DataRows and DataTables rather than scalar values) must be changed as well.</span></span>

<span data-ttu-id="eaaf7-158">Bunun yerine bizim varolan genişletmek daha (hangi uyum sağlayacak şekilde BLL değiştirme istediğinde) iyimser eşzamanlılık kullanalım için DAL'ın TableAdapters bunun yerine yeni yazılan adlı bir veri kümesi oluşturma `NorthwindOptimisticConcurrency`, hangi ekleyeceğiz için bir `Products` TableAdapter, İyimser eşzamanlılık kullanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-158">Rather than extend our existing DAL's TableAdapters to use optimistic concurrency (which would necessitate changing the BLL to accommodate), let's instead create a new Typed DataSet named `NorthwindOptimisticConcurrency`, to which we'll add a `Products` TableAdapter that uses optimistic concurrency.</span></span> <span data-ttu-id="eaaf7-159">Biz oluşturacaksınız bir `ProductsOptimisticConcurrencyBLL` iyimser eşzamanlılık DAL desteklemek için uygun değişiklikleri olan iş mantığı katmanı sınıfı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-159">Following that, we'll create a `ProductsOptimisticConcurrencyBLL` Business Logic Layer class that has the appropriate modifications to support the optimistic concurrency DAL.</span></span> <span data-ttu-id="eaaf7-160">Bu geçişteki yerleştirilmiş sonra biz ASP.NET sayfası oluşturmak için hazır olacaktır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-160">Once this groundwork has been laid, we'll be ready to create the ASP.NET page.</span></span>

## <a name="step-2-creating-a-data-access-layer-that-supports-optimistic-concurrency"></a><span data-ttu-id="eaaf7-161">2. adım: iyimser eşzamanlılık destekleyen veri erişim katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="eaaf7-161">Step 2: Creating a Data Access Layer That Supports Optimistic Concurrency</span></span>

<span data-ttu-id="eaaf7-162">Yeni yazılan veri kümesi oluşturmak için sağ `DAL` klasör içinde `App_Code` klasörü ve adlı yeni bir veri kümesi ekleyin `NorthwindOptimisticConcurrency`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-162">To create a new Typed DataSet, right-click on the `DAL` folder within the `App_Code` folder and add a new DataSet named `NorthwindOptimisticConcurrency`.</span></span> <span data-ttu-id="eaaf7-163">İlk öğreticide gördüğümüz gibi bunun yeni bir TableAdapter yazılan TableAdapter Yapılandırma Sihirbazı'nı otomatik olarak başlatılması veri kümesi için bu nedenle ekleyin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-163">As we saw in the first tutorial, doing so will add a new TableAdapter to the Typed DataSet, automatically launching the TableAdapter Configuration Wizard.</span></span> <span data-ttu-id="eaaf7-164">İlk ekranda, biz bağlanmak-aynı Northwind veritabanı'na bağlanmak istediğiniz veritabanını belirtmek için istenir `NORTHWNDConnectionString` setting from `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-164">In the first screen, we're prompted to specify the database to connect to - connect to the same Northwind database using the `NORTHWNDConnectionString` setting from `Web.config`.</span></span>


<span data-ttu-id="eaaf7-165">[![Aynı Northwind veritabanına bağlan](implementing-optimistic-concurrency-vb/_static/image8.png)](implementing-optimistic-concurrency-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-165">[![Connect to the Same Northwind Database](implementing-optimistic-concurrency-vb/_static/image8.png)](implementing-optimistic-concurrency-vb/_static/image7.png)</span></span>

<span data-ttu-id="eaaf7-166">**Şekil 3**: aynı Northwind veritabanına bağlanma ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-166">**Figure 3**: Connect to the Same Northwind Database ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image9.png))</span></span>


<span data-ttu-id="eaaf7-167">Ardından, biz verilerin nasıl aldığını istenir: geçici SQL deyimi, yeni bir saklı yordam veya varolan bir saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-167">Next, we are prompted as to how to query the data: through an ad-hoc SQL statement, a new stored procedure, or an existing stored procedure.</span></span> <span data-ttu-id="eaaf7-168">Geçici SQL sorguları bizim özgün DAL kullandık olduğundan, bu seçenek burada da kullanın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-168">Since we used ad-hoc SQL queries in our original DAL, use this option here as well.</span></span>


<span data-ttu-id="eaaf7-169">[![Geçici SQL deyimi kullanarak alınacak veri belirtin](implementing-optimistic-concurrency-vb/_static/image11.png)](implementing-optimistic-concurrency-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-169">[![Specify the Data to Retrieve Using an Ad-Hoc SQL Statement](implementing-optimistic-concurrency-vb/_static/image11.png)](implementing-optimistic-concurrency-vb/_static/image10.png)</span></span>

<span data-ttu-id="eaaf7-170">**Şekil 4**: geçici SQL deyimi kullanarak alınacak veri belirtin ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-170">**Figure 4**: Specify the Data to Retrieve Using an Ad-Hoc SQL Statement ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image12.png))</span></span>


<span data-ttu-id="eaaf7-171">Aşağıdaki ekranda ürün bilgisi almak için kullanılacak SQL sorgusu girin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-171">On the following screen, enter the SQL query to use to retrieve the product information.</span></span> <span data-ttu-id="eaaf7-172">İçin kullanılan aynı tam SQL sorgusunu kullanalım `Products` tüm döndürür bizim özgün DAL gelen TableAdapter `Product` ürünün sağlayıcısına ve kategori adları ile birlikte sütunlar:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-172">Let's use the exact same SQL query used for the `Products` TableAdapter from our original DAL, which returns all of the `Product` columns along with the product's supplier and category names:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample2.sql)]


<span data-ttu-id="eaaf7-173">[![Özgün DAL ürünleri TableAdapter aynı SQL sorgudan kullanın](implementing-optimistic-concurrency-vb/_static/image14.png)](implementing-optimistic-concurrency-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-173">[![Use the Same SQL Query from the Products TableAdapter in the Original DAL](implementing-optimistic-concurrency-vb/_static/image14.png)](implementing-optimistic-concurrency-vb/_static/image13.png)</span></span>

<span data-ttu-id="eaaf7-174">**Şekil 5**: aynı SQL sorgusu kullanın `Products` özgün DAL TableAdapter ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-174">**Figure 5**: Use the Same SQL Query from the `Products` TableAdapter in the Original DAL ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image15.png))</span></span>


<span data-ttu-id="eaaf7-175">Sonraki ekrana taşımadan önce Gelişmiş Seçenekler düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-175">Before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="eaaf7-176">Bu TableAdapter employ iyimser eşzamanlılık denetimini sağlamak için yalnızca "iyimser eşzamanlılık kullan" onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-176">To have this TableAdapter employ optimistic concurrency control, simply check the "Use optimistic concurrency" checkbox.</span></span>


<span data-ttu-id="eaaf7-177">[![Denetleme tarafından iyimser eşzamanlılık denetimini etkinleştir &quot;iyimser eşzamanlılık kullanmak&quot; onay kutusu](implementing-optimistic-concurrency-vb/_static/image17.png)](implementing-optimistic-concurrency-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-177">[![Enable Optimistic Concurrency Control by Checking the &quot;Use optimistic concurrency&quot; CheckBox](implementing-optimistic-concurrency-vb/_static/image17.png)](implementing-optimistic-concurrency-vb/_static/image16.png)</span></span>

<span data-ttu-id="eaaf7-178">**Şekil 6**: iyimser eşzamanlılık "iyimser eşzamanlılık kullan" onay kutusunu işaretleyerek denetimi etkinleştir ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-178">**Figure 6**: Enable Optimistic Concurrency Control by Checking the "Use optimistic concurrency" CheckBox ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image18.png))</span></span>


<span data-ttu-id="eaaf7-179">Son olarak, hem bir DataTable doldurun ve DataTable veri erişimi desenleri TableAdapter kullanması gerektiğini gösterir; aynı zamanda DB doğrudan yöntemleri oluşturulması gerektiğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-179">Lastly, indicate that the TableAdapter should use the data access patterns that both fill a DataTable and return a DataTable; also indicate that the DB direct methods should be created.</span></span> <span data-ttu-id="eaaf7-180">Dönüş için yöntem adını DataTable düzeni GetData bizim özgün DAL kullandık adlandırma kuralları yansıtmak amacıyla GetProducts değiştirin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-180">Change the method name for the Return a DataTable pattern from GetData to GetProducts, so as to mirror the naming conventions we used in our original DAL.</span></span>


<span data-ttu-id="eaaf7-181">[![Tüm veri erişim desenlerini kullanan TableAdapter sahip](implementing-optimistic-concurrency-vb/_static/image20.png)](implementing-optimistic-concurrency-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-181">[![Have the TableAdapter Utilize All Data Access Patterns](implementing-optimistic-concurrency-vb/_static/image20.png)](implementing-optimistic-concurrency-vb/_static/image19.png)</span></span>

<span data-ttu-id="eaaf7-182">**Şekil 7**: TableAdapter kullanan tüm veri erişim düzenlere sahip ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-182">**Figure 7**: Have the TableAdapter Utilize All Data Access Patterns ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image21.png))</span></span>


<span data-ttu-id="eaaf7-183">Sihirbazı tamamladıktan sonra veri kümesi Tasarımcısı kesin türü belirtilmiş bir içerecektir `Products` DataTable ve TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-183">After completing the wizard, the DataSet Designer will include a strongly-typed `Products` DataTable and TableAdapter.</span></span> <span data-ttu-id="eaaf7-184">DataTable nesnesinden yeniden adlandırmak için bir dakikanızı ayırın `Products` için `ProductsOptimisticConcurrency`, DataTable nesnesinin başlık çubuğunda sağ tıklayıp bağlam menüsünden yeniden adlandır seçerek bunu yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-184">Take a moment to rename the DataTable from `Products` to `ProductsOptimisticConcurrency`, which you can do by right-clicking on the DataTable's title bar and choosing Rename from the context menu.</span></span>


<span data-ttu-id="eaaf7-185">[![DataTable ve TableAdapter türü belirtilmiş veri kümesine eklenmiştir](implementing-optimistic-concurrency-vb/_static/image23.png)](implementing-optimistic-concurrency-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-185">[![A DataTable and TableAdapter Have Been Added to the Typed DataSet](implementing-optimistic-concurrency-vb/_static/image23.png)](implementing-optimistic-concurrency-vb/_static/image22.png)</span></span>

<span data-ttu-id="eaaf7-186">**Şekil 8**: bir DataTable ve TableAdapter yazılan veri kümesi eklenmiştir ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-186">**Figure 8**: A DataTable and TableAdapter Have Been Added to the Typed DataSet ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image24.png))</span></span>


<span data-ttu-id="eaaf7-187">Arasındaki farklar görmek için `UPDATE` ve `DELETE` arasında sorgular `ProductsOptimisticConcurrency` (hangi iyimser eşzamanlılık kullanır) TableAdapter ve (hangi değil) ürünleri TableAdapter, üzerinde TableAdapter tıklayın ve Özellikler penceresine gidin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-187">To see the differences between the `UPDATE` and `DELETE` queries between the `ProductsOptimisticConcurrency` TableAdapter (which uses optimistic concurrency) and the Products TableAdapter (which doesn't), click on the TableAdapter and go to the Properties window.</span></span> <span data-ttu-id="eaaf7-188">İçinde `DeleteCommand` ve `UpdateCommand` özelliklerin `CommandText` alt DAL'ın güncelleştirme veya silme ilgili yöntem çağrıldığında, veritabanına gönderilen gerçek SQL söz dizimi görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-188">In the `DeleteCommand` and `UpdateCommand` properties' `CommandText` subproperties you can see the actual SQL syntax that is sent to the database when the DAL's update or delete-related methods are invoked.</span></span> <span data-ttu-id="eaaf7-189">İçin `ProductsOptimisticConcurrency` TableAdapter `DELETE` kullanılan ifadesi:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-189">For the `ProductsOptimisticConcurrency` TableAdapter the `DELETE` statement used is:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample3.sql)]

<span data-ttu-id="eaaf7-190">Oysa `DELETE` ürün TableAdapter bizim özgün DAL içinde bildirimi çok basittir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-190">Whereas the `DELETE` statement for the Product TableAdapter in our original DAL is the much simpler:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample4.sql)]

<span data-ttu-id="eaaf7-191">Gördüğünüz gibi `WHERE` yan tümcesinde `DELETE` iyimser eşzamanlılık kullanan TableAdapter deyimi içeren her biri arasında bir karşılaştırma `Product` tablo varolan sütun değerlerini ve özgün değerleri zaman GridView (veya DetailsView veya FormView) son doldurulmuş olduğu.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-191">As you can see, the `WHERE` clause in the `DELETE` statement for the TableAdapter that uses optimistic concurrency includes a comparison between each of the `Product` table's existing column values and the original values at the time the GridView (or DetailsView or FormView) was last populated.</span></span> <span data-ttu-id="eaaf7-192">Dışındaki tüm alanlar itibaren `ProductID`, `ProductName`, ve `Discontinued` olabilir `NULL` değerleri, ek parametreler ve denetimleri doğru Karşılaştırılacak dahil `NULL` değerler `WHERE` yan tümcesi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-192">Since all fields other than `ProductID`, `ProductName`, and `Discontinued` can have `NULL` values, additional parameters and checks are included to correctly compare `NULL` values in the `WHERE` clause.</span></span>

<span data-ttu-id="eaaf7-193">ASP.NET sayfamızı yalnızca güncelleştirme ve silme ürün bilgileri sağlarız gibi biz herhangi bir ek DataTables iyimser eşzamanlılık özellikli veri kümesi için Bu öğretici için ekliyor olmaz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-193">We won't be adding any additional DataTables to the optimistic concurrency-enabled DataSet for this tutorial, as our ASP.NET page will only provide updating and deleting product information.</span></span> <span data-ttu-id="eaaf7-194">Ancak, yine eklemek ihtiyacımız `GetProductByProductID(productID)` yönteme `ProductsOptimisticConcurrency` TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-194">However, we do still need to add the `GetProductByProductID(productID)` method to the `ProductsOptimisticConcurrency` TableAdapter.</span></span>

<span data-ttu-id="eaaf7-195">Bunu gerçekleştirmek için TableAdapter'in başlık çubuğunda sağ tıklayın (yukarıda alanı sağ `Fill` ve `GetProducts` yöntemi adları) ve bağlam menüsünden Sorgu Ekle'i seçin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-195">To accomplish this, right-click on the TableAdapter's title bar (the area right above the `Fill` and `GetProducts` method names) and choose Add Query from the context menu.</span></span> <span data-ttu-id="eaaf7-196">Bu TableAdapter sorgu Yapılandırma Sihirbazı'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-196">This will launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="eaaf7-197">Oluşturmak için bizim TableAdapter'ın ilk yapılandırma ile katılım gibi `GetProductByProductID(productID)` geçici SQL deyimi kullanarak yöntemi (Şekil 4'e bakın).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-197">As with our TableAdapter's initial configuration, opt to create the `GetProductByProductID(productID)` method using an ad-hoc SQL statement (see Figure 4).</span></span> <span data-ttu-id="eaaf7-198">Bu yana `GetProductByProductID(productID)` yöntemi, belirli bir ürünü hakkında bilgi verir, bu sorgu olduğunu gösteren bir `SELECT` sorgu satırları döndürür türü.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-198">Since the `GetProductByProductID(productID)` method returns information about a particular product, indicate that this query is a `SELECT` query type that returns rows.</span></span>


<span data-ttu-id="eaaf7-199">[![Sorgu türü olarak işaretlemek bir &quot;satırlar döndüren seçin&quot;](implementing-optimistic-concurrency-vb/_static/image26.png)](implementing-optimistic-concurrency-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-199">[![Mark the Query Type as a &quot;SELECT which returns rows&quot;](implementing-optimistic-concurrency-vb/_static/image26.png)](implementing-optimistic-concurrency-vb/_static/image25.png)</span></span>

<span data-ttu-id="eaaf7-200">**Şekil 9**: sorgu türü olarak işaretlemek bir "`SELECT` satırlar döndüren" ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-200">**Figure 9**: Mark the Query Type as a "`SELECT` which returns rows" ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image27.png))</span></span>


<span data-ttu-id="eaaf7-201">Sonraki ekranda, önceden yüklenmiş TableAdapter'ın varsayılan sorguyla kullanmak SQL sorgusu için biz istenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-201">On the next screen we're prompted for the SQL query to use, with the TableAdapter's default query pre-loaded.</span></span> <span data-ttu-id="eaaf7-202">Varolan sorguyu yan tümcesi içerecek şekilde büyütmek `WHERE ProductID = @ProductID`, Şekil 10'da gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-202">Augment the existing query to include the clause `WHERE ProductID = @ProductID`, as shown in Figure 10.</span></span>


<span data-ttu-id="eaaf7-203">[![WHERE eklemek belirli ürün kaydı geri dönmek için önceden yüklenmiş sorguya yan tümcesi](implementing-optimistic-concurrency-vb/_static/image29.png)](implementing-optimistic-concurrency-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-203">[![Add a WHERE Clause to the Pre-Loaded Query to Return a Specific Product Record](implementing-optimistic-concurrency-vb/_static/image29.png)](implementing-optimistic-concurrency-vb/_static/image28.png)</span></span>

<span data-ttu-id="eaaf7-204">**Şekil 10**: ekleme bir `WHERE` belirli bir ürün kaydı döndürülecek Pre-Loaded sorgu yan tümcesini ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-204">**Figure 10**: Add a `WHERE` Clause to the Pre-Loaded Query to Return a Specific Product Record ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image30.png))</span></span>


<span data-ttu-id="eaaf7-205">Son olarak, oluşturulan yöntemi adlarını değiştirmek `FillByProductID` ve `GetProductByProductID`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-205">Finally, change the generated method names to `FillByProductID` and `GetProductByProductID`.</span></span>


<span data-ttu-id="eaaf7-206">[![Yöntemleri FillByProductID ve GetProductByProductID olarak yeniden adlandırın](implementing-optimistic-concurrency-vb/_static/image32.png)](implementing-optimistic-concurrency-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-206">[![Rename the Methods to FillByProductID and GetProductByProductID](implementing-optimistic-concurrency-vb/_static/image32.png)](implementing-optimistic-concurrency-vb/_static/image31.png)</span></span>

<span data-ttu-id="eaaf7-207">**Şekil 11**: yöntemlerini yeniden adlandırmak `FillByProductID` ve `GetProductByProductID` ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-207">**Figure 11**: Rename the Methods to `FillByProductID` and `GetProductByProductID` ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image33.png))</span></span>


<span data-ttu-id="eaaf7-208">Bu sihirbaz tam, TableAdapter şimdi veri almak için iki yöntem içerir: `GetProducts()`, döndüren *tüm* ürünleri; ve `GetProductByProductID(productID)`, belirtilen ürün döndürür.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-208">With this wizard complete, the TableAdapter now contains two methods for retrieving data: `GetProducts()`, which returns *all* products; and `GetProductByProductID(productID)`, which returns the specified product.</span></span>

## <a name="step-3-creating-a-business-logic-layer-for-the-optimistic-concurrency-enabled-dal"></a><span data-ttu-id="eaaf7-209">3. adım: iyimser eşzamanlılık etkin DAL için bir iş mantığı katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="eaaf7-209">Step 3: Creating a Business Logic Layer for the Optimistic Concurrency-Enabled DAL</span></span>

<span data-ttu-id="eaaf7-210">Var olan bizim `ProductsBLL` sınıfı toplu güncelleştirme ve DB doğrudan desenleri kullanma örnekleri sahiptir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-210">Our existing `ProductsBLL` class has examples of using both the batch update and DB direct patterns.</span></span> <span data-ttu-id="eaaf7-211">`AddProduct` Yöntemi ve `UpdateProduct` aşırı hem kullanın tümleştirilmesidir toplu güncelleştirme desen bir `ProductRow` TableAdapter'ın güncelleştirme yöntemi örneği.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-211">The `AddProduct` method and `UpdateProduct` overloads both use the batch update pattern, passing in a `ProductRow` instance to the TableAdapter's Update method.</span></span> <span data-ttu-id="eaaf7-212">`DeleteProduct` Yöntemi, diğer yandan TableAdapter's çağırma DB doğrudan deseni kullanır `Delete(productID)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-212">The `DeleteProduct` method, on the other hand, uses the DB direct pattern, calling the TableAdapter's `Delete(productID)` method.</span></span>

<span data-ttu-id="eaaf7-213">Yeni `ProductsOptimisticConcurrency` yöntemleri şimdi gerektirir orijinal değerleri de ayrıca geçirilmesi TableAdapter, DB doğrudan.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-213">With the new `ProductsOptimisticConcurrency` TableAdapter, the DB direct methods now require that the original values also be passed in.</span></span> <span data-ttu-id="eaaf7-214">Örneğin, `Delete` yöntemi şimdi bekliyor on giriş parametreleri: özgün `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, ve `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-214">For example, the `Delete` method now expects ten input parameters: the original `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, and `Discontinued`.</span></span> <span data-ttu-id="eaaf7-215">Bu ek giriş parametreleri değerleri kullanan `WHERE` yan tümcesi `DELETE` veritabanının geçerli değerleri özgün olanları kadar eşlerseniz belirtilen kayıt silme yalnızca veritabanına gönderilen ifadesi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-215">It uses these additional input parameters' values in `WHERE` clause of the `DELETE` statement sent to the database, only deleting the specified record if the database's current values map up to the original ones.</span></span>

<span data-ttu-id="eaaf7-216">While yöntemi imza TableAdapter için 's `Update` kurmadı toplu güncelleştirme desende kullanılacak yöntemi değiştirilmiş, özgün ve yeni değerleri kaydetmek için gereken kod sahiptir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-216">While the method signature for the TableAdapter's `Update` method used in the batch update pattern hasn't changed, the code needed to record the original and new values has.</span></span> <span data-ttu-id="eaaf7-217">Bu nedenle, yerine bizim var olan iyimser eşzamanlılık etkin DAL kullanma girişimi `ProductsBLL` sınıfı, bizim yeni DAL ile çalışmak için yeni bir iş mantığı katmanı sınıf oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-217">Therefore, rather than attempt to use the optimistic concurrency-enabled DAL with our existing `ProductsBLL` class, let's create a new Business Logic Layer class for working with our new DAL.</span></span>

<span data-ttu-id="eaaf7-218">Adlı bir sınıf ekleyin `ProductsOptimisticConcurrencyBLL` için `BLL` klasör içinde `App_Code` klasör.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-218">Add a class named `ProductsOptimisticConcurrencyBLL` to the `BLL` folder within the `App_Code` folder.</span></span>


![BLL klasörüne ProductsOptimisticConcurrencyBLL sınıfı ekleme](implementing-optimistic-concurrency-vb/_static/image34.png)

<span data-ttu-id="eaaf7-220">**Şekil 12**: eklemek `ProductsOptimisticConcurrencyBLL` BLL klasörüne sınıfı</span><span class="sxs-lookup"><span data-stu-id="eaaf7-220">**Figure 12**: Add the `ProductsOptimisticConcurrencyBLL` Class to the BLL Folder</span></span>


<span data-ttu-id="eaaf7-221">Sonra aşağıdaki kodu ekleyin `ProductsOptimisticConcurrencyBLL` sınıfı:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-221">Next, add the following code to the `ProductsOptimisticConcurrencyBLL` class:</span></span>


[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample5.vb)]

<span data-ttu-id="eaaf7-222">Not `NorthwindOptimisticConcurrencyTableAdapters` sınıf bildiriminin başlangıç yukarıda deyimi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-222">Note the using `NorthwindOptimisticConcurrencyTableAdapters` statement above the start of the class declaration.</span></span> <span data-ttu-id="eaaf7-223">`NorthwindOptimisticConcurrencyTableAdapters` Ad alanında `ProductsOptimisticConcurrencyTableAdapter` DAL'ın yöntemleri sağlayan sınıf.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-223">The `NorthwindOptimisticConcurrencyTableAdapters` namespace contains the `ProductsOptimisticConcurrencyTableAdapter` class, which provides the DAL's methods.</span></span> <span data-ttu-id="eaaf7-224">Ayrıca sınıf bildirimi önce bulabilirsiniz `System.ComponentModel.DataObject` ObjectDataSource sihirbazın aşağı açılan listede bu sınıf eklemek için Visual Studio bildirir özniteliği.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-224">Also before the class declaration you'll find the `System.ComponentModel.DataObject` attribute, which instructs Visual Studio to include this class in the ObjectDataSource wizard's drop-down list.</span></span>

<span data-ttu-id="eaaf7-225">`ProductsOptimisticConcurrencyBLL`'S `Adapter` özelliği örneği hızlı erişim sağlar `ProductsOptimisticConcurrencyTableAdapter` sınıfı ve özgün bizim BLL sınıflarda kullanılan deseni izler (`ProductsBLL`, `CategoriesBLL`, vb.).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-225">The `ProductsOptimisticConcurrencyBLL`'s `Adapter` property provides quick access to an instance of the `ProductsOptimisticConcurrencyTableAdapter` class, and follows the pattern used in our original BLL classes (`ProductsBLL`, `CategoriesBLL`, and so on).</span></span> <span data-ttu-id="eaaf7-226">Son olarak, `GetProducts()` yöntemi yalnızca çağırır DAL ait `GetProducts()` yöntemi ve döndürür bir `ProductsOptimisticConcurrencyDataTable` nesnesi doldurulmuş ile bir `ProductsOptimisticConcurrencyRow` veritabanındaki her bir ürün kaydı için örneği.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-226">Finally, the `GetProducts()` method simply calls down into the DAL's `GetProducts()` method and returns a `ProductsOptimisticConcurrencyDataTable` object populated with a `ProductsOptimisticConcurrencyRow` instance for each product record in the database.</span></span>

## <a name="deleting-a-product-using-the-db-direct-pattern-with-optimistic-concurrency"></a><span data-ttu-id="eaaf7-227">İyimser eşzamanlılık ile DB doğrudan düzeni kullanarak ürün silme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-227">Deleting a Product Using the DB Direct Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="eaaf7-228">İyimser eşzamanlılık kullanan bir DAL karşı DB doğrudan deseni kullanırken, yöntemleri yeni ve özgün değerleri geçirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-228">When using the DB direct pattern against a DAL that uses optimistic concurrency, the methods must be passed the new and original values.</span></span> <span data-ttu-id="eaaf7-229">Silme için yeni değerler yoktur, böylece yalnızca özgün değerlerine geçirilmesi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-229">For deleting, there are no new values, so only the original values need be passed in.</span></span> <span data-ttu-id="eaaf7-230">Bizim BLL, daha sonra biz tüm özgün parametrelerden biri giriş parametreleri olarak kabul etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-230">In our BLL, then, we must accept all of the original parameters as input parameters.</span></span> <span data-ttu-id="eaaf7-231">Şimdi sahip `DeleteProduct` yönteminde `ProductsOptimisticConcurrencyBLL` sınıfı DB doğrudan yöntemi kullanın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-231">Let's have the `DeleteProduct` method in the `ProductsOptimisticConcurrencyBLL` class use the DB direct method.</span></span> <span data-ttu-id="eaaf7-232">Bu, bu yöntem giriş parametresi olarak tüm on ürün veri alanlarında almak ve bunları DAL aşağıdaki kodda gösterildiği gibi geçirmek gerektiği anlamına gelir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-232">This means that this method needs to take in all ten product data fields as input parameters, and pass these to the DAL, as shown in the following code:</span></span>


[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample6.vb)]

<span data-ttu-id="eaaf7-233">Kullanıcı Sil düğmesini tıklattığında veritabanındaki değerlerinden - GridView (veya DetailsView veya FormView) en son yüklenen bu değerleri - özgün değerler farklıysa `WHERE` yan tümcesi olmaz eşleştiğini herhangi bir veritabanı kaydının ve kayıt yok etkilenmez.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-233">If the original values - those values that were last loaded into the GridView (or DetailsView or FormView) - differ from the values in the database when the user clicks the Delete button the `WHERE` clause won't match up with any database record and no records will be affected.</span></span> <span data-ttu-id="eaaf7-234">Bu nedenle, TableAdapter's `Delete` yöntemi döndürür `0` ve BLL's `DeleteProduct` yöntemi döndürür `false`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-234">Hence, the TableAdapter's `Delete` method will return `0` and the BLL's `DeleteProduct` method will return `false`.</span></span>

## <a name="updating-a-product-using-the-batch-update-pattern-with-optimistic-concurrency"></a><span data-ttu-id="eaaf7-235">Toplu güncelleştirme desen ile iyimser eşzamanlılık kullanarak ürün güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="eaaf7-235">Updating a Product Using the Batch Update Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="eaaf7-236">TableAdapter'ın daha önce belirtildiği gibi `Update` yöntemi için toplu güncelleştirme düzeni sahip olup olmadığına iyimser eşzamanlılık işe bakılmaksızın aynı yöntem imzası.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-236">As noted earlier, the TableAdapter's `Update` method for the batch update pattern has the same method signature regardless of whether or not optimistic concurrency is employed.</span></span> <span data-ttu-id="eaaf7-237">Yani, `Update` yöntemi bir DataRow satırının, DataRow, DataTable ya da yazılı DataSet dizisi bekliyor.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-237">Namely, the `Update` method expects a DataRow, an array of DataRows, a DataTable, or a Typed DataSet.</span></span> <span data-ttu-id="eaaf7-238">Orijinal değerleri belirtmek için hiçbir ek giriş parametreleri yok.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-238">There are no additional input parameters for specifying the original values.</span></span> <span data-ttu-id="eaaf7-239">DataTable özgün ve değiştirilen değerleri için kendi DataRow(s) izler olasıdır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-239">This is possible because the DataTable keeps track of the original and modified values for its DataRow(s).</span></span> <span data-ttu-id="eaaf7-240">Ne zaman DAL sorunları kendi `UPDATE` deyimi, `@original_ColumnName` parametreleri, DataRow nesnesinin özgün değerlerle doldurulur, ancak `@ColumnName` parametreleri, DataRow nesnesinin değiştirilmiş değerlerle doldurulur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-240">When the DAL issues its `UPDATE` statement, the `@original_ColumnName` parameters are populated with the DataRow's original values, whereas the `@ColumnName` parameters are populated with the DataRow's modified values.</span></span>

<span data-ttu-id="eaaf7-241">İçinde `ProductsBLL` (bizim iyimser olmayan, özgün eşzamanlılık DAL kullanır) sınıfını kodumuza aşağıdaki olaylar dizisi gerçekleştirir ürün bilgilerini güncelleştirmek için toplu güncelleştirme düzeni kullanırken:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-241">In the `ProductsBLL` class (which uses our original, non-optimistic concurrency DAL), when using the batch update pattern to update product information our code performs the following sequence of events:</span></span>

1. <span data-ttu-id="eaaf7-242">Geçerli veritabanı ürün bilgileri okuyun bir `ProductRow` TableAdapter's kullanarak örnek `GetProductByProductID(productID)` yöntemi</span><span class="sxs-lookup"><span data-stu-id="eaaf7-242">Read the current database product information into a `ProductRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="eaaf7-243">Yeni değerler atama `ProductRow` adım 1'den örneği</span><span class="sxs-lookup"><span data-stu-id="eaaf7-243">Assign the new values to the `ProductRow` instance from Step 1</span></span>
3. <span data-ttu-id="eaaf7-244">TableAdapter's çağrısı `Update` tümleştirilmesidir yöntemi `ProductRow` örneği</span><span class="sxs-lookup"><span data-stu-id="eaaf7-244">Call the TableAdapter's `Update` method, passing in the `ProductRow` instance</span></span>

<span data-ttu-id="eaaf7-245">Bu adımlar, ancak dizi doğru iyimser eşzamanlılık olduğundan destek olmaz `ProductRow` içinde doldurulmuş 1. adım, DataRow tarafından kullanılan özgün değerleri, şu anda mevcut olduğu anlamına gelir doğrudan veritabanından doldurulur Veritabanı ve düzenleme işlemi başlangıcında GridView bağlanmış olanlar değil.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-245">This sequence of steps, however, won't correctly support optimistic concurrency because the `ProductRow` populated in Step 1 is populated directly from the database, meaning that the original values used by the DataRow are those that currently exist in the database, and not those that were bound to the GridView at the start of the editing process.</span></span> <span data-ttu-id="eaaf7-246">Kullanarak bir iyimser eşzamanlılık-DAL etkinleştirildiğinde, bunun yerine, alter için ihtiyacımız `UpdateProduct` yöntemi aşırı aşağıdaki adımları kullanın:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-246">Instead, when using an optimistic concurrency-enabled DAL, we need to alter the `UpdateProduct` method overloads to use the following steps:</span></span>

1. <span data-ttu-id="eaaf7-247">Geçerli veritabanı ürün bilgileri okuyun bir `ProductsOptimisticConcurrencyRow` TableAdapter's kullanarak örnek `GetProductByProductID(productID)` yöntemi</span><span class="sxs-lookup"><span data-stu-id="eaaf7-247">Read the current database product information into a `ProductsOptimisticConcurrencyRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="eaaf7-248">Ata *özgün* değerler `ProductsOptimisticConcurrencyRow` adım 1'den örneği</span><span class="sxs-lookup"><span data-stu-id="eaaf7-248">Assign the *original* values to the `ProductsOptimisticConcurrencyRow` instance from Step 1</span></span>
3. <span data-ttu-id="eaaf7-249">Çağrı `ProductsOptimisticConcurrencyRow` örneğinin `AcceptChanges()` DataRow geçerli değerlerini "özgün" olduğunu bildirir yöntemi</span><span class="sxs-lookup"><span data-stu-id="eaaf7-249">Call the `ProductsOptimisticConcurrencyRow` instance's `AcceptChanges()` method, which instructs the DataRow that its current values are the "original" ones</span></span>
4. <span data-ttu-id="eaaf7-250">Ata *yeni* değerler `ProductsOptimisticConcurrencyRow` örneği</span><span class="sxs-lookup"><span data-stu-id="eaaf7-250">Assign the *new* values to the `ProductsOptimisticConcurrencyRow` instance</span></span>
5. <span data-ttu-id="eaaf7-251">TableAdapter's çağrısı `Update` tümleştirilmesidir yöntemi `ProductsOptimisticConcurrencyRow` örneği</span><span class="sxs-lookup"><span data-stu-id="eaaf7-251">Call the TableAdapter's `Update` method, passing in the `ProductsOptimisticConcurrencyRow` instance</span></span>

<span data-ttu-id="eaaf7-252">Belirtilen ürün kaydı için 1. adım okuma tüm geçerli veritabanı değerleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-252">Step 1 reads in all of the current database values for the specified product record.</span></span> <span data-ttu-id="eaaf7-253">Bu adım, gereksiz `UpdateProduct` güncelleştirmeleri aşırı *tüm* ürün sütunların (Bu değerler olarak 2. adımda yazılır), ancak burada yalnızca bir alt kümesini sütun değerlerini içinde olarak geçirilir Bu aşırı yüklemeleri için gereklidir Giriş parametreleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-253">This step is superfluous in the `UpdateProduct` overload that updates *all* of the product columns (as these values are overwritten in Step 2), but is essential for those overloads where only a subset of the column values are passed in as input parameters.</span></span> <span data-ttu-id="eaaf7-254">Özgün değerler atanmış sonra `ProductsOptimisticConcurrencyRow` örneği `AcceptChanges()` yöntemi çağrıldığında, geçerli DataRow değerleri, kullanılacak özgün değerler olarak işaretler `@original_ColumnName` parametrelerinde `UPDATE` deyimi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-254">Once the original values have been assigned to the `ProductsOptimisticConcurrencyRow` instance, the `AcceptChanges()` method is called, which marks the current DataRow values as the original values to be used in the `@original_ColumnName` parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="eaaf7-255">Ardından, yeni parametre değerlerini atanan `ProductsOptimisticConcurrencyRow` ve son olarak, `Update` yöntemi çağrıldığında, DataRow geçirme.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-255">Next, the new parameter values are assigned to the `ProductsOptimisticConcurrencyRow` and, finally, the `Update` method is invoked, passing in the DataRow.</span></span>

<span data-ttu-id="eaaf7-256">Aşağıdaki kodda gösterildiği `UpdateProduct` tüm ürün verilerini kabul eden aşırı alanları olarak giriş parametreleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-256">The following code shows the `UpdateProduct` overload that accepts all product data fields as input parameters.</span></span> <span data-ttu-id="eaaf7-257">Burada gösterilmeyen sırada `ProductsOptimisticConcurrencyBLL` de Bu öğretici içermektedir yüklemeye dahil sınıfı bir `UpdateProduct` yalnızca ürün adı ve fiyat giriş parametreleri olarak kabul eden aşırı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-257">While not shown here, the `ProductsOptimisticConcurrencyBLL` class included in the download for this tutorial also contains an `UpdateProduct` overload that accepts just the product's name and price as input parameters.</span></span>


[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample7.vb)]

## <a name="step-4-passing-the-original-and-new-values-from-the-aspnet-page-to-the-bll-methods"></a><span data-ttu-id="eaaf7-258">4. adım: özgün ve yeni değerleri ASP.NET sayfasından BLL yöntemleri geçirme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-258">Step 4: Passing the Original and New Values From the ASP.NET Page to the BLL Methods</span></span>

<span data-ttu-id="eaaf7-259">DAL ve BLL tam kalan tek şey sisteme yerleşik iyimser eşzamanlılık mantığı kullanabileceği ASP.NET sayfası oluşturmak için.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-259">With the DAL and BLL complete, all that remains is to create an ASP.NET page that can utilize the optimistic concurrency logic built in to the system.</span></span> <span data-ttu-id="eaaf7-260">Özellikle, Web denetimi (GridView, DetailsView veya FormView) veri özgün değerlerini ve ObjectDataSource iki değer için iş mantığı katmanı geçmelidir unutmamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-260">Specifically, the data Web control (the GridView, DetailsView, or FormView) must remember its original values and the ObjectDataSource must pass both sets of values to the Business Logic Layer.</span></span> <span data-ttu-id="eaaf7-261">Ayrıca, ASP.NET sayfası eşzamanlılık ihlalleri kolaylıkla idare edecek yapılandırılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-261">Furthermore, the ASP.NET page must be configured to gracefully handle concurrency violations.</span></span>

<span data-ttu-id="eaaf7-262">Başlangıç açarak `OptimisticConcurrency.aspx` sayfasındaki `EditInsertDelete` klasörü ve GridView ayarı Designer'a ekleyerek kendi `ID` özelliğine `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-262">Start by opening the `OptimisticConcurrency.aspx` page in the `EditInsertDelete` folder and adding a GridView to the Designer, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="eaaf7-263">GridView'ın akıllı etiketten adlı yeni bir ObjectDataSource oluşturmak için kabul `ProductsOptimisticConcurrencyDataSource`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-263">From the GridView's smart tag, opt to create a new ObjectDataSource named `ProductsOptimisticConcurrencyDataSource`.</span></span> <span data-ttu-id="eaaf7-264">İyimser eşzamanlılık destekleyen DAL kullanmak için bu ObjectDataSource istiyoruz beri kullanacak şekilde yapılandırın `ProductsOptimisticConcurrencyBLL` nesnesi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-264">Since we want this ObjectDataSource to use the DAL that supports optimistic concurrency, configure it to use the `ProductsOptimisticConcurrencyBLL` object.</span></span>


<span data-ttu-id="eaaf7-265">[![ObjectDataSource kullanması ProductsOptimisticConcurrencyBLL nesnesi](implementing-optimistic-concurrency-vb/_static/image36.png)](implementing-optimistic-concurrency-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-265">[![Have the ObjectDataSource Use the ProductsOptimisticConcurrencyBLL Object](implementing-optimistic-concurrency-vb/_static/image36.png)](implementing-optimistic-concurrency-vb/_static/image35.png)</span></span>

<span data-ttu-id="eaaf7-266">**Şekil 13**: ObjectDataSource kullanması `ProductsOptimisticConcurrencyBLL` nesne ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-266">**Figure 13**: Have the ObjectDataSource Use the `ProductsOptimisticConcurrencyBLL` Object ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image37.png))</span></span>


<span data-ttu-id="eaaf7-267">Seçin `GetProducts`, `UpdateProduct`, ve `DeleteProduct` Sihirbazı'nda açılan listelerden yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-267">Choose the `GetProducts`, `UpdateProduct`, and `DeleteProduct` methods from drop-down lists in the wizard.</span></span> <span data-ttu-id="eaaf7-268">UpdateProduct yöntemi için ürünün veri alanlarının tümünü kabul eden kullanın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-268">For the UpdateProduct method, use the overload that accepts all of the product's data fields.</span></span>

## <a name="configuring-the-objectdatasource-controls-properties"></a><span data-ttu-id="eaaf7-269">ObjectDataSource denetimin özelliklerini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="eaaf7-269">Configuring the ObjectDataSource Control's Properties</span></span>

<span data-ttu-id="eaaf7-270">Sihirbazı tamamladıktan sonra ObjectDataSource'nın bildirim temelli biçimlendirme aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-270">After completing the wizard, the ObjectDataSource's declarative markup should look like the following:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample8.aspx)]

<span data-ttu-id="eaaf7-271">Gördüğünüz gibi `DeleteParameters` koleksiyonu içeren bir `Parameter` her on giriş parametrelerinde örneği `ProductsOptimisticConcurrencyBLL` sınıfının `DeleteProduct` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-271">As you can see, the `DeleteParameters` collection contains a `Parameter` instance for each of the ten input parameters in the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method.</span></span> <span data-ttu-id="eaaf7-272">Benzer şekilde, `UpdateParameters` koleksiyonu içeren bir `Parameter` her giriş parametrelerinde örneği `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-272">Likewise, the `UpdateParameters` collection contains a `Parameter` instance for each of the input parameters in `UpdateProduct`.</span></span>

<span data-ttu-id="eaaf7-273">Veri değişikliği söz konusu bu önceki öğreticiler için biz ObjectDataSource's kaldırmayı tercih `OldValuesParameterFormatString` bu özellik BLL yöntemi geçirilmesi eski (veya özgün) değerlerinin yanı sıra yeni değerleri beklediğini belirtir beri bu noktada özelliği.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-273">For those previous tutorials that involved data modification, we'd remove the ObjectDataSource's `OldValuesParameterFormatString` property at this point, since this property indicates that the BLL method expects the old (or original) values to be passed in as well as the new values.</span></span> <span data-ttu-id="eaaf7-274">Ayrıca, bu özellik değeri özgün değerler için giriş parametresi adları gösterir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-274">Furthermore, this property value indicates the input parameter names for the original values.</span></span> <span data-ttu-id="eaaf7-275">Özgün değerleri BLL geçiriyoruz olduğundan *değil* bu özelliği kaldırın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-275">Since we are passing in the original values into the BLL, do *not* remove this property.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf7-276">Değeri `OldValuesParameterFormatString` özelliği özgün değerler beklediğiniz giriş parametresi adları için BLL eşleme gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-276">The value of the `OldValuesParameterFormatString` property must map to the input parameter names in the BLL that expect the original values.</span></span> <span data-ttu-id="eaaf7-277">Biz bu parametreler adlı bu yana `original_productName`, `original_supplierID`ve benzeri bırakabilirsiniz `OldValuesParameterFormatString` özellik değeri olarak `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-277">Since we named these parameters `original_productName`, `original_supplierID`, and so on, you can leave the `OldValuesParameterFormatString` property value as `original_{0}`.</span></span> <span data-ttu-id="eaaf7-278">Ancak, BLL yöntemleri giriş parametreleri gibi adları sahip, `old_productName`, `old_supplierID`ve benzeri güncellemeniz gerekir `OldValuesParameterFormatString` özelliğine `old_{0}`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-278">If, however, the BLL methods' input parameters had names like `old_productName`, `old_supplierID`, and so on, you'd need to update the `OldValuesParameterFormatString` property to `old_{0}`.</span></span>


<span data-ttu-id="eaaf7-279">ObjectDataSource doğru özgün değerler BLL yöntemlere geçirmek için sırayla yapılmalıdır bir son özellik ayarı yoktur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-279">There's one final property setting that needs to be made in order for the ObjectDataSource to correctly pass the original values to the BLL methods.</span></span> <span data-ttu-id="eaaf7-280">ObjectDataSource sahip bir ['ınızı özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) için atanabilir [iki değerden birini](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx):</span><span class="sxs-lookup"><span data-stu-id="eaaf7-280">The ObjectDataSource has a [ConflictDetection property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) that can be assigned to [one of two values](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx):</span></span>

- <span data-ttu-id="eaaf7-281">`OverwriteChanges` -Varsayılan değer; Özgün değerler BLL yöntemleri özgün giriş parametreleri göndermez</span><span class="sxs-lookup"><span data-stu-id="eaaf7-281">`OverwriteChanges` - the default value; does not send the original values to the BLL methods' original input parameters</span></span>
- <span data-ttu-id="eaaf7-282">`CompareAllValues` -Özgün değerler BLL yöntemlere; Gönder İyimser eşzamanlılık kullanırken bu seçeneği seçin</span><span class="sxs-lookup"><span data-stu-id="eaaf7-282">`CompareAllValues` - does send the original values to the BLL methods; choose this option when using optimistic concurrency</span></span>

<span data-ttu-id="eaaf7-283">Ayarlamak için bir dakikanızı ayırın `ConflictDetection` özelliğine `CompareAllValues`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-283">Take a moment to set the `ConflictDetection` property to `CompareAllValues`.</span></span>

## <a name="configuring-the-gridviews-properties-and-fields"></a><span data-ttu-id="eaaf7-284">GridView'in özellikleri ve alanları yapılandırma</span><span class="sxs-lookup"><span data-stu-id="eaaf7-284">Configuring the GridView's Properties and Fields</span></span>

<span data-ttu-id="eaaf7-285">Düzgün yapılandırılmış ObjectDataSource'nin özellikleri ile GridView ayarına uygulamamızla dönelim.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-285">With the ObjectDataSource's properties properly configured, let's turn our attention to setting up the GridView.</span></span> <span data-ttu-id="eaaf7-286">İlk olarak, düzenleme ve silme desteklemek için GridView istiyoruz beri GridView'ın akıllı etiket gelen düzenlemeyi etkinleştir ve Enable Deleting onay'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-286">First, since we want the GridView to support editing and deleting, click the Enable Editing and Enable Deleting checkboxes from the GridView's smart tag.</span></span> <span data-ttu-id="eaaf7-287">Bu bir CommandField ekler, `ShowEditButton` ve `ShowDeleteButton` her ikisi de ayarlamak `true`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-287">This will add a CommandField whose `ShowEditButton` and `ShowDeleteButton` are both set to `true`.</span></span>

<span data-ttu-id="eaaf7-288">Ne zaman bağlı `ProductsOptimisticConcurrencyDataSource` ObjectDataSource, GridView içeren bir alan her ürünün veri alanları.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-288">When bound to the `ProductsOptimisticConcurrencyDataSource` ObjectDataSource, the GridView contains a field for each of the product's data fields.</span></span> <span data-ttu-id="eaaf7-289">Bu tür bir GridView düzenlenebilir olsa da, kullanıcı deneyimini herhangi bir şey ancak kabul edilebilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-289">While such a GridView can be edited, the user experience is anything but acceptable.</span></span> <span data-ttu-id="eaaf7-290">`CategoryID` Ve `SupplierID` BoundFields Tedarikçi ve uygun kategoriyi kimlik numaraları girmesini gerektiren kutularındaki sokacak.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-290">The `CategoryID` and `SupplierID` BoundFields will render as TextBoxes, requiring the user to enter the appropriate category and supplier as ID numbers.</span></span> <span data-ttu-id="eaaf7-291">Olacaktır hiç sayısal alanlar ve ürün adı sağlandı ve birim fiyat stoktaki birimler, birimler sırası ve sipariş düzeyi değerleri üzerinde uygun her iki sayısal değerlerdir ve daha büyük veya eşit emin olmak için hiçbir doğrulama denetimleri için biçimlendirme sıfır olarak.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-291">There will be no formatting for the numeric fields and no validation controls to ensure that the product's name has been supplied and that the unit price, units in stock, units on order, and reorder level values are both proper numeric values and are greater than or equal to zero.</span></span>

<span data-ttu-id="eaaf7-292">Biz anlatıldığı gibi *doğrulama denetimleri ekleme düzenleme ve ekleme arabirimleri için* ve *veri değişikliği arabirimi özelleştirme* öğreticileri, kullanıcı arabirimi özelleştirilebilir tarafından BoundFields TemplateFields ile değiştirin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-292">As we discussed in the *Adding Validation Controls to the Editing and Inserting Interfaces* and *Customizing the Data Modification Interface* tutorials, the user interface can be customized by replacing the BoundFields with TemplateFields.</span></span> <span data-ttu-id="eaaf7-293">Bu GridView ve düzenleme arabirimiyle aşağıdaki yollarla değiştirdim:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-293">I've modified this GridView and its editing interface in the following ways:</span></span>

- <span data-ttu-id="eaaf7-294">Kaldırılan `ProductID`, `SupplierName`, ve `CategoryName` BoundFields</span><span class="sxs-lookup"><span data-stu-id="eaaf7-294">Removed the `ProductID`, `SupplierName`, and `CategoryName` BoundFields</span></span>
- <span data-ttu-id="eaaf7-295">Dönüştürülen `ProductName` bir TemplateField BoundField ve RequiredFieldValidation denetim eklenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-295">Converted the `ProductName` BoundField to a TemplateField and added a RequiredFieldValidation control.</span></span>
- <span data-ttu-id="eaaf7-296">Dönüştürülen `CategoryID` ve `SupplierID` TemplateFields, BoundFields ve düzenleme arabirimi metin kutuları yerine DropDownLists kullanmak üzere ayarlanmış.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-296">Converted the `CategoryID` and `SupplierID` BoundFields to TemplateFields, and adjusted the editing interface to use DropDownLists rather than TextBoxes.</span></span> <span data-ttu-id="eaaf7-297">Bu TemplateFields içinde `ItemTemplates`, `CategoryName` ve `SupplierName` veri alanları görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-297">In these TemplateFields' `ItemTemplates`, the `CategoryName` and `SupplierName` data fields are displayed.</span></span>
- <span data-ttu-id="eaaf7-298">Dönüştürülen `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, ve `ReorderLevel` BoundFields TemplateFields ve eklenen CompareValidator kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-298">Converted the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields to TemplateFields and added CompareValidator controls.</span></span>

<span data-ttu-id="eaaf7-299">Biz zaten önceki eğitimlerine bu görevleri gerçekleştirmek üzere nasıl incelenmesi olduğundan, ı yalnızca burada son Tanımlayıcı Sözdizimi listelemek ve uygulama olarak uygulama bırakın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-299">Since we've already examined how to accomplish these tasks in previous tutorials, I'll just list the final declarative syntax here and leave the implementation as practice.</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample9.aspx)]

<span data-ttu-id="eaaf7-300">Tam olarak çalışan bir örnek olması yakın çok çalışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-300">We're very close to having a fully-working example.</span></span> <span data-ttu-id="eaaf7-301">Ancak, yedekleme işi ve bize sorunlara neden birkaç subtleties vardır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-301">However, there are a few subtleties that will creep up and cause us problems.</span></span> <span data-ttu-id="eaaf7-302">Ayrıca, hala bir eşzamanlılık ihlali oluştu yükleyen kullanıcının uyarıları bazı arabirimi ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-302">Additionally, we still need some interface that alerts the user when a concurrency violation has occurred.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf7-303">Doğru özgün değerler (hangi BLL sonra geçirilen) ObjectDataSource geçirilecek sırayla verileri Web denetimi için çok önemli, GridView's `EnableViewState` özelliği ayarlanmış `true` (varsayılan).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-303">In order for a data Web control to correctly pass the original values to the ObjectDataSource (which are then passed to the BLL), it's vital that the GridView's `EnableViewState` property is set to `true` (the default).</span></span> <span data-ttu-id="eaaf7-304">Görünüm durumu devre dışı bırakırsanız, özgün değerler geri göndermede kaybolur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-304">If you disable view state, the original values are lost on postback.</span></span>


## <a name="passing-the-correct-original-values-to-the-objectdatasource"></a><span data-ttu-id="eaaf7-305">ObjectDataSource doğru orijinal değerleri geçirme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-305">Passing the Correct Original Values to the ObjectDataSource</span></span>

<span data-ttu-id="eaaf7-306">Birkaç GridView yapılandırılmış şekilde sorunları vardır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-306">There are a couple of problems with the way the GridView has been configured.</span></span> <span data-ttu-id="eaaf7-307">Varsa ObjectDataSource's `ConflictDetection` özelliği ayarlanmış `CompareAllValues` (olduğu gibi bizim), ne zaman ObjectDataSource's `Update()` veya `Delete()` yöntemleri GridView (veya DetailsView veya FormView) çağrılır, ObjectDataSource kopyalamayı dener GridView'ın özgün değerlere kendi uygun `Parameter` örnekleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-307">If the ObjectDataSource's `ConflictDetection` property is set to `CompareAllValues` (as is ours), when the ObjectDataSource's `Update()` or `Delete()` methods are invoked by the GridView (or DetailsView or FormView), the ObjectDataSource attempts to copy the GridView's original values into its appropriate `Parameter` instances.</span></span> <span data-ttu-id="eaaf7-308">Geri bu işlem için bir grafik gösterimi Şekil 2'ye bakın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-308">Refer back to Figure 2 for a graphical representation of this process.</span></span>

<span data-ttu-id="eaaf7-309">Özellikle, GridView'ın özgün değerler her zaman veri GridView bağlı iki yönlü veri bağlaması deyimlerinde değerler atanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-309">Specifically, the GridView's original values are assigned the values in the two-way databinding statements each time the data is bound to the GridView.</span></span> <span data-ttu-id="eaaf7-310">Bu nedenle, gerekli tüm gerekli özgün değerler ile iki yönlü veri bağlaması yakalanır ve dönüştürülebilir biçiminde sağlanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-310">Therefore, it's essential that the required original values all are captured via two-way databinding and that they are provided in a convertible format.</span></span>

<span data-ttu-id="eaaf7-311">Neden bu önemli olduğunu görmek için tarayıcıda sayfamızı ziyaret etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-311">To see why this is important, take a moment to visit our page in a browser.</span></span> <span data-ttu-id="eaaf7-312">GridView, beklendiği gibi bir düzenleme ve silme düğmesi en soldaki sütunda her ürünle listeler.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-312">As expected, the GridView lists each product with an Edit and Delete button in the leftmost column.</span></span>


<span data-ttu-id="eaaf7-313">[![Ürünler GridView içinde listelenir](implementing-optimistic-concurrency-vb/_static/image39.png)](implementing-optimistic-concurrency-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-313">[![The Products are Listed in a GridView](implementing-optimistic-concurrency-vb/_static/image39.png)](implementing-optimistic-concurrency-vb/_static/image38.png)</span></span>

<span data-ttu-id="eaaf7-314">**Şekil 14**: ürünleri GridView içinde listelenen ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-314">**Figure 14**: The Products are Listed in a GridView ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image40.png))</span></span>


<span data-ttu-id="eaaf7-315">Herhangi bir ürünü için de Sil düğmesini tıklatın, bir `FormatException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-315">If you click the Delete button for any product, a `FormatException` is thrown.</span></span>


<span data-ttu-id="eaaf7-316">[![Herhangi bir FormatException ürün sonuçlarında silinmeye çalışılıyor](implementing-optimistic-concurrency-vb/_static/image42.png)](implementing-optimistic-concurrency-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-316">[![Attempting to Delete Any Product Results in a FormatException](implementing-optimistic-concurrency-vb/_static/image42.png)](implementing-optimistic-concurrency-vb/_static/image41.png)</span></span>

<span data-ttu-id="eaaf7-317">**Şekil 15**: Sil herhangi ürün sonuçlarında çalışılırken bir `FormatException` ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-317">**Figure 15**: Attempting to Delete Any Product Results in a `FormatException` ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image43.png))</span></span>


<span data-ttu-id="eaaf7-318">`FormatException` ObjectDataSource özgün okuma girişiminde bulunduğunda tetiklenir `UnitPrice` değeri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-318">The `FormatException` is raised when the ObjectDataSource attempts to read in the original `UnitPrice` value.</span></span> <span data-ttu-id="eaaf7-319">Bu yana `ItemTemplate` sahip `UnitPrice` para birimi olarak biçimlendirilmiş (`<%# Bind("UnitPrice", "{0:C}") %>`), $19.95 gibi bir para birimi simgesini içerir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-319">Since the `ItemTemplate` has the `UnitPrice` formatted as a currency (`<%# Bind("UnitPrice", "{0:C}") %>`), it includes a currency symbol, like $19.95.</span></span> <span data-ttu-id="eaaf7-320">`FormatException` Bu dizeye dönüştürmek ObjectDataSource denediğinde oluşur bir `decimal`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-320">The `FormatException` occurs as the ObjectDataSource attempts to convert this string into a `decimal`.</span></span> <span data-ttu-id="eaaf7-321">Bu sorunu gidermek için biz dizi seçeneğiniz vardır:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-321">To circumvent this problem, we have a number of options:</span></span>

- <span data-ttu-id="eaaf7-322">Biçimlendirmeyi para birimi kaldırmak `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-322">Remove the currency formatting from the `ItemTemplate`.</span></span> <span data-ttu-id="eaaf7-323">Diğer bir deyişle, yerine `<%# Bind("UnitPrice", "{0:C}") %>`, yalnızca kullanmak `<%# Bind("UnitPrice") %>`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-323">That is, instead of using `<%# Bind("UnitPrice", "{0:C}") %>`, simply use `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="eaaf7-324">Bu dezavantajı, fiyat artık biçimlendirildiğinden emin olur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-324">The downside of this is that the price is no longer formatted.</span></span>
- <span data-ttu-id="eaaf7-325">Görüntü `UnitPrice` bir para birimi olarak biçimlendirilmiş `ItemTemplate`, ancak `Eval` bunu gerçekleştirmek için anahtar sözcüğü.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-325">Display the `UnitPrice` formatted as a currency in the `ItemTemplate`, but use the `Eval` keyword to accomplish this.</span></span> <span data-ttu-id="eaaf7-326">Sözcüğünün `Eval` tek yönlü databinding gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-326">Recall that `Eval` performs one-way databinding.</span></span> <span data-ttu-id="eaaf7-327">Hala sağlamak ihtiyacımız `UnitPrice` nedenle yapmamız hala bir iki yönlü veri bağlaması deyiminde gereken özgün değerler için değer `ItemTemplate`, ancak bu bir etiket Web denetimi özelliği yerleştirilebilir `Visible` özelliği ayarlanmış `false`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-327">We still need to provide the `UnitPrice` value for the original values, so we'll still need a two-way databinding statement in the `ItemTemplate`, but this can be placed in a Label Web control whose `Visible` property is set to `false`.</span></span> <span data-ttu-id="eaaf7-328">Aşağıdaki biçimlendirmede ItemTemplate kullanıyoruz:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-328">We could use the following markup in the ItemTemplate:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample10.aspx)]

- <span data-ttu-id="eaaf7-329">Biçimlendirmeyi para birimi kaldırmak `ItemTemplate`kullanarak `<%# Bind("UnitPrice") %>`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-329">Remove the currency formatting from the `ItemTemplate`, using `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="eaaf7-330">GridView's içinde `RowDataBound` olay işleyicisi, program aracılığıyla erişim etiket Web denetim içinde `UnitPrice` değeri görüntülenir ve ayarlama kendi `Text` biçimlendirilmiş sürüme özelliği.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-330">In the GridView's `RowDataBound` event handler, programmatically access the Label Web control within which the `UnitPrice` value is displayed and set its `Text` property to the formatted version.</span></span>
- <span data-ttu-id="eaaf7-331">Bırakın `UnitPrice` para birimi olarak biçimlendirilmiş.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-331">Leave the `UnitPrice` formatted as a currency.</span></span> <span data-ttu-id="eaaf7-332">GridView's içinde `RowDeleting` olay işleyicisi varolan özgün Değiştir `UnitPrice` değeri ($19.95) kullanarak bir gerçek ondalık değer ile `Decimal.Parse`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-332">In the GridView's `RowDeleting` event handler, replace the existing original `UnitPrice` value ($19.95) with an actual decimal value using `Decimal.Parse`.</span></span> <span data-ttu-id="eaaf7-333">Benzer bir şey nasıl gördüğümüz `RowUpdating` olay işleyicisini [ *işleme BLL - ve ASP.NET sayfası DAL düzeyi durumlar* ](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-333">We saw how to accomplish something similar in the `RowUpdating` event handler in the [*Handling BLL- and DAL-Level Exceptions in an ASP.NET Page*](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial.</span></span>

<span data-ttu-id="eaaf7-334">İkinci yaklaşımda, Git seçtiğim my örneğin gizli etiket Web ekleme, denetim özelliği `Text` iki yönlü veri biçimlendirilmemiş için bağlı bir özelliktir `UnitPrice` değeri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-334">For my example I chose to go with the second approach, adding a hidden Label Web control whose `Text` property is two-way data bound to the unformatted `UnitPrice` value.</span></span>

<span data-ttu-id="eaaf7-335">Bu sorunun çözümüne sonra herhangi bir ürün için de Sil düğmesini yeniden tıklatarak deneyin.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-335">After solving this problem, try clicking the Delete button for any product again.</span></span> <span data-ttu-id="eaaf7-336">Bu süre, alacaksınız bir `InvalidOperationException` ObjectDataSource çalıştığında BLL's çağrılacak `UpdateProduct` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-336">This time you'll get an `InvalidOperationException` when the ObjectDataSource attempts to invoke the BLL's `UpdateProduct` method.</span></span>


<span data-ttu-id="eaaf7-337">[![ObjectDataSource Gönder istediği giriş parametreleri olan bir yöntem bulunamadı.](implementing-optimistic-concurrency-vb/_static/image45.png)](implementing-optimistic-concurrency-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-337">[![The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send](implementing-optimistic-concurrency-vb/_static/image45.png)](implementing-optimistic-concurrency-vb/_static/image44.png)</span></span>

<span data-ttu-id="eaaf7-338">**Şekil 16**: ObjectDataSource Gönder istediği giriş parametreleri olan bir yöntem bulunamıyor ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-338">**Figure 16**: The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image46.png))</span></span>


<span data-ttu-id="eaaf7-339">Özel durumun ileti baktığınızda, onu ObjectDataSource bir BLL çağrılacak istediği işaretlenmemiştir `DeleteProduct` içeren yöntem `original_CategoryName` ve `original_SupplierName` giriş parametreleri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-339">Looking at the exception's message, it's clear that the ObjectDataSource wants to invoke a BLL `DeleteProduct` method that includes `original_CategoryName` and `original_SupplierName` input parameters.</span></span> <span data-ttu-id="eaaf7-340">Bunun nedeni, `ItemTemplate` s için `CategoryID` ve `SupplierID` TemplateFields şu anda iki yönlü bağlama deyimleri içeren `CategoryName` ve `SupplierName` veri alanları.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-340">This is because the `ItemTemplate` s for the `CategoryID` and `SupplierID` TemplateFields currently contain two-way Bind statements with the `CategoryName` and `SupplierName` data fields.</span></span> <span data-ttu-id="eaaf7-341">Bunun yerine, dahil etmek ihtiyacımız `Bind` deyimleri `CategoryID` ve `SupplierID` veri alanları.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-341">Instead, we need to include `Bind` statements with the `CategoryID` and `SupplierID` data fields.</span></span> <span data-ttu-id="eaaf7-342">Bunu başarmak için var olan bağlama deyimleri ile değiştirin `Eval` deyimleri ve gizli etiket denetimleri ekleme `Text` özellikleri bağlı `CategoryID` ve `SupplierID` veri alanları gösterildiği gibi iki yönlü veri bağlamasını kullanma Aşağıda:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-342">To accomplish this, replace the existing Bind statements with `Eval` statements, and then add hidden Label controls whose `Text` properties are bound to the `CategoryID` and `SupplierID` data fields using two-way databinding, as shown below:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample11.aspx)]

<span data-ttu-id="eaaf7-343">Bu değişikliklerle biz şimdi başarıyla silin ve ürün bilgileri düzenleyebilir!</span><span class="sxs-lookup"><span data-stu-id="eaaf7-343">With these changes, we are now able to successfully delete and edit product information!</span></span> <span data-ttu-id="eaaf7-344">Adım 5'te biz eşzamanlılık ihlalleri algılandığını doğrulamak ne göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-344">In Step 5 we'll look at how to verify that concurrency violations are being detected.</span></span> <span data-ttu-id="eaaf7-345">Ancak şu an için güncelleştirmeyi deneyin için birkaç dakika sürebilir ve bu güncelleştirme ve silme için tek bir kullanıcı emin olmak için birkaç kayıtları silme beklendiği gibi çalışır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-345">But for now, take a few minutes to try updating and deleting a few records to ensure that updating and deleting for a single user works as expected.</span></span>

## <a name="step-5-testing-the-optimistic-concurrency-support"></a><span data-ttu-id="eaaf7-346">5. adım: iyimser eşzamanlılık destek test etme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-346">Step 5: Testing the Optimistic Concurrency Support</span></span>

<span data-ttu-id="eaaf7-347">Eşzamanlılık ihlalleri algılanan (yerine doğrudan üzerine yazmaya verilerdeki elde edilen) doğrulamak için Biz bu sayfaya iki tarayıcı pencerelerini açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-347">In order to verify that concurrency violations are being detected (rather than resulting in data being blindly overwritten), we need to open two browser windows to this page.</span></span> <span data-ttu-id="eaaf7-348">Her iki tarayıcı durumlarda ayrıntılarını Düzenle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-348">In both browser instances, click on the Edit button for Chai.</span></span> <span data-ttu-id="eaaf7-349">Ardından, yalnızca bir tarayıcılar, "Chai Çay" adı değiştirin ve Güncelleştir'i tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-349">Then, in just one of the browsers, change the name to "Chai Tea" and click Update.</span></span> <span data-ttu-id="eaaf7-350">Güncelleştirme başarılı ve GridView yeni ürün adı olarak "Chai Çay" ile önceden düzenleme durumuna geri dönün.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-350">The update should succeed and return the GridView to its pre-editing state, with "Chai Tea" as the new product name.</span></span>

<span data-ttu-id="eaaf7-351">Diğer tarayıcı penceresini örneğinde, ancak, ürün adı metin kutusuna "Chai" görüntülenmeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-351">In the other browser window instance, however, the product name TextBox still shows "Chai".</span></span> <span data-ttu-id="eaaf7-352">İkinci bir tarayıcı penceresi içinde güncelleştirme `UnitPrice` için `25.00`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-352">In this second browser window, update the `UnitPrice` to `25.00`.</span></span> <span data-ttu-id="eaaf7-353">İyimser eşzamanlılık desteği olmadan ikinci tarayıcı örneğinde Güncelleştir'i tıklatarak ürün adı "böylece ilk tarayıcı örneği tarafından yapılan değişikliklerin üzerine yazarak geri Chai", için değiştirirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-353">Without optimistic concurrency support, clicking update in the second browser instance would change the product name back to "Chai", thereby overwriting the changes made by the first browser instance.</span></span> <span data-ttu-id="eaaf7-354">İşe iyimser eşzamanlılık ile ancak ikinci tarayıcı örneği Güncelleştir düğmesini tıklatarak sonuçlanan bir [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-354">With optimistic concurrency employed, however, clicking the Update button in the second browser instance results in a [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx).</span></span>


<span data-ttu-id="eaaf7-355">[![Bir eşzamanlılık ihlali algılandığında bir DBConcurrencyException oluşturulur](implementing-optimistic-concurrency-vb/_static/image48.png)](implementing-optimistic-concurrency-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-355">[![When a Concurrency Violation is Detected, a DBConcurrencyException is Thrown](implementing-optimistic-concurrency-vb/_static/image48.png)](implementing-optimistic-concurrency-vb/_static/image47.png)</span></span>

<span data-ttu-id="eaaf7-356">**Şekil 17**: bir eşzamanlılık ihlali algılanırsa, bir `DBConcurrencyException` atılır ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-356">**Figure 17**: When a Concurrency Violation is Detected, a `DBConcurrencyException` is Thrown ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image49.png))</span></span>


<span data-ttu-id="eaaf7-357">`DBConcurrencyException` DAL'ın toplu güncelleştirme düzeni kullanılırken yalnızca atılır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-357">The `DBConcurrencyException` is only thrown when the DAL's batch update pattern is utilized.</span></span> <span data-ttu-id="eaaf7-358">DB doğrudan düzeni bir özel durum oluşturmaz, yalnızca hiçbir satır etkilendi gösterir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-358">The DB direct pattern does not raise an exception, it merely indicates that no rows were affected.</span></span> <span data-ttu-id="eaaf7-359">Bunu göstermek için her iki tarayıcı örnekleri GridView önceden düzenleme durumlarına geri dönün.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-359">To illustrate this, return both browser instances' GridView to their pre-editing state.</span></span> <span data-ttu-id="eaaf7-360">Ardından, ilk tarayıcı örneğinde Düzenle düğmesini tıklatın ve "Chai" dön "Chai Çay" ürün adını değiştirmek ve Güncelleştir'i tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-360">Next, in the first browser instance, click the Edit button and change the product name from "Chai Tea" back to "Chai" and click Update.</span></span> <span data-ttu-id="eaaf7-361">İkinci tarayıcı penceresinde ayrıntılarını Sil düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-361">In the second browser window, click the Delete button for Chai.</span></span>

<span data-ttu-id="eaaf7-362">Delete tuşuna basarak, bağlı sayfaya geri gönderir, GridView ObjectDataSource's çağırır `Delete()` yöntemi ve ObjectDataSource çağırır içine `ProductsOptimisticConcurrencyBLL` sınıfının `DeleteProduct` boyunca özgün değerleri geçirme yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-362">Upon clicking Delete, the page posts back, the GridView invokes the ObjectDataSource's `Delete()` method, and the ObjectDataSource calls down into the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method, passing along the original values.</span></span> <span data-ttu-id="eaaf7-363">Özgün `ProductName` ikinci tarayıcı örneği "Chai hangi geçerli eşleşmiyor Çay", değeri `ProductName` değeri veritabanındaki değer.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-363">The original `ProductName` value for the second browser instance is "Chai Tea", which doesn't match up with the current `ProductName` value in the database.</span></span> <span data-ttu-id="eaaf7-364">Bu nedenle `DELETE` veritabanına verilen deyimi etkiler sıfır satır veritabanında hiçbir kayıt olduğundan, `WHERE` yan tümcesi karşılar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-364">Therefore the `DELETE` statement issued to the database affects zero rows since there's no record in the database that the `WHERE` clause satisfies.</span></span> <span data-ttu-id="eaaf7-365">`DeleteProduct` Yöntemi döndürür `false` ve ObjectDataSource'nın veri GridView DataSet'e bağlanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-365">The `DeleteProduct` method returns `false` and the ObjectDataSource's data is rebound to the GridView.</span></span>

<span data-ttu-id="eaaf7-366">Son kullanıcının açısından, flash ekranın neden ikinci bir tarayıcı penceresinde Chai Çay için Sil düğmesini tıklatarak ve, şimdi "Chai" (ilk tarayıcı tarafından yapılan ürün adı değişikliği olarak listeleniyor ancak geri gelmelerini bağlı ürün hala, yok Örnek).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-366">From the end user's perspective, clicking on the Delete button for Chai Tea in the second browser window caused the screen to flash and, upon coming back, the product is still there, although now it's listed as "Chai" (the product name change made by the first browser instance).</span></span> <span data-ttu-id="eaaf7-367">Kullanıcı yeniden Sil düğmesine tıklarsa, GridView özgün olarak silme başarılı `ProductName` değeri ("Chai") artık eşleştiğini değeri veritabanındaki değer ile.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-367">If the user clicks the Delete button again, the Delete will succeed, as the GridView's original `ProductName` value ("Chai") now matches up with the value in the database.</span></span>

<span data-ttu-id="eaaf7-368">Her iki durumda, kullanıcı deneyimini gölgeden uzak idealdir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-368">In both of these cases, the user experience is far from ideal.</span></span> <span data-ttu-id="eaaf7-369">Biz açıkça kullanıcı nitty-gritty ayrıntılarını göster istemediğiniz `DBConcurrencyException` toplu güncelleştirme düzeni kullanırken, özel durum.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-369">We clearly don't want to show the user the nitty-gritty details of the `DBConcurrencyException` exception when using the batch update pattern.</span></span> <span data-ttu-id="eaaf7-370">Ve DB doğrudan düzeni kullanırken davranış kullanıcılar komutu başarısız oldu, ancak kesin bir gösterge neden olmadan vardı biraz karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-370">And the behavior when using the DB direct pattern is somewhat confusing as the users command failed, but there was no precise indication of why.</span></span>

<span data-ttu-id="eaaf7-371">Bu iki sorunları çözmek için bir güncelleştirme veya silme işlemi başarısız oldu neden için bir açıklama sağlaması sayfasında etiket Web denetimleri oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-371">To remedy these two issues, we can create Label Web controls on the page that provide an explanation to why an update or delete failed.</span></span> <span data-ttu-id="eaaf7-372">Toplu güncelleştirme düzeni için belirleriz olsun veya olmasın bir `DBConcurrencyException` GridView'ın sonrası düzeyi olay işleyicisinde özel durum oluştu uyarı etiketi gerektiği gibi görüntüleme.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-372">For the batch update pattern, we can determine whether or not a `DBConcurrencyException` exception occurred in the GridView's post-level event handler, displaying the warning label as needed.</span></span> <span data-ttu-id="eaaf7-373">DB doğrudan yöntemi için biz BLL yönteminin dönüş değeri inceleyebilirsiniz (olduğu `true` bir satır etkilenen, `false` aksi) ve gerektiği şekilde bir bilgilendirme iletisi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-373">For the DB direct method, we can examine the return value of the BLL method (which is `true` if one row was affected, `false` otherwise) and display an informational message as needed.</span></span>

## <a name="step-6-adding-informational-messages-and-displaying-them-in-the-face-of-a-concurrency-violation"></a><span data-ttu-id="eaaf7-374">6. adım: Bilgilendirici iletileri ekleme ve eşzamanlılık ihlali karşısında görüntüleme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-374">Step 6: Adding Informational Messages and Displaying Them in the Face of a Concurrency Violation</span></span>

<span data-ttu-id="eaaf7-375">Bir eşzamanlılık ihlali oluştuğunda sergilenen davranışı olup DAL'ın toplu güncelleştirme veya DB doğrudan desen kullanılan üzerinde bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-375">When a concurrency violation occurs, the behavior exhibited depends on whether the DAL's batch update or DB direct pattern was used.</span></span> <span data-ttu-id="eaaf7-376">Öğreticimizi güncelleştirme ve silme için kullanılan DB doğrudan düzeni için kullanılan toplu güncelleştirme düzendeki iki desen kullanır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-376">Our tutorial uses both patterns, with the batch update pattern being used for updating and the DB direct pattern used for deleting.</span></span> <span data-ttu-id="eaaf7-377">Başlamak için iki etiket Web denetimleri bir eşzamanlılık ihlali veri güncelleştirmek ya da silme girişimi sırasında oluştu açıklayan sayfamızı ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-377">To get started, let's add two Label Web controls to our page that explain that a concurrency violation occurred when attempting to delete or update data.</span></span> <span data-ttu-id="eaaf7-378">Etiket denetimin ayarlamak `Visible` ve `EnableViewState` özelliklerine `false`; bu bunları nereye olanlar için belirli sayfasını ziyaret dışında her sayfasını ziyaret edin gizli olarak neden olacak kendi `Visible` özelliği ayarlanmış program aracılığıyla `true`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-378">Set the Label control's `Visible` and `EnableViewState` properties to `false`; this will cause them to be hidden on each page visit except for those particular page visits where their `Visible` property is programmatically set to `true`.</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample12.aspx)]

<span data-ttu-id="eaaf7-379">Ayar yanı sıra bunların `Visible`, `EnabledViewState`, ve `Text` özelliklerini ayrıca ayarlarım `CssClass` özelliğine `Warning`, büyük, kırmızı, italik, kalın yazı tipiyle görüntülenecek etiket neden olan kullanıcının.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-379">In addition to setting their `Visible`, `EnabledViewState`, and `Text` properties, I've also set the `CssClass` property to `Warning`, which causes the Label's to be displayed in a large, red, italic, bold font.</span></span> <span data-ttu-id="eaaf7-380">Bu CSS `Warning` sınıfı tanımlanan ve Styles.css için eklenen geri *ekleme, güncelleştirme ve silme ile ilişkili olay incelenerek* Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-380">This CSS `Warning` class was defined and added to Styles.css back in the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial.</span></span>

<span data-ttu-id="eaaf7-381">Bu etiketler eklendikten sonra Visual Studio tasarımcıda Şekil 18'e benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-381">After adding these Labels, the Designer in Visual Studio should look similar to Figure 18.</span></span>


<span data-ttu-id="eaaf7-382">[![İki etiket denetimleri sayfasına eklenmiştir](implementing-optimistic-concurrency-vb/_static/image51.png)](implementing-optimistic-concurrency-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-382">[![Two Label Controls Have Been Added to the Page](implementing-optimistic-concurrency-vb/_static/image51.png)](implementing-optimistic-concurrency-vb/_static/image50.png)</span></span>

<span data-ttu-id="eaaf7-383">**Şekil 18**: iki etiket denetimleri eklenmiştir sayfa ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-383">**Figure 18**: Two Label Controls Have Been Added to the Page ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image52.png))</span></span>


<span data-ttu-id="eaaf7-384">Bu etiket Web kontroller varken, biz ne zaman bir eşzamanlılık ihlali, en uygun etiketin işaret oluştu belirleme incelemek hazır `Visible` özelliği ayarlanabilir `true`, bilgi iletisini görüntüleme.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-384">With these Label Web controls in place, we're ready to examine how to determine when a concurrency violation has occurred, at which point the appropriate Label's `Visible` property can be set to `true`, displaying the informational message.</span></span>

## <a name="handling-concurrency-violations-when-updating"></a><span data-ttu-id="eaaf7-385">Eşzamanlılık ihlalleri güncelleştirirken işleme</span><span class="sxs-lookup"><span data-stu-id="eaaf7-385">Handling Concurrency Violations When Updating</span></span>

<span data-ttu-id="eaaf7-386">İlk önce toplu güncelleştirme düzeni kullanırken eşzamanlılık ihlalleri nasıl ele alınacağını konumundaki bakalım.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-386">Let's first look at how to handle concurrency violations when using the batch update pattern.</span></span> <span data-ttu-id="eaaf7-387">Böyle ihlalleri yığın düzeni neden güncelleştirme bu yana bir `DBConcurrencyException` durum için özel durum kodu belirlemek için ASP.NET sayfamızı eklemek ihtiyacımız olup bir `DBConcurrencyException` güncelleştirme işlemi sırasında özel durum oluştu.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-387">Since such violations with the batch update pattern cause a `DBConcurrencyException` exception to be thrown, we need to add code to our ASP.NET page to determine whether a `DBConcurrencyException` exception occurred during the update process.</span></span> <span data-ttu-id="eaaf7-388">Bu nedenle, biz kaydını düzenleme başlatıldığında başka bir kullanıcı arasında aynı veri değiştirdiğinden, yaptıkları değişiklikleri kaydedilmedi kullanıcı açıklayan bir ileti görüntülenmelidir ve güncelleştirme düğme tıklatıldığında.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-388">If so, we should display a message to the user explaining that their changes were not saved because another user had modified the same data between when they started editing the record and when they clicked the Update button.</span></span>

<span data-ttu-id="eaaf7-389">İçinde gördüğümüz gibi *işleme BLL - ve ASP.NET sayfası DAL düzeyi durumlar* benzer özel durumların algılanabilir ve veri Web denetimin sonrası düzeyi olay işleyicileri gizlenen Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-389">As we saw in the *Handling BLL- and DAL-Level Exceptions in an ASP.NET Page* tutorial, such exceptions can be detected and suppressed in the data Web control's post-level event handlers.</span></span> <span data-ttu-id="eaaf7-390">Bu nedenle, olay işleyici GridView için 's oluşturmak ihtiyacımız `RowUpdated` denetler olay bir `DBConcurrencyException` özel durum.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-390">Therefore, we need to create an event handler for the GridView's `RowUpdated` event that checks if a `DBConcurrencyException` exception has been thrown.</span></span> <span data-ttu-id="eaaf7-391">Bu olay işleyicisi güncelleştirme işlemi sırasında başlatılan özel durumları başvuru olay işleyici kod aşağıda gösterildiği gibi geçirilir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-391">This event handler is passed a reference to any exception that was raised during the updating process, as shown in the event handler code below:</span></span>


[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample13.vb)]

<span data-ttu-id="eaaf7-392">Face, bir `DBConcurrencyException` özel durum, bu olay işleyicisi görüntüler `UpdateConflictMessage` etiket denetimini ve özel durumun işlenip olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-392">In the face of a `DBConcurrencyException` exception, this event handler displays the `UpdateConflictMessage` Label control and indicates that the exception has been handled.</span></span> <span data-ttu-id="eaaf7-393">Bir eşzamanlılık ihlali bir kaydı güncelleştirirken oluştuğunda başka bir kullanıcının değişiklikleri aynı anda üzerlerine beri yerinde bu kodu ile kullanıcının değişiklikler, kaybolur.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-393">With this code in place, when a concurrency violation occurs when updating a record, the user's changes are lost, since they would have overwritten another user's modifications at the same time.</span></span> <span data-ttu-id="eaaf7-394">Özellikle, GridView önceden düzenleme durumuna geri döndürülen ve geçerli veritabanı veriye bağlı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-394">In particular, the GridView is returned to its pre-editing state and bound to the current database data.</span></span> <span data-ttu-id="eaaf7-395">Bu, daha önce görünür diğer kullanıcının değişiklikleriyle GridView satır güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-395">This will update the GridView row with the other user's changes, which were previously not visible.</span></span> <span data-ttu-id="eaaf7-396">Ayrıca, `UpdateConflictMessage` etiket denetimi açıklamak için kullanıcı yalnızca ne.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-396">Additionally, the `UpdateConflictMessage` Label control will explain to the user what just happened.</span></span> <span data-ttu-id="eaaf7-397">Bu olaylar dizisi şekil 19'ayrıntılı olarak gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-397">This sequence of events is detailed in Figure 19.</span></span>


<span data-ttu-id="eaaf7-398">[![Bir kullanıcı s güncelleştirmeleri bir eşzamanlılık ihlali karşılaştıkları kayboluyor](implementing-optimistic-concurrency-vb/_static/image54.png)](implementing-optimistic-concurrency-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-398">[![A User s Updates are Lost in the Face of a Concurrency Violation](implementing-optimistic-concurrency-vb/_static/image54.png)](implementing-optimistic-concurrency-vb/_static/image53.png)</span></span>

<span data-ttu-id="eaaf7-399">**Şekil 19**: bir kullanıcı s güncelleştirmeleri bir eşzamanlılık ihlali karşılaştıkları kayboluyor ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-399">**Figure 19**: A User s Updates are Lost in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image55.png))</span></span>


> [!NOTE]
> <span data-ttu-id="eaaf7-400">Alternatif olarak, GridView önceden düzenleme durumuna döndürme yerine, biz GridView düzenleme durumundayken ayarlayarak bırakabilir `KeepInEditMode` geçilen özelliğinin `GridViewUpdatedEventArgs` nesne true.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-400">Alternatively, rather than returning the GridView to the pre-editing state, we could leave the GridView in its editing state by setting the `KeepInEditMode` property of the passed-in `GridViewUpdatedEventArgs` object to true.</span></span> <span data-ttu-id="eaaf7-401">Bu yaklaşımı benimsemeniz durumunda, ancak GridView verileri rebind emin olun (çağırma tarafından kendi `DataBind()` yöntemi) böylece diğer kullanıcının değerleri düzenleme arabirimin içine yüklenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-401">If you take this approach, however, be certain to rebind the data to the GridView (by invoking its `DataBind()` method) so that the other user's values are loaded into the editing interface.</span></span> <span data-ttu-id="eaaf7-402">Bu iki satır kod Bu öğretici ile İndirilebilecek koduna sahip `RowUpdated` olay işleyicisi geçersiz kılınan çıkışı; yalnızca bu GridView sağlamak için kod satırları düzenleme modunda bir eşzamanlılık ihlali sonra kalır açıklamadan çıkarın.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-402">The code available for download with this tutorial has these two lines of code in the `RowUpdated` event handler commented out; simply uncomment these lines of code to have the GridView remain in edit mode after a concurrency violation.</span></span>


## <a name="responding-to-concurrency-violations-when-deleting"></a><span data-ttu-id="eaaf7-403">Eşzamanlılık ihlallerini silerken yanıt</span><span class="sxs-lookup"><span data-stu-id="eaaf7-403">Responding to Concurrency Violations When Deleting</span></span>

<span data-ttu-id="eaaf7-404">DB doğrudan deseni, bir eşzamanlılık ihlali karşısında gerçekleştirilen herhangi bir özel durumu yok.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-404">With the DB direct pattern, there is no exception raised in the face of a concurrency violation.</span></span> <span data-ttu-id="eaaf7-405">Bunun yerine database deyimi yalnızca WHERE yan tümcesi ile herhangi bir kaydının eşleşmiyor olarak bağlı olarak, hiçbir kayıt etkiler.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-405">Instead, the database statement simply affects no records, as the WHERE clause does not match with any record.</span></span> <span data-ttu-id="eaaf7-406">Bunlar tam olarak bir kayıt etkilenen olup olmadığını gösteren bir Boole değeri döndürür, tüm BLL oluşturulan veri değişikliği yöntemleri tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-406">All of the data modification methods created in the BLL have been designed such that they return a Boolean value indicating whether or not they affected precisely one record.</span></span> <span data-ttu-id="eaaf7-407">Bu nedenle, bir eşzamanlılık ihlali bir kaydı silinirken oluştu belirlemek için biz BLL'ın dönüş değeri inceleyebilirsiniz `DeleteProduct` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-407">Therefore, to determine if a concurrency violation occurred when deleting a record, we can examine the return value of the BLL's `DeleteProduct` method.</span></span>

<span data-ttu-id="eaaf7-408">ObjectDataSource'nın sonrası düzeyi olay işleyicileri BLL yönteminin dönüş değeri incelenebilir `ReturnValue` özelliği `ObjectDataSourceStatusEventArgs` nesne olay işleyicisi geçirildi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-408">The return value for a BLL method can be examined in the ObjectDataSource's post-level event handlers through the `ReturnValue` property of the `ObjectDataSourceStatusEventArgs` object passed into the event handler.</span></span> <span data-ttu-id="eaaf7-409">Biz yönteminden döndürülen değer belirlerken ilgilendiğiniz beri `DeleteProduct` yöntemi, ihtiyacımız ObjectDataSource için 's olay işleyici oluşturmak `Deleted` olay.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-409">Since we are interested in determining the return value from the `DeleteProduct` method, we need to create an event handler for the ObjectDataSource's `Deleted` event.</span></span> <span data-ttu-id="eaaf7-410">`ReturnValue` Özelliği türüdür `object` ve `null` bir özel durumu oluştu ve yöntemi bir değer döndürebilirsiniz önce kesildi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-410">The `ReturnValue` property is of type `object` and can be `null` if an exception was raised and the method was interrupted before it could return a value.</span></span> <span data-ttu-id="eaaf7-411">Bu nedenle, biz öncelikle emin `ReturnValue` özelliği `null` ve bir Boole değeri.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-411">Therefore, we should first ensure that the `ReturnValue` property is not `null` and is a Boolean value.</span></span> <span data-ttu-id="eaaf7-412">Bu onay geçirir, gösteriyoruz varsayılarak `DeleteConflictMessage` Denetim etiketi `ReturnValue` olan `false`.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-412">Assuming this check passes, we show the `DeleteConflictMessage` Label control if the `ReturnValue` is `false`.</span></span> <span data-ttu-id="eaaf7-413">Bu, aşağıdaki kodu kullanarak gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="eaaf7-413">This can be accomplished by using the following code:</span></span>


[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample14.vb)]

<span data-ttu-id="eaaf7-414">Bir eşzamanlılık ihlali karşısında kullanıcının silme isteği iptal edildi.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-414">In the face of a concurrency violation, the user's delete request is canceled.</span></span> <span data-ttu-id="eaaf7-415">GridView, sayfa ve Sil düğmesine tıklandığında kendisinin arasındaki süre, kayıt için kullanıcı ortaya çıkan değişiklikleri yüklenen gösteren bir yenilenir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-415">The GridView is refreshed, showing the changes that occurred for that record between the time the user loaded the page and when he clicked the Delete button.</span></span> <span data-ttu-id="eaaf7-416">Bu tür bir ihlali transpires, `DeleteConflictMessage` etiket gösterilir, (bkz. Şekil 20) ne yalnızca açıklayan.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-416">When such a violation transpires, the `DeleteConflictMessage` Label is shown, explaining what just happened (see Figure 20).</span></span>


<span data-ttu-id="eaaf7-417">[![Bir kullanıcı s Delete karşısında bir eşzamanlılık ihlali iptal edildi](implementing-optimistic-concurrency-vb/_static/image57.png)](implementing-optimistic-concurrency-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-417">[![A User s Delete is Canceled in the Face of a Concurrency Violation](implementing-optimistic-concurrency-vb/_static/image57.png)](implementing-optimistic-concurrency-vb/_static/image56.png)</span></span>

<span data-ttu-id="eaaf7-418">**Şekil 20**: Delete karşısında bir eşzamanlılık ihlali iptal bir kullanıcı s ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf7-418">**Figure 20**: A User s Delete is Canceled in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="eaaf7-419">Özet</span><span class="sxs-lookup"><span data-stu-id="eaaf7-419">Summary</span></span>

<span data-ttu-id="eaaf7-420">Eşzamanlılık ihlalleri olanaklarını mevcut birden çok, her uygulamada güncelleştirmek veya veri silmek için eşzamanlı kullanıcı.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-420">Opportunities for concurrency violations exist in every application that allows multiple, concurrent users to update or delete data.</span></span> <span data-ttu-id="eaaf7-421">Bu tür ihlalleri iki kullanıcı aynı anda aktaranın son yazma "WINS'de" alır aynı veri güncelleştirdiğinizde, diğer kullanıcının üzerine değişiklikleri değişiklikleri için hesaba değil</span><span class="sxs-lookup"><span data-stu-id="eaaf7-421">If such violations are not accounted for, when two users simultaneously update the same data whoever gets in the last write "wins," overwriting the other user's changes changes.</span></span> <span data-ttu-id="eaaf7-422">Alternatif olarak, geliştiricilerin ya da iyimser veya kötümser eşzamanlılık denetimi uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-422">Alternatively, developers can implement either optimistic or pessimistic concurrency control.</span></span> <span data-ttu-id="eaaf7-423">İyimser eşzamanlılık denetimini eşzamanlılık ihlalleri daha azdır ve yalnızca bir güncelleştirme izin vermez veya bir eşzamanlılık ihlali oluşturur komutu silme olduğunu varsayar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-423">Optimistic concurrency control assumes that concurrency violations are infrequent and simply disallows an update or delete command that would constitute a concurrency violation.</span></span> <span data-ttu-id="eaaf7-424">Eşzamanlılık denetimi ihlalleri sık ve yalnızca bir kullanıcının reddetme update veya delete komutu bu eşzamanlılık kabul edilebilir değil varsayar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-424">Pessimistic concurrency control assumes that concurrency violations are frequent and simply rejecting one user's update or delete command is not acceptable.</span></span> <span data-ttu-id="eaaf7-425">Eşzamanlılık denetimi ile böylece değiştirme veya kilitliyken kayıt silme herhangi diğer kullanıcıların önleme kilitleme bir kaydın güncelleştirilmesini gerektirir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-425">With pessimistic concurrency control, updating a record involves locking it, thereby preventing any other users from modifying or deleting the record while it is locked.</span></span>

<span data-ttu-id="eaaf7-426">.NET içinde yazılan veri kümesi iyimser eşzamanlılık denetimini desteklemek için işlevsellik sağlar.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-426">The Typed DataSet in .NET provides functionality for supporting optimistic concurrency control.</span></span> <span data-ttu-id="eaaf7-427">Özellikle, `UPDATE` ve `DELETE` deyimleri veritabanına verilen tüm tablonun sütunlarının içerir, böylece kaydın geçerli veriler özgün verilerle kullanıcı eşleşiyorsa, update veya delete yalnızca oluşacağını sağlar, sahip olduğunda kendi update veya delete gerçekleştiriliyor.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-427">In particular, the `UPDATE` and `DELETE` statements issued to the database include all of the table's columns, thereby ensuring that the update or delete will only occur if the record's current data matches with the original data the user had when performing their update or delete.</span></span> <span data-ttu-id="eaaf7-428">DAL iyimser eşzamanlılık desteklemek üzere yapılandırılmış sonra BLL yöntemleri güncelleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-428">Once the DAL has been configured to support optimistic concurrency, the BLL methods need to be updated.</span></span> <span data-ttu-id="eaaf7-429">Ayrıca, BLL çağıran ASP.NET sayfası ObjectDataSource kendi veri Web denetiminden özgün değerlerini alır ve BLL geçirir şekilde yapılandırılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-429">Additionally, the ASP.NET page that calls down into the BLL must be configured such that the ObjectDataSource retrieves the original values from its data Web control and passes them down into the BLL.</span></span>

<span data-ttu-id="eaaf7-430">Biz bu öğreticide gördüğünüz gibi bir ASP.NET web uygulamasında iyimser eşzamanlılık denetimini uygulama DAL ve BLL güncelleştirme ve ASP.NET sayfasında desteği ekleme içerir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-430">As we saw in this tutorial, implementing optimistic concurrency control in an ASP.NET web application involves updating the DAL and BLL and adding support in the ASP.NET page.</span></span> <span data-ttu-id="eaaf7-431">Olsun veya olmasın bu eklenen akıllıca yatırımı zaman ve çaba iştir, uygulamaya bağlı olarak değişir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-431">Whether or not this added work is a wise investment of your time and effort depends on your application.</span></span> <span data-ttu-id="eaaf7-432">Verileri güncelleştirme eşzamanlı kullanıcı seyrek sahip ya da güncelleştirmekte olduğunuz veri birbirinden farklı ise, ardından eşzamanlılık denetimi bir anahtar sorun değildir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-432">If you infrequently have concurrent users updating data, or the data they are updating is different from one another, then concurrency control is not a key issue.</span></span> <span data-ttu-id="eaaf7-433">Ancak, düzenli olarak birden çok kullanıcı aynı verilerle çalışma sitenizdeki varsa, eşzamanlılık denetimi başka birinin üzerine farkında olmadan bir kullanıcının güncelleştirme ve silme önlenmesine yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-433">If, however, you routinely have multiple users on your site working with the same data, concurrency control can help prevent one user's updates or deletes from unwittingly overwriting another's.</span></span>

<span data-ttu-id="eaaf7-434">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="eaaf7-434">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="eaaf7-435">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="eaaf7-435">About the Author</span></span>

<span data-ttu-id="eaaf7-436">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-436">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="eaaf7-437">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="eaaf7-437">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="eaaf7-438">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-438">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="eaaf7-439">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="eaaf7-439">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="eaaf7-440">[Önceki](customizing-the-data-modification-interface-vb.md)
> [sonraki](adding-client-side-confirmation-when-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="eaaf7-440">[Previous](customizing-the-data-modification-interface-vb.md)
[Next](adding-client-side-confirmation-when-deleting-vb.md)</span></span>
