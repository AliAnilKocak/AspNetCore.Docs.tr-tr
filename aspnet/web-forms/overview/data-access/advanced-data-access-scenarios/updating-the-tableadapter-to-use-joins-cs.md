---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: TableAdapter kullanımı için güncelleştirme birleşimler (C#) | Microsoft Docs
author: rick-anderson
description: Bir veritabanı ile çalışırken, birden çok tablo arasında yayılır istek verileri için yaygındır. İki farklı tablolardan veri almak için şu ya da kullanabilirsiniz...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: be74be8865b021be1f2e2d8181d2eb42cb74eb75
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876767"
---
<a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="0b9d2-104">TableAdapter kullanımı için güncelleştirme (C#) birleştirir</span><span class="sxs-lookup"><span data-stu-id="0b9d2-104">Updating the TableAdapter to Use JOINs (C#)</span></span>
====================
<span data-ttu-id="0b9d2-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0b9d2-106">[Kodu indirme](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) veya [PDF indirin](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="0b9d2-107">Bir veritabanı ile çalışırken, birden çok tablo arasında yayılır istek verileri için yaygındır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="0b9d2-108">İki farklı tablolardan veri almak için şu ilişkili bir alt sorgu veya bir birleştirme işlemi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="0b9d2-109">Bu öğreticide biz bağıntılı alt sorgular ve JOIN söz dizimi ana sorguda bir birleştirme içeren bir TableAdapter oluşturma bakarak önce karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="0b9d2-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="0b9d2-110">Introduction</span></span>

<span data-ttu-id="0b9d2-111">İlişkisel veritabanları ile biz ile çalışma ilgilendiğiniz veri genellikle birden çok tablo arasında yayılır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="0b9d2-112">Örneğin, ürün bilgilerini görüntülerken, büyük olasılıkla her ürün s karşılık gelen kategorisi ve tedarikçi s adlarını listelemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="0b9d2-113">`Products` Tablolu `CategoryID` ve `SupplierID` değerleri, ancak gerçek kategori ve sağlayıcı adları olan `Categories` ve `Suppliers` tabloları, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="0b9d2-114">Başka bir, ilgili tablosundan bilgi almak için biz kullanabilir *alt sorgulara bağıntılı* veya `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="0b9d2-115">İlişkili bir alt sorgu iç içe bir olduğu `SELECT` dış sorgu sütunlarında başvuran sorgu.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="0b9d2-116">Örneğin, [veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-cs.md) iki bağıntılı sorgularda kullandık öğretici `ProductsTableAdapter` her ürün için kategori ve tedarikçi adlarını döndürmek için ana sorgu s.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="0b9d2-117">A `JOIN` iki farklı tablolardan ilgili satırları birleştirir SQL yapısıdır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="0b9d2-118">Kullandık bir `JOIN` içinde [SqlDataSource denetimi sorgulama verilerle](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) her ürünün yanına kategori bilgileri görüntülemek için öğretici.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="0b9d2-119">Biz abstained kullanımından neden `JOIN` TableAdapters ile s'dir karşılık gelen otomatik oluşturma için TableAdapter s Sihirbazı'nı sınırlamaları nedeniyle `INSERT`, `UPDATE`, ve `DELETE` deyimleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="0b9d2-120">Daha açık belirtmek gerekirse TableAdapter s ana sorgu herhangi içeriyorsa, `JOIN` s, TableAdapter otomatik-oluşturamıyor geçici SQL deyimlerini veya için saklı yordamlar, `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="0b9d2-121">Bu öğretici biz kısaca karşılaştırın ve karşıtlık alt sorgulara bağıntılı ve `JOIN` içeren bir TableAdapter oluşturma keşfetme önce s `JOIN` s ana sorgu.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="0b9d2-122">Karşılaştırın ve çakışan bağıntılı alt sorgular ve`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="0b9d2-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="0b9d2-123">Sözcüğünün `ProductsTableAdapter` ilk öğreticide oluşturduğunuz `Northwind` DataSet her ürün s karşılık gelen kategori ve üretici adı geri getirmek için ilişkili alt sorgular kullanır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="0b9d2-124">`ProductsTableAdapter` s ana sorgu aşağıda gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="0b9d2-125">İki alt sorgulara - bağıntılı `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` ve `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -olan `SELECT` dış içinde ek bir sütun olarak ürün başına tek bir değer döndüren sorgular `SELECT` deyimi s sütun listesi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="0b9d2-126">Alternatif olarak, bir `JOIN` her ürün s sağlayıcı ve kategori adını döndürmek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="0b9d2-127">Aşağıdaki sorgu, yukarıdaki biri aynı çıktıyı döndürür ancak kullanan `JOIN` s alt sorgular yerine:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="0b9d2-128">A `JOIN` bir tablodan kayıt bazı ölçütlere göre başka bir tablodan kayıt ile birleştirir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="0b9d2-129">Yukarıdaki sorguda için `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` SQL Server'ın her birleştirme bildirir ürün kaydı kategorisiyle kayıt `CategoryID` değerle s ürün `CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="0b9d2-130">Her ürün için karşılık gelen kategori alanlarını çalışmak için bize birleştirilmiş sonuç verir (gibi `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="0b9d2-131">`JOIN` İlişkisel veritabanlarından veri sorgulanırken s yaygın olarak kullanılan.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="0b9d2-132">Yeni olması durumunda `JOIN` sözdizimi veya kullanım üzerinde biraz tazelemek gerek, d ı öneririz [SQL JOIN öğretici](http://www.w3schools.com/sql/sql_join.asp) adresindeki [W3 okullar](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="0b9d2-133">Aynı zamanda okuma değer olan [ `JOIN` Temelleri](https://msdn.microsoft.com/library/ms191517.aspx) ve [alt sorgu Temelleri](https://msdn.microsoft.com/library/ms189575.aspx) bölümlerini [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="0b9d2-134">Bu yana `JOIN` s ve ilişkili alt sorgulara hem de diğer tablolardan ilgili verileri almak için kullanılabilir, geliştiricilerin çoğu sol kendi uyarı scratching ve kullanmak için hangi yaklaşımın merak ediyor.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="0b9d2-135">Tüm SQL uzmanları ı aynısını kabaca denirse açıklandı ve onun içermiyor t gerçekten önemli performance-wise SQL Server kabaca aynı yürütme planları oluşturacak şekilde.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="0b9d2-136">Ardından, kendi öneriler sizin ve ekibinizin en uygun olanını teknik kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="0b9d2-137">Bu, bu önerileri imparting sonra bu uzmanlar hemen kendi tercih ifade ettiğini belirtmeye değeri `JOIN` bağıntılı alt sorgulara üzerinden s.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="0b9d2-138">Yazılan veri kümeleri kullanarak veri erişim katmanı oluştururken, Araçlar alt sorgulara kullanırken daha iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="0b9d2-139">Özellikle, TableAdapter s Sihirbazı'nı otomatik-karşılık gelen oluşturmaz `INSERT`, `UPDATE`, ve `DELETE` ana sorgu herhangi içeriyorsa deyimleri `JOIN` s, ancak otomatik oluşturur-bağıntılı olduğunda bu deyimleri alt sorgular kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="0b9d2-140">Bu eksiklikleri keşfetmek için bir geçici yazılan veri kümesinde oluşturma `~/App_Code/DAL` klasör.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0b9d2-141">TableAdapter Yapılandırma Sihirbazı sırasında geçici SQL deyimlerini aşağıdaki girin kullanmayı tercih ve `SELECT` sorgu (bkz: Şekil 1):</span><span class="sxs-lookup"><span data-stu-id="0b9d2-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]


<span data-ttu-id="0b9d2-142">[![Birleştirmeler içeren ana bir sorgu girin](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="0b9d2-143">**Şekil 1**: ana sorgusu, CONTAINS girin `JOIN` s ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>


<span data-ttu-id="0b9d2-144">Varsayılan olarak, TableAdapter otomatik olarak oluşturacak `INSERT`, `UPDATE`, ve `DELETE` deyimleri ana sorguya dayalı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="0b9d2-145">Gelişmiş düğmesine tıklarsanız, bu özellik etkin olduğunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="0b9d2-146">Bu ayar rağmen TableAdapter oluşturmak mümkün olmaz `INSERT`, `UPDATE`, ve `DELETE` deyimleri ana sorgu içerdiğinden bir `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Birleştirmeler içeren ana bir sorgu girin](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="0b9d2-148">**Şekil 2**: içeren ana bir sorgu girin `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="0b9d2-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="0b9d2-149">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="0b9d2-150">Bu noktada, veri kümesi s Tasarımcısı sütunlarla DataTable ile tek bir TableAdapter döndürülen alanların her biri için dahil edilir `SELECT` sorgu s sütun listesi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="0b9d2-151">Bu içerir `CategoryName` ve `SupplierName`, Şekil 3'te gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable sütun listesinde döndürülen her bir alan için bir sütun içerir.](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="0b9d2-153">**Şekil 3**: sütun listesinde her bir alan döndürülen DataTable bir sütun içerir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="0b9d2-154">DataTable uygun sütunları sahipken TableAdapter değerleri eksik kendi `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="0b9d2-155">Bunu doğrulamak için Tasarımcısı'nda TableAdapter tıklayın ve Özellikler penceresine gidin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="0b9d2-156">Olmadığını göreceksiniz `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikleri (hiçbiri) ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="0b9d2-157">[![InsertCommand, UpdateCommand ve DeleteCommand özellikleri (hiçbiri) ayarlanır](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="0b9d2-158">**Şekil 4**: `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikleri (hiçbiri) ayarlanır ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>


<span data-ttu-id="0b9d2-159">Bu eksiklikleri olarak çözmek için şu el ile SQL deyimlerini ve parametrelerini sağlayabilir `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` Özellikler penceresini aracılığıyla özellikleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="0b9d2-160">Alternatif olarak, biz TableAdapter s ana sorguya yapılandırarak başlatamadığından *değil* herhangi dahil `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="0b9d2-161">Bu, olanak sağlayacaktır `INSERT`, `UPDATE`, ve `DELETE` otomatik bize için olarak oluşturulup deyimleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="0b9d2-162">Sihirbazı tamamladıktan sonra daha sonra el ile TableAdapter s güncelleştiriyoruz `SelectCommand` onun içerecek şekilde Özellikleri penceresinde `JOIN` sözdizimi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="0b9d2-163">Bu yaklaşım çalışırken, herhangi bir TableAdapter s ana sorgu zaman çünkü geçici SQL sorgularını kullanarak Sihirbazı kullanarak, otomatik olarak oluşturulan yeniden yapılandırılmış, çok kırılır olduğunda `INSERT`, `UPDATE`, ve `DELETE` deyimleri yeniden oluşturuluyorsa.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="0b9d2-164">Biz TableAdapter üzerinde sağ bağlam menüsünden Yapılandır seçtiyseniz ve sihirbazı yeniden tamamlandı tüm daha sonra yapılan özelleştirmeler kaybolacak anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="0b9d2-165">Kırılganlığının otomatik olarak oluşturulan TableAdapter s da artacağını `INSERT`, `UPDATE`, ve `DELETE` deyimleri olan Neyse ki, geçici SQL deyimlerini sınırlıdır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="0b9d2-166">Saklı yordamlar, TableAdapter kullanıyorsa, özelleştirebileceğiniz `SelectCommand`, `InsertCommand`, `UpdateCommand`, veya `DeleteCommand` saklı yordamlar ve saklı yordamları olacağını endişe gerek kalmadan TableAdapter Yapılandırma Sihirbazı'nı yeniden çalıştırın değiştirdi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="0b9d2-167">Sonraki biz oluşturacak bir TableAdapter, başlangıçta, çeşitli adımları kullanan herhangi atlar ana bir sorgu `JOIN` s karşılık gelen eklemek için güncelleştirme ve silme saklı yordamları, otomatik olarak oluşturulan olacaktır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="0b9d2-168">Ardından güncelleştireceğiz `SelectCommand` şekilde kullanan bir `JOIN` ilişkili tablolardan ek sütunlar getirir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="0b9d2-169">Son olarak, karşılık gelen bir iş mantığı katmanı sınıf oluşturun ve bir ASP.NET web sayfası TableAdapter kullanarak gösterin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="0b9d2-170">1. adım: basitleştirilmiş bir ana sorgu kullanarak TableAdapter oluşturma</span><span class="sxs-lookup"><span data-stu-id="0b9d2-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="0b9d2-171">Bu öğretici için bir TableAdapter ve kesin türü belirtilmiş DataTable için ekleyeceğiz `Employees` tablosundaki `NorthwindWithSprocs` veri kümesi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="0b9d2-172">`Employees` Tablo içeren bir `ReportsTo` belirtilen alan `EmployeeID` çalışan s Yöneticisi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="0b9d2-173">Örneğin, Ayla Ilgaz sahip çalışan bir `ReportTo` olan 5 değerini `EmployeeID` Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="0b9d2-174">Sonuç olarak, Anne Steven, kendi manager raporlar.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="0b9d2-175">Her çalışan s raporlama birlikte `ReportsTo` değeri, biz de isteyebilirsiniz kendi yöneticisinin adını almak.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="0b9d2-176">Bu kullanılarak gerçekleştirilebilir bir `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="0b9d2-177">Ancak kullanarak bir `JOIN` başlangıçta TableAdapter Oluşturma Sihirbazı'nı karşılık gelen Ekle otomatik olarak üretmek önleyen, güncelleştirme ve silme özellikleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="0b9d2-178">Bu nedenle, biz, ana sorgu herhangi içermediğinden bir TableAdapter oluşturarak başlar `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="0b9d2-179">Ardından, 2. adımda Yöneticisi s ad yoluyla almak için ana sorgu saklı yordamı güncelleştireceğiz bir `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="0b9d2-180">Başlangıç açarak `NorthwindWithSprocs` kümesinde `~/App_Code/DAL` klasör.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0b9d2-181">Designer'ı sağ tıklatın, ardından bağlam menüsünden Ekle seçeneğini seçin ve TableAdapter menü öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="0b9d2-182">Bu TableAdapter Yapılandırma Sihirbazı'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0b9d2-183">Şekil 5 gösterilmektedir gibi yeni saklı yordamlar oluşturmak ve İleri'yi tıklatın Sihirbazı sahiptir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="0b9d2-184">Yeni oluşturma Yenileyici saklı yordamları TableAdapter s Sihirbazı'ndan için başvurun [oluşturma yeni saklı yordamlar için yazılan veri kümesi s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>


<span data-ttu-id="0b9d2-185">[![Create Yeni saklı yordamlar seçeneği seçin](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="0b9d2-186">**Şekil 5**: Select oluştur Yeni saklı yordamlar seçeneği ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>


<span data-ttu-id="0b9d2-187">Aşağıdaki `SELECT` TableAdapter s ana sorgu bildirimi:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="0b9d2-188">Bu sorgu içermez beri `JOIN` s, TableAdapter Sihirbazı otomatik olarak oluşturacak saklı yordamlar karşılık gelen ile `INSERT`, `UPDATE`, ve `DELETE` ana yürütülmesi için bir saklı yordam yanı sıra deyimleri Sorgu.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="0b9d2-189">Aşağıdaki adımı TableAdapter s saklı yordamları ad olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="0b9d2-190">Adları kullanın `Employees_Select`, `Employees_Insert`, `Employees_Update`, ve `Employees_Delete`Şekil 6'da gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="0b9d2-191">[![Ad TableAdapter s saklı yordamlar](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="0b9d2-192">**Şekil 6**: TableAdapter s saklı yordamlar adı ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>


<span data-ttu-id="0b9d2-193">Son adım bize TableAdapter s yöntemleri adı ister.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="0b9d2-194">Kullanım `Fill` ve `GetEmployees` yöntemi adları olarak.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="0b9d2-195">Ayrıca işaretli doğrudan veritabanı (GenerateDBDirectMethods) onay kutusu güncelleştirmeleri göndermek için Create yöntemlerini bırakın emin olun.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="0b9d2-196">[![Ad TableAdapter s yöntemleri dolgu ve GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="0b9d2-197">**Şekil 7**: TableAdapter s yöntemleri ad `Fill` ve `GetEmployees` ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>


<span data-ttu-id="0b9d2-198">Sihirbazı tamamladıktan sonra veritabanında depolanan yordamları incelemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="0b9d2-199">Dört yenilerini görmeniz gerekir: `Employees_Select`, `Employees_Insert`, `Employees_Update`, ve `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="0b9d2-200">Ardından, inceleme `EmployeesDataTable` ve `EmployeesTableAdapter` yeni oluşturduğunuz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="0b9d2-201">DataTable ana sorgu tarafından döndürülen her bir alan için bir sütun içerir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="0b9d2-202">TableAdapter üzerinde tıklayın ve ardından Properties penceresine gidin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="0b9d2-203">Olmadığını göreceksiniz `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikleri karşılık gelen saklı yordamları çağırmak için doğru şekilde yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="0b9d2-204">[![TableAdapter INSERT, Update içerir ve yetenekleri silin](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="0b9d2-205">**Şekil 8**: TableAdapter Ekle içerir, güncelleştirme ve silme özellikleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>


<span data-ttu-id="0b9d2-206">INSERT ile güncelleştirin ve otomatik olarak oluşturulan saklı yordamlar silin ve `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` doğru yapılandırılmış özellikleri, biz özelleştirmek hazır `SelectCommand` s saklı yordamı ek döndürmek için Her çalışan s Yöneticisi hakkında bilgi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="0b9d2-207">Özellikle, güncelleştirmek ihtiyacımız `Employees_Select` saklı yordamı kullanmak için bir `JOIN` ve s Yöneticisi dönmek `FirstName` ve `LastName` değerleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="0b9d2-208">Saklı yordam güncelleştirildikten sonra Biz bu ek sütunlar içeren DataTable güncelleştirmeniz gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="0b9d2-209">Bu iki görevleri adımları 2 ve 3 üstesinden.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="0b9d2-210">2. adım: Dahil etmek için saklı yordam özelleştirme bir`JOIN`</span><span class="sxs-lookup"><span data-stu-id="0b9d2-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="0b9d2-211">Sunucu Gezgini, Northwind veritabanı s saklı yordamlar klasörüne araştırıp, gidip açma başlangıç `Employees_Select` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="0b9d2-212">Bu saklı yordam görmüyorsanız, saklı yordamlar klasörü sağ tıklatın ve Yenile seçeneğini seçin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="0b9d2-213">Saklı yordamı güncelleştirin, böylece kullandığı bir `LEFT JOIN` s Yöneticisi ilk dönün ve Soyadı:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="0b9d2-214">Güncelleştirdikten sonra `SELECT` dosya menüsüne giderek ve kaydetme seçerek değişiklikleri kaydetme deyimi `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="0b9d2-215">Alternatif olarak, araç çubuğunda Kaydet simgesine tıklayın veya Ctrl + S ulaştı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="0b9d2-216">Değişiklikleri kaydettikten sonra sağ tıklayın `Employees_Select` saklı yordamı Server Explorer'da ve Çalıştır'ı seçin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="0b9d2-217">Bu saklı yordamını çalıştırma ve sonuçları çıktı penceresinde Göster (bkz. Şekil 9).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="0b9d2-218">[![Saklı yordamlar sonuçlar çıktı penceresinde görüntülenir](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="0b9d2-219">**Şekil 9**: saklı yordamları sonuçları, çıktı penceresinde görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="0b9d2-220">3. adım: DataTable s sütunları güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="0b9d2-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="0b9d2-221">Bu noktada, `Employees_Select` depolanan yordamı döndürür `ManagerFirstName` ve `ManagerLastName` değerleri, ancak `EmployeesDataTable` bu sütunları eksik.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="0b9d2-222">Bu eksik sütunları iki yoldan biriyle DataTable eklenebilir:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="0b9d2-223">**El ile** - veri kümesi tasarımcısında DataTable sağ tıklayın ve Sütun Ekle menüsünden'i seçin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="0b9d2-224">Sütun adı ve özelliklerini uygun şekilde ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="0b9d2-225">**Otomatik olarak** -TableAdapter Yapılandırma Sihirbazı'nı DataTable s sütunları tarafından döndürülen alanları yansıtacak şekilde güncelleştirilir `SelectCommand` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="0b9d2-226">Geçici SQL deyimlerini kullanırken, sihirbaz aynı zamanda kaldıracak `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikler bu yana `SelectCommand` şimdi içeren bir `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="0b9d2-227">Ancak saklı yordamları kullanırken, bu komut özellikleri değişmeden kalır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="0b9d2-228">El ile ekleme DataTable sütunları önceki eğitimlerine denedikten [ana/Ayrıntılar DataList ile bir madde işaretli listesi, ana kayıtları kullanarak ayrıntı](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) ve [yüklenen dosyalar](../working-with-binary-files/uploading-files-cs.md), ve şunları yapacağız Bu işlem yeniden daha ayrıntılı bizim sonraki öğreticide bakın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="0b9d2-229">Bu öğreticide, ancak TableAdapter Yapılandırma Sihirbazı'nı aracılığıyla otomatik yaklaşımı kullanın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="0b9d2-230">Başlangıç üzerinde sağ tıklayarak `EmployeesTableAdapter` ve bağlam menüsünden Yapılandır seçme.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="0b9d2-231">Bu seçme, ekleme, güncelleştirme ve silme, kendi dönüş değerleri ve parametreleri (varsa) ile birlikte kullanılan saklı yordamları listeler TableAdapter Yapılandırma Sihirbazı açar.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="0b9d2-232">Şekil 10 Bu sihirbaz gösterilir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="0b9d2-233">Burada görebiliriz `Employees_Select` depolanan yordamı şimdi döndürür `ManagerFirstName` ve `ManagerLastName` alanları.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="0b9d2-234">[![Saklı yordam Employees_Select için güncelleştirilmiş sütun listesi Sihirbazı'nı gösterir](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="0b9d2-235">**Şekil 10**: Sihirbazı için güncelleştirilmiş sütun listesi gösterir `Employees_Select` saklı yordam ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>


<span data-ttu-id="0b9d2-236">Son'u tıklatarak Sihirbazı tamamlayın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="0b9d2-237">Veri kümesi Tasarımcısı için döndürme bağlı `EmployeesDataTable` iki ek sütunları içerir: `ManagerFirstName` ve `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="0b9d2-238">[![İki yeni sütun EmployeesDataTable içerir](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="0b9d2-239">**Şekil 11**: `EmployeesDataTable` içeren iki yeni sütun ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>


<span data-ttu-id="0b9d2-240">Bu göstermek için güncelleştirilmiş `Employees_Select` saklı yordam etkindir ve ekleme, güncelleştirme ve TableAdapter yeteneklerini silme hala işlevsel, görüntülemek ve çalışanlar silmek kullanıcılara bir web sayfası oluşturmak s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="0b9d2-241">Biz bu tür bir sayfayı oluşturmadan önce ancak önce yeni bir sınıf çalışanlarıyla çalışmak için iş mantığı katmanı oluşturmak ihtiyacımız `NorthwindWithSprocs` veri kümesi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="0b9d2-242">Adım 4'te oluşturacağız bir `EmployeesBLLWithSprocs` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="0b9d2-243">Adım 5'te bu sınıf bir ASP.NET sayfasından kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="0b9d2-244">4. adım: iş mantığı katmanı uygulama</span><span class="sxs-lookup"><span data-stu-id="0b9d2-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="0b9d2-245">Yeni bir sınıf dosyasını içinde oluşturmak `~/App_Code/BLL` adlı klasörü `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="0b9d2-246">Bu sınıf varolan semantiğini taklit eder `EmployeesBLL` biri daha az yöntemleri sağlar ve kullandığı sınıfı, yalnızca bu yeni `NorthwindWithSprocs` veri kümesi (yerine `Northwind` veri kümesi).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="0b9d2-247">Aşağıdaki kodu ekleyin `EmployeesBLLWithSprocs` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="0b9d2-248">`EmployeesBLLWithSprocs` s sınıfı `Adapter` özelliği döndürür örneği `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="0b9d2-249">Bu s sınıfı tarafından kullanılan `GetEmployees` ve `DeleteEmployee` yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="0b9d2-250">`GetEmployees` Yöntem çağrılarını `EmployeesTableAdapter` s karşılık gelen `GetEmployees` çağırır yöntemi `Employees_Select` saklı yordamı ve onun sonuçlarında dolduran bir `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="0b9d2-251">`DeleteEmployee` Yöntemi benzer şekilde çağırır `EmployeesTableAdapter` s `Delete` çağırır yöntemi `Employees_Delete` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="0b9d2-252">5. adım: sunu katmanı verilerle çalışma</span><span class="sxs-lookup"><span data-stu-id="0b9d2-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="0b9d2-253">İle `EmployeesBLLWithSprocs` sınıfı tam, biz re ASP.NET sayfası üzerinden çalışan verilerle çalışmak için hazır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="0b9d2-254">Açık `JOINs.aspx` sayfasındaki `AdvancedDAL` klasörü ve sürükleme GridView ayarı tasarımcıya araç kendi `ID` özelliğine `Employees`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="0b9d2-255">Ardından, GridView s akıllı etiketten kılavuz adlı yeni bir ObjectDataSource denetimine bağlama `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="0b9d2-256">ObjectDataSource kullanmak için yapılandırma `EmployeesBLLWithSprocs` sınıfı ve seçin ve DELETE sekmelerinden emin olun `GetEmployees` ve `DeleteEmployee` yöntemleri, aşağı açılan listelerden seçilir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="0b9d2-257">ObjectDataSource s yapılandırmasını tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="0b9d2-258">[![ObjectDataSource EmployeesBLLWithSprocs sınıfını kullanmak için yapılandırma](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="0b9d2-259">**Şekil 12**: ObjectDataSource kullanılacak yapılandırma `EmployeesBLLWithSprocs` sınıfı ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>


<span data-ttu-id="0b9d2-260">[![ObjectDataSource kullanımı GetEmployees ve DeleteEmployee yöntemleri vardır](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="0b9d2-261">**Şekil 13**: ObjectDataSource kullanması `GetEmployees` ve `DeleteEmployee` yöntemleri ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>


<span data-ttu-id="0b9d2-262">Visual Studio ekleyecek bir BoundField GridView her biri için `EmployeesDataTable` s sütun.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="0b9d2-263">Tüm bu BoundFields dışında kaldırmak `Title`, `LastName`, `FirstName`, `ManagerFirstName`, ve `ManagerLastName` ve yeniden adlandırma `HeaderText` Soyadı, ad, Yöneticisi s adını, son dört BoundFields özelliklerini ve Yöneticisi s Soyadı, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="0b9d2-264">Bu sayfadan çalışanları silebilirsiniz yapmalarına izin vermek için size iki şey yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="0b9d2-265">İlk olarak, kendi akıllı etiket Enable Deleting seçeneğinden denetleyerek silme özellikleri sağlamak üzere GridView isteyin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="0b9d2-266">İkinci olarak, ObjectDataSource s değiştirme `OldValuesParameterFormatString` özelliği değerinden ObjectDataSource Sihirbazı'nı ayarlayın (`original_{0}`) varsayılan değerine (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="0b9d2-267">Bu değişiklikleri yaptıktan sonra GridView ve ObjectDataSource s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="0b9d2-268">Sayfa bir tarayıcıdan ziyaret ederek test edin.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="0b9d2-269">Şekil 14 gösterildiği gibi sayfa her çalışan (bir sahip oldukları varsayılarak) bilgilendirilmesine manager s adını listeler.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="0b9d2-270">[![Employees_Select BİRLEŞİMDE depolanan yordamı döndürür Manager s adı](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="0b9d2-271">**Şekil 14**: `JOIN` içinde `Employees_Select` saklı yordam adı s Yöneticisi döndürür ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>


<span data-ttu-id="0b9d2-272">Yürütme işlemi culminates silme akışı başlar Sil düğmesini tıklatarak `Employees_Delete` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="0b9d2-273">Ancak, denenen `DELETE` saklı yordamı deyiminde bir yabancı anahtar kısıtlaması ihlali nedeniyle başarısız olur (bkz. Şekil 15).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="0b9d2-274">Özellikle, her çalışana sahip bir veya daha fazla kayıt `Orders` silme başarısız olmasına neden olan tablo.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="0b9d2-275">[![Bir yabancı anahtar kısıtlaması ihlali karşılık gelen siparişler sonuçları sahip bir çalışan silme](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="0b9d2-276">**Şekil 15**: karşılık gelen siparişler sonuçları bir yabancı anahtar kısıtlaması ihlali sahip bir çalışan silme ([tam boyutlu görüntüyü görüntülemek için tıklatın](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="0b9d2-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>


<span data-ttu-id="0b9d2-277">Bir çalışan olmasını izin vermek için silinmiş olabilir:</span><span class="sxs-lookup"><span data-stu-id="0b9d2-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="0b9d2-278">Güncelleştirmeyi siler basamaklı yabancı anahtar kısıtlaması</span><span class="sxs-lookup"><span data-stu-id="0b9d2-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="0b9d2-279">Kayıtlardan el ile silmeniz `Orders` silmek istediğinizden employee(s) için tablo veya</span><span class="sxs-lookup"><span data-stu-id="0b9d2-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="0b9d2-280">Güncelleştirme `Employees_Delete` saklı yordamı ilgili kayıtlarını silmeniz `Orders` silmeden önce tablo `Employees` kaydı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="0b9d2-281">Biz bu teknik ele [kullanarak var olan saklı yordamlar için yazılan veri kümesi s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="0b9d2-282">I bunu bir alıştırma olarak okuyucuya bırakın.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="0b9d2-283">Özet</span><span class="sxs-lookup"><span data-stu-id="0b9d2-283">Summary</span></span>

<span data-ttu-id="0b9d2-284">İlişkisel veritabanları ile çalışırken, tablolar ilgili birden çok, verilerini çekmesini sorgular için yaygındır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="0b9d2-285">Bağıntılı alt sorgular ve `JOIN` s sorguda ilgili tablolardan veri erişimi için iki farklı teknikleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="0b9d2-286">İçindeki en yaygın olarak yapılan önceki öğreticileri kullanın bağıntılı alt sorgulara TableAdapter otomatik oluşturması nedeniyle olamaz `INSERT`, `UPDATE`, ve `DELETE` ilgili sorgular için deyimleri `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="0b9d2-287">Bu değerleri el ile geçici SQL deyimlerini kullanılırken sağlanabilir sırada TableAdapter Yapılandırma Sihirbazı tamamlandığında, tüm özelleştirmeler üzerine yazılır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="0b9d2-288">Neyse ki, saklı yordamlar kullanılarak oluşturulan TableAdapters geçici SQL deyimlerini kullanarak oluşturulanlar olarak aynı brittleness gelen karşılaşmaz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="0b9d2-289">Bu nedenle, ana sorgusu kullanan bir TableAdapter oluşturmak için uygun bir `JOIN` saklı yordamları kullanırken.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="0b9d2-290">Bu öğreticide böyle bir TableAdapter oluşturma gördük.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="0b9d2-291">Kullanılarak başlatılan bir `JOIN`-daha az `SELECT` karşılık gelen INSERT, update ve delete saklı yordamlar, otomatik oluşturulan böylece TableAdapter s ana sorgu için sorgu.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="0b9d2-292">TableAdapter s ilk yapılandırma ile tam, biz engagement'ta `SelectCommand` saklı yordamı kullanmak için bir `JOIN` ve TableAdapter Yapılandırma Sihirbazı'nı güncelleştirmek için yeniden çalıştırılmıştır `EmployeesDataTable` s sütun.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="0b9d2-293">Otomatik olarak güncelleştirilen TableAdapter Yapılandırma Sihirbazı'nı yeniden çalıştırmak `EmployeesDataTable` tarafından döndürülen veri alanları yansıtacak şekilde sütunları `Employees_Select` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="0b9d2-294">Alternatif olarak, bu sütunları el ile DataTable tablosuna ekledik.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="0b9d2-295">Sonraki öğreticide DataTable tablosuna biz el ile ekleme sütunları inceleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="0b9d2-296">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="0b9d2-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0b9d2-297">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="0b9d2-297">About the Author</span></span>

<span data-ttu-id="0b9d2-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0b9d2-299">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0b9d2-300">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0b9d2-301">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0b9d2-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0b9d2-302">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="0b9d2-302">Special Thanks To</span></span>

<span data-ttu-id="0b9d2-303">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0b9d2-304">Bu öğretici için sağlama gözden geçirenler Hilton Geisenow, David Suru ve Teresa Murphy yoktu.</span><span class="sxs-lookup"><span data-stu-id="0b9d2-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="0b9d2-305">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="0b9d2-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0b9d2-306">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0b9d2-307">[Önceki](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [sonraki](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0b9d2-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>
