---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: "Türü belirtilmiş veri kümesi'nin TableAdapters (VB) için saklı yordamlar Varolanı kullanma | Microsoft Docs"
author: rick-anderson
description: "Önceki öğreticide TableAdapter Sihirbazı'nı kullanarak yeni saklı yordamlar oluşturmak nasıl öğrendiniz. Biz bu öğreticide öğrenin nasıl aynı TableAdapter..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: 15de0ca9bcceb7f745fa311b18d2c095f1dafcb1
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/10/2017
---
<a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="169ee-104">Türü belirtilmiş veri kümesi'nin TableAdapters (VB) saklı yordamları Varolanı kullanma</span><span class="sxs-lookup"><span data-stu-id="169ee-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>
====================
<span data-ttu-id="169ee-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="169ee-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="169ee-106">[Kodu indirme](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) veya [PDF indirin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="169ee-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="169ee-107">Önceki öğreticide TableAdapter Sihirbazı'nı kullanarak yeni saklı yordamlar oluşturmak nasıl öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="169ee-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="169ee-108">Bu öğreticide aynı TableAdapter Sihirbazı ile var olan saklı yordamları nasıl çalışabileceğini öğrenin.</span><span class="sxs-lookup"><span data-stu-id="169ee-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="169ee-109">Biz de el ile yeni saklı yordamlar Veritabanımıza eklemeyi öğrenin.</span><span class="sxs-lookup"><span data-stu-id="169ee-109">We also learn how to manually add new stored procedures to our database.</span></span>


## <a name="introduction"></a><span data-ttu-id="169ee-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="169ee-110">Introduction</span></span>

<span data-ttu-id="169ee-111">İçinde [önceki öğretici](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) erişim geçici yerine veri SQL deyimleri saklı yordamları kullanmak için yazılan veri kümesi s TableAdapters nasıl yapılandırılabilir gördük.</span><span class="sxs-lookup"><span data-stu-id="169ee-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="169ee-112">Özellikle, otomatik olarak bu saklı yordamları oluşturma TableAdapter Sihirbazı'nı nasıl incelendi.</span><span class="sxs-lookup"><span data-stu-id="169ee-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="169ee-113">ASP.NET 2.0 eski bir uygulamaya bağlantı noktası oluşturma veya varolan bir veri modeli geçici bir ASP.NET 2.0 Web oluştururken, veritabanı zaten ihtiyacımız saklı yordamları içeriyor yüksektir.</span><span class="sxs-lookup"><span data-stu-id="169ee-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="169ee-114">Alternatif olarak, el ile veya saklı yordamlar otomatik olarak oluşturur TableAdapter Sihirbazı'nı dışındaki bazı araçla saklı yordamlar oluşturmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="169ee-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="169ee-115">Bu öğreticide biz TableAdapter var olan saklı yordamları kullanmak üzere yapılandırmak nasıl ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="169ee-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="169ee-116">Northwind veritabanı yalnızca yerleşik saklı yordamlar, küçük bir kümesini olduğundan, ayrıca veritabanını Visual Studio ortamı aracılığıyla el ile yeni saklı yordamlar eklemek için gerekli olan adımları ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="169ee-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="169ee-117">Let s başlayın!</span><span class="sxs-lookup"><span data-stu-id="169ee-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="169ee-118">İçinde [kaydırma veritabanı değişiklikleri bir işlem içinde](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) öğreticide eklediğimiz yöntemleri işlemleri desteklemek için TableAdapter (`BeginTransaction`, `CommitTransaction`, vb.).</span><span class="sxs-lookup"><span data-stu-id="169ee-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="169ee-119">Alternatif olarak, hiçbir veri erişim katmanı kodda değişiklik gerektiren tamamen bir saklı yordam içinde işlemleri yönetilebilir.</span><span class="sxs-lookup"><span data-stu-id="169ee-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="169ee-120">Bu öğreticide biz bir saklı yordam s bilgilerinin kapsamındaki bir işlem yürütmek için kullanılan T-SQL komutlarıyla ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="169ee-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>


## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="169ee-121">1. adım: Northwind veritabanına saklı yordamlar ekleme</span><span class="sxs-lookup"><span data-stu-id="169ee-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="169ee-122">Visual Studio, bir veritabanına yeni saklı yordamlar eklemek kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="169ee-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="169ee-123">Let s tüm sütunları döndürür Northwind veritabanına yeni bir saklı yordam eklemek `Products` tablosu için belirli bir olan `CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="169ee-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="169ee-124">Böylece klasörlerinde - veritabanı diyagramları, tablolar, görünümler ve benzeri - görüntülenir Sunucu Gezgini penceresinde, Northwind veritabanı genişletin.</span><span class="sxs-lookup"><span data-stu-id="169ee-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="169ee-125">Önceki öğreticide gördüğümüz gibi saklı yordamlar klasörü veritabanı s var olan saklı yordamları içerir.</span><span class="sxs-lookup"><span data-stu-id="169ee-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="169ee-126">Yeni bir saklı yordam eklemek için saklı yordamlar klasörünü sağ tıklatın ve bağlam menüsünden Yeni saklı yordam ekleme seçeneğini seçin.</span><span class="sxs-lookup"><span data-stu-id="169ee-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>


<span data-ttu-id="169ee-127">[![Saklı yordamlar klasörünü sağ tıklatın ve yeni bir saklı yordam ekleyin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="169ee-128">**Şekil 1**: saklı yordamları klasörü sağ tıklatın ve yeni bir saklı yordam ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>


<span data-ttu-id="169ee-129">Şekil 1'de görüldüğü gibi yeni bir saklı yordam Ekle seçeneğini belirleyerek bir komut penceresi Visual Studio'da saklı yordam oluşturmak için gereken SQL komut dosyası ana hattı ile açılır.</span><span class="sxs-lookup"><span data-stu-id="169ee-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="169ee-130">Bu komut dosyası ayrıntılı hale getirmek ve bu noktada saklı yordamı veritabanına eklenir, yürütmek için bizim işi var.</span><span class="sxs-lookup"><span data-stu-id="169ee-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="169ee-131">Aşağıdaki komut dosyasını girin:</span><span class="sxs-lookup"><span data-stu-id="169ee-131">Enter the following script:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="169ee-132">Çalıştırıldığında, bu komut, yeni bir saklı yordam adlı Northwind veritabanı ekleyecek `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="169ee-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="169ee-133">Bu saklı yordam tek bir giriş parametre kabul eder (`@CategoryID`, türü `int`) ve eşleşen bu ürünler için alanların tümünü döndürür `CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="169ee-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="169ee-134">Bu yürütmek için `CREATE PROCEDURE` komut dosyası ve saklı yordam veritabanına ekleyin, araç çubuğunda Kaydet simgesine tıklayın veya Ctrl + S isabet.</span><span class="sxs-lookup"><span data-stu-id="169ee-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="169ee-135">Bunu, saklı yordamlar klasörü yenilemeler yaptıktan sonra yeni oluşturulan gösteren saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="169ee-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="169ee-136">Komut penceresinde gelen subtlety da, değiştirir `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` için `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="169ee-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="169ee-137">`CREATE PROCEDURE`veritabanına yeni bir saklı yordam ekler sırada `ALTER PROCEDURE` mevcut bir güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="169ee-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="169ee-138">Komut dosyası başlangıcı için değiştikten `ALTER PROCEDURE`, saklı yordamları değiştirme giriş parametreleri veya SQL deyimlerini ve Kaydet simgesine tıklayarak güncelleştirilecek saklı yordamı bu değişikliklerle.</span><span class="sxs-lookup"><span data-stu-id="169ee-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="169ee-139">Şekil 2 gösterir sonra Visual Studio `Products_SelectByCategoryID` saklı yordam kaydedildi.</span><span class="sxs-lookup"><span data-stu-id="169ee-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>


<span data-ttu-id="169ee-140">[![Saklı yordam Products_SelectByCategoryID veritabanına eklendi](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="169ee-141">**Şekil 2**: saklı yordam `Products_SelectByCategoryID` eklendi veritabanına ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>


## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="169ee-142">2. adım: var olan bir saklı yordamı kullanmak için TableAdapter yapılandırma</span><span class="sxs-lookup"><span data-stu-id="169ee-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="169ee-143">Şimdi `Products_SelectByCategoryID` saklı yordam eklendi veritabanına biz bizim yöntemlerinden birini çağrıldığında Bu saklı yordamı kullanmak için veri erişim katmanı yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="169ee-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="169ee-144">Özellikle, ekleyeceğiz bir `GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->` yönteme `ProductsTableAdapter` içinde `NorthwindWithSprocs` yazılan çağıran DataSet `Products_SelectByCategoryID` saklı yordamı yeni oluşturduğumuz.</span><span class="sxs-lookup"><span data-stu-id="169ee-144">In particular, we will add a `GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="169ee-145">Başlangıç açarak `NorthwindWithSprocs` veri kümesi.</span><span class="sxs-lookup"><span data-stu-id="169ee-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="169ee-146">Sağ `ProductsTableAdapter` ve TableAdapter sorgu Yapılandırma Sihirbazı'nı başlatmak için Sorgu Ekle'i seçin.</span><span class="sxs-lookup"><span data-stu-id="169ee-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="169ee-147">İçinde [önceki öğretici](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) biz bize için yeni bir saklı yordam oluşturma TableAdapter olmasını seçti.</span><span class="sxs-lookup"><span data-stu-id="169ee-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="169ee-148">Bu öğreticide, ancak varolan yeni TableAdapter yöntemi wire istiyoruz `Products_SelectByCategoryID` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="169ee-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="169ee-149">Bu nedenle, kullanım varolan saklı yordam seçeneği sihirbaz s ilk adımdan ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>


<span data-ttu-id="169ee-150">[![Saklı yordam seçeneği mevcut Kullan'ı seçin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="169ee-151">**Şekil 3**: kullanım varolan saklı yordamı seçeneği seçin ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>


<span data-ttu-id="169ee-152">Aşağıdaki ekran aşağı açılan liste s veritabanıyla saklı yordamlar doldurulmuş sağlar.</span><span class="sxs-lookup"><span data-stu-id="169ee-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="169ee-153">Saklı yordam seçerek sol ve sağ taraftaki (varsa) döndürülen veri alanları kendi giriş parametreleri listeler.</span><span class="sxs-lookup"><span data-stu-id="169ee-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="169ee-154">Seçin `Products_SelectByCategoryID` saklı yordamı listesinden ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>


<span data-ttu-id="169ee-155">[![Products_SelectByCategoryID çekme saklı yordamı](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="169ee-156">**Şekil 4**: çekme `Products_SelectByCategoryID` saklı yordam ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>


<span data-ttu-id="169ee-157">Sonraki ekranda bize ne tür veriler saklı yordam tarafından döndürülen ister ve burada bizim yanıt TableAdapter s yöntemi tarafından döndürülen türü belirler.</span><span class="sxs-lookup"><span data-stu-id="169ee-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="169ee-158">Örneğin, tablo veri döndürdüğünü belirtmek, yöntemi döndürür bir `ProductsDataTable` örneği saklı yordam tarafından döndürülen kayıt ile doldurulur.</span><span class="sxs-lookup"><span data-stu-id="169ee-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="169ee-159">TableAdapter Bu saklı yordam tek bir değer döndüren gösteriyorsa, buna karşılık, döndürülecek bir `Object` saklı yordam tarafından döndürülen ilk kaydının ilk sütunundaki değeri atanır.</span><span class="sxs-lookup"><span data-stu-id="169ee-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="169ee-160">Bu yana `Products_SelectByCategoryID` saklı yordamı belirli bir kategoriye ait, ilk yanıt - tablo verisi-'ı seçin ve İleri'yi tıklatın, tüm ürünleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="169ee-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>


<span data-ttu-id="169ee-161">[![Saklı yordam tablo verisi döndüren belirtin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="169ee-162">**Şekil 5**: saklı yordam tablo verisi döndüren belirtin ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>


<span data-ttu-id="169ee-163">Kalan tek şey yöntemi desenleri kullanmak için bu yöntemlere ait adlarıyla ardından belirtmek için.</span><span class="sxs-lookup"><span data-stu-id="169ee-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="169ee-164">Her iki dolgu bir DataTable ve Return DataTable seçenekleri işaretli, ancak yöntemlerini yeniden adlandırmak bırakın `FillByCategoryID` ve `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="169ee-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="169ee-165">Sihirbazın gerçekleştireceği görevleri özetini gözden geçirmek için İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="169ee-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="169ee-166">Her şey doğru görünüyorsa, Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-166">If everything looks correct, click Finish.</span></span>


<span data-ttu-id="169ee-167">[![Ad yöntemleri FillByCategoryID ve GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="169ee-168">**Şekil 6**: yöntemler ad `FillByCategoryID` ve `GetProductsByCategoryID` ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="169ee-169">Yeni oluşturduğumuz, TableAdapter yöntemleri `FillByCategoryID` ve `GetProductsByCategoryID`, türünde bir giriş parametresi beklediğiniz `Integer`.</span><span class="sxs-lookup"><span data-stu-id="169ee-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="169ee-170">Bu giriş parametresi değeri saklı yordam içinde geçirilen kendi `@CategoryID` parametresi.</span><span class="sxs-lookup"><span data-stu-id="169ee-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="169ee-171">Değiştirirseniz `Products_SelectByCategory` saklı yordam s parametreleri, aynı zamanda bu TableAdapter yöntemleri parametrelerini güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="169ee-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="169ee-172">' Da anlatıldığı gibi [önceki öğretici](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), bu iki yoldan biriyle yapılabilir: el ile ekleyerek veya parametreleri parametreleri koleksiyonundan veya kaldırarak TableAdapter sihirbazını yeniden tarafından.</span><span class="sxs-lookup"><span data-stu-id="169ee-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>


## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="169ee-173">3. adım: Ekleme bir`GetProductsByCategoryID(categoryID)`BLL yöntemi</span><span class="sxs-lookup"><span data-stu-id="169ee-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="169ee-174">İle `GetProductsByCategoryID` DAL tam, sonraki adıma yöntemdir iş mantığı katmanı Bu yöntemde erişim sağlamak için.</span><span class="sxs-lookup"><span data-stu-id="169ee-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="169ee-175">Açık `ProductsBLLWithSprocs` sınıf dosya ve aşağıdaki yöntemi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="169ee-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>


[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="169ee-176">Bu BLL yöntemi yalnızca döndürür `ProductsDataTable` döndürülen `ProductsTableAdapter` s `GetProductsByCategoryID` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="169ee-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="169ee-177">`DataObjectMethodAttribute` Özniteliği ObjectDataSource s veri kaynağı Yapılandırma Sihirbazı tarafından kullanılan meta veri sağlar.</span><span class="sxs-lookup"><span data-stu-id="169ee-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="169ee-178">Özellikle, bu yöntem seçme sekmesinde s aşağı açılan listede görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="169ee-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="169ee-179">4. adım: Ürün kategorisine göre görüntüleme</span><span class="sxs-lookup"><span data-stu-id="169ee-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="169ee-180">Yeni eklenen test etmek için `Products_SelectByCategoryID` saklı yordam ve bir DropDownList ve GridView içeren bir ASP.NET sayfası oluşturma s izin ilgili DAL ve BLL yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="169ee-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="169ee-181">GridView seçilen kategoriye ait ürünleri görüntüler sırada DropDownList tüm veritabanındaki kategorilerini listeler.</span><span class="sxs-lookup"><span data-stu-id="169ee-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="169ee-182">Biz oluşturulan hedefteki ana/ayrıntı arabirimleri DropDownLists önceki eğitimlerine kullanma.</span><span class="sxs-lookup"><span data-stu-id="169ee-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="169ee-183">Böyle bir ana öğe/ayrıntı raporu uygulayan bir daha derinlemesine bakış için bkz [ana/ayrıntı filtreleme ile bir DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="169ee-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>


<span data-ttu-id="169ee-184">Açık `ExistingSprocs.aspx` sayfasındaki `AdvancedDAL` klasörü ve araç tasarımcıya bir DropDownList sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="169ee-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="169ee-185">DropDownList s ayarlamak `ID` özelliğine `Categories` ve kendi `AutoPostBack` özelliğine `True`.</span><span class="sxs-lookup"><span data-stu-id="169ee-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="169ee-186">Ardından, akıllı etiketten DropDownList adlı yeni bir ObjectDataSource bağlama `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="169ee-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="169ee-187">Böylece kendi veri alır ObjectDataSource yapılandırma `CategoriesBLL` s sınıfı `GetCategories` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="169ee-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="169ee-188">Güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="169ee-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="169ee-189">[![S CategoriesBLL sınıfı GetCategories yönteminden verilerini alma](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="169ee-190">**Şekil 7**: verileri alma `CategoriesBLL` s sınıfı `GetCategories` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>


<span data-ttu-id="169ee-191">[![Güncelleştirme, ekleme, açılan listeleri ayarlayın ve sekmeleri (hiçbiri) silme](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="169ee-192">**Şekil 8**: aşağı açılan listeler güncelleştirme, ekleme ve silme sekmeler (hiçbiri) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>


<span data-ttu-id="169ee-193">ObjectDataSource Sihirbazı'nı tamamladıktan sonra görüntülenecek DropDownList yapılandırma `CategoryName` veri alan ve kullanmak için `CategoryID` olarak alan `Value` her `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="169ee-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="169ee-194">Bu noktada, DropDownList ve ObjectDataSource s bildirim temelli biçimlendirmesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="169ee-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="169ee-195">Ardından, GridView DropDownList yerleştirme Tasarımcısı sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="169ee-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="169ee-196">GridView s ayarlamak `ID` için `ProductsByCategory` ve akıllı etiketten adlı yeni bir ObjectDataSource bağlayın `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="169ee-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="169ee-197">Yapılandırma `ProductsByCategoryDataSource` kullanılacak ObjectDataSource `ProductsBLLWithSprocs` sınıfı, onu sahip almak, verileri kullanarak `GetProductsByCategoryID(categoryID)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="169ee-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="169ee-198">Bu GridView yalnızca verileri görüntülemek için kullanılacağından, güncelleştirme, ekleme, açılan listeleri ayarlamak ve sekmeleri (hiçbiri) SİLİN ve İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>


<span data-ttu-id="169ee-199">[![ObjectDataSource ProductsBLLWithSprocs sınıfını kullanmak için yapılandırma](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="169ee-200">**Şekil 9**: ObjectDataSource kullanılacak yapılandırma `ProductsBLLWithSprocs` sınıfı ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>


<span data-ttu-id="169ee-201">[![Verileri elde edilen GetProductsByCategoryID(categoryID) yöntemi](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="169ee-202">**Şekil 10**: verileri alma `GetProductsByCategoryID(categoryID)` yöntemi ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>


<span data-ttu-id="169ee-203">Sihirbazın son adım bize parametre s kaynağı ister şekilde SELECT sekmede seçilen yöntemi bir parametre bekler.</span><span class="sxs-lookup"><span data-stu-id="169ee-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="169ee-204">Parametre kaynak aşağı açılan listesi denetimine ayarlayın ve seçin `Categories` ControlId aşağı açılan listeden denetim.</span><span class="sxs-lookup"><span data-stu-id="169ee-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="169ee-205">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-205">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="169ee-206">[![Kategoriler DropDownList adlı kullanıcı, Categoryıd'si parametresi kaynağı olarak kullanın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="169ee-207">**Şekil 11**: kullanım `Categories` DropDownList kaynağı olarak `categoryID` parametre ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>


<span data-ttu-id="169ee-208">ObjectDataSource Sihirbazı tamamladığınızda, Visual Studio BoundFields ve bir CheckBoxField ürün veri alanların her biri için ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="169ee-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="169ee-209">Bu alanların uygun gördüğünüz şekilde özelleştirmek çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="169ee-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="169ee-210">Bir tarayıcı aracılığıyla sayfasını ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="169ee-210">Visit the page through a browser.</span></span> <span data-ttu-id="169ee-211">İçecekler kategorisini seçili sayfa ve kılavuzunda listelenen ilgili ürünler ziyaret ederken.</span><span class="sxs-lookup"><span data-stu-id="169ee-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="169ee-212">Şekil 12 olarak alternatif bir kategori için aşağı açılan liste değiştirme gösterir, geri gönderimin neden olur ve yeni seçili kategorinin ürünlerle kılavuz yeniden yükler.</span><span class="sxs-lookup"><span data-stu-id="169ee-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>


<span data-ttu-id="169ee-213">[![Üretmek kategori ürünleri görüntülenir](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="169ee-214">**Şekil 12**: üretmek kategorideki ürünleri görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>


## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="169ee-215">5. adım: bir saklı yordam s deyimleri bir işlem kapsamı içinde sarmalama</span><span class="sxs-lookup"><span data-stu-id="169ee-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="169ee-216">İçinde [kaydırma veritabanı değişiklikleri bir işlem içinde](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) biz açıklanan teknikleri bir işlem kapsamı içinde veritabanı değişikliği bildirimlerini bir dizi gerçekleştirmek için öğretici.</span><span class="sxs-lookup"><span data-stu-id="169ee-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="169ee-217">Bir işlem şemsiyesi ya da yapılan değişiklikler tüm başarılı geri çağırma veya tüm başarısız, kararlılık güvence altına alır.</span><span class="sxs-lookup"><span data-stu-id="169ee-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="169ee-218">İşlemleri kullanma için teknikler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="169ee-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="169ee-219">Sınıflarda kullanarak `System.Transactions` ad alanı</span><span class="sxs-lookup"><span data-stu-id="169ee-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="169ee-220">Veri erişim katmanı kullanmalarına ADO.NET sınıflarını gibi `SqlTransaction`, ve</span><span class="sxs-lookup"><span data-stu-id="169ee-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="169ee-221">Saklı yordam içinde doğrudan T-SQL işlem komut ekleme</span><span class="sxs-lookup"><span data-stu-id="169ee-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="169ee-222">*Kaydırma veritabanı değişiklikleri bir işlem içinde* Öğreticisi kullanılan ADO.NET sınıflarını DAL.</span><span class="sxs-lookup"><span data-stu-id="169ee-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="169ee-223">Bu öğreticinin geri kalanında bir saklı yordam içinde T-SQL komutları kullanarak bir işlem yönetme inceler.</span><span class="sxs-lookup"><span data-stu-id="169ee-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="169ee-224">El ile başlatma, yürütme ve bir işlemin geri alınması için üç anahtar SQL komutları şunlardır `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, ve `ROLLBACK TRANSACTION`sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="169ee-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="169ee-225">ADO.NET yaklaşımda ihtiyacımız aşağıdaki desen uygulamak için bir saklı yordam içinde hareketleri kullanırken ister:</span><span class="sxs-lookup"><span data-stu-id="169ee-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="169ee-226">Bir işlem başlangıcını gösterir.</span><span class="sxs-lookup"><span data-stu-id="169ee-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="169ee-227">İşlem oluşturan SQL deyimlerini yürütün.</span><span class="sxs-lookup"><span data-stu-id="169ee-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="169ee-228">Adım 2 ', geri alma işlemi deyimleri herhangi birinde bir hata varsa.</span><span class="sxs-lookup"><span data-stu-id="169ee-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="169ee-229">Adım 2'deyimleri tümünün hatasız tamamlarsanız, işlem uygulayın.</span><span class="sxs-lookup"><span data-stu-id="169ee-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="169ee-230">Bu desen T-SQL söz dizimi aşağıdaki şablonu kullanarak uygulanabilir:</span><span class="sxs-lookup"><span data-stu-id="169ee-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="169ee-231">Şablon tanımlayarak başlatır bir `TRY...CATCH` SQL Server 2005'e yeni bir yapı bloğu.</span><span class="sxs-lookup"><span data-stu-id="169ee-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="169ee-232">İle gibi `Try...Catch` Visual Basic'te, SQL engeller `TRY...CATCH` bloğu yürütür deyimlerinde `TRY` bloğu.</span><span class="sxs-lookup"><span data-stu-id="169ee-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="169ee-233">Herhangi bir deyimle hata geçirirse denetimi için hemen aktarılır `CATCH` bloğu.</span><span class="sxs-lookup"><span data-stu-id="169ee-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="169ee-234">SQL deyimleri bu oluşma şekli işlem yürütülürken hata varsa `COMMIT TRANSACTION` deyimi değişiklikleri kaydeder ve işlem tamamlar.</span><span class="sxs-lookup"><span data-stu-id="169ee-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="169ee-235">Ancak, deyimlerden bir hatayla sonuçlanırsa, `ROLLBACK TRANSACTION` içinde `CATCH` blok veritabanı işlem başlamadan önce durumuna döndürür.</span><span class="sxs-lookup"><span data-stu-id="169ee-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="169ee-236">Saklı yordamı kullanarak bir hata da başlatır [RAISERROR komutu](https://msdn.microsoft.com/en-us/library/ms178592.aspx), hangi neden bir `SqlException` uygulamada oluşturulması için.</span><span class="sxs-lookup"><span data-stu-id="169ee-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/en-us/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="169ee-237">Bu yana `TRY...CATCH` blok SQL Server 2005'e yeni, Microsoft SQL Server'ın eski sürümlerini kullanıyorsanız, yukarıdaki şablonu çalışmaz.</span><span class="sxs-lookup"><span data-stu-id="169ee-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="169ee-238">SQL Server 2005 kullanmıyorsanız başvurun [SQL Server saklı yordamlar yönetme işlemlerinde](http://www.4guysfromrolla.com/webtech/080305-1.shtml) SQL Server'ın diğer sürümlerinde çalışır bir şablon.</span><span class="sxs-lookup"><span data-stu-id="169ee-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>


<span data-ttu-id="169ee-239">S somut bir örneğe bakın sağlar.</span><span class="sxs-lookup"><span data-stu-id="169ee-239">Let s look at a concrete example.</span></span> <span data-ttu-id="169ee-240">Arasında bir yabancı anahtar kısıtlaması var. `Categories` ve `Products` tabloları, yani, her `CategoryID` alanındaki `Products` tablo eşlenmesi için bir `CategoryID` değeri `Categories` tablo.</span><span class="sxs-lookup"><span data-stu-id="169ee-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="169ee-241">Ürünler, ilişkili bir kategori silme girişimi gibi bu kısıtlamayı ihlal ediyor herhangi bir eylem bir yabancı anahtar kısıtlaması ihlaline neden oluyor.</span><span class="sxs-lookup"><span data-stu-id="169ee-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="169ee-242">Bunu doğrulamak için ikili veri bölümü ile çalışma güncelleştirme ve silme Varolan ikili verileri örnekte yeniden ziyaret (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="169ee-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="169ee-243">(Bkz. Şekil 13) düzenleme ve silme düğmeleri birlikte sistemindeki her kategori bu sayfada listelenir, ancak ürünler - Meşrubat gibi-ilişkili olan bir kategori silmeye çalışırsanız silme bir yabancı anahtar kısıtlaması ihlali nedeniyle başarısız (Şekil 14 bakın).</span><span class="sxs-lookup"><span data-stu-id="169ee-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>


<span data-ttu-id="169ee-244">[![Her kategori düzenleme ve silme düğmeleri ile GridView görüntülenir](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="169ee-245">**Şekil 13**: her kategori düzenleme ve silme düğmeleri ile GridView görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>


<span data-ttu-id="169ee-246">[![Var olan ürünler sahip bir kategori silinemiyor](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="169ee-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="169ee-247">**Şekil 14**: var olan ürünler sahip bir kategori silemezsiniz ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="169ee-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>


<span data-ttu-id="169ee-248">Ancak, biz olup bunların ürünleri ilişkilendirdiğiniz bağımsız olarak silinmesi için kategoriler izin vermek istediğiniz düşünün.</span><span class="sxs-lookup"><span data-stu-id="169ee-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="169ee-249">Bir kategori ürünlerle izin silinmesi, aynı zamanda mevcut ürünlerinden silmek istediğimizi düşünün (yalnızca ürünlerinden ayarlamak için başka bir seçenek olabilir ancak `CategoryID` değerler `NULL`).</span><span class="sxs-lookup"><span data-stu-id="169ee-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="169ee-250">Bu işlevsellik, yabancı anahtar kısıtlaması cascade kurallarla uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="169ee-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="169ee-251">Alternatif olarak, biz kabul eden bir saklı yordam oluşturabilirsiniz bir `@CategoryID` giriş parametresi ve çağrıldığında, tüm ilişkili ürünleri ve belirtilen kategori açıkça siler.</span><span class="sxs-lookup"><span data-stu-id="169ee-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="169ee-252">Bu tür bir saklı yordam bizim ilk teşebbüs aşağıdakine benzeyebilir:</span><span class="sxs-lookup"><span data-stu-id="169ee-252">Our first attempt at such a stored procedure might look like the following:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="169ee-253">Bu kesinlikle ilişkili ürünleri ve kategori silinmesine neden olur, ancak, bunu bir işlem şemsiyesi yapmaz.</span><span class="sxs-lookup"><span data-stu-id="169ee-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="169ee-254">Olduğundan başka bir yabancı anahtar kısıtlaması düşünün `Categories` belirli bir silinmesini engellemek `@CategoryID` değeri.</span><span class="sxs-lookup"><span data-stu-id="169ee-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="169ee-255">Kategori Sil denemeden önce böyle bir durumda ürünlerin tamamı silineceğini sorunudur.</span><span class="sxs-lookup"><span data-stu-id="169ee-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="169ee-256">Hala başka bir tablo kayıtlarında ilişkili olduğundan kategori kalan sırada bu tür bir kategori için bu saklı yordam tüm ürünlerinde kaldırmanız net sonucudur.</span><span class="sxs-lookup"><span data-stu-id="169ee-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="169ee-257">Saklı yordamı bir işlem kapsamı içinde ancak silmeleri Sarmalanan varsa `Products` tablo geri silinemedi karşısında `Categories`.</span><span class="sxs-lookup"><span data-stu-id="169ee-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="169ee-258">İkisi arasındaki kararlılık güvence altına almak için aşağıdaki saklı yordamı komut dosyası bir işlem kullanır `DELETE` deyimleri:</span><span class="sxs-lookup"><span data-stu-id="169ee-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="169ee-259">Eklemek için bir dakikanızı ayırın `Categories_Delete` saklı yordamı Northwind veritabanına.</span><span class="sxs-lookup"><span data-stu-id="169ee-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="169ee-260">Geri saklı yordamlar bir veritabanına ekleme hakkında yönergeler için adım 1'e bakın.</span><span class="sxs-lookup"><span data-stu-id="169ee-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="169ee-261">6. adım: Güncelleştirme`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="169ee-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="169ee-262">Hedefteki sırasında eklediğimiz `Categories_Delete` DAL veritabanına saklı yordam şu anda silme gerçekleştirmek için geçici SQL deyimlerini kullanacak şekilde yapılandırıldı.</span><span class="sxs-lookup"><span data-stu-id="169ee-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="169ee-263">Güncelleştirmek ihtiyacımız `CategoriesTableAdapter` ve kullanmak için talimatını `Categories_Delete` yerine saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="169ee-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="169ee-264">Bu öğreticide daha önce biz birlikte çalıştığınız `NorthwindWithSprocs` veri kümesi.</span><span class="sxs-lookup"><span data-stu-id="169ee-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="169ee-265">Veri kümesi yalnızca tek bir varlık vardır ancak bu `ProductsDataTable`, ve kategorileri ile çalışması gerekir.</span><span class="sxs-lookup"><span data-stu-id="169ee-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="169ee-266">Bu nedenle, Bu öğretici için başvuran veri erişim katmanı ı m hakkında konuşurken kalanı için `Northwind` veri kümesi, ilk olarak oluşturduğumuz bir [veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-vb.md) Öğreticisi.</span><span class="sxs-lookup"><span data-stu-id="169ee-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>


<span data-ttu-id="169ee-267">Açık Northwind veri kümesini seçin `CategoriesTableAdapter`ve Özellikler penceresine gidin.</span><span class="sxs-lookup"><span data-stu-id="169ee-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="169ee-268">Özellikler penceresi listeleri `InsertCommand`, `UpdateCommand`, `DeleteCommand`, ve `SelectCommand` TableAdapter yanı sıra tarafından adını ve bağlantı bilgilerini kullanılır.</span><span class="sxs-lookup"><span data-stu-id="169ee-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="169ee-269">Genişletme `DeleteCommand` ayrıntılarını görmek için özellik.</span><span class="sxs-lookup"><span data-stu-id="169ee-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="169ee-270">Şekil 15 gösterildiği gibi `DeleteCommand` s `ComamndType` özellik metin gönderilecek bildirir metin olarak ayarlanmış `CommandText` özelliği geçici SQL sorgusu olarak.</span><span class="sxs-lookup"><span data-stu-id="169ee-270">As Figure 15 shows, the `DeleteCommand` s `ComamndType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>


![Özellikler penceresinde özelliklerini görüntülemek için Tasarımcısı'nda CategoriesTableAdapter seçin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="169ee-272">**Şekil 15**: seçin `CategoriesTableAdapter` Özellikler penceresinde özelliklerini görüntülemek için Tasarımcısı'nda</span><span class="sxs-lookup"><span data-stu-id="169ee-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>


<span data-ttu-id="169ee-273">Bu ayarları değiştirmek için Özellikler penceresinde (DeleteCommand) metni seçin ve aşağı açılan listeden (yeni) seçin.</span><span class="sxs-lookup"><span data-stu-id="169ee-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="169ee-274">Bu genişletme ayarları için temizleyecek `CommandText`, `CommandType`, ve `Parameters` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="169ee-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="169ee-275">Ardından, ayarlayın `CommandType` özelliğine `StoredProcedure` ve saklı yordam için adına yazın `CommandText` (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="169ee-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="169ee-276">Özelliklerin şu sırayla - ilk girdiğinizden emin olun, `CommandType` ve ardından `CommandText` -Visual Studio otomatik olarak parametreler koleksiyonu doldurur.</span><span class="sxs-lookup"><span data-stu-id="169ee-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="169ee-277">Bu sırada bu özellikleri girmezseniz aracılığıyla parametreler koleksiyonu Düzenleyicisi parametreleri el ile eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="169ee-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="169ee-278">Her iki durumda da, parametreler koleksiyonu Düzenleyicisi yukarı doğru parametre ayarları değişiklikler (bkz. Şekil 16) yapılmıştır doğrulamak için duruma getirmek için parametreleri özelliğinde üç noktaya tıklayın akıllıca s.</span><span class="sxs-lookup"><span data-stu-id="169ee-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="169ee-279">İletişim kutusunda herhangi bir parametre görmüyorsanız eklemek `@CategoryID` parametresi el ile (eklemek gerekmez `@RETURN_VALUE` parametresi).</span><span class="sxs-lookup"><span data-stu-id="169ee-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>


![Parametreleri ayarların doğru olduğundan emin olun](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="169ee-281">**Şekil 16**: parametreleri ayarların doğru olduğundan emin olun</span><span class="sxs-lookup"><span data-stu-id="169ee-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>


<span data-ttu-id="169ee-282">DAL güncelleştirilmiş sonra bir kategori silindiğinde otomatik olarak tüm ilişkili ürünlerinde silin ve bir işlem şemsiyesi bunu.</span><span class="sxs-lookup"><span data-stu-id="169ee-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="169ee-283">Bunu doğrulamak için güncelleştirme ve silme Varolan ikili veri sayfasına dönün ve kategorilerden birini Sil düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="169ee-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="169ee-284">Tek tek bir tıklatmayla fare, kategori ve tüm ilişkili ürünlerinde silinir.</span><span class="sxs-lookup"><span data-stu-id="169ee-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="169ee-285">Sınama önce `Categories_Delete` ürünleri seçilen kategori yanı sıra sayısı silecek, saklı yordam, olabilir, veritabanının bir yedek kopyasının akıllıca.</span><span class="sxs-lookup"><span data-stu-id="169ee-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="169ee-286">Kullanıyorsanız `NORTHWND.MDF` veritabanını `App_Data`, yalnızca Visual Studio'yu kapatın ve MDF ve LDF dosyalarını kopyalayın `App_Data` başka bir klasör için.</span><span class="sxs-lookup"><span data-stu-id="169ee-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="169ee-287">İşlevselliğini test etme sonra veritabanını Visual Studio kapatarak geri yükleyebilirsiniz ve geçerli MDF ve LDF değiştirme dosyaları `App_Data` yedek kopyaları ile.</span><span class="sxs-lookup"><span data-stu-id="169ee-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>


## <a name="summary"></a><span data-ttu-id="169ee-288">Özet</span><span class="sxs-lookup"><span data-stu-id="169ee-288">Summary</span></span>

<span data-ttu-id="169ee-289">TableAdapter s Sihirbazı otomatik olarak saklı yordamlar bize oluşturur, ancak ne zaman biz zaten oluşturulmuş böyle saklı yordamları veya bunları el ile veya diğer araçları ile bunun yerine oluşturmak istediğiniz zamanlar vardır.</span><span class="sxs-lookup"><span data-stu-id="169ee-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="169ee-290">Bu tür senaryolara yer vermek için TableAdapter varolan bir saklı yordamı işaret edecek şekilde de yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="169ee-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="169ee-291">Bu öğreticide saklı yordamlar Visual Studio ortamı ile bir veritabanını el ile ekleyin ve bu saklı yordamları TableAdapter s yöntemleri wire inceledik.</span><span class="sxs-lookup"><span data-stu-id="169ee-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="169ee-292">Biz de T-SQL komutlarını ve komut dosyası düzeni başlatma, yürütme ve işlemlerin bir saklı yordam içinde geri kullanılan incelendi.</span><span class="sxs-lookup"><span data-stu-id="169ee-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="169ee-293">Mutluluk programlama!</span><span class="sxs-lookup"><span data-stu-id="169ee-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="169ee-294">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="169ee-294">About the Author</span></span>

<span data-ttu-id="169ee-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar ve yedi ASP/ASP.NET books kurucusu, [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileri ile bu yana 1998 çalışma.</span><span class="sxs-lookup"><span data-stu-id="169ee-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="169ee-296">Tan bağımsız Danışman, eğitmen ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="169ee-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="169ee-297">En son kendi defteri [ *kendi öğretmek kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="169ee-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="169ee-298">Kendisi üzerinde erişilebilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) veya kendi blog hangi adresinde bulunabilir [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="169ee-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="169ee-299">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="169ee-299">Special Thanks To</span></span>

<span data-ttu-id="169ee-300">Bu öğretici seri pek çok yararlı gözden geçirenler tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="169ee-300">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="169ee-301">Bu öğretici için sağlama gözden geçirenler Hilton Geisenow, S ren Jacob Lauritsen ve Teresa Murphy yoktu.</span><span class="sxs-lookup"><span data-stu-id="169ee-301">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="169ee-302">My yaklaşan MSDN makaleleri gözden geçirme ilginizi çekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="169ee-302">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="169ee-303">Öyleyse, bana bir satırında bırakma [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="169ee-303">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="169ee-304">[Önceki](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[sonraki](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="169ee-304">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
