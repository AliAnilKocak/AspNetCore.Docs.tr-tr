---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Crank ile SignalR bağlantı yoğunluğu | Microsoft Docs
author: tfitzmac
description: Crank ile SignalR bağlantı yoğunluğu
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/22/2015
ms.topic: article
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
ms.technology: dotnet-signalr
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: c4ca8e368c8b722cc81ae7367140fd22f6fc7fd1
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/03/2018
ms.locfileid: "37367832"
---
<a name="signalr-connection-density-testing-with-crank"></a><span data-ttu-id="f1b25-103">Crank ile SignalR bağlantı yoğunluğu</span><span class="sxs-lookup"><span data-stu-id="f1b25-103">SignalR Connection Density Testing with Crank</span></span>
====================
<span data-ttu-id="f1b25-104">tarafından [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="f1b25-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="f1b25-105">Bu makalede, bir uygulama birden çok sanal istemcileri ile test etmek için mili Aracı'nı kullanmayı açıklar.</span><span class="sxs-lookup"><span data-stu-id="f1b25-105">This article describes how to use the Crank tool to test an application with multiple simulated clients.</span></span>


<span data-ttu-id="f1b25-106">Uygulamanızı (ya da bir Azure web rolü, IIS veya Owın kullanarak şirket içinde barındırılan), barındırma ortamı içinde çalışır duruma geçtikten sonra yüksek düzeyde bağlantı yoğunluğu testi mili aracını kullanarak bir uygulamanın yanıt test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f1b25-106">Once your application is running in its hosting environment (either an Azure web role, IIS, or self-hosted using Owin), you can test application's response to a high level of connection density using the Crank tool.</span></span> <span data-ttu-id="f1b25-107">Barındırma ortamı, Internet Information Services (IIS) sunucu, bir Owın konak veya bir Azure web rolü olabilir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-107">The hosting environment can be an Internet Information Services (IIS) server, an Owin host, or an Azure web role.</span></span> <span data-ttu-id="f1b25-108">(Not: performans sayaçları kullanılabilir değil Azure App Service Web Apps üzerinde performans verilerini öğesinden bir bağlantı yoğunluğu testi almanız mümkün olmayacak şekilde.)</span><span class="sxs-lookup"><span data-stu-id="f1b25-108">(Note: Performance counters are not available on Azure App Service Web Apps, so you will not be able to get performance data from a connection density test.)</span></span>

<span data-ttu-id="f1b25-109">Bağlantı yoğunluğu testi bir sunucuda kurulabilecek eş zamanlı TCP bağlantılarını sayısını ifade eder.</span><span class="sxs-lookup"><span data-stu-id="f1b25-109">Connection Density refers to the number of simultaneous TCP connections that can be established on a server.</span></span> <span data-ttu-id="f1b25-110">Her TCP bağlantısı kendi ek yüke neden olur ve çok sayıda boşta kalan bağlantıların açma sonunda bir bellek sorunu oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="f1b25-110">Each TCP connection incurs its own overhead, and opening a large number of idle connections will eventually create a memory bottleneck.</span></span>

<span data-ttu-id="f1b25-111">[SignalR codebase](https://github.com/signalr/signalr) adında bir yük testi araç içerir **Crank**.</span><span class="sxs-lookup"><span data-stu-id="f1b25-111">[The SignalR codebase](https://github.com/signalr/signalr) includes a load-testing tool called **Crank**.</span></span> <span data-ttu-id="f1b25-112">En son sürümünü mili bulunabilir [geliştirme dalını](https://github.com/SignalR/signalr/tree/dev) GitHub üzerinde.</span><span class="sxs-lookup"><span data-stu-id="f1b25-112">The latest version of Crank can be found in [the Dev branch](https://github.com/SignalR/signalr/tree/dev) on GitHub.</span></span> <span data-ttu-id="f1b25-113">Bir Zip arşivi signalr geliştirme dalı codebase indirebileceğiniz [burada](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="f1b25-113">You can download a Zip archive of the Dev branch of the SignalR codebase [here](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span>

<span data-ttu-id="f1b25-114">Mili tam olarak sunucunun bellek saturate için sunucu donanımına olası boşta kalan bağlantıların toplam sayısını hesaplamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-114">Crank may be used to fully saturate the server's memory in order to calculate the total number of idle connections possible on the server hardware.</span></span> <span data-ttu-id="f1b25-115">Alternatif olarak, aynı zamanda mili yük testi için sunucunun belirli bir miktarda bellek baskısı altında belirli bir sayısı veya belirli bellek eşiğini ulaşılana kadar bağlantıları ramping kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f1b25-115">Alternatively, you may also use Crank to load test the server under a certain amount of memory pressure, by ramping up connections until a specific count or a specific memory threshold is reached.</span></span>

<span data-ttu-id="f1b25-116">Test ederken, uzak istemci herhangi bir yarışmaya kaynakları (yani TCP bağlantıları ve bellek gibi) önlemek önemlidir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-116">When testing, it is important to use remote client(s) to avoid any competition for resources (i.e., TCP connections and memory).</span></span> <span data-ttu-id="f1b25-117">Bunlar sunucunun tam kapasitesi (bellek veya CPU) erişmesini engelleyebilir. tüm performans sorunlarını vpn'den emin olmak için istemci izleme.</span><span class="sxs-lookup"><span data-stu-id="f1b25-117">Monitor the client(s) to ensure that they are not hitting any bottlenecks that may prevent the server from reaching its full capacity (memory or CPU).</span></span> <span data-ttu-id="f1b25-118">Tam sunucu iş yükü için istemcilerin sayısını artırmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-118">You may need to increase the number of clients in order to fully load the server.</span></span>

### <a name="running-a-connection-density-test"></a><span data-ttu-id="f1b25-119">Bir bağlantı yoğunluğu testi çalıştırma</span><span class="sxs-lookup"><span data-stu-id="f1b25-119">Running a Connection Density Test</span></span>

<span data-ttu-id="f1b25-120">Bu bölümde bir SignalR uygulama bağlantı yoğunluğu testi çalıştırmak için gereken adımlar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="f1b25-120">This section describes the steps needed to run a connection density test on a SignalR application.</span></span>

1. <span data-ttu-id="f1b25-121">İndirin ve derleyin [geliştirme dalını signalr codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="f1b25-121">Download and build the [Dev branch of the SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span> <span data-ttu-id="f1b25-122">Bir komut istemi'nde gidin &lt;proje dizini&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="f1b25-122">In a command prompt, navigate to &lt;project directory&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span></span>
2. <span data-ttu-id="f1b25-123">Uygulamanızı, hedeflenen barındırma ortamına dağıtın.</span><span class="sxs-lookup"><span data-stu-id="f1b25-123">Deploy your application to its intended hosting environment.</span></span> <span data-ttu-id="f1b25-124">Uygulamanızın kullandığı uç noktasını not edin; Örneğin, oluşturulan uygulamadaki [Başlarken Öğreticisi](../getting-started/tutorial-getting-started-with-signalr.md), uç nokta `http://<yourhost>:8080/signalr`.</span><span class="sxs-lookup"><span data-stu-id="f1b25-124">Make a note of the endpoint that your application uses; for example, in the application created in the [Getting Started tutorial](../getting-started/tutorial-getting-started-with-signalr.md), the endpoint is `http://<yourhost>:8080/signalr`.</span></span>
3. <span data-ttu-id="f1b25-125">Yükleme [SignalR performans sayaçları](signalr-performance.md#perfcounters) sunucusunda.</span><span class="sxs-lookup"><span data-stu-id="f1b25-125">Install [SignalR performance counters](signalr-performance.md#perfcounters) on the server.</span></span> <span data-ttu-id="f1b25-126">Uygulamanız Azure üzerinde çalışıyorsa, bkz. [bir Azure Web rolünde SignalR performans sayaçları kullanarak](using-signalr-performance-counters-in-an-azure-web-role.md).</span><span class="sxs-lookup"><span data-stu-id="f1b25-126">If your application is running on Azure, see [Using SignalR Performance Counters in an Azure Web Role](using-signalr-performance-counters-in-an-azure-web-role.md).</span></span>

<span data-ttu-id="f1b25-127">İçinde indirilen bir kod temelinde oluşturulan ve performans sayaçları, konakta yüklü sonra mili komut satırı aracı bulunabilir `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` klasör.</span><span class="sxs-lookup"><span data-stu-id="f1b25-127">Once you've downloaded and built the codebase, and installed performance counters on your host, the Crank command-line tool can be found in the `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` folder.</span></span>

<span data-ttu-id="f1b25-128">Mili aracı için kullanılabilir seçenekler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="f1b25-128">Available options for the Crank tool include:</span></span>

- <span data-ttu-id="f1b25-129">**/?** : Yardım ekranı gösterilir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-129">**/?**: Shows the help screen.</span></span> <span data-ttu-id="f1b25-130">Kullanılabilir seçenekler de görüntülenir **Url** parametresi atlanırsa.</span><span class="sxs-lookup"><span data-stu-id="f1b25-130">The available options are also displayed if the **Url** parameter is omitted.</span></span>
- <span data-ttu-id="f1b25-131">**/ Url**: SignalR bağlantıları için URL.</span><span class="sxs-lookup"><span data-stu-id="f1b25-131">**/Url**: The URL for SignalR connections.</span></span> <span data-ttu-id="f1b25-132">Bu parametre gereklidir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-132">This parameter is required.</span></span> <span data-ttu-id="f1b25-133">Bir SignalR uygulama için varsayılan eşlemeyi kullanarak yolun içinde sona erecek "/ signalr".</span><span class="sxs-lookup"><span data-stu-id="f1b25-133">For a SignalR application using the default mapping, the path will end in "/signalr".</span></span>
- <span data-ttu-id="f1b25-134">**/ Aktarım**: kullanılan taşıma adı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-134">**/Transport**: The name of the transport used.</span></span> <span data-ttu-id="f1b25-135">Varsayılan `auto`, en iyi kullanılabilir protokol seçer.</span><span class="sxs-lookup"><span data-stu-id="f1b25-135">The default is `auto`, which will select the best available protocol.</span></span> <span data-ttu-id="f1b25-136">Seçenekleriniz `WebSockets`, `ServerSentEvents`, ve `LongPolling` (`ForeverFrame` yerine Internet Explorer kullanıldığı bir seçenek mili için bu yana .NET istemci değildir).</span><span class="sxs-lookup"><span data-stu-id="f1b25-136">Options include `WebSockets`, `ServerSentEvents`, and `LongPolling` (`ForeverFrame` is not an option for Crank, since the .NET client rather than Internet Explorer is used).</span></span> <span data-ttu-id="f1b25-137">SignalR taşımalar nasıl seçer? daha fazla bilgi için bkz: [aktarım ve geri dönüşler](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="f1b25-137">For more information on how SignalR selects transports, see [Transports and Fallbacks](../getting-started/introduction-to-signalr.md#transports).</span></span>
- <span data-ttu-id="f1b25-138">**/ BatchSize**: her toplu eklenen istemci sayısı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-138">**/BatchSize**: The number of clients added in each batch.</span></span> <span data-ttu-id="f1b25-139">Varsayılan değer 50'dir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-139">The default is 50.</span></span>
- <span data-ttu-id="f1b25-140">**/ ConnectInterval**: bağlantıları eklenmesi arasındaki milisaniye cinsinden aralığı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-140">**/ConnectInterval**: The interval in milliseconds between adding connections.</span></span> <span data-ttu-id="f1b25-141">Varsayılan değer 500'dür.</span><span class="sxs-lookup"><span data-stu-id="f1b25-141">The default is 500.</span></span>
- <span data-ttu-id="f1b25-142">**Bağlantı**: yük testi uygulama için kullanılan bağlantı sayısı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-142">**/Connections**: The number of connections used to load-test the application.</span></span> <span data-ttu-id="f1b25-143">Varsayılan değer 100. 000 ' dir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-143">The default is 100,000.</span></span>
- <span data-ttu-id="f1b25-144">**/ ConnectTimeout**: test çalışmasını iptal etmeden önce saniye cinsinden zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-144">**/ConnectTimeout**: The timeout in seconds before aborting the test.</span></span> <span data-ttu-id="f1b25-145">Varsayılan değer 300'dür.</span><span class="sxs-lookup"><span data-stu-id="f1b25-145">The default is 300.</span></span>
- <span data-ttu-id="f1b25-146">**MinServerMBytes**: ulaşmak için en düşük sunucu megabayt.</span><span class="sxs-lookup"><span data-stu-id="f1b25-146">**MinServerMBytes**: The minimum server megabytes to reach.</span></span> <span data-ttu-id="f1b25-147">Varsayılan değer 500'dür.</span><span class="sxs-lookup"><span data-stu-id="f1b25-147">The default is 500.</span></span>
- <span data-ttu-id="f1b25-148">**SendBytes**: boyutu bayt cinsinden sunucuya gönderilen yük.</span><span class="sxs-lookup"><span data-stu-id="f1b25-148">**SendBytes**: The size of the payload sent to the server in bytes.</span></span> <span data-ttu-id="f1b25-149">Varsayılan değer 0'dır.</span><span class="sxs-lookup"><span data-stu-id="f1b25-149">The default is 0.</span></span>
- <span data-ttu-id="f1b25-150">**SendInterval**: sunucuya iletileri arasında geçen milisaniye cinsinden gecikme.</span><span class="sxs-lookup"><span data-stu-id="f1b25-150">**SendInterval**: The delay in milliseconds between messages to the server.</span></span> <span data-ttu-id="f1b25-151">Varsayılan değer 500'dür.</span><span class="sxs-lookup"><span data-stu-id="f1b25-151">The default is 500.</span></span>
- <span data-ttu-id="f1b25-152">**SendTimeout**: sunucuya ileti için milisaniye cinsinden zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-152">**SendTimeout**: The timeout in milliseconds for messages to the server.</span></span> <span data-ttu-id="f1b25-153">Varsayılan değer 300'dür.</span><span class="sxs-lookup"><span data-stu-id="f1b25-153">The default is 300.</span></span>
- <span data-ttu-id="f1b25-154">**ControllerUrl**: bir istemci ana bilgisayar denetleyicisi hub Url.</span><span class="sxs-lookup"><span data-stu-id="f1b25-154">**ControllerUrl**: The Url where one client will host a controller hub.</span></span> <span data-ttu-id="f1b25-155">Varsayılan olarak NULL'dur (denetleyici hub).</span><span class="sxs-lookup"><span data-stu-id="f1b25-155">The default is null (no controller hub).</span></span> <span data-ttu-id="f1b25-156">Denetleyici hub mili oturumu başladığında başlatıldı; Daha fazla kişi denetleyicisi hub'ı ve mili arasında yapılır.</span><span class="sxs-lookup"><span data-stu-id="f1b25-156">The controller hub is started when the Crank session starts; no further contact between the controller hub and Crank is made.</span></span>
- <span data-ttu-id="f1b25-157">**NumClients**: uygulamaya bağlanmak için sanal istemci sayısı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-157">**NumClients**: The number of simulated clients to connect to the application.</span></span> <span data-ttu-id="f1b25-158">Varsayılan biridir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-158">The default is one.</span></span>
- <span data-ttu-id="f1b25-159">**Günlük dosyası**: test çalıştırması için bir günlük dosyası için dosya adı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-159">**Logfile**: The filename for the logfile for the test run.</span></span> <span data-ttu-id="f1b25-160">Varsayılan, `crank.csv` değeridir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-160">The default is `crank.csv`.</span></span>
- <span data-ttu-id="f1b25-161">**SampleInterval**: performans sayacı Örnekler arasındaki milisaniye olarak süre.</span><span class="sxs-lookup"><span data-stu-id="f1b25-161">**SampleInterval**: The time in milliseconds between performance counter samples.</span></span> <span data-ttu-id="f1b25-162">Varsayılan değer 1000'dir.</span><span class="sxs-lookup"><span data-stu-id="f1b25-162">The default is 1000.</span></span>
- <span data-ttu-id="f1b25-163">**SignalRInstance**: sunucu üzerindeki performans sayaçları için örnek adı.</span><span class="sxs-lookup"><span data-stu-id="f1b25-163">**SignalRInstance**: The instance name for the performance counters on the server.</span></span> <span data-ttu-id="f1b25-164">Varsayılan istemci bağlantı durumu kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="f1b25-164">The default is to use the client connection state.</span></span>

### <a name="example"></a><span data-ttu-id="f1b25-165">Örnek</span><span class="sxs-lookup"><span data-stu-id="f1b25-165">Example</span></span>

<span data-ttu-id="f1b25-166">Aşağıdaki komutu adlı bir sitede sınayacak `pfsignalr` "ControllerHub" adlı bir hub ile bağlantı noktası 8080 üzerinde uygulama barındıran Azure üzerinde 100 bağlantı kullanarak.</span><span class="sxs-lookup"><span data-stu-id="f1b25-166">The following command will test a site called `pfsignalr` on Azure that hosts an application on port 8080 with a hub named "ControllerHub", using 100 connections.</span></span>

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`
