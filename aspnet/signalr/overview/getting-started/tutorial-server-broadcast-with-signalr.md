---
uid: signalr/overview/getting-started/tutorial-server-broadcast-with-signalr
title: 'Öğretici: SignalR 2 ile sunucu yayını | Microsoft Docs'
author: tdykstra
description: Bu öğreticide, ASP.NET SignalR 2 sunucu yayın işlevselliği sağlamak için kullanan bir web uygulaması oluşturma işlemi gösterilmektedir. Sunucu yayın anlamına gelir, commun...
ms.author: riande
ms.date: 10/13/2014
ms.assetid: 1568247f-60b5-4eca-96e0-e661fbb2b273
msc.legacyurl: /signalr/overview/getting-started/tutorial-server-broadcast-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: c2248e68b3c9411687ab6410f12ec85488fe0738
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41752790"
---
<a name="tutorial-server-broadcast-with-signalr-2"></a><span data-ttu-id="7ff08-104">Öğretici: SignalR 2 ile sunucu yayını</span><span class="sxs-lookup"><span data-stu-id="7ff08-104">Tutorial: Server Broadcast with SignalR 2</span></span>
====================
<span data-ttu-id="7ff08-105">tarafından [Tom Dykstra](https://github.com/tdykstra), [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="7ff08-105">by [Tom Dykstra](https://github.com/tdykstra), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="7ff08-106">Bu öğreticide, ASP.NET SignalR 2 sunucu yayın işlevselliği sağlamak için kullanan bir web uygulaması oluşturma işlemi gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-106">This tutorial shows how to create a web application that uses ASP.NET SignalR 2 to provide server broadcast functionality.</span></span> <span data-ttu-id="7ff08-107">Sunucu yayın istemcilere gönderilen iletişimleri sunucu tarafından başlatılır anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-107">Server broadcast means that communications sent to clients are initiated by the server.</span></span> <span data-ttu-id="7ff08-108">Bu senaryo, eşler arası senaryoları istemcilere iletişimler bir veya daha fazla istemcileri tarafından başlatılır, sohbet uygulamaları gibi daha farklı bir programlama yaklaşım gerektirir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-108">This scenario requires a different programming approach than peer-to-peer scenarios such as chat applications, in which communications sent to clients are initiated by one or more of the clients.</span></span>
> 
> <span data-ttu-id="7ff08-109">Bu öğreticide oluşturacağınız uygulama bir bandı yayın sunucusu işlevselliği için tipik bir senaryo benzetimini yapar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-109">The application that you'll create in this tutorial simulates a stock ticker, a typical scenario for server broadcast functionality.</span></span>
> 
> <span data-ttu-id="7ff08-110">Bu konu başlığında, başlangıçta Patrick Fletcher tarafından alınmaktadır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-110">This topic was originally written by Patrick Fletcher.</span></span>
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="7ff08-111">Bu öğreticide kullanılan yazılım sürümleri</span><span class="sxs-lookup"><span data-stu-id="7ff08-111">Software versions used in the tutorial</span></span>
> 
> 
> - [<span data-ttu-id="7ff08-112">Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="7ff08-112">Visual Studio 2013</span></span>](https://www.microsoft.com/visualstudio/eng/2013-downloads)
> - <span data-ttu-id="7ff08-113">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="7ff08-113">.NET 4.5</span></span>
> - <span data-ttu-id="7ff08-114">SignalR sürüm 2</span><span class="sxs-lookup"><span data-stu-id="7ff08-114">SignalR version 2</span></span>
>   
> 
> 
> ## <a name="using-visual-studio-2012-with-this-tutorial"></a><span data-ttu-id="7ff08-115">Bu öğreticide Visual Studio 2012 kullanarak</span><span class="sxs-lookup"><span data-stu-id="7ff08-115">Using Visual Studio 2012 with this tutorial</span></span>
> 
> 
> <span data-ttu-id="7ff08-116">Visual Studio 2012 bu öğreticiyle kullanmak için aşağıdakileri yapın:</span><span class="sxs-lookup"><span data-stu-id="7ff08-116">To use Visual Studio 2012 with this tutorial, do the following:</span></span>
> 
> - <span data-ttu-id="7ff08-117">Güncelleştirme, [Paket Yöneticisi](http://docs.nuget.org/docs/start-here/installing-nuget) en son sürüme.</span><span class="sxs-lookup"><span data-stu-id="7ff08-117">Update your [Package Manager](http://docs.nuget.org/docs/start-here/installing-nuget) to the latest version.</span></span>
> - <span data-ttu-id="7ff08-118">Yükleme [Web Platformu yükleyicisi](https://www.microsoft.com/web/downloads/platform.aspx).</span><span class="sxs-lookup"><span data-stu-id="7ff08-118">Install the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx).</span></span>
> - <span data-ttu-id="7ff08-119">Web Platformu Yükleyicisi'nde arama ve yükleme **ASP.NET ve Web Araçları 2013.1 Visual Studio 2012 için**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-119">In the Web Platform Installer, search for and install **ASP.NET and Web Tools 2013.1 for Visual Studio 2012**.</span></span> <span data-ttu-id="7ff08-120">Bu SignalR sınıflar için Visual Studio şablonları gibi yükleyecek **Hub**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-120">This will install Visual Studio templates for SignalR classes such as **Hub**.</span></span>
> - <span data-ttu-id="7ff08-121">Bazı şablonlar (gibi **OWIN başlangıç sınıfı**) kullanılabilir; olmayacaktır, bunlar için sınıf dosyası kullanın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-121">Some templates (such as **OWIN Startup Class**) will not be available; for these, use a Class file instead.</span></span>
> 
> 
> ## <a name="tutorial-versions"></a><span data-ttu-id="7ff08-122">Öğretici sürümleri</span><span class="sxs-lookup"><span data-stu-id="7ff08-122">Tutorial Versions</span></span>
> 
> <span data-ttu-id="7ff08-123">SignalR eski sürümleri hakkında daha fazla bilgi için bkz: [SignalR eski sürümleri](../older-versions/index.md).</span><span class="sxs-lookup"><span data-stu-id="7ff08-123">For information about earlier versions of SignalR, see [SignalR Older Versions](../older-versions/index.md).</span></span>
> 
> ## <a name="questions-and-comments"></a><span data-ttu-id="7ff08-124">Sorularınız ve yorumlarınız</span><span class="sxs-lookup"><span data-stu-id="7ff08-124">Questions and comments</span></span>
> 
> <span data-ttu-id="7ff08-125">Lütfen bu öğreticide sevmediğinizi nasıl ve ne sayfanın alt kısmındaki açıklamalarda geliştirebileceğimiz hakkında geri bildirim bırakın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-125">Please leave feedback on how you liked this tutorial and what we could improve in the comments at the bottom of the page.</span></span> <span data-ttu-id="7ff08-126">Öğretici için doğrudan ilgili olmayan sorularınız varsa, bunları gönderebilir [ASP.NET SignalR Forumu](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) veya [StackOverflow.com](http://stackoverflow.com/).</span><span class="sxs-lookup"><span data-stu-id="7ff08-126">If you have questions that are not directly related to the tutorial, you can post them to the [ASP.NET SignalR forum](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) or [StackOverflow.com](http://stackoverflow.com/).</span></span>


## <a name="overview"></a><span data-ttu-id="7ff08-127">Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="7ff08-127">Overview</span></span>

<span data-ttu-id="7ff08-128">Bu öğreticide, "düzenli aralıklarla göndermek" istediğiniz gerçek zamanlı uygulama temsilcisi bir bandı uygulaması oluşturduğunuzda veya yayın, sunucuya bağlanan tüm istemciler için bildirimler.</span><span class="sxs-lookup"><span data-stu-id="7ff08-128">In this tutorial, you'll create a stock ticker application that is representative of real-time applications in which you want to periodically "push," or broadcast, notifications from the server to all connected clients.</span></span> <span data-ttu-id="7ff08-129">Bu öğreticinin ilk bölümünde sıfırdan uygulama basitleştirilmiş bir sürümünü oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="7ff08-129">In the first part of this tutorial, you'll create a simplified version of that application from scratch.</span></span> <span data-ttu-id="7ff08-130">Öğreticinin geri kalanında, ek özellikler içeren bir NuGet paketini yükleyin ve bu özellikler için kodu gözden.</span><span class="sxs-lookup"><span data-stu-id="7ff08-130">In the remainder of the tutorial, you'll install a NuGet package that contains additional features, and review the code for those features.</span></span>

<span data-ttu-id="7ff08-131">Bu öğreticinin ilk bölümünde oluşturacağınız uygulama stok verileri içeren bir kılavuz görüntüler.</span><span class="sxs-lookup"><span data-stu-id="7ff08-131">The application that you'll build in the first part of this tutorial displays a grid with stock data.</span></span>

![StockTicker ilk sürümü](tutorial-server-broadcast-with-signalr/_static/image1.png)

<span data-ttu-id="7ff08-133">Düzenli aralıklarla sunucu rastgele hisse senedi fiyatlarına güncelleştirir ve tüm bağlı istemcileri güncelleştirmeleri gönderir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-133">Periodically the server randomly updates stock prices and pushes the updates to all connected clients.</span></span> <span data-ttu-id="7ff08-134">Tarayıcı sayıları ve sembolleri **değiştirme** ve **%** sütunları dinamik olarak değiştirme sunucudan yanıt bildirimleri.</span><span class="sxs-lookup"><span data-stu-id="7ff08-134">In the browser the numbers and symbols in the **Change** and **%** columns dynamically change in response to notifications from the server.</span></span> <span data-ttu-id="7ff08-135">Aynı URL'ye ek tarayıcılar açarsanız, bunların tümü aynı verilere ve verilere aynı değişiklikleri aynı anda gösterin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-135">If you open additional browsers to the same URL, they all show the same data and the same changes to the data simultaneously.</span></span>

<span data-ttu-id="7ff08-136">Bu öğreticide, aşağıdaki bölümleri içerir:</span><span class="sxs-lookup"><span data-stu-id="7ff08-136">This tutorial contains the following sections:</span></span>

- [<span data-ttu-id="7ff08-137">Önkoşulları</span><span class="sxs-lookup"><span data-stu-id="7ff08-137">Prerequisites</span></span>](#prerequisites)
- [<span data-ttu-id="7ff08-138">Proje oluşturma</span><span class="sxs-lookup"><span data-stu-id="7ff08-138">Create the project</span></span>](#createproject)
- [<span data-ttu-id="7ff08-139">Sunucu kodunu ayarlayın</span><span class="sxs-lookup"><span data-stu-id="7ff08-139">Set up the server code</span></span>](#server)
- [<span data-ttu-id="7ff08-140">İstemci kodunu ayarlayın</span><span class="sxs-lookup"><span data-stu-id="7ff08-140">Set up the client code</span></span>](#client)
- [<span data-ttu-id="7ff08-141">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="7ff08-141">Test the application</span></span>](#test)
- [<span data-ttu-id="7ff08-142">Günlüğe kaydetmeyi etkinleştirme</span><span class="sxs-lookup"><span data-stu-id="7ff08-142">Enable logging</span></span>](#enablelogging)
- [<span data-ttu-id="7ff08-143">Yükleme ve tam StockTicker örneği gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="7ff08-143">Install and review the full StockTicker sample</span></span>](#fullsample)
- [<span data-ttu-id="7ff08-144">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="7ff08-144">Next steps</span></span>](#nextsteps)

<span data-ttu-id="7ff08-145">[Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketini Visual Studio projesinde benzetimli örnek borsa uygulaması yükler.</span><span class="sxs-lookup"><span data-stu-id="7ff08-145">The [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package installs a sample simulated stock ticker application in a Visual Studio project.</span></span>

> [!NOTE]
> <span data-ttu-id="7ff08-146">Uygulama oluşturma adımlarında size çalışmak istemiyorsanız, yeni bir boş bir ASP.NET Web uygulaması projesinde SignalR.Sample paketini yükleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-146">If you don't want to work through the steps of building the application, you can install the SignalR.Sample package in a new Empty ASP.NET Web Application project.</span></span> <span data-ttu-id="7ff08-147">Bu öğreticide adımları gerçekleştirmeden NuGet paketi yüklerseniz **readme.txt dosyası içindeki yönergeleri izlemeniz gereken**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-147">If you install the NuGet package without performing the steps in this tutorial, **you must follow the instructions in the readme.txt file**.</span></span> <span data-ttu-id="7ff08-148">Paketi çalıştırmak için yüklenen paketteki ConfigureSignalR yöntemi çağıran bir OWIN başlangıç sınıfı eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-148">To run the package you need to add an OWIN startup class which calls the ConfigureSignalR method in the installed package.</span></span> <span data-ttu-id="7ff08-149">OWIN başlangıç sınıfı eklemezseniz bir hata alırsınız.</span><span class="sxs-lookup"><span data-stu-id="7ff08-149">You will receive an error if you do not add the OWIN startup class.</span></span>


<a id="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="7ff08-150">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="7ff08-150">Prerequisites</span></span>

<span data-ttu-id="7ff08-151">Başlamadan önce Visual Studio 2013 yüklü olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="7ff08-151">Before you start, make sure that you have Visual Studio 2013 installed on your computer.</span></span> <span data-ttu-id="7ff08-152">Visual Studio yoksa bkz [ASP.NET indirir](https://www.asp.net/downloads) ücretsiz Visual Studio 2013 Express alınamıyor.</span><span class="sxs-lookup"><span data-stu-id="7ff08-152">If you don't have Visual Studio, see [ASP.NET Downloads](https://www.asp.net/downloads) to get the free Visual Studio 2013 Express.</span></span>

<a id="createproject"></a>

## <a name="create-the-project"></a><span data-ttu-id="7ff08-153">Projeyi oluşturma</span><span class="sxs-lookup"><span data-stu-id="7ff08-153">Create the project</span></span>

1. <span data-ttu-id="7ff08-154">Gelen **dosya** menüsünü tıklatın **yeni proje**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-154">From the **File** menu, click **New Project**.</span></span>
2. <span data-ttu-id="7ff08-155">İçinde **yeni proje** iletişim kutusunda **C#** altında **şablonları** seçip **Web**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-155">In the **New Project** dialog box, expand **C#** under **Templates** and select **Web**.</span></span>
3. <span data-ttu-id="7ff08-156">Seçin **ASP.NET boş Web uygulaması** şablon, proje adı *SignalR.StockTicker*, tıklatıp **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-156">Select the **ASP.NET Empty Web Application** template, name the project *SignalR.StockTicker*, and click **OK**.</span></span>

    ![Yeni Proje iletişim kutusu](tutorial-server-broadcast-with-signalr/_static/image2.png)
4. <span data-ttu-id="7ff08-158">İçinde **yeni ASP.NET** proje penceresi, bırakın **boş** tıklatın ve seçili **proje oluştur**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-158">In the **New ASP.NET** Project window, leave **Empty** selected and click **Create Project**.</span></span>

    ![Yeni ASP proje iletişim kutusu](tutorial-server-broadcast-with-signalr/_static/image3.png)

<a id="server"></a>

## <a name="set-up-the-server-code"></a><span data-ttu-id="7ff08-160">Sunucu kodunu ayarlayın</span><span class="sxs-lookup"><span data-stu-id="7ff08-160">Set up the server code</span></span>

<span data-ttu-id="7ff08-161">Bu bölümde sunucuda çalışan kodu ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-161">In this section you set up the code that runs on the server.</span></span>

### <a name="create-the-stock-class"></a><span data-ttu-id="7ff08-162">Stok sınıfı oluşturma</span><span class="sxs-lookup"><span data-stu-id="7ff08-162">Create the Stock class</span></span>

<span data-ttu-id="7ff08-163">Depolama ve stok hakkında bilgi iletmek için kullanacağınız hisse senedi model sınıfı oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-163">You begin by creating the Stock model class that you'll use to store and transmit information about a stock.</span></span>

1. <span data-ttu-id="7ff08-164">Proje klasöründe yeni bir sınıf dosyası oluşturun, adlandırın *Stock.cs*ve sonra şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-164">Create a new class file in the project folder, name it *Stock.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample1.cs)]

    <span data-ttu-id="7ff08-165">' % S'sembolü (örneğin, Microsoft MSFT) ve fiyat, stocks oluştururken ayarladığınız iki özellikler verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-165">The two properties that you'll set when you create stocks are the Symbol (for example, MSFT for Microsoft) and the Price.</span></span> <span data-ttu-id="7ff08-166">Diğer özellikler, nasıl ve ne zaman fiyat ayarlamak bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-166">The other properties depend on how and when you set Price.</span></span> <span data-ttu-id="7ff08-167">Fiyat, ayarladığınız ilk kez yayıldığı DayOpen için.</span><span class="sxs-lookup"><span data-stu-id="7ff08-167">The first time you set Price, the value gets propagated to DayOpen.</span></span> <span data-ttu-id="7ff08-168">Ne zaman fiyatı, değişiklik kümesi ve YüzdeDeğişiklikleri özellik değerlerini hesaplanan sonraki kez DayOpen ile fiyatı arasındaki fark temel.</span><span class="sxs-lookup"><span data-stu-id="7ff08-168">Subsequent times when you set Price, the Change and PercentChange property values are calculated based on the difference between Price and DayOpen.</span></span>

### <a name="create-the-stockticker-and-stocktickerhub-classes"></a><span data-ttu-id="7ff08-169">StockTicker ve StockTickerHub sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="7ff08-169">Create the StockTicker and StockTickerHub classes</span></span>

<span data-ttu-id="7ff08-170">SignalR hub'ı API sunucusu istemci etkileşimi işlemek için kullanacaksınız.</span><span class="sxs-lookup"><span data-stu-id="7ff08-170">You'll use the SignalR Hub API to handle server-to-client interaction.</span></span> <span data-ttu-id="7ff08-171">SignalR hub'ı sınıfından türetilen StockTickerHub sınıfı bağlantıları ve yöntem çağrıları istemcilerinden gelen işler.</span><span class="sxs-lookup"><span data-stu-id="7ff08-171">A StockTickerHub class that derives from the SignalR Hub class will handle receiving connections and method calls from clients.</span></span> <span data-ttu-id="7ff08-172">Stok verileri korumak ve düzenli aralıklarla istemci bağlantıları bağımsız olarak fiyat güncelleştirmeleri tetiklemek için bir zamanlayıcı nesnesi çalıştırmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-172">You also need to maintain stock data and run a Timer object to periodically trigger price updates, independently of client connections.</span></span> <span data-ttu-id="7ff08-173">Hub örneği geçici olmadığından bu işlevler bir Hub sınıfta konulamaz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-173">You can't put these functions in a Hub class, because Hub instances are transient.</span></span> <span data-ttu-id="7ff08-174">Bir Hub örneği, bağlantılar ve istemciden sunucuya çağrılar gibi hub'ında her işlem için oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-174">A Hub class instance is created for each operation on the hub, such as connections and calls from the client to the server.</span></span> <span data-ttu-id="7ff08-175">Bu nedenle StockTicker ad, ayrı bir sınıf içinde çalıştırmak stok verileri tutar, fiyatları güncelleştirir ve fiyat güncelleştirmeleri yayınlar mekanizması vardır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-175">So the mechanism that keeps stock data, updates prices, and broadcasts the price updates has to run in a separate class, which you'll name StockTicker.</span></span>

![Yayın StockTicker gelen](tutorial-server-broadcast-with-signalr/_static/image5.png)

<span data-ttu-id="7ff08-177">Yalnızca her StockTickerHub örneğinden tekil StockTicker örneğe bir başvuru ayarlanacak ihtiyacınız olacak şekilde sunucuda çalıştırılacak StockTicker sınıfının bir örneğini istersiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-177">You only want one instance of the StockTicker class to run on the server, so you'll need to set up a reference from each StockTickerHub instance to the singleton StockTicker instance.</span></span> <span data-ttu-id="7ff08-178">Stok verileri içeren ve güncelleştirmeleri tetiklenir, ancak StockTicker Hub sınıfına değil çünkü istemcilere yayınlayabileceksiniz StockTicker sınıfı var.</span><span class="sxs-lookup"><span data-stu-id="7ff08-178">The StockTicker class has to be able to broadcast to clients because it has the stock data and triggers updates, but StockTicker is not a Hub class.</span></span> <span data-ttu-id="7ff08-179">SignalR hub'ı bağlantı kapsamı nesnesine bir başvuru almak, bu nedenle, StockTicker sınıfı vardır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-179">Therefore, the StockTicker class has to get a reference to the SignalR Hub connection context object.</span></span> <span data-ttu-id="7ff08-180">Bunu daha sonra SignalR bağlantı bağlam nesnesi istemcilere yayınlamak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-180">It can then use the SignalR connection context object to broadcast to clients.</span></span>

1. <span data-ttu-id="7ff08-181">İçinde **Çözüm Gezgini**, projeye sağ tıklayın ve tıklayın **Ekle | SignalR Hub sınıfı (v2)**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-181">In **Solution Explorer**, right-click the project and click **Add | SignalR Hub Class (v2)**.</span></span>
2. <span data-ttu-id="7ff08-182">Yeni hub'ı adı *StockTickerHub.cs*ve ardından **Ekle**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-182">Name the new hub *StockTickerHub.cs*, and then click **Add**.</span></span> <span data-ttu-id="7ff08-183">SignalR NuGet paketlerini projenize eklenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-183">SignalR NuGet packages will be added to your project.</span></span>
3. <span data-ttu-id="7ff08-184">Şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-184">Replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample2.cs)]

    <span data-ttu-id="7ff08-185">[Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) sınıfı, istemcilerin, sunucuya çağırabilir yöntemleri tanımlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-185">The [Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) class is used to define methods the clients can call on the server.</span></span> <span data-ttu-id="7ff08-186">Bir yöntem tanımladığınız: `GetAllStocks()`.</span><span class="sxs-lookup"><span data-stu-id="7ff08-186">You are defining one method: `GetAllStocks()`.</span></span> <span data-ttu-id="7ff08-187">Bir istemci sunucuya ilk kez bağlandığında, geçerli fiyatları ile stocks tümünün listesini almak için bu yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-187">When a client initially connects to the server, it will call this method to get a list of all of the stocks with their current prices.</span></span> <span data-ttu-id="7ff08-188">Yöntem zaman uyumlu yürütme ve dönüş `IEnumerable<Stock>` nedeniyle bellekten veri döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="7ff08-188">The method can execute synchronously and return `IEnumerable<Stock>` because it is returning data from memory.</span></span> <span data-ttu-id="7ff08-189">Yöntem bir veritabanı araması veya bir web hizmeti çağrısı gibi bir bekleme kapsayacaktır bir şey yaparak verileri almak sahip olduğu belirtirsiniz `Task<IEnumerable<Stock>>` zaman uyumsuz işleme etkinleştirmek için dönüş değeri.</span><span class="sxs-lookup"><span data-stu-id="7ff08-189">If the method had to get the data by doing something that would involve waiting, such as a database lookup or a web service call, you would specify `Task<IEnumerable<Stock>>` as the return value to enable asynchronous processing.</span></span> <span data-ttu-id="7ff08-190">Daha fazla bilgi için [ASP.NET SignalR Hubs API Kılavuzu - sunucu - zaman zaman uyumsuz olarak yürütülecek](../guide-to-the-api/hubs-api-guide-server.md#asyncmethods).</span><span class="sxs-lookup"><span data-stu-id="7ff08-190">For more information, see [ASP.NET SignalR Hubs API Guide - Server - When to execute asynchronously](../guide-to-the-api/hubs-api-guide-server.md#asyncmethods).</span></span>

    <span data-ttu-id="7ff08-191">İstemci üzerinde JavaScript kodunda Hub'ın nasıl başvurulacağını HubName özniteliğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-191">The HubName attribute specifies how the Hub will be referenced in JavaScript code on the client.</span></span> <span data-ttu-id="7ff08-192">Bu öznitelik kullanmazsanız, istemcideki varsayılan adı stockTickerHub bu durumda olabilecek bir sınıf adı ortası büyük küçük harfleri bir sürümü var.</span><span class="sxs-lookup"><span data-stu-id="7ff08-192">The default name on the client if you don't use this attribute is a camel-cased version of the class name, which in this case would be stockTickerHub.</span></span>

    <span data-ttu-id="7ff08-193">StockTicker sınıfı oluşturduğunuzda, daha sonra göreceğiniz üzere, bu sınıfın tekil örneğini statik örneği özelliğinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-193">As you'll see later when you create the StockTicker class, a singleton instance of that class is created in its static Instance property.</span></span> <span data-ttu-id="7ff08-194">Tekil örneğini StockTicker kaç adet istemcinin bağlanın veya bağlantıyı kesin ne olursa olsun bellekte kalır ve bu örneğe GetAllStocks metodu geçerli bir stok bilgilerini döndürmek için kullandığı olduğunu.</span><span class="sxs-lookup"><span data-stu-id="7ff08-194">That singleton instance of StockTicker remains in memory no matter how many clients connect or disconnect, and that instance is what the GetAllStocks method uses to return current stock information.</span></span>
4. <span data-ttu-id="7ff08-195">Proje klasöründe yeni bir sınıf dosyası oluşturun, adlandırın *StockTicker.cs*ve sonra şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-195">Create a new class file in the project folder, name it *StockTicker.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample3.cs)]

    <span data-ttu-id="7ff08-196">Birden çok iş parçacığı StockTicker kod'ın aynı örneğinin çalışacağı beri StockTicker sınıfı threadsafe olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-196">Since multiple threads will be running the same instance of StockTicker code, the StockTicker class has to be threadsafe.</span></span>

    ### <a name="storing-the-singleton-instance-in-a-static-field"></a><span data-ttu-id="7ff08-197">Statik bir alana tekil örneğini depolama</span><span class="sxs-lookup"><span data-stu-id="7ff08-197">Storing the singleton instance in a static field</span></span>

    <span data-ttu-id="7ff08-198">Statik kod başlatır \_örneğiyle sınıf ve bu örnek özelliği yedekleyen örneği alandır oluşturulabilir, sınıfın tek örneğine Oluşturucu, özel olarak işaretlendiğinden.</span><span class="sxs-lookup"><span data-stu-id="7ff08-198">The code initializes the static \_instance field that backs the Instance property with an instance of the class, and this is the only instance of the class that can be created, because the constructor is marked as private.</span></span> <span data-ttu-id="7ff08-199">[Yavaş başlatma](https://msdn.microsoft.com/library/dd997286.aspx) için kullanılan \_değildir ancak örnek oluşturma threadsafe olmasını sağlamak üzere performansı artırmak için örnek alanı.</span><span class="sxs-lookup"><span data-stu-id="7ff08-199">[Lazy initialization](https://msdn.microsoft.com/library/dd997286.aspx) is used for the \_instance field, not for performance reasons but to ensure that the instance creation is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample4.cs)]

    <span data-ttu-id="7ff08-200">StockTickerHub sınıfında daha önce anlatıldığı gibi bir istemci sunucuya her bağlandığında, ayrı bir iş parçacığı çalıştırırken StockTickerHub sınıfının yeni bir örneğini StockTicker.Instance statik özelliğinden StockTicker tekil örneğini alır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-200">Each time a client connects to the server, a new instance of the StockTickerHub class running in a separate thread gets the StockTicker singleton instance from the StockTicker.Instance static property, as you saw earlier in the StockTickerHub class.</span></span>

    ### <a name="storing-stock-data-in-a-concurrentdictionary"></a><span data-ttu-id="7ff08-201">Bir ConcurrentDictionary stok verileri depolama</span><span class="sxs-lookup"><span data-stu-id="7ff08-201">Storing stock data in a ConcurrentDictionary</span></span>

    <span data-ttu-id="7ff08-202">Oluşturucu başlatır \_stocks koleksiyonuyla bazı örnek stok verileri ve GetAllStocks stocks döndürür.</span><span class="sxs-lookup"><span data-stu-id="7ff08-202">The constructor initializes the \_stocks collection with some sample stock data, and GetAllStocks returns the stocks.</span></span> <span data-ttu-id="7ff08-203">Daha önce bahsettiğim gibi stocks Bu koleksiyonu bir sunucu yöntemi istemciler çağırabilirsiniz Hub sınıfta olan StockTickerHub.GetAllStocks tarafından sırayla döndürülür.</span><span class="sxs-lookup"><span data-stu-id="7ff08-203">As you saw earlier, this collection of stocks is in turn returned by StockTickerHub.GetAllStocks which is a server method in the Hub class that clients can call.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample5.cs)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample6.cs)]

    <span data-ttu-id="7ff08-204">Hisse koleksiyon olarak tanımlanan bir [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) türü için iş parçacığı güvenliği.</span><span class="sxs-lookup"><span data-stu-id="7ff08-204">The stocks collection is defined as a [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) type for thread safety.</span></span> <span data-ttu-id="7ff08-205">Alternatif olarak, kullanabileceğinizi bir [sözlük](https://msdn.microsoft.com/library/xfhwa508.aspx) nesne ve ona değişiklikler yaptığınızda sözlük açıkça kilitleme.</span><span class="sxs-lookup"><span data-stu-id="7ff08-205">As an alternative, you could use a [Dictionary](https://msdn.microsoft.com/library/xfhwa508.aspx) object and explicitly lock the dictionary when you make changes to it.</span></span>

    <span data-ttu-id="7ff08-206">Bu örnek uygulama için bu Tamam bellekte uygulama verilerini depolamak için ve StockTicker örneği çıkarıldığından, veri kaybına olur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-206">For this sample application, it's OK to store application data in memory and to lose the data when the StockTicker instance is disposed.</span></span> <span data-ttu-id="7ff08-207">Gerçek bir uygulamada bir veritabanı gibi bir arka uç veri deposu ile işe yarar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-207">In a real application you would work with a back-end data store such as a database.</span></span>

    ### <a name="periodically-updating-stock-prices"></a><span data-ttu-id="7ff08-208">Hisse senedi fiyatlarına düzenli aralıklarla güncelleştiriliyor</span><span class="sxs-lookup"><span data-stu-id="7ff08-208">Periodically updating stock prices</span></span>

    <span data-ttu-id="7ff08-209">Düzenli aralıklarla hisse senedi fiyatlarına rastgele olarak güncelleştiren yöntemleri çağıran bir zamanlayıcı nesnesi oluşturan Oluşturucu başlatır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-209">The constructor starts up a Timer object that periodically calls methods that update stock prices on a random basis.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample7.cs)]

    <span data-ttu-id="7ff08-210">UpdateStockPrices state parametresi null geçirir. Zamanlayıcı tarafından çağrılır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-210">UpdateStockPrices is called by the Timer, which passes in null in the state parameter.</span></span> <span data-ttu-id="7ff08-211">Fiyatlar güncelleştirmeden önce bir kilit alınmış \_updateStockPricesLock nesne.</span><span class="sxs-lookup"><span data-stu-id="7ff08-211">Before updating prices, a lock is taken on the \_updateStockPricesLock object.</span></span> <span data-ttu-id="7ff08-212">Kod, başka bir iş parçacığı zaten fiyatları güncelleştiriyor ve ardından listedeki her stoktaki TryUpdateStockPrice çağırır denetler.</span><span class="sxs-lookup"><span data-stu-id="7ff08-212">The code checks if another thread is already updating prices, and then it calls TryUpdateStockPrice on each stock in the list.</span></span> <span data-ttu-id="7ff08-213">TryUpdateStockPrice yöntemi hisse senedi fiyatının değiştirip değiştirmemeye karar verir ve değiştirmek için ne kadar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-213">The TryUpdateStockPrice method decides whether to change the stock price, and how much to change it.</span></span> <span data-ttu-id="7ff08-214">Hisse senedi fiyatının değişirse, hisse senedi fiyatı değişiklik bağlanan tüm istemciler için yayın için BroadcastStockPrice çağrılır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-214">If the stock price is changed, BroadcastStockPrice is called to broadcast the stock price change to all connected clients.</span></span>

    <span data-ttu-id="7ff08-215">\_UpdatingStockPrices bayrak olarak işaretlenmiş [geçici](https://msdn.microsoft.com/library/x13ttww7.aspx) threadsafe erişimi olmasını sağlamak için.</span><span class="sxs-lookup"><span data-stu-id="7ff08-215">The \_updatingStockPrices flag is marked as [volatile](https://msdn.microsoft.com/library/x13ttww7.aspx) to ensure that access to it is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample8.cs)]

    <span data-ttu-id="7ff08-216">Gerçek bir uygulamada TryUpdateStockPrice yöntemi fiyatı aramak için bir web hizmeti çağırırsınız; Bu kodda değişiklik rastgele bir rasgele sayı üreteci kullanır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-216">In a real application, the TryUpdateStockPrice method would call a web service to look up the price; in this code it uses a random number generator to make changes randomly.</span></span>

    ### <a name="getting-the-signalr-context-so-that-the-stockticker-class-can-broadcast-to-clients"></a><span data-ttu-id="7ff08-217">Böylece StockTicker sınıfı istemcilere yayınlayabilirsiniz SignalR bağlamı alma</span><span class="sxs-lookup"><span data-stu-id="7ff08-217">Getting the SignalR context so that the StockTicker class can broadcast to clients</span></span>

    <span data-ttu-id="7ff08-218">Fiyat değişiklikleri buraya StockTicker nesnesinde kaynaklı olduğundan bağlanan tüm istemciler updateStockPrice yöntemi çağırmak için gereken nesne budur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-218">Because the price changes originate here in the StockTicker object, this is the object that needs to call an updateStockPrice method on all connected clients.</span></span> <span data-ttu-id="7ff08-219">Bir Hub sınıfta bir API İstemci yöntemleri çağırmak için sahip olduğunuz, ancak StockTicker Hub sınıfından türemiyor ve herhangi bir Hub nesnesine bir başvuru yok.</span><span class="sxs-lookup"><span data-stu-id="7ff08-219">In a Hub class you have an API for calling client methods, but StockTicker does not derive from the Hub class and does not have a reference to any Hub object.</span></span> <span data-ttu-id="7ff08-220">Bu nedenle, bağlı istemciler için yayın için StockTickerHub sınıf için SignalR bağlam örneği alın ve istemcilerde yöntemleri çağırmak için kullanmaya StockTicker sınıfı vardır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-220">Therefore, in order to broadcast to connected clients, the StockTicker class has to get the SignalR context instance for the StockTickerHub class and use that to call methods on clients.</span></span>

    <span data-ttu-id="7ff08-221">Başvuran geçişleri oluşturucuya tekil sınıfı örneğini oluşturduğunda, kod SignalR bağlamı için bir başvuru alır ve isteğe bağlı olarak Oluşturucu istemciler özelliğinde koyar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-221">The code gets a reference to the SignalR context when it creates the singleton class instance, passes that reference to the constructor, and the constructor puts it in the Clients property.</span></span>

    <span data-ttu-id="7ff08-222">Yalnızca bir kez bağlamı almak istediğiniz neden iki nedeni vardır: pahalı bir işlem olan içerik alma ve bir kez alma istemcilere gönderilen iletilerin hedeflenen sırasının korunmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-222">There are two reasons why you want to get the context just once: getting the context is an expensive operation, and getting it once ensures that the intended order of messages sent to clients is preserved.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample9.cs)]

    <span data-ttu-id="7ff08-223">Bağlam istemciler özellik alma ve StockTickerClient özelliğinde koyarak olduğu gibi aynı görünen bir Hub sınıfta istemci yöntemleri çağırmak için kod yazmanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-223">Getting the Clients property of the context and putting it in the StockTickerClient property lets you write code to call client methods that looks the same as it would in a Hub class.</span></span> <span data-ttu-id="7ff08-224">Örneğin, tüm istemcilere yayın Clients.All.updateStockPrice(stock) yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-224">For instance, to broadcast to all clients you can write Clients.All.updateStockPrice(stock).</span></span>

    <span data-ttu-id="7ff08-225">İçinde BroadcastStockPrice aradığınız updateStockPrice yöntemi henüz mevcut değil; istemcide çalışan kod yazdığınızda, daha sonra ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-225">The updateStockPrice method that you are calling in BroadcastStockPrice doesn't exist yet; you'll add it later when you write code that runs on the client.</span></span> <span data-ttu-id="7ff08-226">Çalışma zamanında hesaplanacak olan ifade anlamına gelen dinamik Clients.All olduğu için burada updateStockPrice başvurabilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-226">You can refer to updateStockPrice here because Clients.All is dynamic, which means the expression will be evaluated at runtime.</span></span> <span data-ttu-id="7ff08-227">Bu yöntem çağrısının yürütüldüğünde, SignalR yöntem adı ile parametre değeri istemciye gönderir ve istemci updateStockPrice adlı bir yöntemi varsa, bu yöntem çağrılır ve parametre değeri geçirilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-227">When this method call executes, SignalR will send the method name and the parameter value to the client, and if the client has a method named updateStockPrice, that method will be called and the parameter value will be passed to it.</span></span>

    <span data-ttu-id="7ff08-228">Clients.All tüm istemcilere göndermek anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-228">Clients.All means send to all clients.</span></span> <span data-ttu-id="7ff08-229">SignalR, hangi istemcilerin veya göndermek için istemci gruplarının belirtmek için diğer seçenekler sunar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-229">SignalR gives you other options to specify which clients or groups of clients to send to.</span></span> <span data-ttu-id="7ff08-230">Daha fazla bilgi için [HubConnectionContext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="7ff08-230">For more information, see [HubConnectionContext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span></span>

### <a name="register-the-signalr-route"></a><span data-ttu-id="7ff08-231">SignalR yol kaydetme</span><span class="sxs-lookup"><span data-stu-id="7ff08-231">Register the SignalR route</span></span>

<span data-ttu-id="7ff08-232">Sunucunun kesecek ve SignalR ile doğrudan hangi URL'sini de bilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-232">The server needs to know which URL to intercept and direct to SignalR.</span></span> <span data-ttu-id="7ff08-233">Bunu yapmak için OWIN başlangıç sınıfı ekleyin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-233">To do that, add an OWIN startup class:</span></span>

1. <span data-ttu-id="7ff08-234">İçinde **Çözüm Gezgini**projeye sağ tıklayın ve ardından **Ekle | OWIN başlangıç sınıfı**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-234">In **Solution Explorer**, right-click the project, and then click **Add | OWIN Startup Class**.</span></span> <span data-ttu-id="7ff08-235">Sınıf adı **Startup.cs**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-235">Name the class **Startup.cs**.</span></span>
2. <span data-ttu-id="7ff08-236">Değiştirin **Startup.cs** aşağıdaki.</span><span class="sxs-lookup"><span data-stu-id="7ff08-236">Replace the code in **Startup.cs** with the following.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample10.cs)]

<span data-ttu-id="7ff08-237">Sunucu kodu ayarlama tamamladınız.</span><span class="sxs-lookup"><span data-stu-id="7ff08-237">You have now completed setting up the server code.</span></span> <span data-ttu-id="7ff08-238">Sonraki bölümde, istemci ayarlamanız.</span><span class="sxs-lookup"><span data-stu-id="7ff08-238">In the next section you'll set up the client.</span></span>

<a id="client"></a>

## <a name="set-up-the-client-code"></a><span data-ttu-id="7ff08-239">İstemci kodunu ayarlayın</span><span class="sxs-lookup"><span data-stu-id="7ff08-239">Set up the client code</span></span>

1. <span data-ttu-id="7ff08-240">Proje klasöründe yeni bir HTML dosyası oluşturun ve adlandırın *StockTicker.html*.</span><span class="sxs-lookup"><span data-stu-id="7ff08-240">Create a new HTML file in the project folder, and name it *StockTicker.html*.</span></span>
2. <span data-ttu-id="7ff08-241">Şablon kodunu aşağıdaki kodla değiştirin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-241">Replace the template code with the following code.</span></span>

    [!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample11.html)]

    <span data-ttu-id="7ff08-242">HTML 5 sütun ve üst bilgi satırı tüm 5 sütun kapsayan tek bir hücre içeren bir veri satırı bir tablo oluşturur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-242">The HTML creates a table with 5 columns, a header row, and a data row with a single cell that spans all 5 columns.</span></span> <span data-ttu-id="7ff08-243">Veri satırı "yükleniyor..." görüntüler ve yalnızca kısa bir süre içinde uygulama başladığında gösterilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-243">The data row displays "loading..." and will only be shown momentarily when the application starts.</span></span> <span data-ttu-id="7ff08-244">JavaScript kodu satır kaldırın ve sunucudan alınan stok verilerini kendi yerde satır ekleyin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-244">JavaScript code will remove that row and add in its place rows with stock data retrieved from the server.</span></span>

    <span data-ttu-id="7ff08-245">Komut dosyası etiketlerini jQuery komut dosyası, SignalR çekirdek komut dosyası, SignalR proxy'leri komut dosyası ve daha sonra oluşturacağınız bir StockTicker betik dosyası belirtin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-245">The script tags specify the jQuery script file, the SignalR core script file, the SignalR proxies script file, and a StockTicker script file that you'll create later.</span></span> <span data-ttu-id="7ff08-246">"/ Signalr/hubs" URL'sini belirtir, SignalR proxy'leri komut dosyası dinamik olarak oluşturulur ve Hub sınıfı yöntemleri için proxy yöntemleri için StockTickerHub.GetAllStocks bu durumda tanımlar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-246">The SignalR proxies script file, which specifies the "/signalr/hubs" URL, is dynamically generated and defines proxy methods for the methods on the Hub class, in this case for StockTickerHub.GetAllStocks.</span></span> <span data-ttu-id="7ff08-247">Tercih ederseniz, bu JavaScript dosyasını el ile kullanarak oluşturabileceğiniz [SignalR yardımcı programları](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) ve MapHubs yöntemi çağrısında dinamik dosya oluşturma devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-247">If you prefer, you can generate this JavaScript file manually by using [SignalR Utilities](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) and disable dynamic file creation in the MapHubs method call.</span></span>
3. > [!IMPORTANT]
   > <span data-ttu-id="7ff08-248">JavaScript dosyası içinde başvurduğundan emin olun *StockTicker.html* doğrudur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-248">Make sure that the JavaScript file references in *StockTicker.html* are correct.</span></span> <span data-ttu-id="7ff08-249">Diğer bir deyişle, komut dosyası etiketi (örnekte 1.10.2) jQuery sürümünde projenizin jQuery sürümüyle aynı olduğundan emin olun *betikleri* klasöründe ve betik etiketinizi SignalR sürümünde SignalR ile aynı olduğundan emin olun projenizin sürüm *betikleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="7ff08-249">That is, make sure that the jQuery version in your script tag (1.10.2 in the example) is the same as the jQuery version in your project's *Scripts* folder, and make sure that the SignalR version in your script tag is the same as the SignalR version in your project's *Scripts* folder.</span></span> <span data-ttu-id="7ff08-250">Komut dosyası etiketlerini dosya adlarında gerekirse değiştirin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-250">Change the file names in the script tags if necessary.</span></span>
4. <span data-ttu-id="7ff08-251">İçinde **Çözüm Gezgini**, sağ *StockTicker.html*ve ardından **Başlangıç Sayfası Ayarla**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-251">In **Solution Explorer**, right-click *StockTicker.html*, and then click **Set as Start Page**.</span></span>
5. <span data-ttu-id="7ff08-252">Proje klasöründe yeni bir JavaScript dosyası oluşturun ve adlandırın *StockTicker.js*...</span><span class="sxs-lookup"><span data-stu-id="7ff08-252">Create a new JavaScript file in the project folder and name it *StockTicker.js*..</span></span>
6. <span data-ttu-id="7ff08-253">Şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-253">Replace the template code with the following code:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample12.js)]

    <span data-ttu-id="7ff08-254">$.connection SignalR proxy'leri için ifade eder.</span><span class="sxs-lookup"><span data-stu-id="7ff08-254">$.connection refers to the SignalR proxies.</span></span> <span data-ttu-id="7ff08-255">Kod StockTickerHub sınıf için proxy için bir başvuru alır ve bandı değişkenine yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-255">The code gets a reference to the proxy for the StockTickerHub class and puts it in the ticker variable.</span></span> <span data-ttu-id="7ff08-256">Ara sunucu adını [HubName] özniteliği tarafından ayarlanan adıdır:</span><span class="sxs-lookup"><span data-stu-id="7ff08-256">The proxy name is the name that was set by the [HubName] attribute:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample13.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample14.cs)]

    <span data-ttu-id="7ff08-257">Tüm değişkenlerin ve işlevlerin tanımlandıktan sonra dosyayı kodda son satırının SignalR başlangıç işlevini çağırarak SignalR bağlantı başlatır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-257">After all the variables and functions are defined, the last line of code in the file initializes the SignalR connection by calling the SignalR start function.</span></span> <span data-ttu-id="7ff08-258">Başlangıç işlev zaman uyumsuz olarak yürütür ve döndürür bir [jQuery ertelenmiş nesne](http://api.jquery.com/category/deferred-object/), bunun anlamı zaman uyumsuz işlem tamamlandığında çağırılacak işlev belirtmek için yapılan işlevi çağırabilir...</span><span class="sxs-lookup"><span data-stu-id="7ff08-258">The start function executes asynchronously and returns a [jQuery Deferred object](http://api.jquery.com/category/deferred-object/), which means you can call the done function to specify the function to call when the asynchronous operation is completed..</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample15.js)]

    <span data-ttu-id="7ff08-259">İnit işlevi sunucuda getAllStocks işlevini çağırır ve sunucu Stok tablosu döndürür bilgileri kullanır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-259">The init function calls the getAllStocks function on the server and uses the information that the server returns to update the stock table.</span></span> <span data-ttu-id="7ff08-260">Yöntem adı sunucu üzerinde pascal harfleri olmasına rağmen camel istemcide büyük/küçük harfleri kullanmak zorunda varsayılan olarak, dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-260">Notice that by default, you have to use camel casing on the client although the method name is pascal-cased on the server.</span></span> <span data-ttu-id="7ff08-261">Ortası büyük/küçük harf kuralı yalnızca nesneleri yöntemleri için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-261">The camel-casing rule only applies to methods, not objects.</span></span> <span data-ttu-id="7ff08-262">Örneğin, hisse senedi için bakın. Simge ve stok. Fiyat stock.symbol ya da değil stock.price.</span><span class="sxs-lookup"><span data-stu-id="7ff08-262">For example, you refer to stock.Symbol and stock.Price, not stock.symbol or stock.price.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample16.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample17.cs)]

    <span data-ttu-id="7ff08-263">İstemcide pascal casing kullanmak istediğinizi veya tamamen farklı yöntem adı kullanmak istiyorsanız, Hub yönteminin HubMethodName özniteliği ile aynı şekilde tasarlamanız Hub sınıfın kendisi HubName özniteliği ile donatılmış.</span><span class="sxs-lookup"><span data-stu-id="7ff08-263">If you wanted to use pascal casing on the client, or if you wanted to use a completely different method name, you could decorate the Hub method with the HubMethodName attribute the same way you decorated the Hub class itself with the HubName attribute.</span></span>

    <span data-ttu-id="7ff08-264">İnit yöntemi stok biçimi özelliklerine göre arama formatStock sunucudan alınan stok her nesne için bir tablo satır için HTML oluşturulur ve ardından çağırarak supplant (üst kısmında tanımlanan *StockTicker.js*) stok özellik değerleri rowTemplate değişkeni içindeki yer tutucuları değiştirmek için.</span><span class="sxs-lookup"><span data-stu-id="7ff08-264">In the init method, HTML for a table row is created for each stock object received from the server by calling formatStock to format properties of the stock object, and then by calling supplant (which is defined at the top of *StockTicker.js*) to replace placeholders in the rowTemplate variable with the stock object property values.</span></span> <span data-ttu-id="7ff08-265">Sonuçta elde edilen HTML sonra stok tablosuna eklenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-265">The resulting HTML is then appended to the stock table.</span></span>

    <span data-ttu-id="7ff08-266">İnit, içinde zaman uyumsuz başlangıç işlevi tamamlandıktan sonra yürüten bir geri çağırma işlevi olarak geçirerek çağırın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-266">You call init by passing it in as a callback function that executes after the asynchronous start function completes.</span></span> <span data-ttu-id="7ff08-267">Başlangıç çağrıldıktan sonra ayrı bir JavaScript ifadesi olarak init çağrılırsa, bağlantı kurma tamamlanması için başlangıç işlevi beklenmeden hemen yürütülür çünkü işlev başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="7ff08-267">If you called init as a separate JavaScript statement after calling start, the function would fail because it would execute immediately without waiting for the start function to finish establishing the connection.</span></span> <span data-ttu-id="7ff08-268">Bu durumda, init işlevi sunucu bağlantısı yeniden kurulmadan önce getAllStocks işlev çağrısı isteriz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-268">In that case, the init function would try to call the getAllStocks function before the server connection is established.</span></span>

    <span data-ttu-id="7ff08-269">Sunucu hisse ait fiyat değiştiğinde, bağlı istemciler üzerinde updateStockPrice çağırır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-269">When the server changes a stock's price, it calls the updateStockPrice on connected clients.</span></span> <span data-ttu-id="7ff08-270">İşlev çağrıları sunucudan kullanabilmesi için stockTicker proxy istemci özelliğini eklenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-270">The function is added to the client property of the stockTicker proxy in order to make it available to calls from the server.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample18.js)]

    <span data-ttu-id="7ff08-271">Sunucudan init işlevi aynı şekilde bir tablo satır alınan bir stok updateStockPrice işlevi biçimlendirir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-271">The updateStockPrice function formats a stock object received from the server into a table row the same way as in the init function.</span></span> <span data-ttu-id="7ff08-272">Ancak, tabloya satır ekleme, yerine tabloda hisse senedi'nın geçerli satırı bulur ve satır yenisiyle değiştirir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-272">However, instead of appending the row to the table, it finds the stock's current row in the table and replaces that row with the new one.</span></span>

<a id="test"></a>

## <a name="test-the-application"></a><span data-ttu-id="7ff08-273">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="7ff08-273">Test the application</span></span>

1. <span data-ttu-id="7ff08-274">Uygulamayı hata ayıklama modunda çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-274">Press F5 to run the application in debug mode.</span></span>

    <span data-ttu-id="7ff08-275">"Satırın ardından ilk stok verileri görüntülenen kısa bir gecikmeyle yükleniyor..." stok tablonun ilk başta görüntüler ve değiştirmek hisse senedi fiyatlarına başlatın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-275">The stock table initially displays the "loading..." line, then after a short delay the initial stock data is displayed, and then the stock prices start to change.</span></span>

    ![Yükleniyor](tutorial-server-broadcast-with-signalr/_static/image6.png)

    ![İlk stok tablosu](tutorial-server-broadcast-with-signalr/_static/image7.png)

    ![Stok tablosu değişiklikleri sunucudan alınıyor](tutorial-server-broadcast-with-signalr/_static/image8.png)
2. <span data-ttu-id="7ff08-279">Tarayıcınızın adres çubuğundan URL'yi kopyalayın ve bir veya daha fazla yeni tarayıcı pencerelerini yapıştırın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-279">Copy the URL from the browser address bar and paste it into one or more new browser window(s).</span></span>

    <span data-ttu-id="7ff08-280">İlk stok görünen ilk tarayıcı ile aynıdır ve değişiklikler aynı anda gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-280">The initial stock display is the same as the first browser and changes happen simultaneously.</span></span>
3. <span data-ttu-id="7ff08-281">Tüm tarayıcıları kapatın ve yeni bir tarayıcı açın ve sonra aynı URL'ye gidin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-281">Close all browsers and open a new browser, then go to the same URL.</span></span>

    <span data-ttu-id="7ff08-282">StockTicker tekil nesnesi stocks değiştirmeye devam stok tablo gösterecek şekilde sunucu çalışmaya devam etti.</span><span class="sxs-lookup"><span data-stu-id="7ff08-282">The StockTicker singleton object has continued to run in the server, so the stock table display shows that the stocks have continued to change.</span></span> <span data-ttu-id="7ff08-283">(Şekiller değiştirme tablonun ilk sıfır görmüyorum.)</span><span class="sxs-lookup"><span data-stu-id="7ff08-283">(You don't see the initial table with zero change figures.)</span></span>
4. <span data-ttu-id="7ff08-284">Tarayıcıyı kapatın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-284">Close the browser.</span></span>

<a id="enablelogging"></a>

## <a name="enable-logging"></a><span data-ttu-id="7ff08-285">Günlüğe kaydetmeyi etkinleştirme</span><span class="sxs-lookup"><span data-stu-id="7ff08-285">Enable logging</span></span>

<span data-ttu-id="7ff08-286">SignalR istemcide giderilmesine yardımcı olmak için etkinleştirebileceğiniz bir yerleşik günlük işleve sahiptir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-286">SignalR has a built-in logging function that you can enable on the client to aid in troubleshooting.</span></span> <span data-ttu-id="7ff08-287">Bu bölümdeki günlük kaydını etkinleştirmek ve nasıl günlükleri SignalR kullanarak, aşağıdaki taşıma yöntemleri size gösteren örneklere bakın:</span><span class="sxs-lookup"><span data-stu-id="7ff08-287">In this section you enable logging and see examples that show how logs tell you which of the following transport methods SignalR is using:</span></span>

- <span data-ttu-id="7ff08-288">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), IIS 8 ve geçerli tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-288">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), supported by IIS 8 and current browsers.</span></span>
- <span data-ttu-id="7ff08-289">[Sunucu tarafından gönderilen olayları](http://en.wikipedia.org/wiki/Server-sent_events), Internet Explorer dışındaki tarayıcıları tarafından desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="7ff08-289">[Server-sent events](http://en.wikipedia.org/wiki/Server-sent_events), supported by browsers other than Internet Explorer.</span></span>
- <span data-ttu-id="7ff08-290">[Sonsuza kadar çerçeve](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe), Internet Explorer tarafından desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="7ff08-290">[Forever frame](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe), supported by Internet Explorer.</span></span>
- <span data-ttu-id="7ff08-291">[AJAX uzun yoklama](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling), tüm tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-291">[Ajax long polling](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling), supported by all browsers.</span></span>

<span data-ttu-id="7ff08-292">Verilen herhangi bir bağlantısı için hem sunucu hem de istemci destekleyen en iyi bir aktarım yöntemi SignalR seçer.</span><span class="sxs-lookup"><span data-stu-id="7ff08-292">For any given connection, SignalR chooses the best transport method that both the server and the client support.</span></span>

1. <span data-ttu-id="7ff08-293">Açık *StockTicker.js* ve bir dosyanın sonuna bağlantı başlatır kodundan hemen önce günlüğe kaydetmeyi etkinleştirmek için kod satırını ekleyin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-293">Open *StockTicker.js* and add a line of code to enable logging immediately before the code that initializes the connection at the end of the file:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample19.js)]
2. <span data-ttu-id="7ff08-294">Projeyi çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-294">Press F5 to run the project.</span></span>
3. <span data-ttu-id="7ff08-295">Tarayıcınızın geliştirici araçları penceresini açın ve konsol günlükleri görmek için seçin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-295">Open your browser's developer tools window, and select the Console to see the logs.</span></span> <span data-ttu-id="7ff08-296">Signalr aktarım yöntemi için yeni bir bağlantı anlaşması günlükleri görmek için sayfayı yenilemeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-296">You might have to refresh the page to see the logs of Signalr negotiating the transport method for a new connection.</span></span>

    <span data-ttu-id="7ff08-297">Internet Explorer 10, Windows 8'de (IIS 8) çalıştırıyorsanız, aktarım WebSockets yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-297">If you are running Internet Explorer 10 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![IE 10 IIS 8 Konsolu](tutorial-server-broadcast-with-signalr/_static/image9.png)

    <span data-ttu-id="7ff08-299">Internet Explorer 10, Windows 7'de (IIS 7.5) çalıştırıyorsanız, aktarım iframe yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-299">If you are running Internet Explorer 10 on Windows 7 (IIS 7.5), the transport method is iframe.</span></span>

    ![IE 10 konsolu, IIS 7.5](tutorial-server-broadcast-with-signalr/_static/image10.png)

    <span data-ttu-id="7ff08-301">' De Firefox, Firebug bir konsol penceresi almak için eklentisini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-301">In Firefox, install the Firebug add-in to get a Console window.</span></span> <span data-ttu-id="7ff08-302">Windows 8 (IIS 8)'de Firefox 19 çalıştırıyorsanız, aktarım WebSockets yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-302">If you are running Firefox 19 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![Firefox 19 8 IIS Websockets](tutorial-server-broadcast-with-signalr/_static/image11.png)

    <span data-ttu-id="7ff08-304">Windows 7 (IIS 7.5)'de Firefox 19 çalıştırıyorsanız, aktarım sunucu tarafından gönderilen olayları yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-304">If you are running Firefox 19 on Windows 7 (IIS 7.5), the transport method is server-sent events.</span></span>

    ![IIS 7.5 Firefox 19 Konsolu](tutorial-server-broadcast-with-signalr/_static/image12.png)

<a id="fullsample"></a>

## <a name="install-and-review-the-full-stockticker-sample"></a><span data-ttu-id="7ff08-306">Yükleme ve tam StockTicker örneği gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="7ff08-306">Install and review the full StockTicker sample</span></span>

<span data-ttu-id="7ff08-307">Tarafından yüklenen StockTicker uygulama [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketini sıfırdan yeni oluşturduğunuz Basitleştirilmiş sürümden daha fazla özellik içerir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-307">The StockTicker application that is installed by the [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package includes more features than the simplified version that you just created from scratch.</span></span> <span data-ttu-id="7ff08-308">Öğreticinin bu bölümünde NuGet paketini yükleyin ve yeni özellikleri ve bunları uygulayan kod gözden geçirin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-308">In this section of the tutorial, you install the NuGet package and review the new features and the code that implements them.</span></span> <span data-ttu-id="7ff08-309">Bu öğreticinin önceki adımları gerçekleştirmeden paketi yüklerseniz, OWIN başlangıç sınıfı projenize eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-309">If you install the package without performing the earlier steps of this tutorial, you must add an OWIN startup class to your project.</span></span> <span data-ttu-id="7ff08-310">Bu adım, NuGet paketi readme.txt dosyası içindeki açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-310">This step is explained in the readme.txt file for the NuGet package.</span></span>

### <a name="install-the-signalrsample-nuget-package"></a><span data-ttu-id="7ff08-311">SignalR.Sample NuGet paketini yükle</span><span class="sxs-lookup"><span data-stu-id="7ff08-311">Install the SignalR.Sample NuGet package</span></span>

1. <span data-ttu-id="7ff08-312">İçinde **Çözüm Gezgini**, projeye sağ tıklayın ve tıklayın **NuGet paketlerini Yönet**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-312">In **Solution Explorer**, right-click the project and click **Manage NuGet Packages**.</span></span>
2. <span data-ttu-id="7ff08-313">İçinde **NuGet paketlerini Yönet** iletişim kutusu, tıklayın **çevrimiçi**, girin *SignalR.Sample* içinde **çevrimiçi Ara** kutusuna ve ardından tıklatın **Yükleme** içinde **SignalR.Sample** paket.</span><span class="sxs-lookup"><span data-stu-id="7ff08-313">In the **Manage NuGet Packages** dialog box, click **Online**, enter *SignalR.Sample* in the **Search Online** box, and then click **Install** in the **SignalR.Sample** package.</span></span>

    ![SignalR.Sample paketini yükle](tutorial-server-broadcast-with-signalr/_static/image13.png)
3. <span data-ttu-id="7ff08-315">İçinde **Çözüm Gezgini**, genişletme *SignalR.Sample* SignalR.Sample paketini yükleyerek oluşturulduğu klasör.</span><span class="sxs-lookup"><span data-stu-id="7ff08-315">In **Solution Explorer**, expand the *SignalR.Sample* folder which was created by installing the SignalR.Sample package.</span></span>
4. <span data-ttu-id="7ff08-316">İçinde *SignalR.Sample* klasörü sağ tıklatın *StockTicker.html*ve ardından **başlangıç sayfası olarak ayarla**.</span><span class="sxs-lookup"><span data-stu-id="7ff08-316">In the *SignalR.Sample* folder, right-click *StockTicker.html*, and then click **Set As Start Page**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="7ff08-317">Yükleme SignalR.Sample NuGet paketi uygulamanızdaki jQuery sürümü değişebilir, *betikleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="7ff08-317">Installing The SignalR.Sample NuGet package might change the version of jQuery that you have in your *Scripts* folder.</span></span> <span data-ttu-id="7ff08-318">Yeni *StockTicker.html* paketi yükler dosya *SignalR.Sample* klasörü orijinal çalıştırmakistiyorsanızancakyükleyenpaket,jQuerysürümüileuyumluolacak*StockTicker.html* yeniden dosya, komut dosyası etiketi jQuery başvurusunda önce güncelleştirmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-318">The new *StockTicker.html* file that the package installs in the *SignalR.Sample* folder will be in sync with the jQuery version that the package installs, but if you want to run your original *StockTicker.html* file again, you might have to update the jQuery reference in the script tag first.</span></span>

### <a name="run-the-application"></a><span data-ttu-id="7ff08-319">Uygulamayı çalıştırın</span><span class="sxs-lookup"><span data-stu-id="7ff08-319">Run the application</span></span>

1. <span data-ttu-id="7ff08-320">Uygulamayı çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-320">Press F5 to run the application.</span></span>

    <span data-ttu-id="7ff08-321">Daha önce gördüğünüzle kılavuza ek olarak, tam borsa uygulama aynı stok verileri görüntüleyen bir yatay kaydırma penceresi gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-321">In addition to the grid that you saw earlier, the full stock ticker application shows a horizontally scrolling window that displays the same stock data.</span></span> <span data-ttu-id="7ff08-322">Uygulamayı ilk kez çalıştırdığınızda, "pazar" "kapalı" ve statik bir kılavuz ve kaydırma değil bir bandı penceresi görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-322">When you run the application for the first time, the "market" is "closed" and you see a static grid and a ticker window that isn't scrolling.</span></span>

    ![StockTicker ekran Başlat](tutorial-server-broadcast-with-signalr/_static/image14.png)

    <span data-ttu-id="7ff08-324">Tıkladığınızda **açık Pazar**, **Canlı hisse senedi bandı** seçenekler yatay kaydırma yapmak ve düzenli aralıklarla hisse senedi fiyatı değişiklikleri rastgele olarak yayınlamak sunucuyu başlatır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-324">When you click **Open Market**, the **Live Stock Ticker** box starts to scroll horizontally, and the server starts to periodically broadcast stock price changes on a random basis.</span></span> <span data-ttu-id="7ff08-325">Her zaman bir hisse senedi fiyatı değiştirir, her ikisi de **hisse senedi tablo canlı** kılavuz ve **Canlı hisse senedi bandı** kutusu güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-325">Each time a stock price changes, both the **Live Stock Table** grid and the **Live Stock Ticker** box are updated.</span></span> <span data-ttu-id="7ff08-326">Hisse ait fiyat değişikliği pozitif olduğunda hisse senedi yeşil bir arka plan ile gösterilir ve değişiklik negatif olduğunda hisse senedi kırmızı bir arka plan ile gösterilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-326">When a stock's price change is positive, the stock is shown with a green background, and when the change is negative, the stock is shown with a red background.</span></span>

    ![Pazar StockTicker uygulamasını açın](tutorial-server-broadcast-with-signalr/_static/image15.png)

    <span data-ttu-id="7ff08-328">**Kapat Pazar** düğmesi değişiklikleri ve kaydırma bandı durur ve **sıfırlama** düğme fiyat değişiklikleriyle başlatmadan önce bu tüm stok verileri ilk durumuna sıfırlar.</span><span class="sxs-lookup"><span data-stu-id="7ff08-328">The **Close Market** button stops the changes and stops the ticker scrolling, and the **Reset** button resets all stock data to the initial state before price changes started.</span></span> <span data-ttu-id="7ff08-329">Daha fazla tarayıcı pencerelerini açmak ve aynı URL'ye gitmeniz her tarayıcıda aynı anda dinamik olarak güncelleştirilen aynı verileri görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-329">If you open more browser windows and go to the same URL, you see the same data dynamically updated at the same time in each browser.</span></span> <span data-ttu-id="7ff08-330">Düğmelerden birine tıkladığınızda, tüm tarayıcılar aynı anda aynı şekilde yanıt verin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-330">When you click one of the buttons, all browsers respond the same way at the same time.</span></span>

### <a name="live-stock-ticker-display"></a><span data-ttu-id="7ff08-331">Canlı hisse senedi bandı görüntüleme</span><span class="sxs-lookup"><span data-stu-id="7ff08-331">Live Stock Ticker display</span></span>

<span data-ttu-id="7ff08-332">**Canlı hisse senedi bandı** sırasız bir listesini tek bir satıra CSS stillerinden biçimlendirilmiş bir div öğesine içinde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-332">The **Live Stock Ticker** display is an unordered list in a div element that is formatted into a single line by CSS styles.</span></span> <span data-ttu-id="7ff08-333">Bandı başlatılır ve tabloyu aynı şekilde güncelleştirildi: içindeki yer tutucuları değiştirerek bir &lt;li&gt; şablonu dizesi ve dinamik olarak ekleme &lt;li&gt; öğelerine &lt;ul&gt; öğe.</span><span class="sxs-lookup"><span data-stu-id="7ff08-333">The ticker is initialized and updated the same way as the table: by replacing placeholders in a &lt;li&gt; template string and dynamically adding the &lt;li&gt; elements to the &lt;ul&gt; element.</span></span> <span data-ttu-id="7ff08-334">Kaydırma DIV içinde sırasız liste sol kenar boşluğu değiştirmek için jQuery Canlandır işlevi kullanılarak gerçekleştirilir</span><span class="sxs-lookup"><span data-stu-id="7ff08-334">The scrolling is performed by using the jQuery animate function to vary the margin-left of the unordered list within the div.</span></span>

<span data-ttu-id="7ff08-335">HTML borsa kodu:</span><span class="sxs-lookup"><span data-stu-id="7ff08-335">The stock ticker HTML:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample20.html)]

<span data-ttu-id="7ff08-336">CSS borsa kodu:</span><span class="sxs-lookup"><span data-stu-id="7ff08-336">The stock ticker CSS:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample21.html)]

<span data-ttu-id="7ff08-337">Kolaylaştırır jQuery kodu kaydırın:</span><span class="sxs-lookup"><span data-stu-id="7ff08-337">The jQuery code that makes it scroll:</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample22.js)]

### <a name="additional-methods-on-the-server-that-the-client-can-call"></a><span data-ttu-id="7ff08-338">İstemci çağırabilirsiniz sunucuda ek yöntemleri</span><span class="sxs-lookup"><span data-stu-id="7ff08-338">Additional methods on the server that the client can call</span></span>

<span data-ttu-id="7ff08-339">İstemci çağırabilirsiniz dört ek yöntemleri StockTickerHub sınıfı tanımlar:</span><span class="sxs-lookup"><span data-stu-id="7ff08-339">The StockTickerHub class defines four additional methods that the client can call:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample23.cs)]

<span data-ttu-id="7ff08-340">Sayfanın üstündeki düğmeleri yanıt OpenMarket CloseMarket ve sıfırlama çağrılır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-340">OpenMarket, CloseMarket, and Reset are called in response to the buttons at the top of the page.</span></span> <span data-ttu-id="7ff08-341">Bunlar, tüm istemcilere hemen yayılır durumundaki bir değişikliği tetikleyen bir istemci desenini gösterir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-341">They demonstrate the pattern of one client triggering a change in state that is immediately propagated to all clients.</span></span> <span data-ttu-id="7ff08-342">Bu yöntemlerin her biri bir yöntem StockTicker sınıfında Pazar durumu değiştirin ve ardından yeni durum yayınlar bu etkileri çağırır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-342">Each of these methods calls a method in the StockTicker class that effects the market state change and then broadcasts the new state.</span></span>

<span data-ttu-id="7ff08-343">StockTicker sınıfında, Pazar durumunu MarketState enum değeri döndüren bir MarketState özelliği tarafından korunur:</span><span class="sxs-lookup"><span data-stu-id="7ff08-343">In the StockTicker class, the state of the market is maintained by a MarketState property that returns a MarketState enum value:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample24.cs)]

<span data-ttu-id="7ff08-344">Pazar durum değişikliği yöntemlerin her biri bunu kilit bloğu içinde StockTicker sınıfı threadsafe olabilir çünkü:</span><span class="sxs-lookup"><span data-stu-id="7ff08-344">Each of the methods that change the market state do so inside a lock block because the StockTicker class has to be threadsafe:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample25.cs)]

<span data-ttu-id="7ff08-345">Bu kod, threadsafe olduğundan emin olmak için \_MarketState özelliği yedekleyen marketState alan geçici olarak işaretlendi</span><span class="sxs-lookup"><span data-stu-id="7ff08-345">To ensure that this code is threadsafe, the \_marketState field that backs the MarketState property is marked as volatile,</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample26.cs)]

<span data-ttu-id="7ff08-346">Bunlar istemcide tanımlanan farklı yöntemleri çağırmak dışında BroadcastMarketStateChange ve BroadcastMarketReset yöntemleri zaten gördüğünüz BroadcastStockPrice yöntemine benzerdir:</span><span class="sxs-lookup"><span data-stu-id="7ff08-346">The BroadcastMarketStateChange and BroadcastMarketReset methods are similar to the BroadcastStockPrice method that you already saw, except they call different methods defined at the client:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample27.cs)]

### <a name="additional-functions-on-the-client-that-the-server-can-call"></a><span data-ttu-id="7ff08-347">Sunucu çağırabilirsiniz istemcide ek işlevler</span><span class="sxs-lookup"><span data-stu-id="7ff08-347">Additional functions on the client that the server can call</span></span>

<span data-ttu-id="7ff08-348">UpdateStockPrice işlevi artık kılavuz hem bandı görüntü işleme ve kırmızı ve yeşil renk Flash jQuery.Color kullanır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-348">The updateStockPrice function now handles both the grid and the ticker display, and it uses jQuery.Color to flash red and green colors.</span></span>

<span data-ttu-id="7ff08-349">Yeni işlevleri *SignalR.StockTicker.js* etkinleştirme ve devre dışı düğmeleri temel durum pazarlamak ve durdurma veya bandı pencereyi yatay kaydırma başlatın.</span><span class="sxs-lookup"><span data-stu-id="7ff08-349">New functions in *SignalR.StockTicker.js* enable and disable the buttons based on market state, and they stop or start the ticker window horizontal scrolling.</span></span> <span data-ttu-id="7ff08-350">Birden çok işlevleri ticker.client için eklendiği [jQuery işlevi genişletmek](http://api.jquery.com/jQuery.extend/) bunları eklemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="7ff08-350">Since multiple functions are being added to ticker.client, the [jQuery extend function](http://api.jquery.com/jQuery.extend/) is used to add them.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample28.js)]

### <a name="additional-client-setup-after-establishing-the-connection"></a><span data-ttu-id="7ff08-351">Bağlantı kurulduktan sonra ek istemci kurulumu</span><span class="sxs-lookup"><span data-stu-id="7ff08-351">Additional client setup after establishing the connection</span></span>

<span data-ttu-id="7ff08-352">İstemci bağlantı kurar sonra yapmak için bazı ek işleri sahip: Pazar açık veya kapalı uygun marketOpened veya marketClosed işlevi çağırabilir ve sunucu yöntem çağrılarını düğmeleri eklemek için olup olmadığını öğrenin.</span><span class="sxs-lookup"><span data-stu-id="7ff08-352">After the client establishes the connection, it has some additional work to do: find out if the market is open or closed in order to call the appropriate marketOpened or marketClosed function, and attach the server method calls to the buttons.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample29.js)]

<span data-ttu-id="7ff08-353">Bağlantı kurulduktan sonra böylece kullanılabilir olmadan önce sunucu yöntemlerini çağırmak kod deneyemez server yöntemlerini kadar düğmeleri kadar kablolu arabirimlerdir değil.</span><span class="sxs-lookup"><span data-stu-id="7ff08-353">The server methods are not wired up to the buttons until after the connection is established, so that the code can't try to call the server methods before they are available.</span></span>

<a id="nextsteps"></a>

## <a name="next-steps"></a><span data-ttu-id="7ff08-354">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="7ff08-354">Next steps</span></span>

<span data-ttu-id="7ff08-355">Bu öğreticide sunucudan tüm bağlı istemciler, düzenli aralıklarla ve herhangi bir istemciden gelen bildirimlere yanıt iletileri yayınlar bir SignalR uygulama programı öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="7ff08-355">In this tutorial you've learned how to program a SignalR application that broadcasts messages from the server to all connected clients, both on a periodic basis and in response to notifications from any client.</span></span> <span data-ttu-id="7ff08-356">Sunucu durumunu korumak üzere bir çok iş parçacıklı tekil örneğini kullanarak desenini ayrıca çok oyunculu çevrimiçi oyun senaryolarda da kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="7ff08-356">The pattern of using a multi-threaded singleton instance to maintain server state can also be also used in multi-player online game scenarios.</span></span> <span data-ttu-id="7ff08-357">Bir örnek için bkz. [SignalR tabanlı ShootR game](https://github.com/NTaylorMullen/ShootR).</span><span class="sxs-lookup"><span data-stu-id="7ff08-357">For an example, see [the ShootR game that is based on SignalR](https://github.com/NTaylorMullen/ShootR).</span></span>

<span data-ttu-id="7ff08-358">Eşler arası iletişim senaryolarında gösteren öğreticiler için bkz. [SignalR ile çalışmaya başlama](introduction-to-signalr.md) ve [SignalR ile gerçek zamanlı güncelleştirme](tutorial-high-frequency-realtime-with-signalr.md).</span><span class="sxs-lookup"><span data-stu-id="7ff08-358">For tutorials that show peer-to-peer communication scenarios, see [Getting Started with SignalR](introduction-to-signalr.md) and [Real-Time Updating with SignalR](tutorial-high-frequency-realtime-with-signalr.md).</span></span>

<span data-ttu-id="7ff08-359">Daha gelişmiş SignalR geliştirme kavramları hakkında bilgi için SignalR kaynak kodu ve kaynaklar için aşağıdaki siteleri ziyaret edin:</span><span class="sxs-lookup"><span data-stu-id="7ff08-359">To learn more advanced SignalR development concepts, visit the following sites for SignalR source code and resources:</span></span>

- [<span data-ttu-id="7ff08-360">ASP.NET SignalR</span><span class="sxs-lookup"><span data-stu-id="7ff08-360">ASP.NET SignalR</span></span>](../../index.md)
- [<span data-ttu-id="7ff08-361">SignalR projesi</span><span class="sxs-lookup"><span data-stu-id="7ff08-361">SignalR Project</span></span>](http://signalr.net/)
- [<span data-ttu-id="7ff08-362">SignalR Github ve örnekleri</span><span class="sxs-lookup"><span data-stu-id="7ff08-362">SignalR Github and Samples</span></span>](https://github.com/SignalR/SignalR)
- [<span data-ttu-id="7ff08-363">SignalR Wiki</span><span class="sxs-lookup"><span data-stu-id="7ff08-363">SignalR Wiki</span></span>](https://github.com/SignalR/SignalR/wiki)

<span data-ttu-id="7ff08-364">Bir SignalR uygulamayı azure'a dağıtma hakkında kılavuz için bkz. [Azure App service'taki Web Apps ile SignalR kullanarak](../deployment/using-signalr-with-azure-web-sites.md).</span><span class="sxs-lookup"><span data-stu-id="7ff08-364">For a walkthrough on how to deploy a SignalR application to Azure, see [Using SignalR with Web Apps in Azure App Service](../deployment/using-signalr-with-azure-web-sites.md).</span></span> <span data-ttu-id="7ff08-365">Visual Studio web projesini bir Windows Azure Web sitesine dağıtma hakkında ayrıntılı bilgi için bkz. [Azure App Service'te ASP.NET web uygulaması oluşturma](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-get-started/).</span><span class="sxs-lookup"><span data-stu-id="7ff08-365">For detailed information about how to deploy a Visual Studio web project to a Windows Azure Web Site, see [Create an ASP.NET web app in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-get-started/).</span></span>
