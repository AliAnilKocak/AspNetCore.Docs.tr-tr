---
uid: signalr/overview/getting-started/tutorial-server-broadcast-with-signalr
title: "Öğretici: Sunucu yayın 2 SignalR ile | Microsoft Docs"
author: tdykstra
description: "Bu öğretici sunucu yayın işlevselliği sağlamak için ASP.NET SignalR 2 kullanan bir web uygulamasının nasıl oluşturulacağını gösterir. Sunucu yayın o commun anlama gelir..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/13/2014
ms.topic: article
ms.assetid: 1568247f-60b5-4eca-96e0-e661fbb2b273
ms.technology: dotnet-signalr
ms.prod: .net-framework
msc.legacyurl: /signalr/overview/getting-started/tutorial-server-broadcast-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: 98a7ce4991d58181177cf56976888e9fd1526987
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2018
---
<a name="tutorial-server-broadcast-with-signalr-2"></a><span data-ttu-id="bcf41-104">Öğretici: Sunucu yayın SignalR 2 ile</span><span class="sxs-lookup"><span data-stu-id="bcf41-104">Tutorial: Server Broadcast with SignalR 2</span></span>
====================
<span data-ttu-id="bcf41-105">tarafından [zel Dykstra](https://github.com/tdykstra), [zel FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="bcf41-105">by [Tom Dykstra](https://github.com/tdykstra), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="bcf41-106">Bu öğretici sunucu yayın işlevselliği sağlamak için ASP.NET SignalR 2 kullanan bir web uygulamasının nasıl oluşturulacağını gösterir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-106">This tutorial shows how to create a web application that uses ASP.NET SignalR 2 to provide server broadcast functionality.</span></span> <span data-ttu-id="bcf41-107">Sunucu yayın istemcilere gönderilen iletişimleri sunucu tarafından başlatılan anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-107">Server broadcast means that communications sent to clients are initiated by the server.</span></span> <span data-ttu-id="bcf41-108">Bu senaryo, eşler arası senaryolar istemcilere iletişimler bir veya daha fazla istemcileri tarafından başlatılır, sohbet uygulamaları gibi daha farklı bir programlama yaklaşımı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-108">This scenario requires a different programming approach than peer-to-peer scenarios such as chat applications, in which communications sent to clients are initiated by one or more of the clients.</span></span>
> 
> <span data-ttu-id="bcf41-109">Bu öğreticide oluşturacaksınız uygulama bir borsa sunucusu yayın işlevselliği için tipik bir senaryo benzetimini yapar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-109">The application that you'll create in this tutorial simulates a stock ticker, a typical scenario for server broadcast functionality.</span></span>
> 
> <span data-ttu-id="bcf41-110">Bu konuda, ilk olarak CAN Fletcher'dan tarafından yazıldı.</span><span class="sxs-lookup"><span data-stu-id="bcf41-110">This topic was originally written by Patrick Fletcher.</span></span>
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="bcf41-111">Öğreticide kullanılan yazılım sürümleri</span><span class="sxs-lookup"><span data-stu-id="bcf41-111">Software versions used in the tutorial</span></span>
> 
> 
> - [<span data-ttu-id="bcf41-112">Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="bcf41-112">Visual Studio 2013</span></span>](https://www.microsoft.com/visualstudio/eng/2013-downloads)
> - <span data-ttu-id="bcf41-113">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="bcf41-113">.NET 4.5</span></span>
> - <span data-ttu-id="bcf41-114">SignalR sürüm 2</span><span class="sxs-lookup"><span data-stu-id="bcf41-114">SignalR version 2</span></span>
>   
> 
> 
> ## <a name="using-visual-studio-2012-with-this-tutorial"></a><span data-ttu-id="bcf41-115">Bu öğretici ile Visual Studio 2012 kullanma</span><span class="sxs-lookup"><span data-stu-id="bcf41-115">Using Visual Studio 2012 with this tutorial</span></span>
> 
> 
> <span data-ttu-id="bcf41-116">Visual Studio 2012 bu öğreticiyle kullanmak için aşağıdakileri yapın:</span><span class="sxs-lookup"><span data-stu-id="bcf41-116">To use Visual Studio 2012 with this tutorial, do the following:</span></span>
> 
> - <span data-ttu-id="bcf41-117">Güncelleştirme, [Paket Yöneticisi](http://docs.nuget.org/docs/start-here/installing-nuget) en son sürüme.</span><span class="sxs-lookup"><span data-stu-id="bcf41-117">Update your [Package Manager](http://docs.nuget.org/docs/start-here/installing-nuget) to the latest version.</span></span>
> - <span data-ttu-id="bcf41-118">Yükleme [Web Platformu yükleyicisi](https://www.microsoft.com/web/downloads/platform.aspx).</span><span class="sxs-lookup"><span data-stu-id="bcf41-118">Install the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx).</span></span>
> - <span data-ttu-id="bcf41-119">Web Platformu Yükleyicisi'nde arayın ve yükleyin **ASP.NET ve Web Araçları 2013.1 Visual Studio 2012 için**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-119">In the Web Platform Installer, search for and install **ASP.NET and Web Tools 2013.1 for Visual Studio 2012**.</span></span> <span data-ttu-id="bcf41-120">Bu SignalR sınıfları için Visual Studio şablonları gibi yükleyecek **Hub**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-120">This will install Visual Studio templates for SignalR classes such as **Hub**.</span></span>
> - <span data-ttu-id="bcf41-121">Bazı şablonlar (gibi **OWIN başlangıç sınıfı**); kullanılamaz bunlar için bunun yerine bir sınıf dosyası kullanın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-121">Some templates (such as **OWIN Startup Class**) will not be available; for these, use a Class file instead.</span></span>
> 
> 
> ## <a name="tutorial-versions"></a><span data-ttu-id="bcf41-122">Eğitmen sürümleri</span><span class="sxs-lookup"><span data-stu-id="bcf41-122">Tutorial Versions</span></span>
> 
> <span data-ttu-id="bcf41-123">SignalR daha önceki sürümleri hakkında daha fazla bilgi için bkz: [SignalR eski sürümleri](../older-versions/index.md).</span><span class="sxs-lookup"><span data-stu-id="bcf41-123">For information about earlier versions of SignalR, see [SignalR Older Versions](../older-versions/index.md).</span></span>
> 
> ## <a name="questions-and-comments"></a><span data-ttu-id="bcf41-124">Sorularınız ve yorumlarınız</span><span class="sxs-lookup"><span data-stu-id="bcf41-124">Questions and comments</span></span>
> 
> <span data-ttu-id="bcf41-125">Lütfen Bu öğretici beğendiğinizi nasıl ve ne biz sayfanın sonundaki açıklamalarında artabileceğini görüşlerinizi.</span><span class="sxs-lookup"><span data-stu-id="bcf41-125">Please leave feedback on how you liked this tutorial and what we could improve in the comments at the bottom of the page.</span></span> <span data-ttu-id="bcf41-126">Öğretici için doğrudan ilgili olmayan sorularınız varsa, bunları nakledebilirsiniz [ASP.NET SignalR Forumu](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) veya [StackOverflow.com](http://stackoverflow.com/).</span><span class="sxs-lookup"><span data-stu-id="bcf41-126">If you have questions that are not directly related to the tutorial, you can post them to the [ASP.NET SignalR forum](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) or [StackOverflow.com](http://stackoverflow.com/).</span></span>


## <a name="overview"></a><span data-ttu-id="bcf41-127">Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="bcf41-127">Overview</span></span>

<span data-ttu-id="bcf41-128">Bu öğreticide, düzenli aralıklarla göndermek"" istediğiniz gerçek zamanlı uygulamaları temsilcisidir bir borsa uygulaması oluşturun veya yayın, sunucudan bildirimleri bağlanan tüm istemciler için.</span><span class="sxs-lookup"><span data-stu-id="bcf41-128">In this tutorial, you'll create a stock ticker application that is representative of real-time applications in which you want to periodically "push," or broadcast, notifications from the server to all connected clients.</span></span> <span data-ttu-id="bcf41-129">Bu öğreticinin ilk bölümü baştan uygulama basitleştirilmiş bir sürümünü oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-129">In the first part of this tutorial, you'll create a simplified version of that application from scratch.</span></span> <span data-ttu-id="bcf41-130">Öğretici kalanı ek özellikler içeren bir NuGet paketi yükleyin ve bu özellikleri için kod gözden geçirme.</span><span class="sxs-lookup"><span data-stu-id="bcf41-130">In the remainder of the tutorial, you'll install a NuGet package that contains additional features, and review the code for those features.</span></span>

<span data-ttu-id="bcf41-131">Bu öğreticinin ilk bölümü oluşturacağınız uygulama hisse senedi verileri içeren bir kılavuz görüntüler.</span><span class="sxs-lookup"><span data-stu-id="bcf41-131">The application that you'll build in the first part of this tutorial displays a grid with stock data.</span></span>

![StockTicker ilk sürüm](tutorial-server-broadcast-with-signalr/_static/image1.png)

<span data-ttu-id="bcf41-133">Düzenli aralıklarla sunucu rastgele hisse senedi fiyatları güncelleştirir ve tüm bağlı istemcileri güncelleştirmeleri iter.</span><span class="sxs-lookup"><span data-stu-id="bcf41-133">Periodically the server randomly updates stock prices and pushes the updates to all connected clients.</span></span> <span data-ttu-id="bcf41-134">Tarayıcı sayıları ve sembolleri **değiştirme** ve  **%**  sütunları dinamik olarak değiştirme bildirimlere yanıt olarak sunucudan.</span><span class="sxs-lookup"><span data-stu-id="bcf41-134">In the browser the numbers and symbols in the **Change** and **%** columns dynamically change in response to notifications from the server.</span></span> <span data-ttu-id="bcf41-135">Aynı URL'ye ek tarayıcılar açarsanız, hepsi aynı veri ve veri aynı değişiklikleri aynı anda gösterin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-135">If you open additional browsers to the same URL, they all show the same data and the same changes to the data simultaneously.</span></span>

<span data-ttu-id="bcf41-136">Bu öğretici aşağıdaki bölümleri içerir:</span><span class="sxs-lookup"><span data-stu-id="bcf41-136">This tutorial contains the following sections:</span></span>

- [<span data-ttu-id="bcf41-137">Önkoşulları</span><span class="sxs-lookup"><span data-stu-id="bcf41-137">Prerequisites</span></span>](#prerequisites)
- [<span data-ttu-id="bcf41-138">Proje oluşturma</span><span class="sxs-lookup"><span data-stu-id="bcf41-138">Create the project</span></span>](#createproject)
- [<span data-ttu-id="bcf41-139">Sunucu kodu ayarlamanız</span><span class="sxs-lookup"><span data-stu-id="bcf41-139">Set up the server code</span></span>](#server)
- [<span data-ttu-id="bcf41-140">İstemci kodu ayarlamanız</span><span class="sxs-lookup"><span data-stu-id="bcf41-140">Set up the client code</span></span>](#client)
- [<span data-ttu-id="bcf41-141">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="bcf41-141">Test the application</span></span>](#test)
- [<span data-ttu-id="bcf41-142">Günlük kaydını etkinleştir</span><span class="sxs-lookup"><span data-stu-id="bcf41-142">Enable logging</span></span>](#enablelogging)
- [<span data-ttu-id="bcf41-143">Yükleme ve tam StockTicker örnek gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="bcf41-143">Install and review the full StockTicker sample</span></span>](#fullsample)
- [<span data-ttu-id="bcf41-144">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="bcf41-144">Next steps</span></span>](#nextsteps)

<span data-ttu-id="bcf41-145">[Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketini bir Visual Studio projesi benzetimli örnek bir borsa uygulamayı yükler.</span><span class="sxs-lookup"><span data-stu-id="bcf41-145">The [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package installs a sample simulated stock ticker application in a Visual Studio project.</span></span>

> [!NOTE]
> <span data-ttu-id="bcf41-146">Uygulama oluşturma adımları boyunca çalışmaya istemiyorsanız, yeni bir boş bir ASP.NET Web uygulaması projesindeki SignalR.Sample paketi yükleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-146">If you don't want to work through the steps of building the application, you can install the SignalR.Sample package in a new Empty ASP.NET Web Application project.</span></span> <span data-ttu-id="bcf41-147">Bu öğreticide adımları uygularken olmadan NuGet paketi yüklerseniz **readme.txt dosyasında yönergeleri izlemelisiniz**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-147">If you install the NuGet package without performing the steps in this tutorial, **you must follow the instructions in the readme.txt file**.</span></span> <span data-ttu-id="bcf41-148">Paketi çalıştırmak için yüklenen pakette ConfigureSignalR yöntemini çağıran bir OWIN başlangıç sınıfı eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-148">To run the package you need to add an OWIN startup class which calls the ConfigureSignalR method in the installed package.</span></span> <span data-ttu-id="bcf41-149">OWIN başlangıç sınıfı eklemezseniz bir hata alırsınız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-149">You will receive an error if you do not add the OWIN startup class.</span></span>


<a id="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="bcf41-150">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="bcf41-150">Prerequisites</span></span>

<span data-ttu-id="bcf41-151">Başlamadan önce Visual Studio 2013 bilgisayarınızda yüklü olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="bcf41-151">Before you start, make sure that you have Visual Studio 2013 installed on your computer.</span></span> <span data-ttu-id="bcf41-152">Visual Studio sahip değilseniz, bkz: [ASP.NET indirmeleri](https://www.asp.net/downloads) ücretsiz Visual Studio 2013 Express alınamıyor.</span><span class="sxs-lookup"><span data-stu-id="bcf41-152">If you don't have Visual Studio, see [ASP.NET Downloads](https://www.asp.net/downloads) to get the free Visual Studio 2013 Express.</span></span>

<a id="createproject"></a>

## <a name="create-the-project"></a><span data-ttu-id="bcf41-153">Projeyi oluşturma</span><span class="sxs-lookup"><span data-stu-id="bcf41-153">Create the project</span></span>

1. <span data-ttu-id="bcf41-154">Gelen **dosya** menüsünde tıklatın **yeni proje**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-154">From the **File** menu, click **New Project**.</span></span>
2. <span data-ttu-id="bcf41-155">İçinde **yeni proje** iletişim kutusunda, genişletin **C#** altında **şablonları** seçip **Web**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-155">In the **New Project** dialog box, expand **C#** under **Templates** and select **Web**.</span></span>
3. <span data-ttu-id="bcf41-156">Seçin **ASP.NET boş Web uygulaması** şablonu, proje adı *SignalR.StockTicker*, tıklatıp **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-156">Select the **ASP.NET Empty Web Application** template, name the project *SignalR.StockTicker*, and click **OK**.</span></span>

    ![Yeni Proje iletişim kutusu](tutorial-server-broadcast-with-signalr/_static/image2.png)
4. <span data-ttu-id="bcf41-158">İçinde **yeni ASP.NET** proje penceresinin, bırakın **boş** 'ı tıklatın ve seçili **proje oluştur**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-158">In the **New ASP.NET** Project window, leave **Empty** selected and click **Create Project**.</span></span>

    ![Yeni ASP proje iletişim kutusu](tutorial-server-broadcast-with-signalr/_static/image3.png)

<a id="server"></a>

## <a name="set-up-the-server-code"></a><span data-ttu-id="bcf41-160">Sunucu kodu ayarlamanız</span><span class="sxs-lookup"><span data-stu-id="bcf41-160">Set up the server code</span></span>

<span data-ttu-id="bcf41-161">Bu bölümde, sunucu üzerinde çalışan bir kod ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-161">In this section you set up the code that runs on the server.</span></span>

### <a name="create-the-stock-class"></a><span data-ttu-id="bcf41-162">Hisse senedi sınıfı oluşturma</span><span class="sxs-lookup"><span data-stu-id="bcf41-162">Create the Stock class</span></span>

<span data-ttu-id="bcf41-163">Depolamak ve stok hakkında bilgi aktarmak için kullanacağınız hisse senedi model sınıfı oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-163">You begin by creating the Stock model class that you'll use to store and transmit information about a stock.</span></span>

1. <span data-ttu-id="bcf41-164">Proje klasöründe yeni bir sınıf dosyası oluşturun, adlandırın *Stock.cs*ve ardından şablon kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-164">Create a new class file in the project folder, name it *Stock.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample1.cs)]

    <span data-ttu-id="bcf41-165">İstediğiniz hisse oluşturduğunuzda, ayarlarız iki simge (örneğin, Microsoft MSFT) ve fiyat özelliklerdir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-165">The two properties that you'll set when you create stocks are the Symbol (for example, MSFT for Microsoft) and the Price.</span></span> <span data-ttu-id="bcf41-166">Diğer özellikler nasıl ve ne zaman fiyat ayarlama bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-166">The other properties depend on how and when you set Price.</span></span> <span data-ttu-id="bcf41-167">Fiyat, ayarladığınız ilk kez değeri için DayOpen yayılan.</span><span class="sxs-lookup"><span data-stu-id="bcf41-167">The first time you set Price, the value gets propagated to DayOpen.</span></span> <span data-ttu-id="bcf41-168">Zaman fiyat, değişikliği ayarlamak ve YüzdeDeğişiklikleri özellik değerlerini hesaplanan sonraki kez fiyat DayOpen arasındaki fark temel.</span><span class="sxs-lookup"><span data-stu-id="bcf41-168">Subsequent times when you set Price, the Change and PercentChange property values are calculated based on the difference between Price and DayOpen.</span></span>

### <a name="create-the-stockticker-and-stocktickerhub-classes"></a><span data-ttu-id="bcf41-169">StockTicker ve StockTickerHub sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="bcf41-169">Create the StockTicker and StockTickerHub classes</span></span>

<span data-ttu-id="bcf41-170">Sunucu istemciye etkileşim işlemek için SignalR hub'ı API kullanacaksınız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-170">You'll use the SignalR Hub API to handle server-to-client interaction.</span></span> <span data-ttu-id="bcf41-171">SignalR hub'ı sınıfından türetilen StockTickerHub sınıfı, bağlantıları ve yöntem çağrılarını istemcilerinden gelen işleyecek.</span><span class="sxs-lookup"><span data-stu-id="bcf41-171">A StockTickerHub class that derives from the SignalR Hub class will handle receiving connections and method calls from clients.</span></span> <span data-ttu-id="bcf41-172">Aynı zamanda hisse senedi verileri korumak ve istemci bağlantıları bağımsız olarak fiyat güncelleştirmeleri düzenli aralıklarla tetiklemek için bir zamanlayıcı nesnesini çalıştırmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-172">You also need to maintain stock data and run a Timer object to periodically trigger price updates, independently of client connections.</span></span> <span data-ttu-id="bcf41-173">Hub örnekleri geçici olduğundan, bu işlevlerin bir Hub sınıfta yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-173">You can't put these functions in a Hub class, because Hub instances are transient.</span></span> <span data-ttu-id="bcf41-174">Bir Hub örneği bağlantılar ve istemciden sunucuya çağrılar gibi hub üzerindeki her bir işlemin oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-174">A Hub class instance is created for each operation on the hub, such as connections and calls from the client to the server.</span></span> <span data-ttu-id="bcf41-175">Bu nedenle, StockTicker ad ayrı bir sınıf içinde çalıştırmak hisse senedi verileri tutar, fiyatları güncelleştirir ve fiyat güncelleştirmeleri yayınlar mekanizması vardır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-175">So the mechanism that keeps stock data, updates prices, and broadcasts the price updates has to run in a separate class, which you'll name StockTicker.</span></span>

![StockTicker yayın](tutorial-server-broadcast-with-signalr/_static/image5.png)

<span data-ttu-id="bcf41-177">Bir başvuru her StockTickerHub örneğinden singleton StockTicker örneğine ayarlanmış gerekir böylece sunucuda çalıştırmak için StockTicker sınıfının bir örneği yalnızca istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-177">You only want one instance of the StockTicker class to run on the server, so you'll need to set up a reference from each StockTickerHub instance to the singleton StockTicker instance.</span></span> <span data-ttu-id="bcf41-178">StockTicker sınıfı istemcilere stok verileri içeren ve güncelleştirmeleri tetikler ancak StockTicker Hub sınıfına değil çünkü yayın mümkün olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-178">The StockTicker class has to be able to broadcast to clients because it has the stock data and triggers updates, but StockTicker is not a Hub class.</span></span> <span data-ttu-id="bcf41-179">Bu nedenle, StockTicker sınıfı SignalR hub'ı bağlantı bağlamı nesneye bir başvurusu almak zorundadır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-179">Therefore, the StockTicker class has to get a reference to the SignalR Hub connection context object.</span></span> <span data-ttu-id="bcf41-180">Bunu ardından, SignalR bağlantısı bağlam nesnesi istemcilere yayınlamak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-180">It can then use the SignalR connection context object to broadcast to clients.</span></span>

1. <span data-ttu-id="bcf41-181">İçinde **Çözüm Gezgini**, projeyi sağ tıklatın ve **Ekle | SignalR hub'ı sınıfı (v2)**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-181">In **Solution Explorer**, right-click the project and click **Add | SignalR Hub Class (v2)**.</span></span>
2. <span data-ttu-id="bcf41-182">Yeni hub'ı adı *StockTickerHub.cs*ve ardından **Ekle**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-182">Name the new hub *StockTickerHub.cs*, and then click **Add**.</span></span> <span data-ttu-id="bcf41-183">SignalR NuGet paketlerini projenize eklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-183">SignalR NuGet packages will be added to your project.</span></span>
3. <span data-ttu-id="bcf41-184">Şablon kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-184">Replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample2.cs)]

    <span data-ttu-id="bcf41-185">[Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) sınıfı, istemcilerin sunucuda çağırabilir yöntemlerini tanımlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-185">The [Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) class is used to define methods the clients can call on the server.</span></span> <span data-ttu-id="bcf41-186">Bir yöntem tanımlama: `GetAllStocks()`.</span><span class="sxs-lookup"><span data-stu-id="bcf41-186">You are defining one method: `GetAllStocks()`.</span></span> <span data-ttu-id="bcf41-187">Bir istemci başlangıçta sunucuya bağlandığında, kendi geçerli fiyatlarla hisse tümünde listesini almak için bu yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-187">When a client initially connects to the server, it will call this method to get a list of all of the stocks with their current prices.</span></span> <span data-ttu-id="bcf41-188">Yöntemi, zaman uyumlu olarak yürütür ve dönüş `IEnumerable<Stock>` bellekten veri döndürmektir olduğundan.</span><span class="sxs-lookup"><span data-stu-id="bcf41-188">The method can execute synchronously and return `IEnumerable<Stock>` because it is returning data from memory.</span></span> <span data-ttu-id="bcf41-189">Yöntemin bir veritabanı araması veya bir web hizmeti çağrısı gibi bekleme içerir bir şey yaparak veri almak sahip belirtirsiniz `Task<IEnumerable<Stock>>` zaman uyumsuz işleme etkinleştirmek için dönüş değeri olarak.</span><span class="sxs-lookup"><span data-stu-id="bcf41-189">If the method had to get the data by doing something that would involve waiting, such as a database lookup or a web service call, you would specify `Task<IEnumerable<Stock>>` as the return value to enable asynchronous processing.</span></span> <span data-ttu-id="bcf41-190">Daha fazla bilgi için bkz: [ASP.NET SignalR hub'ları API Kılavuzu - Server - zaman uyumsuz olarak yürütülecek ne zaman](../guide-to-the-api/hubs-api-guide-server.md#asyncmethods).</span><span class="sxs-lookup"><span data-stu-id="bcf41-190">For more information, see [ASP.NET SignalR Hubs API Guide - Server - When to execute asynchronously](../guide-to-the-api/hubs-api-guide-server.md#asyncmethods).</span></span>

    <span data-ttu-id="bcf41-191">İstemci üzerinde JavaScript kodunda Hub'ın nasıl başvurulacak HubName özniteliği belirtir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-191">The HubName attribute specifies how the Hub will be referenced in JavaScript code on the client.</span></span> <span data-ttu-id="bcf41-192">Bu öznitelik kullanmazsanız istemcideki varsayılan adı stockTickerHub bu durumda olacaktır sınıf adının başlamalıdır bir sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="bcf41-192">The default name on the client if you don't use this attribute is a camel-cased version of the class name, which in this case would be stockTickerHub.</span></span>

    <span data-ttu-id="bcf41-193">StockTicker sınıfı oluşturduğunuzda, daha sonra anlatıldığı gibi sınıfı tek örneğini statik örneği özelliğinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-193">As you'll see later when you create the StockTicker class, a singleton instance of that class is created in its static Instance property.</span></span> <span data-ttu-id="bcf41-194">Kaç adet istemcinin bağlanın veya bağlantıyı kesin olsun bellekte StockTicker tek örneğini kalır ve bu örnek GetAllStocks yöntemi geçerli stok bilgileri döndürmek için kullandığı olduğundan.</span><span class="sxs-lookup"><span data-stu-id="bcf41-194">That singleton instance of StockTicker remains in memory no matter how many clients connect or disconnect, and that instance is what the GetAllStocks method uses to return current stock information.</span></span>
4. <span data-ttu-id="bcf41-195">Proje klasöründe yeni bir sınıf dosyası oluşturun, adlandırın *StockTicker.cs*ve ardından şablon kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-195">Create a new class file in the project folder, name it *StockTicker.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample3.cs)]

    <span data-ttu-id="bcf41-196">Birden çok iş parçacığı StockTicker kodu aynı örneği çalışacağı beri StockTicker sınıfı threadsafe olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-196">Since multiple threads will be running the same instance of StockTicker code, the StockTicker class has to be threadsafe.</span></span>

    ### <a name="storing-the-singleton-instance-in-a-static-field"></a><span data-ttu-id="bcf41-197">Statik bir alana tek örnek depolama</span><span class="sxs-lookup"><span data-stu-id="bcf41-197">Storing the singleton instance in a static field</span></span>

    <span data-ttu-id="bcf41-198">Statik kodu başlatır \_, sınıf ve bu örneği örneği özelliğiyle yedekler örneği alan olup, Oluşturucusu özel olarak işaretlendiğinden oluşturulabilir, sınıfı tek örneği.</span><span class="sxs-lookup"><span data-stu-id="bcf41-198">The code initializes the static \_instance field that backs the Instance property with an instance of the class, and this is the only instance of the class that can be created, because the constructor is marked as private.</span></span> <span data-ttu-id="bcf41-199">[Geç başlatma](https://msdn.microsoft.com/library/dd997286.aspx) için kullanılan \_değil ancak örnek oluşturma threadsafe olduğundan emin olmak üzere performansı artırmak için örnek alanı.</span><span class="sxs-lookup"><span data-stu-id="bcf41-199">[Lazy initialization](https://msdn.microsoft.com/library/dd997286.aspx) is used for the \_instance field, not for performance reasons but to ensure that the instance creation is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample4.cs)]

    <span data-ttu-id="bcf41-200">Daha önce StockTickerHub sınıfında anlatıldığı gibi bir istemci sunucuya her bağlandığında StockTicker.Instance statik özelliğinden StockTicker tek örneği ayrı bir iş parçacığı çalıştıran StockTickerHub sınıfının yeni bir örneğini alır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-200">Each time a client connects to the server, a new instance of the StockTickerHub class running in a separate thread gets the StockTicker singleton instance from the StockTicker.Instance static property, as you saw earlier in the StockTickerHub class.</span></span>

    ### <a name="storing-stock-data-in-a-concurrentdictionary"></a><span data-ttu-id="bcf41-201">Bir ConcurrentDictionary stok veri depolama</span><span class="sxs-lookup"><span data-stu-id="bcf41-201">Storing stock data in a ConcurrentDictionary</span></span>

    <span data-ttu-id="bcf41-202">Oluşturucu başlatır \_istediğiniz hisse koleksiyonuyla bazı örnek stok verileri ve GetAllStocks istediğiniz hisse döndürür.</span><span class="sxs-lookup"><span data-stu-id="bcf41-202">The constructor initializes the \_stocks collection with some sample stock data, and GetAllStocks returns the stocks.</span></span> <span data-ttu-id="bcf41-203">Daha önce gördüğünüz gibi bu koleksiyonu hisse sırayla bir sunucu yöntemle istemcileri çağırabilirsiniz Hub sınıfında StockTickerHub.GetAllStocks tarafından döndürülür.</span><span class="sxs-lookup"><span data-stu-id="bcf41-203">As you saw earlier, this collection of stocks is in turn returned by StockTickerHub.GetAllStocks which is a server method in the Hub class that clients can call.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample5.cs)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample6.cs)]

    <span data-ttu-id="bcf41-204">İstediğiniz hisse koleksiyonu olarak tanımlanan bir [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) iş parçacığı güvenliği için türü.</span><span class="sxs-lookup"><span data-stu-id="bcf41-204">The stocks collection is defined as a [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) type for thread safety.</span></span> <span data-ttu-id="bcf41-205">Alternatif olarak, kullanabileceğinizi bir [sözlük](https://msdn.microsoft.com/library/xfhwa508.aspx) nesne ve değişiklik yaptığınız zaman sözlük açıkça kilitleyin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-205">As an alternative, you could use a [Dictionary](https://msdn.microsoft.com/library/xfhwa508.aspx) object and explicitly lock the dictionary when you make changes to it.</span></span>

    <span data-ttu-id="bcf41-206">Bu örnek uygulama için bu Tamam bellekte uygulama verilerini depolamak için ve StockTicker örneği çıkarıldığından, veri kaybına olur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-206">For this sample application, it's OK to store application data in memory and to lose the data when the StockTicker instance is disposed.</span></span> <span data-ttu-id="bcf41-207">Gerçek bir uygulamada bir veritabanı gibi bir arka uç veri deposu ile çalışır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-207">In a real application you would work with a back-end data store such as a database.</span></span>

    ### <a name="periodically-updating-stock-prices"></a><span data-ttu-id="bcf41-208">Stok fiyatları düzenli olarak güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="bcf41-208">Periodically updating stock prices</span></span>

    <span data-ttu-id="bcf41-209">Düzenli aralıklarla rastgele temelinde hisse senedi fiyatları güncelleştirme yöntemlerini çağıran bir süreölçer nesnesi yukarı Oluşturucusu başlatır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-209">The constructor starts up a Timer object that periodically calls methods that update stock prices on a random basis.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample7.cs)]

    <span data-ttu-id="bcf41-210">UpdateStockPrices null durumu parametre olarak geçirir Zamanlayıcı tarafından çağrılır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-210">UpdateStockPrices is called by the Timer, which passes in null in the state parameter.</span></span> <span data-ttu-id="bcf41-211">Fiyatlar güncelleştirmeden önce bir kilit alınır \_updateStockPricesLock nesnesi.</span><span class="sxs-lookup"><span data-stu-id="bcf41-211">Before updating prices, a lock is taken on the \_updateStockPricesLock object.</span></span> <span data-ttu-id="bcf41-212">Kod, başka bir iş parçacığı zaten fiyatları güncelleştirme ve ardından listedeki her stoktaki TryUpdateStockPrice çağırır denetler.</span><span class="sxs-lookup"><span data-stu-id="bcf41-212">The code checks if another thread is already updating prices, and then it calls TryUpdateStockPrice on each stock in the list.</span></span> <span data-ttu-id="bcf41-213">TryUpdateStockPrice yöntemi mi hisse senedi fiyatı değiştirmeye karar verir ve değiştirmek için ne kadar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-213">The TryUpdateStockPrice method decides whether to change the stock price, and how much to change it.</span></span> <span data-ttu-id="bcf41-214">Hisse senedi fiyatı değiştirdiyseniz BroadcastStockPrice bağlanan tüm istemciler için stok fiyat değişikliği yayını için çağrılır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-214">If the stock price is changed, BroadcastStockPrice is called to broadcast the stock price change to all connected clients.</span></span>

    <span data-ttu-id="bcf41-215">\_UpdatingStockPrices bayrak olarak işaretli [volatile](https://msdn.microsoft.com/library/x13ttww7.aspx) erişimi threadsafe olduğundan emin olmak için.</span><span class="sxs-lookup"><span data-stu-id="bcf41-215">The \_updatingStockPrices flag is marked as [volatile](https://msdn.microsoft.com/library/x13ttww7.aspx) to ensure that access to it is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample8.cs)]

    <span data-ttu-id="bcf41-216">Gerçek bir uygulamada TryUpdateStockPrice yöntemi fiyatı aramak için bir web hizmeti çağırırdı; Bu kodda değişiklik rastgele bir rastgele sayı üreticisinin kullanır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-216">In a real application, the TryUpdateStockPrice method would call a web service to look up the price; in this code it uses a random number generator to make changes randomly.</span></span>

    ### <a name="getting-the-signalr-context-so-that-the-stockticker-class-can-broadcast-to-clients"></a><span data-ttu-id="bcf41-217">Böylece StockTicker sınıfı istemcilere yayınlayabilirsiniz SignalR bağlamı alma</span><span class="sxs-lookup"><span data-stu-id="bcf41-217">Getting the SignalR context so that the StockTicker class can broadcast to clients</span></span>

    <span data-ttu-id="bcf41-218">Fiyat değişikliklerinin burada StockTicker nesnesinde kaynaklı olduğundan, bu bağlanan tüm istemciler üzerinde bir updateStockPrice yöntemini çağırmak için gereken nesnesidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-218">Because the price changes originate here in the StockTicker object, this is the object that needs to call an updateStockPrice method on all connected clients.</span></span> <span data-ttu-id="bcf41-219">Bir Hub sınıfı, bir API İstemci yöntemleri çağırmak için sahip, ancak StockTicker Hub sınıfından türemiyor ve herhangi bir Hub nesneye bir başvurusu yok.</span><span class="sxs-lookup"><span data-stu-id="bcf41-219">In a Hub class you have an API for calling client methods, but StockTicker does not derive from the Hub class and does not have a reference to any Hub object.</span></span> <span data-ttu-id="bcf41-220">Bu nedenle, bağlı istemciler için yayın için SignalR bağlam örneği için StockTickerHub sınıfını almak ve istemcilerde yöntemlerini çağırmaya kullanmaya StockTicker sınıfı sahiptir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-220">Therefore, in order to broadcast to connected clients, the StockTicker class has to get the SignalR context instance for the StockTickerHub class and use that to call methods on clients.</span></span>

    <span data-ttu-id="bcf41-221">Singleton sınıf örneği, başvuru geçişleri oluşturucuya oluşturduğunda kodu SignalR bağlamı için bir başvuru alır ve isteğe bağlı olarak Oluşturucusu istemcileri özelliğinde yerleştirir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-221">The code gets a reference to the SignalR context when it creates the singleton class instance, passes that reference to the constructor, and the constructor puts it in the Clients property.</span></span>

    <span data-ttu-id="bcf41-222">Bağlam yalnızca bir kez almak istediğiniz neden iki nedeni vardır: bağlamı alma pahalı bir işlem olduğundan ve bir kez alma sağlar istemcilere gönderilen iletilerin hedeflenen sırasını korunur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-222">There are two reasons why you want to get the context just once: getting the context is an expensive operation, and getting it once ensures that the intended order of messages sent to clients is preserved.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample9.cs)]

    <span data-ttu-id="bcf41-223">Bağlamının istemcileri özellik alma ve StockTickerClient özelliğinde koyma gibi görünen aynı Hub sınıfında istemci yöntemleri çağırmak için kod yazmanıza izin verir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-223">Getting the Clients property of the context and putting it in the StockTickerClient property lets you write code to call client methods that looks the same as it would in a Hub class.</span></span> <span data-ttu-id="bcf41-224">Örneğin, tüm istemcilere yayınlamak için Clients.All.updateStockPrice(stock) yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-224">For instance, to broadcast to all clients you can write Clients.All.updateStockPrice(stock).</span></span>

    <span data-ttu-id="bcf41-225">İçinde BroadcastStockPrice aradığınız updateStockPrice yöntemi henüz yok; istemci üzerinde çalışan bir kod yazarken daha sonra eklersiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-225">The updateStockPrice method that you are calling in BroadcastStockPrice doesn't exist yet; you'll add it later when you write code that runs on the client.</span></span> <span data-ttu-id="bcf41-226">Clients.All çalışma zamanında ifadenin hesaplanacağı anlamına gelir dinamik olduğundan burada updateStockPrice başvurabilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-226">You can refer to updateStockPrice here because Clients.All is dynamic, which means the expression will be evaluated at runtime.</span></span> <span data-ttu-id="bcf41-227">Bu yöntem çağrısı yürütüldüğünde, SignalR yöntem adı ve parametre değeri istemciye gönderir ve istemci updateStockPrice adlı bir yöntemi varsa, bu yöntem çağrılır ve parametre değeri geçirilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-227">When this method call executes, SignalR will send the method name and the parameter value to the client, and if the client has a method named updateStockPrice, that method will be called and the parameter value will be passed to it.</span></span>

    <span data-ttu-id="bcf41-228">Clients.All tüm istemcilere göndermek anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-228">Clients.All means send to all clients.</span></span> <span data-ttu-id="bcf41-229">SignalR hangi istemcilerin veya göndermek için istemci gruplarının belirtmek için diğer seçenekler sunar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-229">SignalR gives you other options to specify which clients or groups of clients to send to.</span></span> <span data-ttu-id="bcf41-230">Daha fazla bilgi için bkz: [HubConnectionContext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="bcf41-230">For more information, see [HubConnectionContext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span></span>

### <a name="register-the-signalr-route"></a><span data-ttu-id="bcf41-231">SignalR rota kaydetme</span><span class="sxs-lookup"><span data-stu-id="bcf41-231">Register the SignalR route</span></span>

<span data-ttu-id="bcf41-232">Sunucu kesecek ve SignalR için doğrudan hangi URL bilmek ister.</span><span class="sxs-lookup"><span data-stu-id="bcf41-232">The server needs to know which URL to intercept and direct to SignalR.</span></span> <span data-ttu-id="bcf41-233">Ekleyeceksiniz yapın ve OWIN başlangıç sınıfı.</span><span class="sxs-lookup"><span data-stu-id="bcf41-233">To do that you'll add and OWIN startup class.</span></span>

1. <span data-ttu-id="bcf41-234">İçinde **Çözüm Gezgini**, projeye sağ tıklayın ve ardından **Ekle | OWIN başlangıç sınıfı**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-234">In **Solution Explorer**, right-click the project, and then click **Add | OWIN Startup Class**.</span></span> <span data-ttu-id="bcf41-235">Sınıf adını **haline**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-235">Name the class **Startup.cs**.</span></span>
2. <span data-ttu-id="bcf41-236">Kodla **haline** aşağıdaki.</span><span class="sxs-lookup"><span data-stu-id="bcf41-236">Replace the code in **Startup.cs** with the following.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample10.cs)]

<span data-ttu-id="bcf41-237">Sunucu kodu ayarlama tamamladınız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-237">You have now completed setting up the server code.</span></span> <span data-ttu-id="bcf41-238">Sonraki bölümde istemci ayarlarsınız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-238">In the next section you'll set up the client.</span></span>

<a id="client"></a>

## <a name="set-up-the-client-code"></a><span data-ttu-id="bcf41-239">İstemci kodu ayarlamanız</span><span class="sxs-lookup"><span data-stu-id="bcf41-239">Set up the client code</span></span>

1. <span data-ttu-id="bcf41-240">Proje klasöründe yeni bir HTML dosyası oluşturun ve adlandırın *StockTicker.html*.</span><span class="sxs-lookup"><span data-stu-id="bcf41-240">Create a new HTML file in the project folder, and name it *StockTicker.html*.</span></span>
2. <span data-ttu-id="bcf41-241">Şablon kodu aşağıdaki kodla değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-241">Replace the template code with the following code.</span></span>

    [!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample11.html)]

    <span data-ttu-id="bcf41-242">HTML 5 sütunları, sütun başlığı ve tüm 5 sütunu kapsayan tek bir hücre ile bir veri satırı bir tablo oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-242">The HTML creates a table with 5 columns, a header row, and a data row with a single cell that spans all 5 columns.</span></span> <span data-ttu-id="bcf41-243">Veri satırı "yükleniyor..." görüntüler ve yalnızca kısa bir süre içinde uygulama başladığında görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-243">The data row displays "loading..." and will only be shown momentarily when the application starts.</span></span> <span data-ttu-id="bcf41-244">JavaScript kodu satır kaldırın ve sunucudan alınan stok verilerle bunun yerine satır ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-244">JavaScript code will remove that row and add in its place rows with stock data retrieved from the server.</span></span>

    <span data-ttu-id="bcf41-245">Komut dosyası etiketlerini jQuery komut dosyası, SignalR core komut dosyası, SignalR proxy'leri komut dosyası ve daha sonra oluşturacaksınız StockTicker komut dosyasını belirtin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-245">The script tags specify the jQuery script file, the SignalR core script file, the SignalR proxies script file, and a StockTicker script file that you'll create later.</span></span> <span data-ttu-id="bcf41-246">"/ Signalr/hub" URL'yi belirtir, SignalR proxy'leri komut dosyası dinamik olarak oluşturulur ve Hub sınıfı yöntemleri için proxy yöntemleri için StockTickerHub.GetAllStocks bu durumda tanımlar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-246">The SignalR proxies script file, which specifies the "/signalr/hubs" URL, is dynamically generated and defines proxy methods for the methods on the Hub class, in this case for StockTickerHub.GetAllStocks.</span></span> <span data-ttu-id="bcf41-247">Tercih ederseniz, bu JavaScript dosyası el ile kullanarak oluşturabileceğiniz [SignalR yardımcı programları](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) ve MapHubs yöntem çağrısı içinde dinamik dosya oluşturma devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-247">If you prefer, you can generate this JavaScript file manually by using [SignalR Utilities](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) and disable dynamic file creation in the MapHubs method call.</span></span>
3. > [!IMPORTANT]
 > <span data-ttu-id="bcf41-248">JavaScript dosyası içinde başvurduğundan emin olun *StockTicker.html* doğrudur.</span><span class="sxs-lookup"><span data-stu-id="bcf41-248">Make sure that the JavaScript file references in *StockTicker.html* are correct.</span></span> <span data-ttu-id="bcf41-249">Diğer bir deyişle, komut dosyası etiketinin (örnekte 1.10.2) jQuery sürümünü projenizin jQuery sürümü ile aynı olduğundan emin olun *betikleri* klasörünü ve komut dosyası etiketinin SignalR sürümünde SignalR ile aynı olduğundan emin olun projenizin sürümünde *betikleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="bcf41-249">That is, make sure that the jQuery version in your script tag (1.10.2 in the example) is the same as the jQuery version in your project's *Scripts* folder, and make sure that the SignalR version in your script tag is the same as the SignalR version in your project's *Scripts* folder.</span></span> <span data-ttu-id="bcf41-250">Komut dosyası etiketlerini dosya adlarında gerekiyorsa değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-250">Change the file names in the script tags if necessary.</span></span>
4. <span data-ttu-id="bcf41-251">İçinde **Çözüm Gezgini**, sağ *StockTicker.html*ve ardından **Başlangıç Sayfası Ayarla**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-251">In **Solution Explorer**, right-click *StockTicker.html*, and then click **Set as Start Page**.</span></span>
5. <span data-ttu-id="bcf41-252">Proje klasöründe yeni bir JavaScript dosyası oluşturun ve adlandırın *StockTicker.js*...</span><span class="sxs-lookup"><span data-stu-id="bcf41-252">Create a new JavaScript file in the project folder and name it *StockTicker.js*..</span></span>
6. <span data-ttu-id="bcf41-253">Şablon kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-253">Replace the template code with the following code:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample12.js)]

    <span data-ttu-id="bcf41-254">$.connection SignalR proxy'leri başvuruyor.</span><span class="sxs-lookup"><span data-stu-id="bcf41-254">$.connection refers to the SignalR proxies.</span></span> <span data-ttu-id="bcf41-255">Kod StockTickerHub sınıfı için proxy için bir başvuru alır ve borsa takip değişkene koyar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-255">The code gets a reference to the proxy for the StockTickerHub class and puts it in the ticker variable.</span></span> <span data-ttu-id="bcf41-256">Proxy adı [HubName] özniteliği tarafından ayarlanan adıdır:</span><span class="sxs-lookup"><span data-stu-id="bcf41-256">The proxy name is the name that was set by the [HubName] attribute:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample13.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample14.cs)]

    <span data-ttu-id="bcf41-257">Tüm işlevleri ve değişkenler tanımlandıktan sonra dosyanın içindeki son satırının SignalR başlangıç işlevini çağırarak SignalR bağlantısı başlatır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-257">After all the variables and functions are defined, the last line of code in the file initializes the SignalR connection by calling the SignalR start function.</span></span> <span data-ttu-id="bcf41-258">Başlangıç işlevi zaman uyumsuz olarak yürütür ve döndürür bir [jQuery ertelenmiş nesne](http://api.jquery.com/category/deferred-object/), anlamına gelir zaman uyumsuz işlemi tamamlandığında çağrılacak işlevin belirtmek için Bitti'yi işlevi çağırabilirsiniz...</span><span class="sxs-lookup"><span data-stu-id="bcf41-258">The start function executes asynchronously and returns a [jQuery Deferred object](http://api.jquery.com/category/deferred-object/), which means you can call the done function to specify the function to call when the asynchronous operation is completed..</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample15.js)]

    <span data-ttu-id="bcf41-259">İnit işlevi sunucuda getAllStocks işlevi çağırır ve sunucu stok tablosunu güncelleştirmek için bilgileri kullanır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-259">The init function calls the getAllStocks function on the server and uses the information that the server returns to update the stock table.</span></span> <span data-ttu-id="bcf41-260">Yöntem adı sunucuda pascal ortası olsa ortası istemci üzerinde büyük/küçük harfleri kullanmak zorunda varsayılan olarak, dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-260">Notice that by default, you have to use camel casing on the client although the method name is pascal-cased on the server.</span></span> <span data-ttu-id="bcf41-261">Ortası büyük büyük/küçük harf kural yalnızca nesneleri yöntemleri için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-261">The camel-casing rule only applies to methods, not objects.</span></span> <span data-ttu-id="bcf41-262">Örneğin, stoka bakın. Simge ve hisse senedi. Fiyat veya değil, stock.symbol stock.price.</span><span class="sxs-lookup"><span data-stu-id="bcf41-262">For example, you refer to stock.Symbol and stock.Price, not stock.symbol or stock.price.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample16.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample17.cs)]

    <span data-ttu-id="bcf41-263">İstemcide pascal büyük/küçük harf kullanmak istediğinizi veya tamamen farklı bir yöntem adını kullanmak istiyorsanız, HubMethodName özniteliği Hub yöntemiyle aynı şekilde tasarlamanız Hub sınıfının kendisi HubName özniteliği ile donatılmış.</span><span class="sxs-lookup"><span data-stu-id="bcf41-263">If you wanted to use pascal casing on the client, or if you wanted to use a completely different method name, you could decorate the Hub method with the HubMethodName attribute the same way you decorated the Hub class itself with the HubName attribute.</span></span>

    <span data-ttu-id="bcf41-264">Init yöntemi stok nesne biçim özelliklerine göre arama formatStock sunucudan alınan stok her nesne için bir tablo satır için HTML oluşturulur ve göre çağırma supplant (üst kısmında tanımlanan *StockTicker.js*) ile stok nesne özellik değerlerini rowTemplate değişkeni yer tutucuları değiştirmek için.</span><span class="sxs-lookup"><span data-stu-id="bcf41-264">In the init method, HTML for a table row is created for each stock object received from the server by calling formatStock to format properties of the stock object, and then by calling supplant (which is defined at the top of *StockTicker.js*) to replace placeholders in the rowTemplate variable with the stock object property values.</span></span> <span data-ttu-id="bcf41-265">Sonuçta elde edilen HTML sonra stok tablosuna eklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-265">The resulting HTML is then appended to the stock table.</span></span>

    <span data-ttu-id="bcf41-266">Init içinde zaman uyumsuz başlangıç işlevi tamamlandıktan sonra çalıştırılan bir geri çağırma işlevini geçirerek çağırın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-266">You call init by passing it in as a callback function that executes after the asynchronous start function completes.</span></span> <span data-ttu-id="bcf41-267">Başlangıç çağrıldıktan sonra ayrı bir JavaScript ifadesi olarak init adlı bağlantı kurarak tamamlamak başlangıç işlevi için beklenmeden hemen yürütülür işlevi başarısız.</span><span class="sxs-lookup"><span data-stu-id="bcf41-267">If you called init as a separate JavaScript statement after calling start, the function would fail because it would execute immediately without waiting for the start function to finish establishing the connection.</span></span> <span data-ttu-id="bcf41-268">Bu durumda, sunucu bağlantı kurulmadan önce getAllStocks işlevi çağırmak init işlevi isteriz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-268">In that case, the init function would try to call the getAllStocks function before the server connection is established.</span></span>

    <span data-ttu-id="bcf41-269">Sunucu stoğu 's fiyat değiştiğinde bağlı istemcilerde updateStockPrice çağırır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-269">When the server changes a stock's price, it calls the updateStockPrice on connected clients.</span></span> <span data-ttu-id="bcf41-270">İşlev çağrıları sunucudan kullanabilmesi için stockTicker proxy istemci özelliğine eklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-270">The function is added to the client property of the stockTicker proxy in order to make it available to calls from the server.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample18.js)]

    <span data-ttu-id="bcf41-271">İnit işlevi olduğu gibi bir tablo satıra sunucudan alınan bir stok nesnesi updateStockPrice işlevi biçimlendirir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-271">The updateStockPrice function formats a stock object received from the server into a table row the same way as in the init function.</span></span> <span data-ttu-id="bcf41-272">Ancak, tabloya satır ekleme, yerine hisse senedi'nın geçerli satır tabloda bulur ve satır yeni bir bağlantıyla değiştirir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-272">However, instead of appending the row to the table, it finds the stock's current row in the table and replaces that row with the new one.</span></span>

<a id="test"></a>

## <a name="test-the-application"></a><span data-ttu-id="bcf41-273">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="bcf41-273">Test the application</span></span>

1. <span data-ttu-id="bcf41-274">Uygulamayı hata ayıklama modunda çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-274">Press F5 to run the application in debug mode.</span></span>

    <span data-ttu-id="bcf41-275">"... Satır, ardından ilk hisse senedi verileri görüntülenen kısa bir gecikmeyle yüklenirken" hisse senedi tablosu başlangıçta görüntüler ve değiştirmek hisse senedi fiyatları başlatın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-275">The stock table initially displays the "loading..." line, then after a short delay the initial stock data is displayed, and then the stock prices start to change.</span></span>

    ![Yükleme](tutorial-server-broadcast-with-signalr/_static/image6.png)

    ![İlk hisse senedi tablosu](tutorial-server-broadcast-with-signalr/_static/image7.png)

    ![Hisse senedi tablosu değişiklikleri sunucudan alınıyor](tutorial-server-broadcast-with-signalr/_static/image8.png)
2. <span data-ttu-id="bcf41-279">Tarayıcınızın adres çubuğundan URL'yi kopyalayın ve bir veya daha fazla yeni tarayıcı pencerelerini yapıştırın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-279">Copy the URL from the browser address bar and paste it into one or more new browser window(s).</span></span>

    <span data-ttu-id="bcf41-280">İlk stok görünen ilk tarayıcı ile aynıdır ve aynı anda değişiklikleri gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-280">The initial stock display is the same as the first browser and changes happen simultaneously.</span></span>
3. <span data-ttu-id="bcf41-281">Tüm tarayıcılar kapatın ve yeni bir tarayıcı açın, sonra aynı URL'ye gidin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-281">Close all browsers and open a new browser, then go to the same URL.</span></span>

    <span data-ttu-id="bcf41-282">StockTicker tekil nesnesi hisse senedi tablosu görüntülenmesini istediğiniz hisse değiştirmeye devam etti gösterecek şekilde Server'da çalıştırmak devam etti.</span><span class="sxs-lookup"><span data-stu-id="bcf41-282">The StockTicker singleton object has continued to run in the server, so the stock table display shows that the stocks have continued to change.</span></span> <span data-ttu-id="bcf41-283">(Sıfır ilk tabloyla rakamları değiştirmek görmüyorum.)</span><span class="sxs-lookup"><span data-stu-id="bcf41-283">(You don't see the initial table with zero change figures.)</span></span>
4. <span data-ttu-id="bcf41-284">Tarayıcıyı kapatın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-284">Close the browser.</span></span>

<a id="enablelogging"></a>

## <a name="enable-logging"></a><span data-ttu-id="bcf41-285">Günlük kaydını etkinleştir</span><span class="sxs-lookup"><span data-stu-id="bcf41-285">Enable logging</span></span>

<span data-ttu-id="bcf41-286">SignalR giderilmesine yardımcı olmak için istemcide etkinleştirebilirsiniz bir yerleşik günlük işlevi vardır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-286">SignalR has a built-in logging function that you can enable on the client to aid in troubleshooting.</span></span> <span data-ttu-id="bcf41-287">Bu bölümdeki günlüğe yazılmasını etkinleştirmek ve nasıl günlükleri SignalR kullanarak, aşağıdaki taşıma yöntemleri size Göster örneklere bakın:</span><span class="sxs-lookup"><span data-stu-id="bcf41-287">In this section you enable logging and see examples that show how logs tell you which of the following transport methods SignalR is using:</span></span>

- <span data-ttu-id="bcf41-288">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), IIS 8 ve geçerli tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-288">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), supported by IIS 8 and current browsers.</span></span>
- <span data-ttu-id="bcf41-289">[Sunucu tarafından gönderilen olaylar](http://en.wikipedia.org/wiki/Server-sent_events), Internet Explorer dışında tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-289">[Server-sent events](http://en.wikipedia.org/wiki/Server-sent_events), supported by browsers other than Internet Explorer.</span></span>
- <span data-ttu-id="bcf41-290">[Devamlı çerçeve](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe), Internet Explorer tarafından desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="bcf41-290">[Forever frame](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe), supported by Internet Explorer.</span></span>
- <span data-ttu-id="bcf41-291">[AJAX yoklama uzun](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling), tüm tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-291">[Ajax long polling](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling), supported by all browsers.</span></span>

<span data-ttu-id="bcf41-292">Verilen her bağlantı için SignalR hem sunucu hem de istemci destek en iyi aktarım yöntemi seçer.</span><span class="sxs-lookup"><span data-stu-id="bcf41-292">For any given connection, SignalR chooses the best transport method that both the server and the client support.</span></span>

1. <span data-ttu-id="bcf41-293">Açık *StockTicker.js* ve bir dosyanın sonunda bağlantı başlatır kodundan hemen önce günlüğe kaydetmeyi etkinleştirmek için kod satırı ekleyin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-293">Open *StockTicker.js* and add a line of code to enable logging immediately before the code that initializes the connection at the end of the file:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample19.js)]
2. <span data-ttu-id="bcf41-294">Projeyi çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-294">Press F5 to run the project.</span></span>
3. <span data-ttu-id="bcf41-295">Tarayıcınızın geliştirici araçları penceresini açın ve konsol günlükleri görmek için seçin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-295">Open your browser's developer tools window, and select the Console to see the logs.</span></span> <span data-ttu-id="bcf41-296">Signalr aktarım yöntemi için yeni bir bağlantı anlaşması günlükleri görmek için sayfayı yenileyin gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-296">You might have to refresh the page to see the logs of Signalr negotiating the transport method for a new connection.</span></span>

    <span data-ttu-id="bcf41-297">Windows 8 (IIS 8) Internet Explorer 10 çalıştırıyorsanız, aktarım WebSockets yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-297">If you are running Internet Explorer 10 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![IE 10 IIS 8 Console](tutorial-server-broadcast-with-signalr/_static/image9.png)

    <span data-ttu-id="bcf41-299">Internet Explorer 10 Windows 7 (IIS 7.5) çalıştırıyorsanız, aktarım IFRAME yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-299">If you are running Internet Explorer 10 on Windows 7 (IIS 7.5), the transport method is iframe.</span></span>

    ![IE 10 Console, IIS 7.5](tutorial-server-broadcast-with-signalr/_static/image10.png)

    <span data-ttu-id="bcf41-301">Firefox'ta, Firebug bir konsol penceresi almak için eklentisini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-301">In Firefox, install the Firebug add-in to get a Console window.</span></span> <span data-ttu-id="bcf41-302">Windows 8 (IIS 8) Firefox 19 çalıştırıyorsanız, aktarım WebSockets yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-302">If you are running Firefox 19 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![Firefox 19 IIS 8 Websockets](tutorial-server-broadcast-with-signalr/_static/image11.png)

    <span data-ttu-id="bcf41-304">Windows 7 (IIS 7.5) Firefox 19 çalıştırıyorsanız, aktarım sunucu tarafından gönderilen olaylar yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-304">If you are running Firefox 19 on Windows 7 (IIS 7.5), the transport method is server-sent events.</span></span>

    ![Firefox 19 IIS 7.5 Console](tutorial-server-broadcast-with-signalr/_static/image12.png)

<a id="fullsample"></a>

## <a name="install-and-review-the-full-stockticker-sample"></a><span data-ttu-id="bcf41-306">Yükleme ve tam StockTicker örnek gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="bcf41-306">Install and review the full StockTicker sample</span></span>

<span data-ttu-id="bcf41-307">Tarafından yüklenen StockTicker uygulama [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketi sıfırdan az önce oluşturduğunuz Basitleştirilmiş sürümden daha fazla özellik içerir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-307">The StockTicker application that is installed by the [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package includes more features than the simplified version that you just created from scratch.</span></span> <span data-ttu-id="bcf41-308">Öğreticinin bu bölümünde NuGet paketini yükleyin ve yeni özellikler ve bunları uygulayan kodunu gözden geçirin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-308">In this section of the tutorial, you install the NuGet package and review the new features and the code that implements them.</span></span> <span data-ttu-id="bcf41-309">Bu öğreticinin önceki adımları gerçekleştirmeden paketi yüklerseniz OWIN başlangıç sınıfı projenize eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-309">If you install the package without performing the earlier steps of this tutorial, you must add an OWIN startup class to your project.</span></span> <span data-ttu-id="bcf41-310">Bu adım için NuGet paketi readme.txt dosyasında açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-310">This step is explained in the readme.txt file for the NuGet package.</span></span>

### <a name="install-the-signalrsample-nuget-package"></a><span data-ttu-id="bcf41-311">SignalR.Sample NuGet paketini yükleyin</span><span class="sxs-lookup"><span data-stu-id="bcf41-311">Install the SignalR.Sample NuGet package</span></span>

1. <span data-ttu-id="bcf41-312">İçinde **Çözüm Gezgini**, projeyi sağ tıklatın ve **NuGet paketlerini Yönet**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-312">In **Solution Explorer**, right-click the project and click **Manage NuGet Packages**.</span></span>
2. <span data-ttu-id="bcf41-313">İçinde **NuGet paketlerini Yönet** iletişim kutusu, tıklatın **çevrimiçi**, girin *SignalR.Sample* içinde **arama çevrimiçi** kutusuna ve ardından tıklatın **Yükleme** içinde **SignalR.Sample** paket.</span><span class="sxs-lookup"><span data-stu-id="bcf41-313">In the **Manage NuGet Packages** dialog box, click **Online**, enter *SignalR.Sample* in the **Search Online** box, and then click **Install** in the **SignalR.Sample** package.</span></span>

    ![SignalR.Sample paketini yükle](tutorial-server-broadcast-with-signalr/_static/image13.png)
3. <span data-ttu-id="bcf41-315">İçinde **Çözüm Gezgini**, genişletin *SignalR.Sample* SignalR.Sample paketi yükleyerek oluşturulduğu klasör.</span><span class="sxs-lookup"><span data-stu-id="bcf41-315">In **Solution Explorer**, expand the *SignalR.Sample* folder which was created by installing the SignalR.Sample package.</span></span>
4. <span data-ttu-id="bcf41-316">İçinde *SignalR.Sample* klasörünü sağ tıklatın *StockTicker.html*ve ardından **başlangıç sayfası olarak ayarla**.</span><span class="sxs-lookup"><span data-stu-id="bcf41-316">In the *SignalR.Sample* folder, right-click *StockTicker.html*, and then click **Set As Start Page**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="bcf41-317">Yükleme için SignalR.Sample NuGet paketi uygulamanızdaki jQuery sürümü değişebilir, *betikleri* klasör.</span><span class="sxs-lookup"><span data-stu-id="bcf41-317">Installing The SignalR.Sample NuGet package might change the version of jQuery that you have in your *Scripts* folder.</span></span> <span data-ttu-id="bcf41-318">Yeni *StockTicker.html* paketi yükler dosya *SignalR.Sample* klasörü orijinal çalıştırmakisteyipistemediğiniziancakyükleyenpaket,jQuerysürümüyleeşitlemeolacaktır*StockTicker.html* dosyasını yeniden, komut dosyası etiketinin jQuery başvurusunda önce güncelleştirmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-318">The new *StockTicker.html* file that the package installs in the *SignalR.Sample* folder will be in sync with the jQuery version that the package installs, but if you want to run your original *StockTicker.html* file again, you might have to update the jQuery reference in the script tag first.</span></span>

### <a name="run-the-application"></a><span data-ttu-id="bcf41-319">Uygulamayı çalıştırın</span><span class="sxs-lookup"><span data-stu-id="bcf41-319">Run the application</span></span>

1. <span data-ttu-id="bcf41-320">Uygulamayı çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-320">Press F5 to run the application.</span></span>

    <span data-ttu-id="bcf41-321">Daha önce gördüğünüzle kılavuza ek olarak, tam borsa uygulama aynı stok verileri görüntüleyen bir yatay kaydırma penceresi gösterilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-321">In addition to the grid that you saw earlier, the full stock ticker application shows a horizontally scrolling window that displays the same stock data.</span></span> <span data-ttu-id="bcf41-322">Uygulamayı ilk kez çalıştırdığınızda "pazar" "kapalı" ve statik bir tablo ve kaydırma değil bir borsa takip pencere görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-322">When you run the application for the first time, the "market" is "closed" and you see a static grid and a ticker window that isn't scrolling.</span></span>

    ![StockTicker ekran Başlat](tutorial-server-broadcast-with-signalr/_static/image14.png)

    <span data-ttu-id="bcf41-324">Tıkladığınızda **açık Pazar**, **dinamik stok borsa takip** kutusunu yatay kaydırma, ve sunucu stok fiyat değişiklikleri rasgele olarak düzenli aralıklarla yayınlanacak başlayan.</span><span class="sxs-lookup"><span data-stu-id="bcf41-324">When you click **Open Market**, the **Live Stock Ticker** box starts to scroll horizontally, and the server starts to periodically broadcast stock price changes on a random basis.</span></span> <span data-ttu-id="bcf41-325">Hisse senedi fiyatı her zaman değişikliği, her ikisi de **dinamik stok tablo** kılavuz ve **dinamik stok borsa takip** kutusunu güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-325">Each time a stock price changes, both the **Live Stock Table** grid and the **Live Stock Ticker** box are updated.</span></span> <span data-ttu-id="bcf41-326">Hisse 's fiyat değişikliği pozitif olduğunda hisse senedi yeşil bir arka plan gösterilir ve değişiklik negatif olduğunda hisse senedi kırmızı bir arka plan ile gösterilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-326">When a stock's price change is positive, the stock is shown with a green background, and when the change is negative, the stock is shown with a red background.</span></span>

    ![Pazar StockTicker uygulamasını açın](tutorial-server-broadcast-with-signalr/_static/image15.png)

    <span data-ttu-id="bcf41-328">**Kapat Pazar** düğmesi değişiklikleri ve kaydırma borsa takip durur ve **sıfırlama** düğme fiyat değişiklikleri başlatmadan önce bu tüm hisse senedi verileri ilk durumuna sıfırlar.</span><span class="sxs-lookup"><span data-stu-id="bcf41-328">The **Close Market** button stops the changes and stops the ticker scrolling, and the **Reset** button resets all stock data to the initial state before price changes started.</span></span> <span data-ttu-id="bcf41-329">Daha fazla tarayıcı pencerelerini açın ve aynı URL'ye gidin, aynı zamanda her tarayıcıda dinamik olarak güncelleştirilen aynı veri bakın.</span><span class="sxs-lookup"><span data-stu-id="bcf41-329">If you open more browser windows and go to the same URL, you see the same data dynamically updated at the same time in each browser.</span></span> <span data-ttu-id="bcf41-330">Düğmeleri birine tıkladığınızda, tüm tarayıcılar aynı anda aynı şekilde yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-330">When you click one of the buttons, all browsers respond the same way at the same time.</span></span>

### <a name="live-stock-ticker-display"></a><span data-ttu-id="bcf41-331">Dinamik stok borsa takip görüntüleme</span><span class="sxs-lookup"><span data-stu-id="bcf41-331">Live Stock Ticker display</span></span>

<span data-ttu-id="bcf41-332">**Dinamik stok borsa takip** sırasız bir listesini tek bir satıra CSS stilleri göre biçimlendirilmiş bir div öğesinin içinde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-332">The **Live Stock Ticker** display is an unordered list in a div element that is formatted into a single line by CSS styles.</span></span> <span data-ttu-id="bcf41-333">Sayaç başlatılır ve tablo aynı şekilde güncelleştirildi: yer tutucuları değiştirerek bir &lt;li&gt; şablonu dizesi ve dinamik olarak ekleme &lt;li&gt; öğelerine &lt;ul&gt; öğesi.</span><span class="sxs-lookup"><span data-stu-id="bcf41-333">The ticker is initialized and updated the same way as the table: by replacing placeholders in a &lt;li&gt; template string and dynamically adding the &lt;li&gt; elements to the &lt;ul&gt; element.</span></span> <span data-ttu-id="bcf41-334">Kaydırma DIV içinde sırasız liste sol kenar boşluğu değiştirmek için jQuery animasyon olarak oluşturmak işlevini kullanarak gerçekleştirilir</span><span class="sxs-lookup"><span data-stu-id="bcf41-334">The scrolling is performed by using the jQuery animate function to vary the margin-left of the unordered list within the div.</span></span>

<span data-ttu-id="bcf41-335">Bandı HTML:</span><span class="sxs-lookup"><span data-stu-id="bcf41-335">The stock ticker HTML:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample20.html)]

<span data-ttu-id="bcf41-336">Bandı CSS:</span><span class="sxs-lookup"><span data-stu-id="bcf41-336">The stock ticker CSS:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-signalr/samples/sample21.html)]

<span data-ttu-id="bcf41-337">Kolaylaştırır jQuery kodu kaydırma:</span><span class="sxs-lookup"><span data-stu-id="bcf41-337">The jQuery code that makes it scroll:</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample22.js)]

### <a name="additional-methods-on-the-server-that-the-client-can-call"></a><span data-ttu-id="bcf41-338">İstemci çağırabilirsiniz sunucuda ek yöntemleri</span><span class="sxs-lookup"><span data-stu-id="bcf41-338">Additional methods on the server that the client can call</span></span>

<span data-ttu-id="bcf41-339">StockTickerHub sınıfı, istemci çağırabilirsiniz dört ek yöntemleri tanımlar:</span><span class="sxs-lookup"><span data-stu-id="bcf41-339">The StockTickerHub class defines four additional methods that the client can call:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample23.cs)]

<span data-ttu-id="bcf41-340">Sayfanın üstündeki düğmelere yanıt OpenMarket, CloseMarket ve sıfırlama çağrılır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-340">OpenMarket, CloseMarket, and Reset are called in response to the buttons at the top of the page.</span></span> <span data-ttu-id="bcf41-341">Bunlar, tüm istemcilere hemen yayılır durumundaki bir değişikliği tetikleyen bir istemci desenini gösterir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-341">They demonstrate the pattern of one client triggering a change in state that is immediately propagated to all clients.</span></span> <span data-ttu-id="bcf41-342">Bu yöntemlerin her biri bir yöntem StockTicker sınıfında Pazar durumu değiştirin ve ardından yeni bir durum yayınlar bu etkileri çağırır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-342">Each of these methods calls a method in the StockTicker class that effects the market state change and then broadcasts the new state.</span></span>

<span data-ttu-id="bcf41-343">StockTicker sınıfında Pazar durumunu MarketState enum değeri döndüren bir MarketState özelliği tarafından korunur:</span><span class="sxs-lookup"><span data-stu-id="bcf41-343">In the StockTicker class, the state of the market is maintained by a MarketState property that returns a MarketState enum value:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample24.cs)]

<span data-ttu-id="bcf41-344">Pazar durum değişikliği yöntemlerin her biri bunu kilit bloğu içinde StockTicker sınıfı threadsafe olduğu:</span><span class="sxs-lookup"><span data-stu-id="bcf41-344">Each of the methods that change the market state do so inside a lock block because the StockTicker class has to be threadsafe:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample25.cs)]

<span data-ttu-id="bcf41-345">Bu kod threadsafe, olduğundan emin olmak için \_MarketState özelliği yedekler marketState alanı geçici işaretli</span><span class="sxs-lookup"><span data-stu-id="bcf41-345">To ensure that this code is threadsafe, the \_marketState field that backs the MarketState property is marked as volatile,</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample26.cs)]

<span data-ttu-id="bcf41-346">İstemcide tanımlanan farklı yöntemleri çağırmak dışında BroadcastMarketStateChange ve BroadcastMarketReset yöntemleri zaten gördüğünüz, BroadcastStockPrice yöntemi benzerdir:</span><span class="sxs-lookup"><span data-stu-id="bcf41-346">The BroadcastMarketStateChange and BroadcastMarketReset methods are similar to the BroadcastStockPrice method that you already saw, except they call different methods defined at the client:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-signalr/samples/sample27.cs)]

### <a name="additional-functions-on-the-client-that-the-server-can-call"></a><span data-ttu-id="bcf41-347">Sunucu çağırabilirsiniz istemci üzerinde ek işlevleri</span><span class="sxs-lookup"><span data-stu-id="bcf41-347">Additional functions on the client that the server can call</span></span>

<span data-ttu-id="bcf41-348">UpdateStockPrice işlevi artık kılavuz ve borsa takip görüntü işleme ve kırmızı ve yeşil renkleri Flash jQuery.Color kullanır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-348">The updateStockPrice function now handles both the grid and the ticker display, and it uses jQuery.Color to flash red and green colors.</span></span>

<span data-ttu-id="bcf41-349">Yeni işlevler *SignalR.StockTicker.js* etkinleştirme ve devre dışı bırak düğmeleri temel alarak pazara durumu ve bunlar başlatmak veya durdurmak borsa takip penceresini yatay kaydırma.</span><span class="sxs-lookup"><span data-stu-id="bcf41-349">New functions in *SignalR.StockTicker.js* enable and disable the buttons based on market state, and they stop or start the ticker window horizontal scrolling.</span></span> <span data-ttu-id="bcf41-350">Birden çok işlevleri ticker.client için eklenmekte olan bu yana [jQuery genişletmek işlevi](http://api.jquery.com/jQuery.extend/) bunları eklemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="bcf41-350">Since multiple functions are being added to ticker.client, the [jQuery extend function](http://api.jquery.com/jQuery.extend/) is used to add them.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample28.js)]

### <a name="additional-client-setup-after-establishing-the-connection"></a><span data-ttu-id="bcf41-351">Bağlantı kurulduktan sonra ek istemci kurulumu</span><span class="sxs-lookup"><span data-stu-id="bcf41-351">Additional client setup after establishing the connection</span></span>

<span data-ttu-id="bcf41-352">İstemci bağlantı kurar sonra yapmak için bazı ek iş vardır: Pazar açık veya kapalı uygun marketOpened veya marketClosed işlevini çağırın ve sunucu yöntem çağrılarını düğmelere eklemek için olup olmadığını öğrenin.</span><span class="sxs-lookup"><span data-stu-id="bcf41-352">After the client establishes the connection, it has some additional work to do: find out if the market is open or closed in order to call the appropriate marketOpened or marketClosed function, and attach the server method calls to the buttons.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-signalr/samples/sample29.js)]

<span data-ttu-id="bcf41-353">Bağlantı kurulduktan sonra böylece kodu kullanılabilir önce sunucu yöntemlerini çağırmaya deneyemez server yöntemlerini kadar düğmeleri kadar kablolu arabirimlerdir değil.</span><span class="sxs-lookup"><span data-stu-id="bcf41-353">The server methods are not wired up to the buttons until after the connection is established, so that the code can't try to call the server methods before they are available.</span></span>

<a id="nextsteps"></a>

## <a name="next-steps"></a><span data-ttu-id="bcf41-354">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="bcf41-354">Next steps</span></span>

<span data-ttu-id="bcf41-355">Bu öğreticide iletileri sunucudan bağlanan tüm istemciler, düzenli aralıklarla hem bildirimlere yanıt olarak herhangi bir istemciden yayınlar SignalR uygulama programı nasıl öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="bcf41-355">In this tutorial you've learned how to program a SignalR application that broadcasts messages from the server to all connected clients, both on a periodic basis and in response to notifications from any client.</span></span> <span data-ttu-id="bcf41-356">Sunucu durumunu korumak üzere birden çok iş parçacıklı tek bir örneği kullanılarak desenini de çok oyunculu oyun çevrimiçi senaryolarda da kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="bcf41-356">The pattern of using a multi-threaded singleton instance to maintain server state can also be also used in multi-player online game scenarios.</span></span> <span data-ttu-id="bcf41-357">Bir örnek için bkz: [SignalR tabanlı ShootR oyun](https://github.com/NTaylorMullen/ShootR).</span><span class="sxs-lookup"><span data-stu-id="bcf41-357">For an example, see [the ShootR game that is based on SignalR](https://github.com/NTaylorMullen/ShootR).</span></span>

<span data-ttu-id="bcf41-358">Eşler arası iletişim senaryoları Göster öğreticileri için bkz: [SignalR ile çalışmaya başlama](introduction-to-signalr.md) ve [SignalR ile gerçek zamanlı güncelleştirme](tutorial-high-frequency-realtime-with-signalr.md).</span><span class="sxs-lookup"><span data-stu-id="bcf41-358">For tutorials that show peer-to-peer communication scenarios, see [Getting Started with SignalR](introduction-to-signalr.md) and [Real-Time Updating with SignalR](tutorial-high-frequency-realtime-with-signalr.md).</span></span>

<span data-ttu-id="bcf41-359">Daha gelişmiş SignalR geliştirme kavramları hakkında bilgi için SignalR kaynak kodu ve kaynaklar için aşağıdaki siteleri ziyaret edin:</span><span class="sxs-lookup"><span data-stu-id="bcf41-359">To learn more advanced SignalR development concepts, visit the following sites for SignalR source code and resources:</span></span>

- [<span data-ttu-id="bcf41-360">ASP.NET SignalR</span><span class="sxs-lookup"><span data-stu-id="bcf41-360">ASP.NET SignalR</span></span>](../../index.md)
- [<span data-ttu-id="bcf41-361">SignalR Project</span><span class="sxs-lookup"><span data-stu-id="bcf41-361">SignalR Project</span></span>](http://signalr.net/)
- [<span data-ttu-id="bcf41-362">SignalR Github ve örnekler</span><span class="sxs-lookup"><span data-stu-id="bcf41-362">SignalR Github and Samples</span></span>](https://github.com/SignalR/SignalR)
- [<span data-ttu-id="bcf41-363">SignalR Wiki</span><span class="sxs-lookup"><span data-stu-id="bcf41-363">SignalR Wiki</span></span>](https://github.com/SignalR/SignalR/wiki)

<span data-ttu-id="bcf41-364">Bir SignalR uygulamayı Azure'a dağıtma hakkında bir kılavuz için bkz: [SignalR kullanarak Azure App Service'te Web uygulamalarını](../deployment/using-signalr-with-azure-web-sites.md).</span><span class="sxs-lookup"><span data-stu-id="bcf41-364">For a walkthrough on how to deploy a SignalR application to Azure, see [Using SignalR with Web Apps in Azure App Service](../deployment/using-signalr-with-azure-web-sites.md).</span></span> <span data-ttu-id="bcf41-365">Windows Azure Web sitesi için bir Visual Studio web projesi dağıtma hakkında ayrıntılı bilgi için bkz: [Azure App Service'te bir ASP.NET web uygulaması oluşturma](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-get-started/).</span><span class="sxs-lookup"><span data-stu-id="bcf41-365">For detailed information about how to deploy a Visual Studio web project to a Windows Azure Web Site, see [Create an ASP.NET web app in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-get-started/).</span></span>
