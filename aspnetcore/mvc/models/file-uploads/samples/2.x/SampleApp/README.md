# <a name="upload-files-sample-app"></a><span data-ttu-id="c6a04-101">Dosyaları karşıya yükleme örnek uygulaması</span><span class="sxs-lookup"><span data-stu-id="c6a04-101">Upload Files Sample App</span></span>

<span data-ttu-id="c6a04-102">Bu örnek uygulama, [ASP.NET Core içindeki dosyaları karşıya yükle](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) konusunda açıklanan kavramları gösterir.</span><span class="sxs-lookup"><span data-stu-id="c6a04-102">This sample app demonstrates concepts described in the [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) topic.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="c6a04-103">Güvenlikle ilgili dikkat edilmesi gerekenler</span><span class="sxs-lookup"><span data-stu-id="c6a04-103">Security considerations</span></span>

<span data-ttu-id="c6a04-104">Kullanıcılara bir sunucuya dosya yükleme yeteneği sağlarken dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="c6a04-104">Use caution when providing users with the ability to upload files to a server.</span></span> <span data-ttu-id="c6a04-105">Saldırganlar [hizmet reddi](/windows-hardware/drivers/ifs/denial-of-service) saldırıları yürütebilir, virüs veya kötü amaçlı yazılım yüklemeye veya diğer yollarla ağların ve sunucuların güvenliğinin aşılmasına çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="c6a04-105">Attackers may execute [denial of service](/windows-hardware/drivers/ifs/denial-of-service) attacks, attempt to upload viruses or malware, or attempt to compromise networks and servers in other ways.</span></span>

<span data-ttu-id="c6a04-106">Başarılı bir saldırının olasılığını azaltan güvenlik adımları şunlardır:</span><span class="sxs-lookup"><span data-stu-id="c6a04-106">Security steps that reduce the likelihood of a successful attack are:</span></span>

* <span data-ttu-id="c6a04-107">Dosyaları, tercihen sistem dışı bir sürücüye sahip bir özel dosya yükleme alanına yükleyin.</span><span class="sxs-lookup"><span data-stu-id="c6a04-107">Upload files to a dedicated file upload area on the system, preferably to a non-system drive.</span></span> <span data-ttu-id="c6a04-108">Adanmış bir konumun kullanılması, karşıya yüklenen dosyalar üzerinde güvenlik önlemleri yapmayı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="c6a04-108">Use of a dedicated location makes it easier to impose security measures on uploaded files.</span></span> <span data-ttu-id="c6a04-109">Dosya yükleme konumunda yürütme izinlerini devre dışı bırakın.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-109">Disable execute permissions on the file upload location.&dagger;</span></span>
* <span data-ttu-id="c6a04-110">Karşıya yüklenen dosyaları uygulamayla aynı dizin ağacında hiçbir şekilde kalıcı hale getirme.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-110">Never persist uploaded files in the same directory tree as the app.&dagger;</span></span>
* <span data-ttu-id="c6a04-111">Uygulama tarafından belirlenen bir güvenli dosya adı kullanın.</span><span class="sxs-lookup"><span data-stu-id="c6a04-111">Use a safe file name determined by the app.</span></span> <span data-ttu-id="c6a04-112">Kullanıcı girişi veya karşıya yüklenen dosyanın güvenilmeyen dosya adı tarafından belirtilen bir dosya adı kullanmayın.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-112">Don't use a file name provided by user input or the untrusted file name of the uploaded file.&dagger;</span></span>
* <span data-ttu-id="c6a04-113">Yalnızca belirli bir onaylanan dosya uzantıları kümesine izin verin.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-113">Only allow a specific set of approved file extensions.&dagger;</span></span>
* <span data-ttu-id="c6a04-114">Kullanıcının bir kendini gizleyen dosya yüklemesini engellemek için dosya biçimi imzasını denetleyin (örneğin,. *exe* dosyasını *. txt* uzantısıyla karşıya yükleme).&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-114">Check the file format signature to prevent a user from uploading a masqueraded file (for example, uploading an *.exe* file with a *.txt* extension).&dagger;</span></span>
* <span data-ttu-id="c6a04-115">Sunucu üzerinde istemci tarafı denetimlerinin de gerçekleştirildiğinden emin olun.</span><span class="sxs-lookup"><span data-stu-id="c6a04-115">Verify that client-side checks are also performed on the server.</span></span> <span data-ttu-id="c6a04-116">İstemci tarafı denetimleri kolayca atmayı kolaylaştırır.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-116">Client-side checks are easy to circumvent.&dagger;</span></span>
* <span data-ttu-id="c6a04-117">Karşıya yükleme işleminin boyutunu denetleyin ve beklenenden daha büyük olan karşıya yüklemeleri önleyin.&dagger;</span><span class="sxs-lookup"><span data-stu-id="c6a04-117">Check the size of the upload and prevent uploads that are larger than expected.&dagger;</span></span>
* <span data-ttu-id="c6a04-118">Aynı ada sahip karşıya yüklenen bir dosya tarafından dosyaların üzerine yazılmaması gerektiğinde, dosyayı karşıya yüklemeden önce dosya adını veritabanına veya fiziksel depolamaya göre denetleyin.</span><span class="sxs-lookup"><span data-stu-id="c6a04-118">When files shouldn't be overwritten by an uploaded file with the same name, check the file name against the database or physical storage before uploading the file.</span></span>
* <span data-ttu-id="c6a04-119">**Dosya depolanmadan önce karşıya yüklenen içerik üzerinde bir virüs/kötü amaçlı yazılım tarayıcısı çalıştırın.**</span><span class="sxs-lookup"><span data-stu-id="c6a04-119">**Run a virus/malware scanner on uploaded content before the file is stored.**</span></span>

<span data-ttu-id="c6a04-120">örnek uygulama &dagger;ölçütleri karşılayan bir yaklaşımı gösterir.</span><span class="sxs-lookup"><span data-stu-id="c6a04-120">&dagger;The sample app demonstrates an approach that meets the criteria.</span></span>

> [!WARNING]
> <span data-ttu-id="c6a04-121">Kötü amaçlı bir kodun bir sisteme karşıya yükleme için kod yürütme için ilk adımı sık şöyledir:</span><span class="sxs-lookup"><span data-stu-id="c6a04-121">Uploading malicious code to a system is frequently the first step to executing code that can:</span></span>
>
> * <span data-ttu-id="c6a04-122">Tamamen devralma sistemin.</span><span class="sxs-lookup"><span data-stu-id="c6a04-122">Completely takeover a system.</span></span>
> * <span data-ttu-id="c6a04-123">Sistemin kilitlenme sonucuyla bir sistemi aşırı yükleme.</span><span class="sxs-lookup"><span data-stu-id="c6a04-123">Overload a system with the result that the system crashes.</span></span>
> * <span data-ttu-id="c6a04-124">Kullanıcı veya sistem verilerini tehlikeye.</span><span class="sxs-lookup"><span data-stu-id="c6a04-124">Compromise user or system data.</span></span>
> * <span data-ttu-id="c6a04-125">Genel Kullanıcı arabirimine Graffiti uygulayın.</span><span class="sxs-lookup"><span data-stu-id="c6a04-125">Apply graffiti to a public UI.</span></span>
>
> <span data-ttu-id="c6a04-126">Kullanıcıların dosyaları kabul ederken saldırı yüzey alanı azaltma hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="c6a04-126">For information on reducing the attack surface area when accepting files from users, see the following resources:</span></span>
>
> * [<span data-ttu-id="c6a04-127">Sınırsız dosya karşıya yükleme</span><span class="sxs-lookup"><span data-stu-id="c6a04-127">Unrestricted File Upload</span></span>](https://www.owasp.org/index.php/Unrestricted_File_Upload)
> * [<span data-ttu-id="c6a04-128">Azure güvenlik: uygun denetimleri kullanıcıların dosyaları kabul ederken karşılandığından emin</span><span class="sxs-lookup"><span data-stu-id="c6a04-128">Azure Security: Ensure appropriate controls are in place when accepting files from users</span></span>](/azure/security/azure-security-threat-modeling-tool-input-validation#controls-users)

<span data-ttu-id="c6a04-129">Daha fazla bilgi için bkz. [ASP.NET Core dosyaları karşıya yükleme](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span><span class="sxs-lookup"><span data-stu-id="c6a04-129">For additional information, see [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span></span>

## <a name="how-to-use-the-sample"></a><span data-ttu-id="c6a04-130">Örneği kullanma</span><span class="sxs-lookup"><span data-stu-id="c6a04-130">How to use the sample</span></span>

<span data-ttu-id="c6a04-131">*AppSettings. JSON* dosyasında:</span><span class="sxs-lookup"><span data-stu-id="c6a04-131">In the *appsettings.json* file:</span></span>

1. <span data-ttu-id="c6a04-132">Depolanan dosyalar için yolu ayarlayın (`StoredFilesPath`).</span><span class="sxs-lookup"><span data-stu-id="c6a04-132">Set the path for stored files (`StoredFilesPath`).</span></span>

   * <span data-ttu-id="c6a04-133">Örnek uygulama, değeri, sistem C: sürücü kökünde *Dosya* adında bir klasör olduğunu varsayan `c:\\files`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="c6a04-133">The sample app sets the value to `c:\\files`, which assumes that a folder named *files* exists at the system's C: drive root.</span></span>
   * <span data-ttu-id="c6a04-134">Yolun mevcut olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c6a04-134">The path must exist.</span></span> <span data-ttu-id="c6a04-135">Sistemin C: sürücüsünde bir *dosyalar* klasörü oluşturun veya yolu uygun bir konum olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c6a04-135">Create a *files* folder on the system's C: drive or set the path to a suitable location.</span></span>
   * <span data-ttu-id="c6a04-136">Uygulamanın işlemi, yola okuma/yazma izinleri gerektiriyor.</span><span class="sxs-lookup"><span data-stu-id="c6a04-136">The app's process requires read/write permissions to the path.</span></span>
   * <span data-ttu-id="c6a04-137">**ÖNEMLI!**</span><span class="sxs-lookup"><span data-stu-id="c6a04-137">**IMPORTANT!**</span></span> <span data-ttu-id="c6a04-138">Yoldaki tüm kullanıcılar için yürütme izinlerini devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="c6a04-138">Disable execute permissions for all users at the path.</span></span>

1. <span data-ttu-id="c6a04-139">Dosya boyutu sınırını (`FileSizeLimit`) bayt cinsinden ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c6a04-139">Set the file size limit (`FileSizeLimit`) in bytes.</span></span> <span data-ttu-id="c6a04-140">Örnek uygulamanın varsayılan değer olan `2097152` (2.097.152 bayt), dosya yüklemelerine 2 MB 'a kadar izin verir.</span><span class="sxs-lookup"><span data-stu-id="c6a04-140">The sample app's default value of `2097152` (2,097,152 bytes) permits file uploads up to 2 MB.</span></span>
