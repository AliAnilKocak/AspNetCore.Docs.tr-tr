---
title: Bir web grubundaki ASP.NET Core barındırma
author: guardrex
description: ASP.NET Core uygulaması bir web grubu ortamında paylaşılan kaynaklar ile birden çok örneğini barındırmayı öğrenin.
ms.author: riande
ms.custom: mvc
ms.date: 07/16/2018
uid: host-and-deploy/web-farm
ms.openlocfilehash: 2435c24bc205486331c828337ca81c43e6e60448
ms.sourcegitcommit: 3ca527f27c88cfc9d04688db5499e372fbc2c775
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/17/2018
ms.locfileid: "39096104"
---
# <a name="host-aspnet-core-in-a-web-farm"></a><span data-ttu-id="f067d-103">Bir web grubundaki ASP.NET Core barındırma</span><span class="sxs-lookup"><span data-stu-id="f067d-103">Host ASP.NET Core in a web farm</span></span>

<span data-ttu-id="f067d-104">Tarafından [Luke Latham](https://github.com/guardrex) ve [Chris Ross](https://github.com/Tratcher)</span><span class="sxs-lookup"><span data-stu-id="f067d-104">By [Luke Latham](https://github.com/guardrex) and [Chris Ross](https://github.com/Tratcher)</span></span>

<span data-ttu-id="f067d-105">A *web grubu* iki veya daha fazla web sunucusu grubudur (veya *düğümleri*) birden fazla uygulama barındırın.</span><span class="sxs-lookup"><span data-stu-id="f067d-105">A *web farm* is a group of two or more web servers (or *nodes*) that host multiple instances of an app.</span></span> <span data-ttu-id="f067d-106">Bir web grubu için kullanıcılardan gelen istekleri geldiğinde bir *yük dengeleyici* istekleri web grubun düğümlere dağıtır.</span><span class="sxs-lookup"><span data-stu-id="f067d-106">When requests from users arrive to a web farm, a *load balancer* distributes the requests to the web farm's nodes.</span></span> <span data-ttu-id="f067d-107">Web grupları geliştirme:</span><span class="sxs-lookup"><span data-stu-id="f067d-107">Web farms improve:</span></span>

* <span data-ttu-id="f067d-108">**Güvenilirlik/kullanılabilirlik** &ndash; bir veya daha fazla düğüm başarısız olursa, yük dengeleyici, istekleri istekleri işlemeye devam et için çalışan diğer düğümlere yönlendirebilir.</span><span class="sxs-lookup"><span data-stu-id="f067d-108">**Reliability/availability** &ndash; When one or more nodes fail, the load balancer can route requests to other functioning nodes to continue processing requests.</span></span>
* <span data-ttu-id="f067d-109">**Kapasite/performans** &ndash; birden çok düğüm, tek bir sunucudan daha fazla istekleri işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="f067d-109">**Capacity/performance** &ndash; Multiple nodes can process more requests than a single server.</span></span> <span data-ttu-id="f067d-110">Yük Dengeleyici, istekleri düğümlerine dağıtarak iş yükünü dengeler.</span><span class="sxs-lookup"><span data-stu-id="f067d-110">The load balancer balances the workload by distributing requests to the nodes.</span></span>
* <span data-ttu-id="f067d-111">**Ölçeklenebilirlik** &ndash; daha fazla veya daha az kapasite gerekli olduğunda, etkin düğüm sayısını artırabilir veya iş yüküyle eşleşmesi için azaltılabilir.</span><span class="sxs-lookup"><span data-stu-id="f067d-111">**Scalability** &ndash; When more or less capacity is required, the number of active nodes can be increased or decreased to match the workload.</span></span> <span data-ttu-id="f067d-112">Grup platform technologies gibi web [Azure App Service](https://azure.microsoft.com/services/app-service/), otomatik olarak ekleyebilir veya sistem yöneticisinin veya insan müdahalesi olmadan otomatik olarak isteğinde düğümleri kaldırma.</span><span class="sxs-lookup"><span data-stu-id="f067d-112">Web farm platform technologies, such as [Azure App Service](https://azure.microsoft.com/services/app-service/), can automatically add or remove nodes at the request of the system administrator or automatically without human intervention.</span></span>
* <span data-ttu-id="f067d-113">**Bakım** &ndash; sonuçları daha kolay Sistem Yönetimi'nde bir dizi paylaşılan hizmetler bir web grubu düğümlerinin güvenebilirler.</span><span class="sxs-lookup"><span data-stu-id="f067d-113">**Maintainability** &ndash; Nodes of a web farm can rely on a set of shared services, which results in easier system management.</span></span> <span data-ttu-id="f067d-114">Örneğin, bir web grubu düğümlerini tek veritabanı sunucusu ve görüntüler ve indirilebilir dosyalar gibi statik kaynaklar için ortak bir ağ konumuna bağlı güvenebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f067d-114">For example, the nodes of a web farm can rely upon a single database server and a common network location for static resources, such as images and downloadable files.</span></span>

<span data-ttu-id="f067d-115">Bu konuda, yapılandırma ve paylaşılan kaynaklar üzerinde kullanan bir web grubunda barındırılan ASP.NET core uygulamaları için bağımlılıklar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="f067d-115">This topic describes configuration and dependencies for ASP.NET core apps hosted in a web farm that rely upon shared resources.</span></span>

## <a name="general-configuration"></a><span data-ttu-id="f067d-116">Genel yapılandırma</span><span class="sxs-lookup"><span data-stu-id="f067d-116">General configuration</span></span>

<xref:host-and-deploy/index>  
<span data-ttu-id="f067d-117">Barındırma ortamları hakkında bilgi edinmek ve ASP.NET Core uygulamaları dağıtın.</span><span class="sxs-lookup"><span data-stu-id="f067d-117">Learn how to set up hosting environments and deploy ASP.NET Core apps.</span></span> <span data-ttu-id="f067d-118">Bir işlem yöneticisi başlar ve yeniden başlatma otomatik hale getirmek için web grubunda her bir düğümde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="f067d-118">Configure a process manager on each node of the web farm to automate app starts and restarts.</span></span> <span data-ttu-id="f067d-119">Her düğüm, ASP.NET Core çalışma zamanı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="f067d-119">Each node requires the ASP.NET Core runtime.</span></span> <span data-ttu-id="f067d-120">Konular, daha fazla bilgi için bkz [konak dağıtıp](xref:host-and-deploy/index) belgelerin alan.</span><span class="sxs-lookup"><span data-stu-id="f067d-120">For more information, see the topics in the [Host and deploy](xref:host-and-deploy/index) area of the documentation.</span></span>

<xref:host-and-deploy/proxy-load-balancer>  
<span data-ttu-id="f067d-121">Proxy sunucuları ve yük Dengeleyiciler, genellikle önemli bilgi gizlememeniz arkasında barındırılan uygulamalar için yapılandırma hakkında bilgi edinin.</span><span class="sxs-lookup"><span data-stu-id="f067d-121">Learn about configuration for apps hosted behind proxy servers and load balancers, which often obscure important request information.</span></span>

<xref:host-and-deploy/azure-apps/index>  
<span data-ttu-id="f067d-122">[Azure App Service](https://azure.microsoft.com/services/app-service/) olduğu bir [Microsoft bulut platformu hizmet](https://azure.microsoft.com/) ASP.NET Core web uygulamalarını barındırmak için dahil olmak üzere.</span><span class="sxs-lookup"><span data-stu-id="f067d-122">[Azure App Service](https://azure.microsoft.com/services/app-service/) is a [Microsoft cloud computing platform service](https://azure.microsoft.com/) for hosting web apps, including ASP.NET Core.</span></span> <span data-ttu-id="f067d-123">App Service otomatik ölçeklendirme, Yük Dengeleme, düzeltme eki uygulama ve sürekli dağıtım sağlayan tam olarak yönetilen bir platformdur.</span><span class="sxs-lookup"><span data-stu-id="f067d-123">App Service is a fully managed platform that provides automatic scaling, load balancing, patching, and continuous deployment.</span></span>

## <a name="app-data"></a><span data-ttu-id="f067d-124">Uygulama verileri</span><span class="sxs-lookup"><span data-stu-id="f067d-124">App data</span></span>

<span data-ttu-id="f067d-125">Bir uygulama birden fazla örneğe ölçeklendirildiğinde düğümlere paylaşımı gerektiren uygulama durumu olabilir.</span><span class="sxs-lookup"><span data-stu-id="f067d-125">When an app is scaled to multiple instances, there might be app state that requires sharing across nodes.</span></span> <span data-ttu-id="f067d-126">Paylaşım geçici bir durumdur, düşünün bir [IDistributedCache](/dotnet/api/microsoft.extensions.caching.distributed.idistributedcache).</span><span class="sxs-lookup"><span data-stu-id="f067d-126">If the state is transient, consider sharing an [IDistributedCache](/dotnet/api/microsoft.extensions.caching.distributed.idistributedcache).</span></span> <span data-ttu-id="f067d-127">Paylaşılan durum Kalıcılık gerektiriyorsa, paylaşılan durumu bir veritabanında saklamanın göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="f067d-127">If the shared state requires persistence, consider storing the shared state in a database.</span></span>

## <a name="required-configuration"></a><span data-ttu-id="f067d-128">Gerekli yapılandırma</span><span class="sxs-lookup"><span data-stu-id="f067d-128">Required configuration</span></span>

<span data-ttu-id="f067d-129">Veri koruma ve önbelleğe alma, bir web grubuna dağıtılan uygulamalar için yapılandırma gerektirir.</span><span class="sxs-lookup"><span data-stu-id="f067d-129">Data Protection and Caching require configuration for apps deployed to a web farm.</span></span>

### <a name="data-protection"></a><span data-ttu-id="f067d-130">Veri Koruma</span><span class="sxs-lookup"><span data-stu-id="f067d-130">Data Protection</span></span>

<span data-ttu-id="f067d-131">[ASP.NET Core veri koruma sisteminde](xref:security/data-protection/introduction) verileri korumak için uygulamalar tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="f067d-131">The [ASP.NET Core Data Protection system](xref:security/data-protection/introduction) is used by apps to protect data.</span></span> <span data-ttu-id="f067d-132">Veri koruması kullanır depolanan şifreleme anahtarları kümesi üzerinde bir *anahtar halkası*.</span><span class="sxs-lookup"><span data-stu-id="f067d-132">Data Protection relies upon a set of cryptographic keys stored in a *key ring*.</span></span> <span data-ttu-id="f067d-133">Veri koruma sisteminde başlatıldığında, geçerli [varsayılan ayarları](xref:security/data-protection/configuration/default-settings) anahtar halkası yerel olarak depolar.</span><span class="sxs-lookup"><span data-stu-id="f067d-133">When the Data Protection system is initialized, it applies [default settings](xref:security/data-protection/configuration/default-settings) that store the key ring locally.</span></span> <span data-ttu-id="f067d-134">Varsayılan yapılandırmada web grubunun her düğüme benzersiz bir anahtar halkası depolanır.</span><span class="sxs-lookup"><span data-stu-id="f067d-134">Under the default configuration, a unique key ring is stored on each node of the web farm.</span></span> <span data-ttu-id="f067d-135">Sonuç olarak, her web grubu düğümü, herhangi bir düğümde bir uygulama tarafından şifrelenmiş verilerin şifresini çözemez.</span><span class="sxs-lookup"><span data-stu-id="f067d-135">Consequently, each web farm node can't decrypt data that's encrypted by an app on any other node.</span></span> <span data-ttu-id="f067d-136">Varsayılan yapılandırma, uygulamaları bir web grubunda barındırmak için genel kullanıma uygun değil.</span><span class="sxs-lookup"><span data-stu-id="f067d-136">The default configuration isn't generally appropriate for hosting apps in a web farm.</span></span> <span data-ttu-id="f067d-137">Paylaşılan bir anahtar halkası uygulama kullanıcı isteklerini her zaman aynı düğüme yönlendirmek alternatiftir.</span><span class="sxs-lookup"><span data-stu-id="f067d-137">An alternative to implementing a shared key ring is to always route user requests to the same node.</span></span> <span data-ttu-id="f067d-138">Web grubu dağıtımları için veri koruma sistem yapılandırması hakkında daha fazla bilgi için bkz. <xref:security/data-protection/configuration/overview>.</span><span class="sxs-lookup"><span data-stu-id="f067d-138">For more information on Data Protection system configuration for web farm deployments, see <xref:security/data-protection/configuration/overview>.</span></span>

### <a name="caching"></a><span data-ttu-id="f067d-139">Önbelleğe alma</span><span class="sxs-lookup"><span data-stu-id="f067d-139">Caching</span></span>

<span data-ttu-id="f067d-140">Bir web çiftliği ortamında, web grubun düğümlerde önbelleğe alınmış öğeleri önbelleğe alma mekanizması paylaşmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="f067d-140">In a web farm environment, the caching mechanism must share cached items across the web farm's nodes.</span></span> <span data-ttu-id="f067d-141">Önbelleğe alma ya da ortak bir Redis önbelleği, paylaşılan bir SQL Server veritabanı veya web grubunda önbelleğe alınmış öğeleri paylaşan özel bir önbelleğe alma uygulaması kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="f067d-141">Caching must either rely upon a common Redis cache, a shared SQL Server database, or a custom caching implementation that shares cached items across the web farm.</span></span> <span data-ttu-id="f067d-142">Daha fazla bilgi için bkz. <xref:performance/caching/distributed>.</span><span class="sxs-lookup"><span data-stu-id="f067d-142">For more information, see <xref:performance/caching/distributed>.</span></span>

## <a name="dependent-components"></a><span data-ttu-id="f067d-143">Bağımlı bileşenler</span><span class="sxs-lookup"><span data-stu-id="f067d-143">Dependent components</span></span>

<span data-ttu-id="f067d-144">Aşağıdaki senaryoları, ek bir yapılandırma gerekmez, ancak yapılandırma için web grupları iste teknolojileri bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="f067d-144">The following scenarios don't require additional configuration, but they depend on technologies that require configuration for web farms.</span></span>

| <span data-ttu-id="f067d-145">Senaryo</span><span class="sxs-lookup"><span data-stu-id="f067d-145">Scenario</span></span> | <span data-ttu-id="f067d-146">Bağlıdır &hellip;</span><span class="sxs-lookup"><span data-stu-id="f067d-146">Depends on &hellip;</span></span> |
| -------- | ------------------- |
| <span data-ttu-id="f067d-147">Kimlik doğrulaması</span><span class="sxs-lookup"><span data-stu-id="f067d-147">Authentication</span></span> | <span data-ttu-id="f067d-148">Veri koruma (bkz <xref:security/data-protection/configuration/overview>).</span><span class="sxs-lookup"><span data-stu-id="f067d-148">Data Protection (see <xref:security/data-protection/configuration/overview>).</span></span><br><br><span data-ttu-id="f067d-149">Daha fazla bilgi için bkz. <xref:security/authentication/cookie> ve <xref:security/cookie-sharing>.</span><span class="sxs-lookup"><span data-stu-id="f067d-149">For more information, see <xref:security/authentication/cookie> and <xref:security/cookie-sharing>.</span></span> |
| <span data-ttu-id="f067d-150">Kimlik</span><span class="sxs-lookup"><span data-stu-id="f067d-150">Identity</span></span> | <span data-ttu-id="f067d-151">Kimlik doğrulaması ve veritabanı yapılandırması.</span><span class="sxs-lookup"><span data-stu-id="f067d-151">Authentication and database configuration.</span></span><br><br><span data-ttu-id="f067d-152">Daha fazla bilgi için bkz. <xref:security/authentication/identity>.</span><span class="sxs-lookup"><span data-stu-id="f067d-152">For more information, see <xref:security/authentication/identity>.</span></span> |
| <span data-ttu-id="f067d-153">Oturum</span><span class="sxs-lookup"><span data-stu-id="f067d-153">Session</span></span> | <span data-ttu-id="f067d-154">Veri koruma (şifrelenmiş tanımlama bilgileri) (bkz <xref:security/data-protection/configuration/overview>) ve önbelleğe alma (bkz <xref:performance/caching/distributed>).</span><span class="sxs-lookup"><span data-stu-id="f067d-154">Data Protection (encrypted cookies) (see <xref:security/data-protection/configuration/overview>) and Caching (see <xref:performance/caching/distributed>).</span></span><br><br><span data-ttu-id="f067d-155">Daha fazla bilgi için [oturum ve uygulama durumu: oturum durumunu](xref:fundamentals/app-state#session-state).</span><span class="sxs-lookup"><span data-stu-id="f067d-155">For more information, see [Session and app state: Session state](xref:fundamentals/app-state#session-state).</span></span> |
| <span data-ttu-id="f067d-156">TempData</span><span class="sxs-lookup"><span data-stu-id="f067d-156">TempData</span></span> | <span data-ttu-id="f067d-157">Veri koruma (şifrelenmiş tanımlama bilgileri) (bkz <xref:security/data-protection/configuration/overview>) veya oturumu (bkz [oturum ve uygulama durumu: oturum durumunu](xref:fundamentals/app-state#session-state)).</span><span class="sxs-lookup"><span data-stu-id="f067d-157">Data Protection (encrypted cookies) (see <xref:security/data-protection/configuration/overview>) or Session (see [Session and app state: Session state](xref:fundamentals/app-state#session-state)).</span></span><br><br><span data-ttu-id="f067d-158">Daha fazla bilgi için [oturum ve uygulama durumu: TempData](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="f067d-158">For more information, see [Session and app state: TempData](xref:fundamentals/app-state#tempdata).</span></span> |
| <span data-ttu-id="f067d-159">Sahteciliğe karşı koruma</span><span class="sxs-lookup"><span data-stu-id="f067d-159">Anti-forgery</span></span> | <span data-ttu-id="f067d-160">Veri koruma (bkz <xref:security/data-protection/configuration/overview>).</span><span class="sxs-lookup"><span data-stu-id="f067d-160">Data Protection (see <xref:security/data-protection/configuration/overview>).</span></span><br><br><span data-ttu-id="f067d-161">Daha fazla bilgi için bkz. <xref:security/anti-request-forgery>.</span><span class="sxs-lookup"><span data-stu-id="f067d-161">For more information, see <xref:security/anti-request-forgery>.</span></span> |

## <a name="troubleshoot"></a><span data-ttu-id="f067d-162">Sorun giderme</span><span class="sxs-lookup"><span data-stu-id="f067d-162">Troubleshoot</span></span>

<span data-ttu-id="f067d-163">Veri koruma veya önbelleğe alma için bir web grubu ortamında yapılandırılmamış, isteklerin işlenmesi aralıklı hatalar ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="f067d-163">When Data Protection or Caching isn't configured for a web farm environment, intermittent errors occur when requests are processed.</span></span> <span data-ttu-id="f067d-164">Bu, çünkü kullanıcı istekleri her zaman aynı düğüme geri yönlendirilmesini değil ve düğümleri aynı kaynakları paylaşmayın oluşur.</span><span class="sxs-lookup"><span data-stu-id="f067d-164">This occurs because nodes don't share the same resources and user requests aren't always routed back to the same node.</span></span>

<span data-ttu-id="f067d-165">Tanımlama bilgisi kimlik doğrulamasını kullanarak uygulamada oturum oturum açtığında kullanıcıyı göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="f067d-165">Consider a user who signs into the app using cookie authentication.</span></span> <span data-ttu-id="f067d-166">Uygulama bir web grubu düğümü üzerinde kullanıcı işaretlerine.</span><span class="sxs-lookup"><span data-stu-id="f067d-166">The user signs into the app on one web farm node.</span></span> <span data-ttu-id="f067d-167">Bir sonraki istekte, bunlar burada açan aynı düğümde alınırsa, uygulama kimlik doğrulama tanımlama bilgisi şifresini ve uygulamanın kaynağa erişim izni verir.</span><span class="sxs-lookup"><span data-stu-id="f067d-167">If their next request arrives at the same node where they signed in, the app is able to decrypt the authentication cookie and allows access to the app's resource.</span></span> <span data-ttu-id="f067d-168">Bir sonraki istekte farklı bir düğümden alınırsa, uygulama düğümden burada kullanıcının oturum açtığı ve istenen kaynak için yetkilendirme başarısız kimlik doğrulama tanımlama bilgisinin şifresini çözemez.</span><span class="sxs-lookup"><span data-stu-id="f067d-168">If their next request arrives at a different node, the app can't decrypt the authentication cookie from the node where the user signed in, and authorization for the requested resource fails.</span></span>

<span data-ttu-id="f067d-169">Aşağıdaki belirtilerden birini olduğunda **aralıklı olarak**, sorun genellikle bir web grubu ortamında hatalı veri koruması veya önbelleğe alma yapılandırmasını izlenen:</span><span class="sxs-lookup"><span data-stu-id="f067d-169">When any of the following symptoms occur **intermittently**, the problem is usually traced to improper Data Protection or Caching configuration for a web farm environment:</span></span>

* <span data-ttu-id="f067d-170">Kimlik doğrulaması sonları &ndash; kimlik doğrulama tanımlama bilgisi yanlış yapılandırılmış veya şifresi çözülemiyor.</span><span class="sxs-lookup"><span data-stu-id="f067d-170">Authentication breaks &ndash; The authentication cookie is misconfigured or can't be decrypted.</span></span> <span data-ttu-id="f067d-171">OAuth (Facebook, Microsoft, Twitter) veya Openıdconnect oturum açmalar "bağıntı başarısız oldu." hatasıyla başarısız</span><span class="sxs-lookup"><span data-stu-id="f067d-171">OAuth (Facebook, Microsoft, Twitter) or OpenIdConnect logins fail with the error "Correlation failed."</span></span>
* <span data-ttu-id="f067d-172">Yetkilendirme sonları &ndash; kimlik kaybolur.</span><span class="sxs-lookup"><span data-stu-id="f067d-172">Authorization breaks &ndash; Identity is lost.</span></span>
* <span data-ttu-id="f067d-173">Oturum durumu verileri kaybeder.</span><span class="sxs-lookup"><span data-stu-id="f067d-173">Session state loses data.</span></span>
* <span data-ttu-id="f067d-174">Önbelleğe alınmış öğeleri kaybolur.</span><span class="sxs-lookup"><span data-stu-id="f067d-174">Cached items disappear.</span></span>
* <span data-ttu-id="f067d-175">TempData başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="f067d-175">TempData fails.</span></span>
* <span data-ttu-id="f067d-176">Başarısız gönderileri &ndash; sahteciliğe karşı koruma denetimi başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="f067d-176">POSTs fail &ndash; The anti-forgery check fails.</span></span>

<span data-ttu-id="f067d-177">Web grubu dağıtımları için veri koruma yapılandırması hakkında daha fazla bilgi için bkz. <xref:security/data-protection/configuration/overview>.</span><span class="sxs-lookup"><span data-stu-id="f067d-177">For more information on Data Protection configuration for web farm deployments, see <xref:security/data-protection/configuration/overview>.</span></span> <span data-ttu-id="f067d-178">Web grubu dağıtımları için önbelleğe alma yapılandırması hakkında daha fazla bilgi için bkz. <xref:performance/caching/distributed>.</span><span class="sxs-lookup"><span data-stu-id="f067d-178">For more information on Caching configuration for web farm deployments, see <xref:performance/caching/distributed>.</span></span>
